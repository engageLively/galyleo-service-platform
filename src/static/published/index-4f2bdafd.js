System.register(['./__rootModule___commonjs-entry-2a340242.js', './index-57981d2f.js', './loading-indicator.cp-680c2ecd.js', './ui.cp-46daffed.js', './messages.cp-ccfb5763.js', './code-search.cp-140da4d6.js', './editor-modes-146d3c1c.js', './editor-plugin-b7298219.js', './inputs-b8bdf948.js', './dialogs.cp-40ebcbc0.js', 'lively.collab', './canvas-eb622915.js', './object-classes-cce74fc2.js', './morph-to-image-e16449de.js'], (function (exports, module) {
  'use strict';
  var Image, _asyncToGenerator, Label, TilingLayout, ViewModel, part, component, connect, signal, Color, pt, initializeClass, ShellClientResource, runCommand, _inherits, _createSuper, _classCallCheck, _createClass, Text, Morph, Icon, guardNamed, disconnect, L2LClient, bounceEasing, delay, arr, _slicedToArray, string, defaultDirectory, _toConsumableArray, Rectangle, fun, obj, GridLayout, World, config, packagesOfSnapshot, resource, join, runCommand$1, exports$1, currentUserToken, isUserLoggedIn, currentUser, currentUsername, reloadPackage, addOrChangeCSSDeclaration, generateFontFaceString, _createForOfIteratorHelper, _defineProperty, _wrapRegExp, registerExtension, easings, touchInputDevice, morph, MorphicDB, HTMLMorph, ConstraintLayout, ShadowObject, modules, LinearGradient, rect, promise, graph, date, without, add, Path, Ellipse, clearUserData, clearAllUserData, storeCurrentUser, storeCurrentUsersOrganizations, storeCurrentUserToken, waitFor, timeToRun, currentUsersOrganizations, once, materialDesignColors, num, epiConnect, PolicyApplicator, BreakpointStore, tree, inspect, KeyHandler, interactivelySaveWorld, createMorphSnapshot, BrowserModuleTranslationCache, _typeof, max, min, Polygon, Closure, getClassName, SystemTooltip, notYetImplemented, noUpdate, commonjsHelpers, isModuleLoaded, module$1, adoptObject, withAllViewModelsDo, joinPath, grid, Point, Path$1, loadMorphFromSnapshot, completions, runEval, serialize, pathForBrowserHistory, subscribe, GreenButton, ConfirmPrompt, RedButton, PlainButton, SearchField, InputLineDark, DarkPrompt, AbstractPromptModel, OKCancelButtonWrapper, LightPrompt, InputLineDefault, Checkbox, LabeledCheckboxLight, LabeledCheckbox, TreeData, prompts, Window, Menu, Spinner, DarkButton, MorphList, LoadingIndicator, SystemList, SystemButton, EnumSelector, SystemButtonDark, DarkNumberIconWidget, PropertyLabel, PropertyLabelActive, DarkThemeList, PropertyLabelHovered, AddButton, PropLabel, DarkFlap, DarkPopupWindow, RemoveButton, DropDownList, DarkDropDownList, ButtonDarkDefault, PopupWindow, TextInput, PropertyLabelDisabled, evalOnServer, CodeMirrorEnabledEditorPlugin, Snippet, EditorPlugin, guessTextModeName, localInterface, loadPackage, show, showAndSnapToGuides, removeSnapToGuidesOf, browserForFile, RichTextPlugin, PropertySection, PropertySectionModel, ColorInput, DarkColorPicker, PopupModel, ShadowPopup, OpacityPopup, FlipPopup, TiltPopup, CursorPopup, BlurPopup, InsetShadowPopup, MullerColumnView, ColumnListDark, ColumnListDefault, COLORS, InteractiveComponentDescriptor, RichTextControl, Halo, MorphHighlighter, _missingExportShim, GridLayoutHalo, StatusMessageConfirm, StatusMessageError, StatusMessageDefault, CodeSearch, defineMode, defineMIME, DiffEditorPlugin, InputLine, InformIconOnLight, SaveWorldDialog, CommentBrowser, CommentData, Canvas, ObjectPackage, renderMorphToDataURI;
  return {
    setters: [function (module) {
      Image = module.I;
      _asyncToGenerator = module._;
      Label = module.L;
      TilingLayout = module.T;
      ViewModel = module.V;
      part = module.p;
      component = module.c;
      connect = module.a;
      signal = module.s;
      Color = module.C;
      pt = module.b;
      initializeClass = module.i;
      ShellClientResource = module.S;
      runCommand = module.r;
      _inherits = module.d;
      _createSuper = module.e;
      _classCallCheck = module.f;
      _createClass = module.g;
      Text = module.h;
      Morph = module.M;
      Icon = module.j;
      guardNamed = module.k;
      disconnect = module.l;
      L2LClient = module.m;
      bounceEasing = module.n;
      delay = module.o;
      arr = module.q;
      _slicedToArray = module.t;
      string = module.u;
      defaultDirectory = module.v;
      _toConsumableArray = module.w;
      Rectangle = module.R;
      fun = module.x;
      obj = module.y;
      GridLayout = module.G;
      World = module.W;
      config = module.z;
      packagesOfSnapshot = module.A;
      resource = module.B;
      join = module.D;
      runCommand$1 = module.E;
      exports$1 = module.F;
      currentUserToken = module.H;
      isUserLoggedIn = module.J;
      currentUser = module.K;
      currentUsername = module.N;
      reloadPackage = module.O;
      addOrChangeCSSDeclaration = module.P;
      generateFontFaceString = module.Q;
      _createForOfIteratorHelper = module.U;
      _defineProperty = module.X;
      _wrapRegExp = module.Y;
      registerExtension = module.Z;
      easings = module.$;
      touchInputDevice = module.a0;
      morph = module.a1;
      MorphicDB = module.a2;
      HTMLMorph = module.a3;
      ConstraintLayout = module.a4;
      ShadowObject = module.a5;
      modules = module.a6;
      LinearGradient = module.a7;
      rect = module.a8;
      promise = module.a9;
      graph = module.aa;
      date = module.ab;
      without = module.ac;
      add = module.ad;
      Path = module.ae;
      Ellipse = module.af;
      clearUserData = module.ag;
      clearAllUserData = module.ah;
      storeCurrentUser = module.ai;
      storeCurrentUsersOrganizations = module.aj;
      storeCurrentUserToken = module.ak;
      waitFor = module.al;
      timeToRun = module.am;
      currentUsersOrganizations = module.an;
      once = module.ao;
      materialDesignColors = module.ap;
      num = module.aq;
      epiConnect = module.ar;
      PolicyApplicator = module.as;
      BreakpointStore = module.at;
      tree = module.au;
      inspect = module.av;
      KeyHandler = module.aw;
      interactivelySaveWorld = module.ax;
      createMorphSnapshot = module.ay;
      BrowserModuleTranslationCache = module.az;
      _typeof = module.aA;
      max = module.aB;
      min = module.aC;
      Polygon = module.aD;
      Closure = module.aE;
      getClassName = module.aF;
      SystemTooltip = module.aG;
      notYetImplemented = module.aH;
      noUpdate = module.aI;
      commonjsHelpers = module.aJ;
      isModuleLoaded = module.aK;
      module$1 = module.aL;
      adoptObject = module.aM;
      withAllViewModelsDo = module.aN;
      joinPath = module.aO;
      grid = module.aP;
      Point = module.aQ;
      Path$1 = module.aR;
      loadMorphFromSnapshot = module.aS;
      completions = module.aT;
      runEval = module.aU;
      serialize = module.aV;
      pathForBrowserHistory = module.aW;
      subscribe = module.aX;
    }, function (module) {
      GreenButton = module.G;
      ConfirmPrompt = module.C;
      RedButton = module.R;
      PlainButton = module.P;
      SearchField = module.S;
      InputLineDark = module.I;
      DarkPrompt = module.D;
      AbstractPromptModel = module.A;
      OKCancelButtonWrapper = module.O;
      LightPrompt = module.L;
      InputLineDefault = module.a;
      Checkbox = module.b;
      LabeledCheckboxLight = module.c;
      LabeledCheckbox = module.d;
      TreeData = module.T;
      prompts = module.p;
      Window = module.W;
      Menu = module.M;
    }, function (module) {
      Spinner = module.S;
      DarkButton = module.D;
      MorphList = module.M;
      LoadingIndicator = module.L;
      SystemList = module.a;
      SystemButton = module.b;
      EnumSelector = module.E;
      SystemButtonDark = module.c;
      DarkNumberIconWidget = module.d;
      PropertyLabel = module.P;
      PropertyLabelActive = module.e;
      DarkThemeList = module.f;
      PropertyLabelHovered = module.g;
      AddButton = module.A;
      PropLabel = module.h;
      DarkFlap = module.i;
      DarkPopupWindow = module.j;
      RemoveButton = module.R;
      DropDownList = module.k;
      DarkDropDownList = module.l;
      ButtonDarkDefault = module.B;
      PopupWindow = module.m;
      TextInput = module.T;
      PropertyLabelDisabled = module.n;
    }, function (module) {
      evalOnServer = module.e;
      CodeMirrorEnabledEditorPlugin = module.C;
      Snippet = module.S;
      EditorPlugin = module.E;
      guessTextModeName = module.g;
      localInterface = module.l;
      loadPackage = module.a;
      show = module.s;
      showAndSnapToGuides = module.b;
      removeSnapToGuidesOf = module.r;
      browserForFile = module.c;
      RichTextPlugin = module.R;
      PropertySection = module.P;
      PropertySectionModel = module.d;
      ColorInput = module.f;
      DarkColorPicker = module.D;
      PopupModel = module.h;
      ShadowPopup = module.i;
      OpacityPopup = module.O;
      FlipPopup = module.F;
      TiltPopup = module.T;
      CursorPopup = module.j;
      BlurPopup = module.B;
      InsetShadowPopup = module.I;
      MullerColumnView = module.M;
      ColumnListDark = module.k;
      ColumnListDefault = module.m;
      COLORS = module.n;
      InteractiveComponentDescriptor = module.o;
      RichTextControl = module.p;
      Halo = module.H;
      MorphHighlighter = module.q;
      _missingExportShim = module._;
      GridLayoutHalo = module.G;
    }, function (module) {
      StatusMessageConfirm = module.StatusMessageConfirm;
      StatusMessageError = module.StatusMessageError;
      StatusMessageDefault = module.StatusMessageDefault;
    }, function (module) {
      CodeSearch = module.C;
    }, function (module) {
      defineMode = module.defineMode;
      defineMIME = module.defineMIME;
    }, function (module) {
      DiffEditorPlugin = module["default"];
    }, function (module) {
      InputLine = module.I;
      InformIconOnLight = module.a;
    }, function (module) {
      SaveWorldDialog = module.SaveWorldDialog;
    }, function (module) {
      CommentBrowser = module.CommentBrowser;
      CommentData = module.CommentData;
    }, function (module) {
      Canvas = module.C;
    }, function (module) {
      ObjectPackage = module["default"];
    }, function (module) {
      renderMorphToDataURI = module.renderMorphToDataURI;
    }],
    execute: (function () {

      exports('p', projectAsset);

      var __varRecorder__$D = lively.FreezerRuntime.recorderFor("lively.morphic/events/html-drop-handler.js");

      function uploadItem() {}

      __varRecorder__$D.uploadItem = uploadItem;

      function uploadFile(_x, _x2, _x3) {
        return _uploadFile.apply(this, arguments);
      }

      function _uploadFile() {
        _uploadFile = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee(file, type, options) {
          var imageUrl;
          return regeneratorRuntime.wrap(function _callee$(_context) {
            while (1) {
              switch (_context.prev = _context.next) {
                case 0:
                  if (!type.startsWith("image/")) {
                    _context.next = 5;
                    break;
                  }

                  _context.next = 3;
                  return __varRecorder__$D.fileReadAsDataURL(file);

                case 3:
                  imageUrl = _context.sent;
                  return _context.abrupt("return", new __varRecorder__$D.Image({
                    imageUrl: imageUrl,
                    autoResize: true,
                    name: file.name
                  }));

                case 5:
                  return _context.abrupt("return", null);

                case 6:
                case "end":
                  return _context.stop();
              }
            }
          }, _callee);
        }));
        return _uploadFile.apply(this, arguments);
      }

      __varRecorder__$D.uploadFile = uploadFile;

      function fileReadAsDataURL(file) {
        return new Promise(function (resolve, reject) {
          var reader = new FileReader();

          reader.onload = function (e) {
            return resolve(e.target.result);
          };

          reader.readAsDataURL(file);
        });
      }

      __varRecorder__$D.fileReadAsDataURL = fileReadAsDataURL;
      __varRecorder__$D.Image = Image;
      __varRecorder__$D.uploadItem = uploadItem;
      __varRecorder__$D.uploadFile = uploadFile;

      var __varRecorder__$C = lively.FreezerRuntime.recorderFor("lively.components/widgets/mode-selector.cp.js");
      __varRecorder__$C.Label = Label;
      __varRecorder__$C.TilingLayout = TilingLayout;
      __varRecorder__$C.ViewModel = ViewModel;
      __varRecorder__$C.part = part;
      __varRecorder__$C.component = component;
      __varRecorder__$C.connect = connect;
      __varRecorder__$C.signal = signal;
      __varRecorder__$C.Color = Color;
      __varRecorder__$C.pt = pt;

      (function (superclass) {
        var __lively_classholder__ = lively.FreezerRuntime.recorderFor("lively.components/widgets/mode-selector.cp.js");

        var __lively_class__ = __lively_classholder__.hasOwnProperty("ModeSelectorModel") && typeof __lively_classholder__.ModeSelectorModel === "function" ? __lively_classholder__.ModeSelectorModel : __lively_classholder__.ModeSelectorModel = function ModeSelectorModel(__first_arg__) {
          if (__first_arg__ && __first_arg__[Symbol["for"]("lively-instance-restorer")]) ; else {
            return this[Symbol["for"]("lively-instance-initialize")].apply(this, arguments);
          }
        };

        return initializeClass(__lively_class__, superclass, [{
          key: "viewDidLoad",
          value: function ModeSelectorModel_viewDidLoad_() {
            this.createLabels();
            this.select(this.selectedItem || this.items[0].name);
            if (!this.enabled) this.disable();
          }
        }, {
          key: "onRefresh",
          value: function ModeSelectorModel_onRefresh_(prop) {
            if (prop === "enabled") {
              if (this.enabled) this.enable();else this.disable();
            }

            if (prop === "selectedItem") {
              this.select(this.selectedItem);
            }
          }
        }, {
          key: "enable",
          value: function ModeSelectorModel_enable_() {
            this.ui.labels.forEach(function (l) {
              return l.nativeCursor = "pointer";
            });
            this.view.opacity = 1;
          }
        }, {
          key: "disable",
          value: function ModeSelectorModel_disable_() {
            this.ui.labels.forEach(function (l) {
              return l.nativeCursor = "not-allowed";
            });
            this.view.opacity = 0.5;
          }
        }, {
          key: "createLabels",
          value: function ModeSelectorModel_createLabels_() {
            var _this = this;

            this.view.submorphs = this.items.map(function (item) {
              var label = __varRecorder__$C.part(__varRecorder__$C.ModeSelectorLabel, {
                textString: item.text,
                name: item.name,
                tooltip: item.tooltip
              });

              __varRecorder__$C.connect(label, "onMouseDown", _this, "select", {
                updater: "function ($upd) {\n          if (!viewModel.enabled) return;\n          $upd(label.name, true, true);\n        }",
                varMapping: {
                  label: label,
                  viewModel: _this
                }
              });

              return label;
            });
          }
        }, {
          key: "select",
          value: function () {
            var _ModeSelectorModel_select_ = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee(itemName) {
              var withAnimation,
                  withSignal,
                  labelToSelect,
                  _args = arguments;
              return regeneratorRuntime.wrap(function _callee$(_context) {
                while (1) {
                  switch (_context.prev = _context.next) {
                    case 0:
                      withAnimation = _args.length > 1 && _args[1] !== undefined ? _args[1] : false;
                      withSignal = _args.length > 2 && _args[2] !== undefined ? _args[2] : false;

                      if (!withAnimation) {
                        _context.next = 9;
                        break;
                      }

                      this.ui.labels.forEach(function (l) {
                        if (l.name !== itemName) {
                          l.withAnimationDo(function () {
                            l.master = {
                              auto: __varRecorder__$C.ModeSelectorLabel
                            };
                          }, {
                            duration: 200
                          });
                        }
                      });
                      labelToSelect = this.ui.labels.find(function (label) {
                        return label.name === itemName;
                      });
                      _context.next = 7;
                      return labelToSelect.withAnimationDo(function () {
                        labelToSelect.master = {
                          auto: __varRecorder__$C.ModeSelectorLabelSelected
                        };
                      }, {
                        duration: 200
                      });

                    case 7:
                      _context.next = 11;
                      break;

                    case 9:
                      this.ui.labels.forEach(function (l) {
                        if (l.name !== itemName) {
                          l.master = {
                            auto: __varRecorder__$C.ModeSelectorLabel
                          };
                        }
                      });
                      this.ui.labels.find(function (label) {
                        return label.name === itemName;
                      }).master = {
                        auto: __varRecorder__$C.ModeSelectorLabelSelected
                      };

                    case 11:
                      this.selectedItem = itemName;
                      if (withSignal) __varRecorder__$C.signal(this.view, "selectionChanged", this.selectedItem);

                    case 13:
                    case "end":
                      return _context.stop();
                  }
                }
              }, _callee, this);
            }));

            function ModeSelectorModel_select_(_x) {
              return _ModeSelectorModel_select_.apply(this, arguments);
            }

            return ModeSelectorModel_select_;
          }()
        }], [{
          key: Symbol["for"]("__LivelyClassName__"),
          get: function get() {
            return "ModeSelectorModel";
          }
        }, {
          key: "properties",
          get: function get() {
            return {
              expose: {
                get: function get() {
                  return ["select", "items", "enabled", "selectedItem"];
                }
              },
              items: {},
              selectedItem: {},
              enabled: {
                defaultValue: true
              }
            };
          }
        }], __lively_classholder__, {
          pathInPackage: function pathInPackage() {
            return "./widgets/mode-selector.cp.js";
          },
          unsubscribeFromToplevelDefinitionChanges: function unsubscribeFromToplevelDefinitionChanges() {
            return function () {};
          },
          subscribeToToplevelDefinitionChanges: function subscribeToToplevelDefinitionChanges() {
            return function () {};
          },
          "package": function _package() {
            return {
              name: "lively.components",
              version: "0.1.0"
            };
          }
        }, {
          start: 1098,
          end: 4531
        });
      })(__varRecorder__$C.ViewModel);

      __varRecorder__$C.ModeSelectorLabel = __varRecorder__$C.component["for"](function () {
        return __varRecorder__$C.component({
          type: __varRecorder__$C.Label,
          nativeCursor: "pointer",
          name: "mode selector label",
          fontWeight: "bold",
          fill: __varRecorder__$C.Color.transparent,
          fontColor: __varRecorder__$C.Color.black,
          padding: 5,
          borderRadius: 3,
          textString: "a mode selector label"
        });
      }, {
        module: "lively.components/widgets/mode-selector.cp.js",
        "export": "ModeSelectorLabel",
        range: {
          start: 4539,
          end: 4792
        }
      }, __varRecorder__$C.ModeSelectorLabel);
      __varRecorder__$C.ModeSelectorLabelSelected = __varRecorder__$C.component["for"](function () {
        return __varRecorder__$C.component(__varRecorder__$C.ModeSelectorLabel, {
          fill: __varRecorder__$C.Color.black.withA(0.4),
          fontColor: __varRecorder__$C.Color.white
        });
      }, {
        module: "lively.components/widgets/mode-selector.cp.js",
        "export": "ModeSelectorLabelSelected",
        range: {
          start: 4800,
          end: 4918
        }
      }, __varRecorder__$C.ModeSelectorLabelSelected);
      __varRecorder__$C.ModeSelector = __varRecorder__$C.component["for"](function () {
        return __varRecorder__$C.component({
          defaultViewModel: __varRecorder__$C.ModeSelectorModel,
          name: "mode selector",
          extent: __varRecorder__$C.pt(234.7, 36.7),
          nativeCursor: "pointer",
          height: 30,
          fill: __varRecorder__$C.Color.transparent,
          layout: new __varRecorder__$C.TilingLayout({
            align: "center",
            axisAlign: "center",
            orderByIndex: true,
            spacing: 5
          }),
          submorphs: [__varRecorder__$C.part(__varRecorder__$C.ModeSelectorLabel, {
            name: "mode1",
            textString: "demo"
          }), __varRecorder__$C.part(__varRecorder__$C.ModeSelectorLabel, {
            name: "mode2",
            textString: "demo2"
          })]
        });
      }, {
        module: "lively.components/widgets/mode-selector.cp.js",
        "export": "ModeSelector",
        range: {
          start: 4926,
          end: 5397
        }
      }, __varRecorder__$C.ModeSelector);
      var ModeSelector = __varRecorder__$C.ModeSelector;
      __varRecorder__$C.ModeSelector = ModeSelector;

      var __varRecorder__$B = lively.FreezerRuntime.recorderFor("lively.shell/git-client-resource.js");
      __varRecorder__$B.ShellClientResource = ShellClientResource;
      __varRecorder__$B.runCommand = runCommand;

      var GitShellResource = /*#__PURE__*/function (_varRecorder__$Shell) {
        _inherits(GitShellResource, _varRecorder__$Shell);

        var _super = _createSuper(GitShellResource);

        function GitShellResource(url) {
          var _this;

          _classCallCheck(this, GitShellResource);

          url = url.replace("git/", "");
          _this = _super.call(this, url);
          _this.options.cwd = _this.url;
          return _this;
        }

        _createClass(GitShellResource, [{
          key: "runCommand",
          value: function runCommand(cmd) {
            return __varRecorder__$B.runCommand(cmd, this.options);
          }
        }, {
          key: "isGitRepository",
          value: function () {
            var _isGitRepository = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee() {
              var isDir, cmd;
              return regeneratorRuntime.wrap(function _callee$(_context) {
                while (1) {
                  switch (_context.prev = _context.next) {
                    case 0:
                      _context.next = 2;
                      return this.isDirectory();

                    case 2:
                      isDir = _context.sent;

                      if (isDir) {
                        _context.next = 5;
                        break;
                      }

                      return _context.abrupt("return", false);

                    case 5:
                      cmd = this.runCommand("test -d \".git\"");
                      _context.next = 8;
                      return cmd.whenDone();

                    case 8:
                      return _context.abrupt("return", cmd.exitCode === 0);

                    case 9:
                    case "end":
                      return _context.stop();
                  }
                }
              }, _callee, this);
            }));

            function isGitRepository() {
              return _isGitRepository.apply(this, arguments);
            }

            return isGitRepository;
          }()
        }, {
          key: "initializeGitRepository",
          value: function () {
            var _initializeGitRepository = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee2() {
              var cmd;
              return regeneratorRuntime.wrap(function _callee2$(_context2) {
                while (1) {
                  switch (_context2.prev = _context2.next) {
                    case 0:
                      cmd = this.runCommand("git init && git symbolic-ref HEAD refs/heads/main");
                      _context2.next = 3;
                      return cmd.whenDone();

                    case 3:
                      if (!(cmd.exitCode !== 0)) {
                        _context2.next = 5;
                        break;
                      }

                      throw Error("Error initializing git repository");

                    case 5:
                    case "end":
                      return _context2.stop();
                  }
                }
              }, _callee2, this);
            }));

            function initializeGitRepository() {
              return _initializeGitRepository.apply(this, arguments);
            }

            return initializeGitRepository;
          }()
        }, {
          key: "hasRemote",
          value: function () {
            var _hasRemote = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee3() {
              var checkRemoteCommand, res;
              return regeneratorRuntime.wrap(function _callee3$(_context3) {
                while (1) {
                  switch (_context3.prev = _context3.next) {
                    case 0:
                      checkRemoteCommand = "git remote";
                      _context3.next = 3;
                      return this.runCommand(checkRemoteCommand).whenDone();

                    case 3:
                      res = _context3.sent;

                      if (!(res.exitCode !== 0)) {
                        _context3.next = 6;
                        break;
                      }

                      throw Error("Error while executing git remote.");

                    case 6:
                      if (!(res.stdout === "")) {
                        _context3.next = 10;
                        break;
                      }

                      return _context3.abrupt("return", false);

                    case 10:
                      return _context3.abrupt("return", true);

                    case 11:
                    case "end":
                      return _context3.stop();
                  }
                }
              }, _callee3, this);
            }));

            function hasRemote() {
              return _hasRemote.apply(this, arguments);
            }

            return hasRemote;
          }()
        }, {
          key: "hasRemoteMainConfigured",
          value: function () {
            var _hasRemoteMainConfigured = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee4() {
              var getRemoteURLCommand, res, remoteOutput, remoteURL, checkRemoteBranchCommand;
              return regeneratorRuntime.wrap(function _callee4$(_context4) {
                while (1) {
                  switch (_context4.prev = _context4.next) {
                    case 0:
                      getRemoteURLCommand = "git remote -v";
                      _context4.next = 3;
                      return this.runCommand(getRemoteURLCommand).whenDone();

                    case 3:
                      res = _context4.sent;

                      if (!(res.exitCode !== 0)) {
                        _context4.next = 6;
                        break;
                      }

                      throw Error("Error while executing git remote.");

                    case 6:
                      remoteOutput = res.stdout;

                      if (!(remoteOutput === "")) {
                        _context4.next = 9;
                        break;
                      }

                      throw "Remote unconfigured. This should be impossible!";

                    case 9:
                      remoteURL = remoteOutput.match(/(https:.*)\s\(/)[1];
                      checkRemoteBranchCommand = "git ls-remote --heads ".concat(remoteURL, " main");
                      _context4.next = 13;
                      return this.runCommand(checkRemoteBranchCommand).whenDone();

                    case 13:
                      res = _context4.sent;

                      if (!(res.exitCode !== 0)) {
                        _context4.next = 16;
                        break;
                      }

                      throw Error("Error while checking remote branches.");

                    case 16:
                      if (!(res.stdout === "")) {
                        _context4.next = 18;
                        break;
                      }

                      return _context4.abrupt("return", false);

                    case 18:
                      return _context4.abrupt("return", true);

                    case 19:
                    case "end":
                      return _context4.stop();
                  }
                }
              }, _callee4, this);
            }));

            function hasRemoteMainConfigured() {
              return _hasRemoteMainConfigured.apply(this, arguments);
            }

            return hasRemoteMainConfigured;
          }()
        }, {
          key: "createAndAddRemoteToGitRepository",
          value: function () {
            var _createAndAddRemoteToGitRepository = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee5(token, repoName, repoUser, repoDescription, orgScope, priv) {
              var repoCreationCommand, cmd, addingRemoteCommand;
              return regeneratorRuntime.wrap(function _callee5$(_context5) {
                while (1) {
                  switch (_context5.prev = _context5.next) {
                    case 0:
                      repoCreationCommand = orgScope ? "curl -L               -X POST               -H \"Accept: application/vnd.github+json\"               -H \"Authorization: Bearer ".concat(token, "\"              -H \"X-GitHub-Api-Version: 2022-11-28\"               https://api.github.com/orgs/").concat(repoUser, "/repos               -d '{\"name\":\"").concat(repoName, "\",\"description\":\"").concat(repoDescription, "\", \"private\":").concat(!!priv, "}'") : "curl -L               -X POST               -H \"Accept: application/vnd.github+json\"               -H \"Authorization: Bearer ".concat(token, "\"               https://api.github.com/user/repos               -d '{\"name\":\"").concat(repoName, "\", \"description\": \"").concat(repoDescription, "\", \"private\":").concat(!!priv, "}'");
                      cmd = this.runCommand(repoCreationCommand);
                      _context5.next = 4;
                      return cmd.whenDone();

                    case 4:
                      if (!(cmd.exitCode !== 0)) {
                        _context5.next = 6;
                        break;
                      }

                      throw Error("Error executing curl call to create GitHub repository");

                    case 6:
                      addingRemoteCommand = "git remote add origin https://".concat(token, "@github.com/").concat(repoUser, "/").concat(repoName, ".git");
                      cmd = this.runCommand(addingRemoteCommand);
                      _context5.next = 10;
                      return cmd.whenDone();

                    case 10:
                      if (!(cmd.exitCode !== 0)) {
                        _context5.next = 12;
                        break;
                      }

                      throw Error("Error adding the remote to local repository");

                    case 12:
                    case "end":
                      return _context5.stop();
                  }
                }
              }, _callee5, this);
            }));

            function createAndAddRemoteToGitRepository(_x, _x2, _x3, _x4, _x5, _x6) {
              return _createAndAddRemoteToGitRepository.apply(this, arguments);
            }

            return createAndAddRemoteToGitRepository;
          }()
        }, {
          key: "changeRemoteVisibility",
          value: function () {
            var _changeRemoteVisibility = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee6(token, repoName, repoUser, visibility) {
              var changeVisbilityCommand, cmd;
              return regeneratorRuntime.wrap(function _callee6$(_context6) {
                while (1) {
                  switch (_context6.prev = _context6.next) {
                    case 0:
                      changeVisbilityCommand = "curl -L   -X PATCH   -H \"Accept: application/vnd.github+json\"   -H \"Authorization: Bearer ".concat(token, "\"   -H \"X-GitHub-Api-Version: 2022-11-28\"   https://api.github.com/repos/").concat(repoUser, "/").concat(repoName, "   -d '{\"private\":").concat(visibility === "private", "}'");
                      cmd = this.runCommand(changeVisbilityCommand);
                      _context6.next = 4;
                      return cmd.whenDone();

                    case 4:
                      if (!(cmd.exitCode !== 0)) {
                        _context6.next = 7;
                        break;
                      }

                      console.error("Error updating repository settings.");
                      return _context6.abrupt("return", false);

                    case 7:
                      console.log("Repository settings updated.");
                      return _context6.abrupt("return", true);

                    case 9:
                    case "end":
                      return _context6.stop();
                  }
                }
              }, _callee6, this);
            }));

            function changeRemoteVisibility(_x7, _x8, _x9, _x10) {
              return _changeRemoteVisibility.apply(this, arguments);
            }

            return changeRemoteVisibility;
          }()
        }, {
          key: "activateGitHubPages",
          value: function () {
            var _activateGitHubPages = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee7(token, repoName, repoUser) {
              var activateGitHubPagesEnvironmentCommand, cmd;
              return regeneratorRuntime.wrap(function _callee7$(_context7) {
                while (1) {
                  switch (_context7.prev = _context7.next) {
                    case 0:
                      activateGitHubPagesEnvironmentCommand = "curl -L       -X POST       -H \"Accept: application/vnd.github+json\"       -H \"Authorization: Bearer ".concat(token, "\"       -H \"X-GitHub-Api-Version: 2022-11-28\"       https://api.github.com/repos/").concat(repoUser, "/").concat(repoName, "/pages       -d '{\"build_type\": \"workflow\"}'");
                      cmd = this.runCommand(activateGitHubPagesEnvironmentCommand);
                      _context7.next = 4;
                      return cmd.whenDone();

                    case 4:
                      if (cmd.exitCode !== 0) console.error("Activating GitHub Pages for ".concat(repoUser, "/").concat(repoName, " was not successful. Proceeding."));

                    case 5:
                    case "end":
                      return _context7.stop();
                  }
                }
              }, _callee7, this);
            }));

            function activateGitHubPages(_x11, _x12, _x13) {
              return _activateGitHubPages.apply(this, arguments);
            }

            return activateGitHubPages;
          }()
        }, {
          key: "commitRepo",
          value: function () {
            var _commitRepo = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee8(message) {
              var tag,
                  tagName,
                  filesToCommit,
                  cmdString,
                  cmd,
                  _args8 = arguments;
              return regeneratorRuntime.wrap(function _callee8$(_context8) {
                while (1) {
                  switch (_context8.prev = _context8.next) {
                    case 0:
                      tag = _args8.length > 1 && _args8[1] !== undefined ? _args8[1] : false;
                      tagName = _args8.length > 2 ? _args8[2] : undefined;
                      filesToCommit = _args8.length > 3 && _args8[3] !== undefined ? _args8[3] : ".";
                      cmdString = "git add ".concat(filesToCommit, " && git commit -m \"").concat(message, "\"");
                      cmd = this.runCommand(cmdString);
                      _context8.next = 7;
                      return cmd.whenDone();

                    case 7:
                      if (!(cmd.exitCode !== 0 && !cmd.stdout.includes("nothing to commit"))) {
                        _context8.next = 11;
                        break;
                      }

                      throw Error("Error committing");

                    case 11:
                      if (!tag) {
                        _context8.next = 18;
                        break;
                      }

                      cmdString = "git tag v".concat(tagName);
                      cmd = this.runCommand(cmdString);
                      _context8.next = 16;
                      return cmd.whenDone();

                    case 16:
                      if (!(cmd.exitCode !== 0)) {
                        _context8.next = 18;
                        break;
                      }

                      throw Error("Error tagging release");

                    case 18:
                      return _context8.abrupt("return", true);

                    case 19:
                    case "end":
                      return _context8.stop();
                  }
                }
              }, _callee8, this);
            }));

            function commitRepo(_x14) {
              return _commitRepo.apply(this, arguments);
            }

            return commitRepo;
          }()
        }, {
          key: "pushRepo",
          value: function () {
            var _pushRepo = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee9() {
              var cmd;
              return regeneratorRuntime.wrap(function _callee9$(_context9) {
                while (1) {
                  switch (_context9.prev = _context9.next) {
                    case 0:
                      cmd = this.runCommand("git push --set-upstream origin main");
                      _context9.next = 3;
                      return cmd.whenDone();

                    case 3:
                      if (!(cmd.exitCode !== 0)) {
                        _context9.next = 5;
                        break;
                      }

                      throw Error("Error pushing to remote");

                    case 5:
                      cmd = this.runCommand("git push origin --tags");
                      _context9.next = 8;
                      return cmd.whenDone();

                    case 8:
                      if (!(cmd.exitCode !== 0)) {
                        _context9.next = 10;
                        break;
                      }

                      throw Error("Error pushing tags to remote");

                    case 10:
                      return _context9.abrupt("return", true);

                    case 11:
                    case "end":
                      return _context9.stop();
                  }
                }
              }, _callee9, this);
            }));

            function pushRepo() {
              return _pushRepo.apply(this, arguments);
            }

            return pushRepo;
          }()
        }, {
          key: "pullRepo",
          value: function () {
            var _pullRepo = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee10() {
              var hasRemoteBranch, pullCmd, cmd;
              return regeneratorRuntime.wrap(function _callee10$(_context10) {
                while (1) {
                  switch (_context10.prev = _context10.next) {
                    case 0:
                      _context10.next = 2;
                      return this.hasRemoteMainConfigured();

                    case 2:
                      hasRemoteBranch = _context10.sent;

                      if (hasRemoteBranch) {
                        _context10.next = 5;
                        break;
                      }

                      return _context10.abrupt("return", false);

                    case 5:
                      _context10.next = 7;
                      return this.runCommand("git stash").whenDone();

                    case 7:
                      pullCmd = this.runCommand("git pull --rebase");
                      _context10.next = 10;
                      return pullCmd.whenDone();

                    case 10:
                      if (!(pullCmd.exitCode !== 0)) {
                        _context10.next = 12;
                        break;
                      }

                      throw Error("Error pulling. Might be due to a conflict!");

                    case 12:
                      cmd = this.runCommand("git stash pop");
                      _context10.next = 15;
                      return cmd.whenDone();

                    case 15:
                      if (!(cmd.exitCode !== 0 && cmd.stderr !== "No stash entries found.\n")) {
                        _context10.next = 19;
                        break;
                      }

                      throw Error("Error applying stash. Might be due to a conflict!");

                    case 19:
                      return _context10.abrupt("return", true);

                    case 20:
                    case "end":
                      return _context10.stop();
                  }
                }
              }, _callee10, this);
            }));

            function pullRepo() {
              return _pullRepo.apply(this, arguments);
            }

            return pullRepo;
          }()
        }, {
          key: "resetFile",
          value: function () {
            var _resetFile = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee11(fileName) {
              var resetCmd;
              return regeneratorRuntime.wrap(function _callee11$(_context11) {
                while (1) {
                  switch (_context11.prev = _context11.next) {
                    case 0:
                      resetCmd = "git checkout ".concat(fileName);
                      _context11.next = 3;
                      return this.runCommand(resetCmd).whenDone();

                    case 3:
                    case "end":
                      return _context11.stop();
                  }
                }
              }, _callee11, this);
            }));

            function resetFile(_x15) {
              return _resetFile.apply(this, arguments);
            }

            return resetFile;
          }()
        }, {
          key: "hasUncommitedChanges",
          value: function () {
            var _hasUncommitedChanges = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee12() {
              var checkCmd, check;
              return regeneratorRuntime.wrap(function _callee12$(_context12) {
                while (1) {
                  switch (_context12.prev = _context12.next) {
                    case 0:
                      checkCmd = "(git add * || true) && git diff --cached --exit-code && git diff --exit-code";
                      check = this.runCommand(checkCmd);
                      _context12.next = 4;
                      return check.whenDone();

                    case 4:
                      return _context12.abrupt("return", !!check.exitCode);

                    case 5:
                    case "end":
                      return _context12.stop();
                  }
                }
              }, _callee12, this);
            }));

            function hasUncommitedChanges() {
              return _hasUncommitedChanges.apply(this, arguments);
            }

            return hasUncommitedChanges;
          }()
        }]);

        return GitShellResource;
      }(__varRecorder__$B.ShellClientResource);
      __varRecorder__$B.GitShellResource = GitShellResource;
      var gitResourceExtension = {
        name: "git-shell-client",
        matches: function matches(url) {
          return url.startsWith("git/") || url.match(/[a-z]:\\/i);
        },
        resourceClass: __varRecorder__$B.GitShellResource
      };
      __varRecorder__$B.gitResourceExtension = gitResourceExtension;
      __varRecorder__$B.gitResourceExtension = gitResourceExtension;
      __varRecorder__$B["default"] = GitShellResource;

      var __varRecorder__$A = lively.FreezerRuntime.recorderFor("lively.project/templates/test-action.js");

      var workflowDefinition = "name: Run Tests\n\non:%ACTION_TRIGGER%\n  workflow_dispatch:\n\nconcurrency:\n  group: \"test\"\n  cancel-in-progress: true\n\njobs:\n  tests:\n    runs-on: ubuntu-latest\n    steps:\n      - name: Setup `node`\n        uses: actions/setup-node@v3\n        with:\n          node-version: '18.12.1'\n      - name: Restore `lively.next` installation\n        id: cache-lively-with-build\n        uses: actions/cache/restore@v3\n        env:\n          cache-name: lively-repo-with-build\n          ref: %LIVELY_VERSION%\n        with:\n          path: .            \n          key: ${{ runner.os }}-${{ env.cache-name }}-${{ env.ref }}\n      - name: Checkout `lively.next`\n        if: ${{ steps.cache-lively-with-build.outputs.cache-hit != 'true' }}\n        uses: actions/checkout@v3\n        with:\n          repository: LivelyKernel/lively.next\n          ref: %LIVELY_VERSION%\n      - name: Install `lively.next`\n        if: ${{ steps.cache-lively-with-build.outputs.cache-hit != 'true' }}\n        run: |\n          chmod a+x ./install.sh\n          ./install.sh\n      - name: Save `lively` installation in cache\n        if: ${{ steps.cache-lively-with-build.outputs.cache-hit != 'true' }}\n        uses: actions/cache/save@v3\n        env:\n          cache-name: lively-repo-with-build\n          ref: %LIVELY_VERSION%\n        with:\n          path: .            \n          key: ${{ runner.os }}-${{ env.cache-name }}-${{ env.ref }}     \n      - name: Checkout Project Repository\n        uses: actions/checkout@v3\n        with:\n          path: local_projects/%PROJECT_NAME%\n      - name: Start `lively.next`\n        run: |\n          ./start-server.sh > /dev/null 2>&1 &\n          # wait until server is guaranteed to be running\n          sleep 30\n      - name: Run CI Test Script \n        run:  ./scripts/test.sh %PROJECT_NAME%";
      __varRecorder__$A.workflowDefinition = workflowDefinition;
      __varRecorder__$A.workflowDefinition = workflowDefinition;

      var __varRecorder__$z = lively.FreezerRuntime.recorderFor("lively.ide/studio/version-checker.cp.js");
      __varRecorder__$z.component = component;
      __varRecorder__$z.Text = Text;
      __varRecorder__$z.part = part;
      __varRecorder__$z.TilingLayout = TilingLayout;
      __varRecorder__$z.Morph = Morph;
      __varRecorder__$z.Icon = Icon;
      __varRecorder__$z.Label = Label;
      __varRecorder__$z.evalOnServer = evalOnServer;
      __varRecorder__$z.Color = Color;
      __varRecorder__$z.pt = pt;
      __varRecorder__$z.runCommand = runCommand;
      __varRecorder__$z.guardNamed = guardNamed;
      __varRecorder__$z.Spinner = Spinner;
      __varRecorder__$z.disconnect = disconnect;
      __varRecorder__$z.connect = connect;
      __varRecorder__$z.L2LClient = L2LClient;
      __varRecorder__$z.bounceEasing = bounceEasing;
      __varRecorder__$z.delay = delay;

      var VersionChecker = function (superclass) {
        var __lively_classholder__ = lively.FreezerRuntime.recorderFor("lively.ide/studio/version-checker.cp.js");

        var __lively_class__ = __lively_classholder__.hasOwnProperty("VersionChecker") && typeof __lively_classholder__.VersionChecker === "function" ? __lively_classholder__.VersionChecker : __lively_classholder__.VersionChecker = function VersionChecker(__first_arg__) {
          if (__first_arg__ && __first_arg__[Symbol["for"]("lively-instance-restorer")]) ; else {
            return this[Symbol["for"]("lively-instance-initialize")].apply(this, arguments);
          }
        };

        return initializeClass(__lively_class__, superclass, [{
          key: "isVersionChecker",
          get: function get() {
            return true;
          }
        }, {
          key: "onLoad",
          value: function VersionChecker_onLoad_() {
            if (!this.isComponent) {
              this.withAllSubmorphsDo(function (m) {
                return m.halosEnabled = false;
              });
            }
          }
        }, {
          key: "checkVersion",
          value: function () {
            var _VersionChecker_checkVersion_ = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee() {
              return regeneratorRuntime.wrap(function _callee$(_context) {
                while (1) {
                  switch (_context.prev = _context.next) {
                    case 0:
                      this.reset();
                      _context.next = 3;
                      return this.displayLivelyVersionStatus();

                    case 3:
                    case "end":
                      return _context.stop();
                  }
                }
              }, _callee, this);
            }));

            function VersionChecker_checkVersion_() {
              return _VersionChecker_checkVersion_.apply(this, arguments);
            }

            return VersionChecker_checkVersion_;
          }()
        }, {
          key: "updateLively",
          value: function () {
            var _VersionChecker_updateLively_ = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee3() {
              var li, cwd, currentClientCommit, checkIfNewServer, _checkIfNewServer, updateStatus, cmd;

              return regeneratorRuntime.wrap(function _callee3$(_context3) {
                while (1) {
                  switch (_context3.prev = _context3.next) {
                    case 0:
                      _checkIfNewServer = function _checkIfNewServer3() {
                        _checkIfNewServer = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee2() {
                          var retries,
                              backoffTime,
                              peers,
                              gitVersionCheckerOnServer,
                              sameServerVersion,
                              _args2 = arguments;
                          return regeneratorRuntime.wrap(function _callee2$(_context2) {
                            while (1) {
                              switch (_context2.prev = _context2.next) {
                                case 0:
                                  retries = _args2.length > 0 && _args2[0] !== undefined ? _args2[0] : 20;
                                  backoffTime = 2000;
                                  _context2.next = 4;
                                  return __varRecorder__$z.L2LClient["default"]().listPeers();

                                case 4:
                                  peers = _context2.sent;
                                  gitVersionCheckerOnServer = peers.find(function (peer) {
                                    return peer.type === "git version checker";
                                  });

                                  if (gitVersionCheckerOnServer) {
                                    _context2.next = 11;
                                    break;
                                  }

                                  if (!retries) {
                                    _context2.next = 10;
                                    break;
                                  }

                                  setTimeout(checkIfNewServer(retries - 1), backoffTime);
                                  return _context2.abrupt("return");

                                case 10:
                                  throw new Error("Timing Issue during automatic restart of lively.next. You need to restart lively manually!");

                                case 11:
                                  _context2.next = 13;
                                  return __varRecorder__$z.L2LClient["default"]().sendAndWait({
                                    target: gitVersionCheckerOnServer.id,
                                    action: "check git version",
                                    data: {
                                      payload: currentClientCommit
                                    }
                                  });

                                case 13:
                                  sameServerVersion = _context2.sent;

                                  if (!sameServerVersion.data) {
                                    _context2.next = 22;
                                    break;
                                  }

                                  if (!(sameServerVersion.data.isError && sameServerVersion.data.error === "message not understood: check git version")) {
                                    _context2.next = 20;
                                    break;
                                  }

                                  if (!retries) {
                                    _context2.next = 19;
                                    break;
                                  }

                                  setTimeout(checkIfNewServer(retries - 1), backoffTime);
                                  return _context2.abrupt("return");

                                case 19:
                                  throw new Error("Timing Issue during automatic restart of lively.next. You need to restart lively manually!");

                                case 20:
                                  _context2.next = 27;
                                  break;

                                case 22:
                                  li.remove();

                                  __varRecorder__$z.disconnect(__varRecorder__$z.L2LClient["default"](), "onReconnect");

                                  _context2.next = 26;
                                  return $world.inform("Press OK to reload this page and finish the update.");

                                case 26:
                                  location.reload();

                                case 27:
                                case "end":
                                  return _context2.stop();
                              }
                            }
                          }, _callee2);
                        }));
                        return _checkIfNewServer.apply(this, arguments);
                      };

                      checkIfNewServer = function _checkIfNewServer2() {
                        return _checkIfNewServer.apply(this, arguments);
                      };

                      $world.withAllSubmorphsDo(function (m) {
                        return m.blur = 3;
                      });
                      li = $world.showLoadingIndicatorFor($world, "Updating lively");
                      _context3.next = 6;
                      return __varRecorder__$z.VersionChecker.cwd();

                    case 6:
                      cwd = _context3.sent;
                      _context3.next = 9;
                      return __varRecorder__$z.VersionChecker.currentLivelyVersion(true);

                    case 9:
                      currentClientCommit = _context3.sent;

                      __varRecorder__$z.connect(__varRecorder__$z.L2LClient["default"](), "onReconnect", checkIfNewServer);

                      updateStatus = new __varRecorder__$z.Text({
                        name: "update status",
                        fill: __varRecorder__$z.Color.white,
                        extent: __varRecorder__$z.pt(300, 300),
                        clipMode: "auto",
                        lineWrapping: "by-words",
                        position: __varRecorder__$z.pt(li.center.x - 150, li.bottom + 10),
                        hasFixedPosition: true,
                        fixedWidth: true,
                        fixedHeight: true,
                        padding: 5,
                        borderColor: __varRecorder__$z.Color.lively,
                        borderWidth: 2,
                        needsDocument: true,
                        borderRadius: 5,
                        halosEnabled: true
                      });
                      $world.addMorph(updateStatus);
                      cmd = __varRecorder__$z.runCommand("./update.sh", {
                        cwd: cwd
                      });

                      __varRecorder__$z.connect(cmd, "stdout", function (output) {
                        updateStatus.textString = updateStatus.textString + output;
                        updateStatus.gotoDocumentEnd();
                        updateStatus.scrollCursorIntoView();
                      });

                    case 15:
                    case "end":
                      return _context3.stop();
                  }
                }
              }, _callee3);
            }));

            function VersionChecker_updateLively_() {
              return _VersionChecker_updateLively_.apply(this, arguments);
            }

            return VersionChecker_updateLively_;
          }()
        }, {
          key: "onMouseDown",
          value: function () {
            var _VersionChecker_onMouseDown_ = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee5(evt) {
              var _this = this;

              return regeneratorRuntime.wrap(function _callee5$(_context5) {
                while (1) {
                  switch (_context5.prev = _context5.next) {
                    case 0:
                      initializeClass._get(Object.getPrototypeOf(__lively_class__.prototype), "onMouseDown", this).call(this, evt);

                      if (!(evt.targetMorph === this.ui.status)) {
                        _context5.next = 5;
                        break;
                      }

                      _context5.next = 4;
                      return this.updateLively();

                    case 4:
                      return _context5.abrupt("return");

                    case 5:
                      if (!(evt.targetMorph.name === "commit id copier")) {
                        _context5.next = 8;
                        break;
                      }

                      __varRecorder__$z.guardNamed("copying", /*#__PURE__*/_asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee4() {
                        return regeneratorRuntime.wrap(function _callee4$(_context4) {
                          while (1) {
                            switch (_context4.prev = _context4.next) {
                              case 0:
                                navigator.clipboard.writeText(_this.hash);
                                _context4.next = 3;
                                return _this.ui.copyButton.animate({
                                  duration: 500,
                                  fontColor: __varRecorder__$z.Color.green
                                }).then(function () {
                                  return __varRecorder__$z.delay(2000);
                                }).then(function () {
                                  return _this.ui.copyButton.animate({
                                    duration: 500,
                                    fontColor: __varRecorder__$z.Color.rgb(152, 152, 152)
                                  });
                                });

                              case 3:
                              case "end":
                                return _context4.stop();
                            }
                          }
                        }, _callee4);
                      })))();

                      return _context5.abrupt("return");

                    case 8:
                      if (!this.isComponent) {
                        this.checkVersion();
                      }

                    case 9:
                    case "end":
                      return _context5.stop();
                  }
                }
              }, _callee5, this);
            }));

            function VersionChecker_onMouseDown_(_x) {
              return _VersionChecker_onMouseDown_.apply(this, arguments);
            }

            return VersionChecker_onMouseDown_;
          }()
        }, {
          key: "relayout",
          value: function VersionChecker_relayout_() {
            var padding = 10;
            var dragAreaWidth = 5;

            if (this.world().sceneGraph && this.world().sceneGraph.owner) {
              this.bottomLeft = this.world().visibleBounds().bottomLeft().withX(this.world().sceneGraph.right).addXY(padding, -padding).subXY(dragAreaWidth, 0);
            } else {
              this.bottomLeft = this.world().visibleBounds().insetBy(padding).bottomLeft();
            }
          }
        }, {
          key: "displayLivelyVersionStatus",
          value: function () {
            var _VersionChecker_displayLivelyVersionStatus_ = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee6() {
              var _yield$__varRecorder_, hash, comparison, comparisonResult;

              return regeneratorRuntime.wrap(function _callee6$(_context6) {
                while (1) {
                  switch (_context6.prev = _context6.next) {
                    case 0:
                      _context6.next = 2;
                      return __varRecorder__$z.VersionChecker.checkVersionRelation();

                    case 2:
                      _yield$__varRecorder_ = _context6.sent;
                      hash = _yield$__varRecorder_.hash;
                      comparison = _yield$__varRecorder_.comparison;
                      this.hash = hash;

                      if (hash && comparison) {
                        _context6.next = 9;
                        break;
                      }

                      this.showError();
                      return _context6.abrupt("return");

                    case 9:
                      hash = hash.slice(0, 6);
                      comparisonResult = __varRecorder__$z.VersionChecker.parseHashComparison(comparison);
                      _context6.t0 = comparisonResult;
                      _context6.next = _context6.t0 === 0 ? 14 : _context6.t0 === 1 ? 16 : _context6.t0 === -1 ? 18 : _context6.t0 === 2 ? 20 : 21;
                      break;

                    case 14:
                      this.showEven(hash);
                      return _context6.abrupt("break", 21);

                    case 16:
                      this.showAhead(hash);
                      return _context6.abrupt("break", 21);

                    case 18:
                      this.showBehind(hash);
                      return _context6.abrupt("break", 21);

                    case 20:
                      this.showDiverged(hash);

                    case 21:
                    case "end":
                      return _context6.stop();
                  }
                }
              }, _callee6, this);
            }));

            function VersionChecker_displayLivelyVersionStatus_() {
              return _VersionChecker_displayLivelyVersionStatus_.apply(this, arguments);
            }

            return VersionChecker_displayLivelyVersionStatus_;
          }()
        }, {
          key: "showEven",
          value: function VersionChecker_showEven_(version) {
            var status = this.ui.status;
            status.value = ["Version: ", {}, "[".concat(version, "]"), {
              fontWeight: "bold"
            }];
            this.updateShownIcon("even");
          }
        }, {
          key: "showBehind",
          value: function () {
            var _VersionChecker_showBehind_ = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee7(version) {
              var cwd, currentBranchCmd, currBranch, _this$ui, status, updateButtonWrapper;

              return regeneratorRuntime.wrap(function _callee7$(_context7) {
                while (1) {
                  switch (_context7.prev = _context7.next) {
                    case 0:
                      _context7.next = 2;
                      return __varRecorder__$z.VersionChecker.cwd();

                    case 2:
                      cwd = _context7.sent;
                      currentBranchCmd = "git rev-parse --abbrev-ref HEAD";
                      _context7.next = 6;
                      return __varRecorder__$z.runCommand(currentBranchCmd, {
                        cwd: cwd
                      }).whenDone();

                    case 6:
                      currBranch = _context7.sent;
                      currBranch = currBranch.stdout.replace("\n", "");
                      _this$ui = this.ui, status = _this$ui.status, updateButtonWrapper = _this$ui.updateButtonWrapper;

                      if (currBranch === "main") {
                        updateButtonWrapper.visible = updateButtonWrapper.isLayoutable = true;
                        status.reactsToPointer = true;
                        status.nativeCursor = "pointer";
                        this.bounceUpdateButton();
                        status.value = ["Press here to update!", {
                          fontWeight: "bold"
                        }];
                        this.updateShownIcon("none");
                      } else {
                        status.value = ["Version: ", {}, "[".concat(version, "]"), {
                          fontWeight: "bold"
                        }, " (Please update!)"];
                        this.updateShownIcon("behind");
                      }

                    case 10:
                    case "end":
                      return _context7.stop();
                  }
                }
              }, _callee7, this);
            }));

            function VersionChecker_showBehind_(_x2) {
              return _VersionChecker_showBehind_.apply(this, arguments);
            }

            return VersionChecker_showBehind_;
          }()
        }, {
          key: "bounceUpdateButton",
          value: function () {
            var _VersionChecker_bounceUpdateButton_ = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee8() {
              var updateButton;
              return regeneratorRuntime.wrap(function _callee8$(_context8) {
                while (1) {
                  switch (_context8.prev = _context8.next) {
                    case 0:
                      updateButton = this.ui.updateButton;
                      _context8.next = 3;
                      return updateButton.animate({
                        customTween: function customTween(p) {
                          updateButton.left = __varRecorder__$z.bounceEasing(p, 1, 10, 1);
                        },
                        easing: function easing(t) {
                          return t;
                        }
                      });

                    case 3:
                      _context8.next = 5;
                      return updateButton.animate({
                        left: 0
                      });

                    case 5:
                      setTimeout(this.bounceUpdateButton.bind(this), 2500);

                    case 6:
                    case "end":
                      return _context8.stop();
                  }
                }
              }, _callee8, this);
            }));

            function VersionChecker_bounceUpdateButton_() {
              return _VersionChecker_bounceUpdateButton_.apply(this, arguments);
            }

            return VersionChecker_bounceUpdateButton_;
          }()
        }, {
          key: "showAhead",
          value: function VersionChecker_showAhead_(version) {
            var status = this.ui.status;
            status.value = ["Version: ", {}, "[".concat(version, "]"), {
              fontWeight: "bold"
            }];
            this.updateShownIcon("ahead");
          }
        }, {
          key: "showDiverged",
          value: function VersionChecker_showDiverged_(version) {
            var status = this.ui.status;
            status.value = ["Version: ", {}, "[".concat(version, "]"), {
              fontWeight: "bold"
            }, " (Please update!)"];
            this.updateShownIcon("diverged");
          }
        }, {
          key: "showError",
          value: function VersionChecker_showError_() {
            var status = this.ui.status;
            status.value = "Error while checking";
            this.updateShownIcon("error");
          }
        }, {
          key: "updateShownIcon",
          value: function VersionChecker_updateShownIcon_(mode) {
            var _this$ui2 = this.ui,
                checking = _this$ui2.checking,
                statusIcon = _this$ui2.statusIcon;

            switch (mode) {
              case "checking":
                {
                  checking.visible = checking.isLayoutable = true;
                  statusIcon.visible = statusIcon.isLayoutable = false;
                  return;
                }

              case "even":
                {
                  statusIcon.textAndAttributes = __varRecorder__$z.Icon.textAttribute("check-circle");
                  statusIcon.fontColor = __varRecorder__$z.Color.rgb(40, 180, 99);
                  break;
                }

              case "ahead":
                {
                  statusIcon.textAndAttributes = __varRecorder__$z.Icon.textAttribute("arrow-up");
                  statusIcon.fontColor = __varRecorder__$z.Color.rgb(72, 152, 243);
                  break;
                }

              case "diverged":
                {
                  statusIcon.textAndAttributes = __varRecorder__$z.Icon.textAttribute("arrows-up-down");
                  statusIcon.fontColor = __varRecorder__$z.Color.rgb(231, 76, 60);
                  break;
                }

              case "error":
                {
                  statusIcon.textAndAttributes = __varRecorder__$z.Icon.textAttribute("exclamation-triangle");
                  statusIcon.fontColor = __varRecorder__$z.Color.rgb(231, 76, 60);
                  break;
                }

              case "behind":
                {
                  statusIcon.textAndAttributes = __varRecorder__$z.Icon.textAttribute("arrow-down");
                  statusIcon.fontColor = __varRecorder__$z.Color.rgb(231, 76, 60);
                  break;
                }

              case "none":
                {
                  checking.visible = checking.isLayoutable = false;
                  statusIcon.visible = statusIcon.isLayoutable = false;
                  return;
                }
            }

            checking.visible = checking.isLayoutable = false;
            statusIcon.visible = statusIcon.isLayoutable = true;
          }
        }, {
          key: "reset",
          value: function VersionChecker_reset_() {
            var status = this.ui.status;
            status.value = "Checking version...";
            this.updateShownIcon("checking");
          }
        }], [{
          key: Symbol["for"]("__LivelyClassName__"),
          get: function get() {
            return "VersionChecker";
          }
        }, {
          key: "properties",
          get: function get() {
            return {
              isEpiMorph: {
                derived: true,
                get: function get() {
                  return !this.isComponent;
                }
              },
              respondsToVisibleWindow: {
                derived: true,
                get: function get() {
                  return !this.isComponent;
                }
              },
              ui: {
                derived: true,
                get: function get() {
                  return {
                    status: this.get("version status label"),
                    checking: this.get("loading indicator"),
                    statusIcon: this.get("status icon label"),
                    copyButton: this.get("commit id copier"),
                    updateButton: this.get("update button"),
                    updateButtonWrapper: this.get("update button wrapper")
                  };
                }
              }
            };
          }
        }, {
          key: "currentLivelyVersion",
          value: function () {
            var _VersionChecker_currentLivelyVersion_ = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee9(main) {
              var cwd, fetchCmd, hashCmd, result;
              return regeneratorRuntime.wrap(function _callee9$(_context9) {
                while (1) {
                  switch (_context9.prev = _context9.next) {
                    case 0:
                      _context9.next = 2;
                      return __varRecorder__$z.VersionChecker.cwd();

                    case 2:
                      cwd = _context9.sent;
                      fetchCmd = "git fetch";
                      _context9.next = 6;
                      return __varRecorder__$z.runCommand(fetchCmd, {
                        cwd: cwd
                      }).whenDone();

                    case 6:
                      hashCmd = main ? "git merge-base origin/main HEAD" : "git rev-parse @";
                      _context9.next = 9;
                      return __varRecorder__$z.runCommand(hashCmd, {
                        cwd: cwd
                      }).whenDone();

                    case 9:
                      result = _context9.sent;
                      return _context9.abrupt("return", result.stdout.trim());

                    case 11:
                    case "end":
                      return _context9.stop();
                  }
                }
              }, _callee9);
            }));

            function VersionChecker_currentLivelyVersion_(_x3) {
              return _VersionChecker_currentLivelyVersion_.apply(this, arguments);
            }

            return VersionChecker_currentLivelyVersion_;
          }()
        }, {
          key: "cwd",
          value: function () {
            var _VersionChecker_cwd_ = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee10() {
              return regeneratorRuntime.wrap(function _callee10$(_context10) {
                while (1) {
                  switch (_context10.prev = _context10.next) {
                    case 0:
                      _context10.next = 2;
                      return __varRecorder__$z.evalOnServer("System.baseURL").then(function (cwd) {
                        return cwd.replace("file://", "");
                      });

                    case 2:
                      return _context10.abrupt("return", _context10.sent);

                    case 3:
                    case "end":
                      return _context10.stop();
                  }
                }
              }, _callee10);
            }));

            function VersionChecker_cwd_() {
              return _VersionChecker_cwd_.apply(this, arguments);
            }

            return VersionChecker_cwd_;
          }()
        }, {
          key: "checkVersionRelation",
          value: function () {
            var _VersionChecker_checkVersionRelation_ = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee11(hashToCheckAgainst, compareLatestAncestor) {
              var cwd, currentLivelyVersion, comparison, commonAncestor, findLatestMainAncestorCmd, comparingCmd;
              return regeneratorRuntime.wrap(function _callee11$(_context11) {
                while (1) {
                  switch (_context11.prev = _context11.next) {
                    case 0:
                      _context11.next = 2;
                      return __varRecorder__$z.VersionChecker.cwd();

                    case 2:
                      cwd = _context11.sent;
                      _context11.next = 5;
                      return __varRecorder__$z.VersionChecker.currentLivelyVersion();

                    case 5:
                      currentLivelyVersion = _context11.sent;

                      if (!compareLatestAncestor) {
                        _context11.next = 13;
                        break;
                      }

                      findLatestMainAncestorCmd = "git merge-base origin/main HEAD";
                      _context11.next = 10;
                      return __varRecorder__$z.runCommand(findLatestMainAncestorCmd, {
                        cwd: cwd
                      }).whenDone();

                    case 10:
                      __varRecorder__$z.__inter0__ = _context11.sent;
                      commonAncestor = __varRecorder__$z.__inter0__.stdout;
                      commonAncestor = commonAncestor.trim();

                    case 13:
                      if (!hashToCheckAgainst) hashToCheckAgainst = "origin/main";
                      comparingCmd = "git rev-list --left-right --count ".concat(hashToCheckAgainst, "...").concat(compareLatestAncestor ? commonAncestor : "@");
                      _context11.next = 17;
                      return __varRecorder__$z.runCommand(comparingCmd, {
                        cwd: cwd
                      }).whenDone();

                    case 17:
                      __varRecorder__$z.__inter1__ = _context11.sent;
                      comparison = __varRecorder__$z.__inter1__.stdout;
                      return _context11.abrupt("return", {
                        comparison: comparison,
                        hash: currentLivelyVersion
                      });

                    case 20:
                    case "end":
                      return _context11.stop();
                  }
                }
              }, _callee11);
            }));

            function VersionChecker_checkVersionRelation_(_x4, _x5) {
              return _VersionChecker_checkVersionRelation_.apply(this, arguments);
            }

            return VersionChecker_checkVersionRelation_;
          }()
        }, {
          key: "parseHashComparison",
          value: function VersionChecker_parseHashComparison_(comparison) {
            comparison = comparison.replace("\n", "").split("\t");
            var numberOfUniqueCommitsOnRemote = parseInt(comparison[0]);
            var numberOfUniqueCommitsLocal = parseInt(comparison[1]);
            if (numberOfUniqueCommitsOnRemote === 0 && numberOfUniqueCommitsLocal === 0) return 0;
            if (numberOfUniqueCommitsOnRemote !== 0 && numberOfUniqueCommitsLocal === 0) return -1;
            if (numberOfUniqueCommitsOnRemote === 0 && numberOfUniqueCommitsLocal !== 0) return 1;
            return 2;
          }
        }], __lively_classholder__, {
          pathInPackage: function pathInPackage() {
            return "./studio/version-checker.cp.js";
          },
          unsubscribeFromToplevelDefinitionChanges: function unsubscribeFromToplevelDefinitionChanges() {
            return function () {};
          },
          subscribeToToplevelDefinitionChanges: function subscribeToToplevelDefinitionChanges() {
            return function () {};
          },
          "package": function _package() {
            return {
              name: "lively.ide",
              version: "0.1.0"
            };
          }
        }, {
          start: 603,
          end: 13359
        });
      }(__varRecorder__$z.Morph);

      __varRecorder__$z.LivelyVersionChecker = __varRecorder__$z.component["for"](function () {
        return __varRecorder__$z.component({
          type: __varRecorder__$z.VersionChecker,
          name: "lively version checker",
          borderColor: __varRecorder__$z.Color.rgb(23, 160, 251),
          borderRadius: 5,
          extent: __varRecorder__$z.pt(135.5, 25.1),
          fill: __varRecorder__$z.Color.rgba(0, 0, 0, 0.6),
          hasFixedPosition: true,
          layout: new __varRecorder__$z.TilingLayout({
            orderByIndex: true,
            hugContentsHorizontally: true,
            hugContentsVertically: true,
            padding: {
              height: 0,
              width: 0,
              x: 5,
              y: 5
            },
            reactToSubmorphAnimations: false,
            spacing: 5
          }),
          nativeCursor: "pointer",
          position: __varRecorder__$z.pt(535, 438.4),
          submorphs: [{
            type: __varRecorder__$z.Label,
            fill: __varRecorder__$z.Color.transparent,
            name: "version status label",
            fontColor: __varRecorder__$z.Color.rgb(253, 254, 254),
            lineHeight: 1.2,
            reactsToPointer: false,
            textAndAttributes: ["Checking version...", null]
          }, __varRecorder__$z.part(__varRecorder__$z.Spinner, {
            name: "loading indicator",
            extent: __varRecorder__$z.pt(83.7, 68.1),
            fill: __varRecorder__$z.Color.rgba(255, 255, 255, 0),
            scale: 0.22
          }), {
            name: "update button wrapper",
            fill: __varRecorder__$z.Color.transparent,
            extent: __varRecorder__$z.pt(30, 0),
            clipMode: "visible",
            isLayoutable: false,
            visible: false,
            submorphs: [{
              type: __varRecorder__$z.Label,
              name: "update button",
              fontSize: 14,
              lineHeight: 1.1,
              fontColor: __varRecorder__$z.Color.lively,
              fill: __varRecorder__$z.Color.transparent,
              textAndAttributes: __varRecorder__$z.Icon.textAttribute("arrow-left")
            }]
          }, {
            type: __varRecorder__$z.Label,
            name: "status icon label",
            fontSize: 14,
            lineHeight: 1.1,
            fontColor: __varRecorder__$z.Color.rgb(231, 76, 60),
            fill: __varRecorder__$z.Color.transparent,
            isLayoutable: false,
            textAndAttributes: __varRecorder__$z.Icon.textAttribute("exclamation-triangle"),
            visible: false
          }, {
            type: __varRecorder__$z.Label,
            name: "commit id copier",
            nativeCursor: "pointer",
            fontSize: 14,
            lineHeight: 1.1,
            fontColor: __varRecorder__$z.Color.rgb(148, 152, 166),
            fill: __varRecorder__$z.Color.transparent,
            textAndAttributes: __varRecorder__$z.Icon.textAttribute("copy")
          }]
        });
      }, {
        module: "lively.ide/studio/version-checker.cp.js",
        "export": "LivelyVersionChecker",
        range: {
          start: 13367,
          end: 15217
        }
      }, __varRecorder__$z.LivelyVersionChecker);
      var LivelyVersionChecker = __varRecorder__$z.LivelyVersionChecker;
      __varRecorder__$z.LivelyVersionChecker = LivelyVersionChecker;
      __varRecorder__$z.VersionChecker = VersionChecker;

      var versionChecker_cp = /*#__PURE__*/Object.freeze({
        __proto__: null,
        LivelyVersionChecker: LivelyVersionChecker,
        VersionChecker: VersionChecker
      });

      var __varRecorder__$y = lively.FreezerRuntime.recorderFor("lively.project/templates/build-shell.js");

      var buildScriptShell = "#!/bin/bash\n\n. ../../scripts/lively-next-flatn-env.sh\nlively_next_flatn_env \"$(dirname \"$(dirname \"$(pwd)\")\")\"\nexport FLATN_DEV_PACKAGE_DIRS=$FLATN_DEV_PACKAGE_DIRS:$(pwd);\nnode --no-experimental-fetch --no-warnings --experimental-import-meta-resolve --experimental-loader ../../flatn/resolver.mjs ./tools/build.mjs\n";
      __varRecorder__$y.buildScriptShell = buildScriptShell;
      __varRecorder__$y.buildScriptShell = buildScriptShell;

      var __varRecorder__$x = lively.FreezerRuntime.recorderFor("lively.project/templates/build.js");

      var buildScript = "/* global process */\nimport { rollup } from 'rollup';\nimport jsonPlugin from '@rollup/plugin-json';\nimport { babel } from '@rollup/plugin-babel';\nimport { lively } from 'lively.freezer/src/plugins/rollup';\nimport resolver from 'lively.freezer/src/resolvers/node.cjs';\nimport PresetEnv from '@babel/preset-env';\n\nconst minify = process.env.MINIFY;\n\nconst build = await rollup({\n  input: './index.js',\n  shimMissingExports: true,  \n  plugins: [\n    lively({\n      autoRun: {\n        title: '%PROJECT_NAME%',\n      },\n      minify,\n      asBrowserModule: true,\n      excludedModules: [\n\t    'lively.collab',\n        'mocha-es6','mocha', // references old lgtg that breaks the build\n        'rollup', // has a dist file that cant be parsed by rollup\n        // other stuff that is only needed by rollup\n        '@babel/preset-env',\n        '@babel/plugin-syntax-import-meta',\n        '@rollup/plugin-json', \n        '@rollup/plugin-commonjs',\n        'rollup-plugin-polyfill-node',\n        'babel-plugin-transform-es2015-modules-systemjs'\n      ],\n      resolver\n    }),\n    jsonPlugin({ exclude: /https\\:\\/\\/jspm.dev\\/.*\\.json/}),\n    babel({\n     babelHelpers: 'bundled', \n     presets: [PresetEnv]\n    })\n   ]\n});\n\nawait build.write({\n  format: 'system',\n  dir: 'build'\n});\n";
      __varRecorder__$x.buildScript = buildScript;
      __varRecorder__$x.buildScript = buildScript;

      var __varRecorder__$w = lively.FreezerRuntime.recorderFor("lively.project/templates/build-upload-action.js");

      var buildRemoteScript = "name: Build Project\n\non:%ACTION_TRIGGER%\n  workflow_dispatch:\n\nconcurrency:\n  group: \"build-and-upload\"\n  cancel-in-progress: true\n\njobs:\n  build:\n    runs-on: ubuntu-latest\n    steps:\n      - name: Setup `node`\n        uses: actions/setup-node@v3\n        with:\n          node-version: '18.12.1'\n      - name: Restore `lively.next` installation\n        id: cache-lively\n        uses: actions/cache/restore@v3\n        env:\n          cache-name: lively-repo\n          ref: %LIVELY_VERSION%\n        with:\n          path: .            \n          key: ${{ runner.os }}-${{ env.cache-name }}-${{ env.ref }}\n      - name: Checkout `lively.next`\n        if: ${{ steps.cache-lively.outputs.cache-hit != 'true' }}\n        uses: actions/checkout@v3\n        with:\n          repository: LivelyKernel/lively.next\n          ref: %LIVELY_VERSION%\n      - name: Install `lively.next`\n        if: ${{ steps.cache-lively.outputs.cache-hit != 'true' }}\n        run: |\n          chmod a+x ./install.sh\n          ./install.sh --freezer-only\n      - name: Save `lively` installation in cache\n        if: ${{ steps.cache-lively.outputs.cache-hit != 'true' }}\n        uses: actions/cache/save@v3\n        env:\n          cache-name: lively-repo\n          ref: %LIVELY_VERSION%\n        with:\n          path: .            \n          key: ${{ runner.os }}-${{ env.cache-name }}-${{ env.ref }}     \n      - name: Checkout Project Repository\n        uses: actions/checkout@v3\n        with:\n          path: local_projects/%PROJECT_NAME%\n      - name: Build Project\n        run: npm run build-minified --prefix local_projects/%PROJECT_NAME%\n      - name: Upload Build Artifacts\n        uses: actions/upload-artifact@v3\n        with:\n          name: build\n          path: local_projects/%PROJECT_NAME%/build";
      __varRecorder__$w.buildRemoteScript = buildRemoteScript;
      __varRecorder__$w.buildRemoteScript = buildRemoteScript;

      var __varRecorder__$v = lively.FreezerRuntime.recorderFor("lively.project/templates/deploy-pages-action.js");

      var deployScript = "name: Deploy Project to GitHub Pages\n\non:%ACTION_TRIGGER%\n  workflow_dispatch:\n\npermissions:\n  pages: write\n  id-token: write%TOKEN_PERMISSIONS%\n\nconcurrency:\n  group: \"build-and-deploy\"\n  cancel-in-progress: false\n\njobs:\n  build:\n    runs-on: ubuntu-latest\n    steps:\n      - name: Setup `node`\n        uses: actions/setup-node@v3\n        with:\n          node-version: '18.12.1'\n      - name: Restore `lively.next` repo\n        id: cache-lively\n        uses: actions/cache/restore@v3\n        env:\n          cache-name: lively-repo\n          ref: %LIVELY_VERSION%\n        with:\n          path: .            \n          key: ${{ runner.os }}-${{ env.cache-name }}-${{ env.ref }}\n      - name: Checkout `lively.next`\n        if: ${{ steps.cache-lively.outputs.cache-hit != 'true' }}\n        uses: actions/checkout@v3\n        with:\n          repository: LivelyKernel/lively.next\n          ref: %LIVELY_VERSION%\n      - name: Install `lively.next`\n        if: ${{ steps.cache-lively.outputs.cache-hit != 'true' }}\n        run: |\n          chmod a+x ./install.sh\n          ./install.sh --freezer-only\n      - name: Save `lively` repo in cache\n        if: ${{ steps.cache-lively.outputs.cache-hit != 'true' }}\n        uses: actions/cache/save@v3\n        env:\n          cache-name: lively-repo\n          ref: %LIVELY_VERSION%\n        with:\n          path: .            \n          key: ${{ runner.os }}-${{ env.cache-name }}-${{ env.ref }}     \n      - name: Checkout Project Repository\n        uses: actions/checkout@v3\n        with:\n          path: local_projects/%PROJECT_NAME%\n      - name: Build Project\n        run: npm run build-minified --prefix local_projects/%PROJECT_NAME%\n      - name: Upload artifact\n        uses: actions/upload-pages-artifact@v2\n        with:\n          path: local_projects/%PROJECT_NAME%/build\n  deploy:\n    needs: [build]\n    runs-on: ubuntu-latest\n    steps:\n      - name: Setup Pages\n        uses: actions/configure-pages@v3\n      - name: Deploy to GitHub Pages\n        uses: actions/deploy-pages@v2\n      - name: Delete uploaded Artifact\n        uses: geekyeggo/delete-artifact@v2\n        with:\n          name: github-pages";
      __varRecorder__$v.deployScript = deployScript;
      __varRecorder__$v.deployScript = deployScript;

      var __varRecorder__$u = lively.FreezerRuntime.recorderFor("lively.ide/shell/completers.js");
      __varRecorder__$u.arr = arr;
      __varRecorder__$u.runCommand = runCommand;

      (function (superclass) {
        var __lively_classholder__ = lively.FreezerRuntime.recorderFor("lively.ide/shell/completers.js");

        var __lively_class__ = __lively_classholder__.hasOwnProperty("ShellCompleter") && typeof __lively_classholder__.ShellCompleter === "function" ? __lively_classholder__.ShellCompleter : __lively_classholder__.ShellCompleter = function ShellCompleter(__first_arg__) {
          if (__first_arg__ && __first_arg__[Symbol["for"]("lively-instance-restorer")]) ; else {
            return this[Symbol["for"]("lively-instance-initialize")].apply(this, arguments);
          }
        };

        return initializeClass(__lively_class__, superclass, [{
          key: "buildCommand",
          value: function ShellCompleter_buildCommand_(inputBefore) {
            var _ref = inputBefore.match(/\$([^\s]*)$/i) || [],
                _ref2 = _slicedToArray(_ref, 2);
                _ref2[0];
                var prefix = _ref2[1];

            if (typeof prefix === "string") {
              return {
                command: "compgen -v -S \"[variable]\" ".concat(prefix),
                prefix: prefix
              };
            }

            var _ref3 = inputBefore.match(/(^|;)\s*([^\s]*)$/i) || [],
                _ref4 = _slicedToArray(_ref3, 3);
                _ref4[0];
                _ref4[1];
                var prefix = _ref4[2];

            if (typeof prefix === "string") {
              return {
                command: "compgen -a -S \"[alias]\" ".concat(prefix, "\n                        compgen -c -S \"[command]\" ").concat(prefix, "\n                        compgen -b -S \"[builtin]\" ").concat(prefix),
                prefix: prefix
              };
            }

            var prefix = __varRecorder__$u.arr.last(inputBefore.split(/[\s;]/));

            return {
              prefix: prefix,
              command: "compgen -f -S \"[file]\" ".concat(prefix)
            };
          }
        }, {
          key: "compute",
          value: function () {
            var _ShellCompleter_compute_ = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee(textMorph) {
              var plugin, _textMorph$cursorPosi, row, column, prefix, rawCompletions, _this$buildCommand, commandString, cmd, priorities, completions;

              return regeneratorRuntime.wrap(function _callee$(_context) {
                while (1) {
                  switch (_context.prev = _context.next) {
                    case 0:
                      plugin = textMorph.pluginFind(function (_ref5) {
                        var isShellEditorPlugin = _ref5.isShellEditorPlugin;
                        return isShellEditorPlugin;
                      });
                      _textMorph$cursorPosi = textMorph.cursorPosition, row = _textMorph$cursorPosi.row, column = _textMorph$cursorPosi.column;
                      prefix = textMorph.getLine(row).slice(0, column);
                      rawCompletions = "";

                      if (plugin) {
                        _context.next = 6;
                        break;
                      }

                      return _context.abrupt("return", []);

                    case 6:
                      _this$buildCommand = this.buildCommand(prefix), commandString = _this$buildCommand.command, prefix = _this$buildCommand.prefix;
                      _context.prev = 7;
                      cmd = __varRecorder__$u.runCommand(commandString, {
                        cwd: plugin.cwd
                      });
                      _context.next = 11;
                      return cmd.whenDone();

                    case 11:
                      rawCompletions = cmd.stdout;
                      _context.next = 18;
                      break;

                    case 14:
                      _context.prev = 14;
                      _context.t0 = _context["catch"](7);
                      console.warn("shell completer errored: ".concat(_context.t0.stack || _context.t0));
                      return _context.abrupt("return", []);

                    case 18:
                      priorities = {
                        variable: 300,
                        file: 400,
                        builtin: 400,
                        command: 500,
                        alias: 200
                      };
                      completions = rawCompletions.split("\n").map(function (ea) {
                        var _ref6 = ea.match(/(.*)\[([^\]]+)\]$/) || [],
                            _ref7 = _slicedToArray(_ref6, 3);
                            _ref7[0];
                            var completion = _ref7[1],
                            kind = _ref7[2];

                        if (!completion) return null;
                        var priority = priorities[kind] || 0;
                        var basePriority = 1500;
                        return {
                          completion: completion,
                          prefix: prefix,
                          info: kind,
                          priority: basePriority + priority
                        };
                      }).filter(Boolean);
                      return _context.abrupt("return", completions);

                    case 21:
                    case "end":
                      return _context.stop();
                  }
                }
              }, _callee, this, [[7, 14]]);
            }));

            function ShellCompleter_compute_(_x) {
              return _ShellCompleter_compute_.apply(this, arguments);
            }

            return ShellCompleter_compute_;
          }()
        }], [{
          key: Symbol["for"]("__LivelyClassName__"),
          get: function get() {
            return "ShellCompleter";
          }
        }], __lively_classholder__, {
          pathInPackage: function pathInPackage() {
            return "./shell/completers.js";
          },
          unsubscribeFromToplevelDefinitionChanges: function unsubscribeFromToplevelDefinitionChanges() {
            return function () {};
          },
          subscribeToToplevelDefinitionChanges: function subscribeToToplevelDefinitionChanges() {
            return function () {};
          },
          "package": function _package() {
            return {
              name: "lively.ide",
              version: "0.1.0"
            };
          }
        }, {
          start: 87,
          end: 2022
        });
      })(undefined);

      var shellCompleters = [new __varRecorder__$u.ShellCompleter()];
      __varRecorder__$u.shellCompleters = shellCompleters;
      __varRecorder__$u.shellCompleters = shellCompleters;

      var __varRecorder__$t = lively.FreezerRuntime.recorderFor("lively.ide/shell/mode.js");
      __varRecorder__$t.defineMode = defineMode;
      __varRecorder__$t.defineMIME = defineMIME;

      __varRecorder__$t.defineMode("shell", function () {
        var words = {};

        function define(style, string) {
          var split = string.split(" ");

          for (var i = 0; i < split.length; i++) {
            words[split[i]] = style;
          }
        }

        define("atom", "true false");
        define("keyword", "if then do else elif while until for in esac fi fin " + "fil done exit set unset export function");
        define("builtin", "ab awk bash beep cat cc cd chown chmod chroot clear cp " + "curl cut diff echo find gawk gcc get git grep hg kill killall ln ls make " + "mkdir openssl mv nc node npm ping ps restart rm rmdir sed service sh " + "shopt shred source sort sleep ssh start stop su sudo svn tee telnet top " + "touch vi vim wall wc wget who write yes zsh");

        function tokenBase(stream, state) {
          if (stream.eatSpace()) return null;
          var sol = stream.sol();
          var ch = stream.next();

          if (ch === "\\") {
            stream.next();
            return null;
          }

          if (ch === "'" || ch === "\"" || ch === "`") {
            state.tokens.unshift(tokenString(ch, ch === "`" ? "quote" : "string"));
            return tokenize(stream, state);
          }

          if (ch === "#") {
            if (sol && stream.eat("!")) {
              stream.skipToEnd();
              return "meta";
            }

            stream.skipToEnd();
            return "comment";
          }

          if (ch === "$") {
            state.tokens.unshift(tokenDollar);
            return tokenize(stream, state);
          }

          if (ch === "+" || ch === "=") {
            return "operator";
          }

          if (ch === "-") {
            stream.eat("-");
            stream.eatWhile(/\w/);
            return "attribute";
          }

          if (/\d/.test(ch)) {
            stream.eatWhile(/\d/);

            if (stream.eol() || !/\w/.test(stream.peek())) {
              return "number";
            }
          }

          stream.eatWhile(/[\w-]/);
          var cur = stream.current();
          if (stream.peek() === "=" && /\w+/.test(cur)) return "def";
          return words.hasOwnProperty(cur) ? words[cur] : null;
        }

        function tokenString(quote, style) {
          var close = quote == "(" ? ")" : quote == "{" ? "}" : quote;
          return function (stream, state) {
            var next;
            var end = false;
            var escaped = false;

            while ((next = stream.next()) != null) {
              if (next === close && !escaped) {
                end = true;
                break;
              }

              if (next === "$" && !escaped && quote !== "'") {
                escaped = true;
                stream.backUp(1);
                state.tokens.unshift(tokenDollar);
                break;
              }

              if (!escaped && next === quote && quote !== close) {
                state.tokens.unshift(tokenString(quote, style));
                return tokenize(stream, state);
              }

              escaped = !escaped && next === "\\";
            }

            if (end || !escaped) state.tokens.shift();
            return style;
          };
        }

        var tokenDollar = function tokenDollar(stream, state) {
          if (state.tokens.length > 1) stream.eat("$");
          var ch = stream.next();

          if (/['"({]/.test(ch)) {
            state.tokens[0] = tokenString(ch, ch == "(" ? "quote" : ch == "{" ? "def" : "string");
            return tokenize(stream, state);
          }

          if (!/\d/.test(ch)) stream.eatWhile(/\w/);
          state.tokens.shift();
          return "def";
        };

        function tokenize(stream, state) {
          return (state.tokens[0] || tokenBase)(stream, state);
        }

        return {
          startState: function startState() {
            return {
              tokens: []
            };
          },
          token: function token(stream, state) {
            return tokenize(stream, state);
          },
          closeBrackets: "()[]{}''\"\"``",
          lineComment: "#",
          fold: "brace"
        };
      });

      __varRecorder__$t.defineMIME("text/x-sh", "shell");

      var __varRecorder__$s = lively.FreezerRuntime.recorderFor("lively.ide/shell/editor-plugin.js");
      __varRecorder__$s.arr = arr;
      __varRecorder__$s.string = string;
      __varRecorder__$s.signal = signal;
      __varRecorder__$s.CodeMirrorEnabledEditorPlugin = CodeMirrorEnabledEditorPlugin;
      __varRecorder__$s.defaultDirectory = defaultDirectory;
      __varRecorder__$s.runCommand = runCommand;
      __varRecorder__$s.shellCompleters = shellCompleters;
      __varRecorder__$s.Snippet = Snippet;
      __varRecorder__$s.defaultDir = __varRecorder__$s.defaultDir || undefined;
      Promise.resolve(__varRecorder__$s.defaultDirectory()).then(function (dir) {
        return __varRecorder__$s.defaultDir = dir;
      });

      var ShellEditorPlugin = function (superclass) {
        var __lively_classholder__ = lively.FreezerRuntime.recorderFor("lively.ide/shell/editor-plugin.js");

        var __lively_class__ = __lively_classholder__.hasOwnProperty("ShellEditorPlugin") && typeof __lively_classholder__.ShellEditorPlugin === "function" ? __lively_classholder__.ShellEditorPlugin : __lively_classholder__.ShellEditorPlugin = function ShellEditorPlugin(__first_arg__) {
          if (__first_arg__ && __first_arg__[Symbol["for"]("lively-instance-restorer")]) ; else {
            return this[Symbol["for"]("lively-instance-initialize")].apply(this, arguments);
          }
        };

        return initializeClass(__lively_class__, superclass, [{
          key: Symbol["for"]("lively-instance-initialize"),
          value: function ShellEditorPlugin_initialize_() {
            var _this;

            _this = initializeClass._get(Object.getPrototypeOf(__lively_class__.prototype), Symbol["for"]("lively-instance-initialize"), this).call(this);
            this.state = {
              cwd: __varRecorder__$s.defaultDir,
              command: null
            };
            return _this;
          }
        }, {
          key: "isShellEditorPlugin",
          get: function get() {
            return true;
          }
        }, {
          key: "shortName",
          get: function get() {
            return "shell";
          }
        }, {
          key: "options",
          get: function get() {
            return this.state;
          }
        }, {
          key: "options",
          set: function set(o) {
            return this.state = Object.assign(this.state, o);
          }
        }, {
          key: "cwd",
          get: function get() {
            return this.state.cwd || __varRecorder__$s.defaultDir || "";
          }
        }, {
          key: "cwd",
          set: function set(cwd) {
            this.state.cwd = cwd;

            __varRecorder__$s.signal(this, "cwd", cwd);
          }
        }, {
          key: "command",
          get: function get() {
            return this.state.command;
          }
        }, {
          key: "command",
          set: function set(cmd) {
            this.state.command = cmd;

            __varRecorder__$s.signal(this, "command", cmd);
          }
        }, {
          key: "runCommand",
          value: function ShellEditorPlugin_runCommand_(cmd, opts) {
            return this.command = __varRecorder__$s.runCommand(cmd, Object.assign({
              cwd: this.cwd,
              owner: this.textMorph.id
            }, opts));
          }
        }, {
          key: "changeCwdInteractively",
          value: function () {
            var _ShellEditorPlugin_changeCwdInteractively_ = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee() {
              var _ref;

              var cwd, dirs, _ref2, status, newDirs, _ref2$selections, choice;

              return regeneratorRuntime.wrap(function _callee$(_context) {
                while (1) {
                  switch (_context.prev = _context.next) {
                    case 0:
                      cwd = this.cwd;
                      dirs = __varRecorder__$s.arr.uniq((_ref = [cwd]).concat.apply(_ref, [__varRecorder__$s.defaultDir].concat(_toConsumableArray(this.knownCwds)))).filter(Boolean);
                      _context.next = 4;
                      return this.textMorph.world().editListPrompt("Choose working directory:", dirs, {
                        requester: this.textMorph.getWindow(),
                        historyId: "lively.morphic-ide/shell-changeCwdInteractively-hist-list",
                        preselect: dirs.indexOf(cwd)
                      });

                    case 4:
                      _context.t0 = _context.sent;

                      if (_context.t0) {
                        _context.next = 7;
                        break;
                      }

                      _context.t0 = {};

                    case 7:
                      _ref2 = _context.t0;
                      status = _ref2.status;
                      newDirs = _ref2.list;
                      _ref2$selections = _slicedToArray(_ref2.selections, 1);
                      choice = _ref2$selections[0];

                      if (!(status === "canceled")) {
                        _context.next = 14;
                        break;
                      }

                      return _context.abrupt("return");

                    case 14:
                      this.knownCwds = newDirs;

                      if (choice) {
                        _context.next = 17;
                        break;
                      }

                      return _context.abrupt("return");

                    case 17:
                      this.textMorph.setStatusMessage(choice);
                      this.cwd = choice;
                      this.updateWindowTitle();

                    case 20:
                    case "end":
                      return _context.stop();
                  }
                }
              }, _callee, this);
            }));

            function ShellEditorPlugin_changeCwdInteractively_() {
              return _ShellEditorPlugin_changeCwdInteractively_.apply(this, arguments);
            }

            return ShellEditorPlugin_changeCwdInteractively_;
          }()
        }, {
          key: "knownCwds",
          get: function get() {
            if (typeof localStorage === "undefined") return [];

            try {
              var cwds = localStorage.getItem("lively.morphic-ide/shell-known-cwds");
              return cwds ? JSON.parse(cwds) : [];
            } catch (e) {
              return [];
            }
          }
        }, {
          key: "knownCwds",
          set: function set(cwds) {
            if (typeof localStorage === "undefined") return;

            try {
              localStorage.setItem("lively.morphic-ide/shell-known-cwds", JSON.stringify(cwds));
            } catch (e) {
              console.error(e);
            }
          }
        }, {
          key: "updateWindowTitle",
          value: function ShellEditorPlugin_updateWindowTitle_() {
            var win = this.textMorph.getWindow();
            if (!win || !win.title.includes("Shell Workspace")) return;
            var part1 = "Shell Workspace";
            var part2 = this.command && this.command.isRunning() ? " (running ".concat(this.command.pid, ")") : "";
            var part3 = !this.cwd ? "" : " - ".concat(__varRecorder__$s.string.truncateLeft(this.cwd, 35));
            win.title = [part1, part2, part3].join("");
          }
        }, {
          key: "getCommands",
          value: function ShellEditorPlugin_getCommands_(otherCommands) {
            var _this2 = this;

            var ed = this.textMorph;
            return [{
              name: "[shell] spawn command from selected text",
              exec: function () {
                var _exec = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee2(_) {
                  var opts,
                      sel,
                      cmd,
                      insert,
                      _args2 = arguments;
                  return regeneratorRuntime.wrap(function _callee2$(_context2) {
                    while (1) {
                      switch (_context2.prev = _context2.next) {
                        case 0:
                          opts = _args2.length > 1 && _args2[1] !== undefined ? _args2[1] : {
                            printit: false
                          };
                          sel = ed.selection;
                          if (sel.isEmpty()) ed.selectLine(sel.lead.row);
                          cmd = _this2.runCommand(sel.text, {});
                          sel.collapseToEnd();

                          if (opts.printit) {
                            insert = function insert(out) {
                              var start = sel.start;
                              sel.collapseToEnd();
                              ed.insertText(out);
                              sel.range = {
                                start: start,
                                end: ed.cursorPosition
                              };
                            };

                            cmd.on("stdout", insert);
                            cmd.on("stderr", insert);
                          }

                          _this2.updateWindowTitle();

                          _context2.next = 9;
                          return cmd.whenStarted();

                        case 9:
                          _this2.updateWindowTitle();

                          _context2.next = 12;
                          return cmd.whenDone();

                        case 12:
                          _this2.updateWindowTitle();

                          if (opts.printit) {
                            cmd.removeListener("stdout", insert);
                            cmd.removeListener("stderr", insert);
                          } else {
                            ed.setStatusMessage(cmd.output.trim());
                          }

                          return _context2.abrupt("return", true);

                        case 15:
                        case "end":
                          return _context2.stop();
                      }
                    }
                  }, _callee2);
                }));

                function exec(_x) {
                  return _exec.apply(this, arguments);
                }

                return exec;
              }()
            }, {
              name: "[shell] kill current command",
              exec: function () {
                var _exec2 = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee3(_) {
                  var opts,
                      cmd,
                      _args3 = arguments;
                  return regeneratorRuntime.wrap(function _callee3$(_context3) {
                    while (1) {
                      switch (_context3.prev = _context3.next) {
                        case 0:
                          opts = _args3.length > 1 && _args3[1] !== undefined ? _args3[1] : {
                            signal: undefined
                          };
                          cmd = _this2.command;

                          if (cmd) {
                            _context3.next = 5;
                            break;
                          }

                          ed.setStatusMessage("No command running");
                          return _context3.abrupt("return", true);

                        case 5:
                          ed.setStatusMessage("Sending signal ".concat(opts.signal || "KILL", " to command ").concat(cmd.pid));
                          _context3.next = 8;
                          return cmd.kill(opts.signal);

                        case 8:
                          return _context3.abrupt("return", true);

                        case 9:
                        case "end":
                          return _context3.stop();
                      }
                    }
                  }, _callee3);
                }));

                function exec(_x2) {
                  return _exec2.apply(this, arguments);
                }

                return exec;
              }()
            }, {
              name: "[shell] change working directory",
              exec: function () {
                var _exec3 = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee4() {
                  return regeneratorRuntime.wrap(function _callee4$(_context4) {
                    while (1) {
                      switch (_context4.prev = _context4.next) {
                        case 0:
                          _context4.next = 2;
                          return _this2.changeCwdInteractively();

                        case 2:
                          return _context4.abrupt("return", true);

                        case 3:
                        case "end":
                          return _context4.stop();
                      }
                    }
                  }, _callee4);
                }));

                function exec() {
                  return _exec3.apply(this, arguments);
                }

                return exec;
              }()
            }].concat(otherCommands);
          }
        }, {
          key: "getKeyBindings",
          value: function ShellEditorPlugin_getKeyBindings_(otherKeybindings) {
            return otherKeybindings.concat([{
              keys: {
                mac: "Meta-D",
                win: "Alt-Enter"
              },
              command: {
                command: "[shell] spawn command from selected text",
                args: {
                  printit: false
                }
              }
            }, {
              keys: {
                mac: "Meta-P",
                win: "Ctrl-Alt-Enter"
              },
              command: {
                command: "[shell] spawn command from selected text",
                args: {
                  printit: true
                }
              }
            }, {
              keys: {
                mac: "Meta-Shift-L D I R",
                win: "Ctrl-Shift-L D I R"
              },
              command: "[shell] change working directory"
            }]);
          }
        }, {
          key: "getSnippets",
          value: function ShellEditorPlugin_getSnippets_(otherSnippets) {
            return otherSnippets.concat([["findjs", "find ${0:.} \\( -name ${1:excluded} \\) -prune -o -iname '*.js' -type f -print0 | xargs -0 grep -nH ${2:what}"]].map(function (_ref3) {
              var _ref4 = _slicedToArray(_ref3, 2),
                  trigger = _ref4[0],
                  expansion = _ref4[1];

              return new __varRecorder__$s.Snippet({
                trigger: trigger,
                expansion: expansion
              });
            }));
          }
        }, {
          key: "getCompleters",
          value: function ShellEditorPlugin_getCompleters_(completers) {
            return completers.concat(__varRecorder__$s.shellCompleters);
          }
        }], [{
          key: Symbol["for"]("__LivelyClassName__"),
          get: function get() {
            return "ShellEditorPlugin";
          }
        }], __lively_classholder__, {
          pathInPackage: function pathInPackage() {
            return "./shell/editor-plugin.js";
          },
          unsubscribeFromToplevelDefinitionChanges: function unsubscribeFromToplevelDefinitionChanges() {
            return function () {};
          },
          subscribeToToplevelDefinitionChanges: function subscribeToToplevelDefinitionChanges() {
            return function () {};
          },
          "package": function _package() {
            return {
              name: "lively.ide",
              version: "0.1.0"
            };
          }
        }, {
          start: 465,
          end: 5892
        });
      }(__varRecorder__$s.CodeMirrorEnabledEditorPlugin);
      __varRecorder__$s["default"] = ShellEditorPlugin;

      var __varRecorder__$r = lively.FreezerRuntime.recorderFor("lively.ide/shell/terminal.js");
      __varRecorder__$r.pt = pt;
      __varRecorder__$r.Rectangle = Rectangle;
      __varRecorder__$r.Color = Color;
      __varRecorder__$r.connect = connect;
      __varRecorder__$r.arr = arr;
      __varRecorder__$r.fun = fun;
      __varRecorder__$r.obj = obj;
      __varRecorder__$r.defaultDirectory = defaultDirectory;
      __varRecorder__$r.GridLayout = GridLayout;
      __varRecorder__$r.Morph = Morph;
      __varRecorder__$r.Text = Text;
      __varRecorder__$r.World = World;
      __varRecorder__$r.config = config;
      __varRecorder__$r.ShellEditorPlugin = ShellEditorPlugin;
      __varRecorder__$r.DiffEditorPlugin = DiffEditorPlugin;
      __varRecorder__$r.EditorPlugin = EditorPlugin;
      __varRecorder__$r.guessTextModeName = guessTextModeName;
      __varRecorder__$r.packagesOfSnapshot = packagesOfSnapshot;
      __varRecorder__$r.DarkButton = DarkButton;
      __varRecorder__$r.InputLine = InputLine;

      (function (superclass) {
        var __lively_classholder__ = lively.FreezerRuntime.recorderFor("lively.ide/shell/terminal.js");

        var __lively_class__ = __lively_classholder__.hasOwnProperty("TerminalView") && typeof __lively_classholder__.TerminalView === "function" ? __lively_classholder__.TerminalView : __lively_classholder__.TerminalView = function TerminalView(__first_arg__) {
          if (__first_arg__ && __first_arg__[Symbol["for"]("lively-instance-restorer")]) ; else {
            return this[Symbol["for"]("lively-instance-initialize")].apply(this, arguments);
          }
        };

        return initializeClass(__lively_class__, superclass, [{
          key: "setStatusMessage",
          value: function TerminalView_setStatusMessage_() {
            var _this$getWindow;

            return (_this$getWindow = this.getWindow()).setStatusMessage.apply(_this$getWindow, arguments);
          }
        }], [{
          key: Symbol["for"]("__LivelyClassName__"),
          get: function get() {
            return "TerminalView";
          }
        }], __lively_classholder__, {
          pathInPackage: function pathInPackage() {
            return "./shell/terminal.js";
          },
          unsubscribeFromToplevelDefinitionChanges: function unsubscribeFromToplevelDefinitionChanges() {
            return function () {};
          },
          subscribeToToplevelDefinitionChanges: function subscribeToToplevelDefinitionChanges() {
            return function () {};
          },
          "package": function _package() {
            return {
              name: "lively.ide",
              version: "0.1.0"
            };
          }
        }, {
          start: 920,
          end: 1045
        });
      })(__varRecorder__$r.Text);

      var Terminal = exports('T', function (superclass) {
        var __lively_classholder__ = lively.FreezerRuntime.recorderFor("lively.ide/shell/terminal.js");

        var __lively_class__ = __lively_classholder__.hasOwnProperty("Terminal") && typeof __lively_classholder__.Terminal === "function" ? __lively_classholder__.Terminal : __lively_classholder__.Terminal = function Terminal(__first_arg__) {
          if (__first_arg__ && __first_arg__[Symbol["for"]("lively-instance-restorer")]) ; else {
            return this[Symbol["for"]("lively-instance-initialize")].apply(this, arguments);
          }
        };

        return initializeClass(__lively_class__, superclass, [{
          key: Symbol["for"]("lively-instance-initialize"),
          value: function Terminal_initialize_(props) {
            var _this2 = this;

            var _this;

            _this = initializeClass._get(Object.getPrototypeOf(__lively_class__.prototype), Symbol["for"]("lively-instance-initialize"), this).call(this, props);
            if (!props.cwd) Promise.resolve(function () {
              return _this2.cwd = __varRecorder__$r.defaultDirectory();
            });
            return _this;
          }
        }, {
          key: "__additionally_serialize__",
          value: function Terminal___additionally_serialize___(snapshot, objRef, pool, addFn) {
            initializeClass._get(Object.getPrototypeOf(__lively_class__.prototype), "__additionally_serialize__", this).call(this, snapshot, objRef, pool, addFn);

            var ref = pool.ref(this.ui.output);
            var props = ref.currentSnapshot.props;
            if (props.attributeConnections) props.attributeConnections.value = [];
            if (props.plugins) props.plugins.value = [];

            if (props.anchors) {
              props.anchors.value = props.anchors.value.filter(function (_ref) {
                var id = _ref.id;
                return id.startsWith("selection-");
              });
            }

            if (props.savedMarks) props.savedMarks.value = [];
            ref = pool.ref(this.ui.input);
            props = ref.currentSnapshot.props;
            if (props.attributeConnections) props.attributeConnections.value = [];
            if (props.plugins) props.plugins.value = [];

            if (props.anchors) {
              props.anchors.value = props.anchors.value.filter(function (_ref2) {
                var id = _ref2.id;
                return id.startsWith("selection-");
              });
            }

            if (props.savedMarks) props.savedMarks.value = [];
            snapshot.props._serializedState = {
              verbatim: true,
              value: {
                cwd: this.cwd
              }
            };
          }
        }, {
          key: "onLoad",
          value: function Terminal_onLoad_(_, snapshot) {
            if (this._serializedState) {
              this.cwd = this._serializedState.cwd;
              delete this._serializedState;
            }

            __varRecorder__$r.connect(this.ui.input, "inputAccepted", this, "execCommand", {
              updater: function updater($upd, command) {
                return $upd("[shell terminal] run command or send input", {
                  command: command
                });
              }
            });
          }
        }, {
          key: "defaultStyle",
          get: function get() {
            return Object.assign({}, __varRecorder__$r.config.codeEditor.defaultStyle);
          }
        }, {
          key: "focus",
          value: function Terminal_focus_() {
            this.ui[this.lastFocused].focus();
          }
        }, {
          key: "clear",
          value: function Terminal_clear_() {
            this.ui.output.textString = "";
          }
        }, {
          key: "updateWindowTitle",
          value: function Terminal_updateWindowTitle_() {
            var win = this.getWindow();
            if (!win) return;
            var title = "Term";
            var command = this.command;

            if (command) {
              var commandString = command.commandString,
                  status = command.status;
              title += " - ".concat(commandString ? commandString + " " : "").concat(status);
            }

            win.title = title;
          }
        }, {
          key: "updateTextMode",
          value: function Terminal_updateTextMode_() {
            var ed = this.ui.output;

            var mode = __varRecorder__$r.guessTextModeName(ed);

            var pluginsToRemove = ed.plugins.filter(function (ea) {
              return ea.isEditorPlugin;
            });
            var pluginsToAdd = [];

            if (mode === "diff") {
              var plugin = pluginsToRemove.find(function (p) {
                return p instanceof __varRecorder__$r.DiffEditorPlugin;
              });
              if (plugin) __varRecorder__$r.arr.remove(pluginsToRemove, plugin);else pluginsToAdd.push(new __varRecorder__$r.DiffEditorPlugin());
            }

            ed.plugins = __varRecorder__$r.arr.withoutAll(ed.plugins, pluginsToRemove).concat(pluginsToAdd);
          }
        }, {
          key: "keybindings",
          get: function get() {
            return [{
              keys: "F1|Alt-Up",
              command: "focus output"
            }, {
              keys: "F2|Alt-Down",
              command: "focus input"
            }, {
              keys: "Ctrl-D",
              command: {
                command: "[shell] kill current command",
                args: {
                  signal: "KILL"
                }
              }
            }, {
              keys: "Ctrl-C",
              command: {
                command: "[shell] kill current command",
                args: {
                  signal: "INT"
                }
              }
            }, {
              keys: {
                mac: "Meta-Shift-L D I R",
                win: "Ctrl-Shift-L D I R"
              },
              command: "[shell] change working directory"
            }].concat(initializeClass._get(Object.getPrototypeOf(__lively_class__.prototype), "keybindings", this));
          }
        }, {
          key: "commands",
          get: function get() {
            return initializeClass._get(Object.getPrototypeOf(__lively_class__.prototype), "commands", this).concat([{
              name: "focus input",
              exec: function exec(term) {
                term.lastFocused = "input";
                var m = term.ui.input;
                m.show();
                m.focus();
                return true;
              }
            }, {
              name: "focus output",
              exec: function exec(term) {
                term.lastFocused = "output";
                var m = term.ui.output;
                m.show();
                m.focus();
                return true;
              }
            }, {
              name: "[shell terminal] run command or send input",
              exec: function exec(term) {
                var opts = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {
                  command: ""
                };

                if (term.command && term.command.isRunning()) {
                  term.command.writeToStdin(opts.command + "\n");
                } else {
                  term.clear();
                  term.runCommand(opts.command, __varRecorder__$r.obj.dissoc(opts, ["command"]));
                }

                return true;
              }
            }, {
              name: "[shell] kill current command",
              exec: function () {
                var _exec = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee(term) {
                  var opts,
                      command,
                      sig,
                      _args = arguments;
                  return regeneratorRuntime.wrap(function _callee$(_context) {
                    while (1) {
                      switch (_context.prev = _context.next) {
                        case 0:
                          opts = _args.length > 1 && _args[1] !== undefined ? _args[1] : {
                            signal: undefined
                          };
                          command = term.command;

                          if (command) {
                            _context.next = 5;
                            break;
                          }

                          term.setStatusMessage("No command running");
                          return _context.abrupt("return", true);

                        case 5:
                          sig = opts.signal || "KILL";
                          term.addOutput("\nsend signal ".concat(sig));
                          term.setStatusMessage("Sending signal ".concat(sig, " to command ").concat(command.pid));
                          _context.next = 10;
                          return command.kill(sig);

                        case 10:
                          return _context.abrupt("return", true);

                        case 11:
                        case "end":
                          return _context.stop();
                      }
                    }
                  }, _callee);
                }));

                function exec(_x) {
                  return _exec.apply(this, arguments);
                }

                return exec;
              }()
            }, {
              name: "[shell] change working directory",
              exec: function () {
                var _exec2 = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee2(term) {
                  return regeneratorRuntime.wrap(function _callee2$(_context2) {
                    while (1) {
                      switch (_context2.prev = _context2.next) {
                        case 0:
                          _context2.next = 2;
                          return term.shellPlugin.changeCwdInteractively();

                        case 2:
                          return _context2.abrupt("return", true);

                        case 3:
                        case "end":
                          return _context2.stop();
                      }
                    }
                  }, _callee2);
                }));

                function exec(_x2) {
                  return _exec2.apply(this, arguments);
                }

                return exec;
              }()
            }]);
          }
        }, {
          key: "addOutput",
          value: function Terminal_addOutput_(text) {
            var ed = this.ui.output;
            var isAtFileEnd = ed.isAtDocumentEnd();
            ed.append(text);

            if (isAtFileEnd) {
              __varRecorder__$r.fun.debounceNamed(ed.id, 50, function () {
                ed.gotoDocumentEnd();
                ed.scrollCursorIntoView();
              })();
            }
          }
        }, {
          key: "diffModulesOfSnapshot",
          value: function () {
            var _Terminal_diffModulesOfSnapshot_ = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee3(urlToSnapshot) {
              var _this3 = this;

              var cmd, _cmd$stdout$split$fil, _cmd$stdout$split$fil2, snapOld, snapNew, oldPackages, newPackages, differentFiles;

              return regeneratorRuntime.wrap(function _callee3$(_context3) {
                while (1) {
                  switch (_context3.prev = _context3.next) {
                    case 0:
                      cmd = this.shellPlugin.runCommand("git diff " + urlToSnapshot);
                      _context3.next = 3;
                      return cmd.whenDone();

                    case 3:
                      _cmd$stdout$split$fil = cmd.stdout.split("\n").filter(function (m) {
                        return m.length > 1000;
                      }).map(function (json) {
                        return JSON.parse(json.slice(1));
                      }), _cmd$stdout$split$fil2 = _slicedToArray(_cmd$stdout$split$fil, 2), snapOld = _cmd$stdout$split$fil2[0], snapNew = _cmd$stdout$split$fil2[1];

                      if (snapOld && snapNew) {
                        oldPackages = __varRecorder__$r.packagesOfSnapshot(snapOld);
                        newPackages = __varRecorder__$r.packagesOfSnapshot(snapNew);
                        differentFiles = [];

                        __varRecorder__$r.arr.zip(oldPackages, newPackages).forEach(function (_ref3) {
                          var _ref4 = _slicedToArray(_ref3, 2),
                              oldPackage = _ref4[0],
                              newPackage = _ref4[1];

                          if (oldPackage && newPackage) {
                            __varRecorder__$r.arr.zip(Object.entries(oldPackage.files), Object.entries(newPackage.files)).forEach(function (_ref5) {
                              var _ref6 = _slicedToArray(_ref5, 2),
                                  _ref6$ = _slicedToArray(_ref6[0], 2),
                                  fileName = _ref6$[0],
                                  oldFile = _ref6$[1],
                                  _ref6$2 = _slicedToArray(_ref6[1], 2);
                                  _ref6$2[0];
                                  var newFile = _ref6$2[1];

                              if (oldFile !== newFile) {
                                differentFiles.push([fileName, oldFile, newFile]);
                              }
                            });
                          }
                        });

                        differentFiles.forEach(function (_ref7) {
                          var _ref8 = _slicedToArray(_ref7, 3),
                              fName = _ref8[0],
                              a = _ref8[1],
                              b = _ref8[2];

                          _this3.world().execCommand("diff and open in window", {
                            a: a,
                            b: b,
                            title: fName
                          });
                        });
                      } else {
                        this.world().inform("No Changes!");
                      }

                    case 5:
                    case "end":
                      return _context3.stop();
                  }
                }
              }, _callee3, this);
            }));

            function Terminal_diffModulesOfSnapshot_(_x3) {
              return _Terminal_diffModulesOfSnapshot_.apply(this, arguments);
            }

            return Terminal_diffModulesOfSnapshot_;
          }()
        }, {
          key: "runCommand",
          value: function Terminal_runCommand_(cmd, opts) {
            if (this.command && this.command.isRunning()) {
              throw new Error("".concat(this.command, " still running"));
            }

            return this.command = this.shellPlugin.runCommand(cmd, opts);
          }
        }], [{
          key: Symbol["for"]("__LivelyClassName__"),
          get: function get() {
            return "Terminal";
          }
        }, {
          key: "open",
          value: function Terminal_open_() {
            var options = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};
            var term = new this(options);
            var winOpts = {
              name: "ShellTerminal window",
              title: options.title || "Terminal"
            };
            var win = term.openInWindow(winOpts);
            term.focus();
            return win;
          }
        }, {
          key: "runCommand",
          value: function Terminal_runCommand_(cmdString, options) {
            var win = this.open(options);
            var term = win.targetMorph;
            term.runCommand(cmdString, options);
            return win;
          }
        }, {
          key: "forCommand",
          value: function Terminal_forCommand_(command, options) {
            return this.open(Object.assign({
              command: command
            }, options));
          }
        }, {
          key: "findOrCreateForCommand",
          value: function Terminal_findOrCreateForCommand_(cmd) {
            var w = __varRecorder__$r.World.defaultWorld();

            var existing = __varRecorder__$r.arr.grep(w.submorphs, /ShellTerminal window/).find(function (ea) {
              return ea.targetMorph.command && ea.targetMorph.command.pid === cmd.pid;
            });

            return existing || this.forCommand(cmd);
          }
        }, {
          key: "properties",
          get: function get() {
            return {
              title: {
                defaultValue: "Terminal"
              },
              name: {
                defaultValue: "terminal"
              },
              extent: {
                defaultValue: __varRecorder__$r.pt(600, 300)
              },
              lastFocused: {
                defaultValue: "input"
              },
              submorphs: {
                initialize: function initialize() {
                  this.submorphs = [Object.assign({
                    type: __varRecorder__$r.TerminalView,
                    name: "output",
                    lineWrapping: "no-wrap",
                    textString: "",
                    readOnly: false
                  }, this.defaultStyle), new __varRecorder__$r.InputLine(Object.assign({}, this.defaultStyle, {
                    name: "input",
                    textString: "",
                    clearOnInput: true,
                    historyId: "lively.shell-terminal-input-history",
                    border: {
                      width: 1,
                      color: __varRecorder__$r.Color.gray
                    },
                    plugins: [new __varRecorder__$r.ShellEditorPlugin(), new __varRecorder__$r.EditorPlugin()],
                    clipMode: "hidden"
                  })), {
                    type: "button",
                    name: "changeCwdButton",
                    label: "cwd...",
                    borderRadius: 3,
                    fontSize: 12,
                    master: __varRecorder__$r.DarkButton,
                    isLayoutable: false,
                    padding: __varRecorder__$r.Rectangle.inset(4, 2)
                  }];
                  var _this$ui = this.ui,
                      input = _this$ui.input,
                      changeCwdButton = _this$ui.changeCwdButton;
                  var self = this;

                  __varRecorder__$r.connect(input, "inputAccepted", this, "execCommand", {
                    updater: function updater($upd, command) {
                      return $upd("[shell terminal] run command or send input", {
                        command: command
                      });
                    }
                  });

                  __varRecorder__$r.connect(this, "extent", changeCwdButton, "topRight", {
                    converter: function converter(ext) {
                      return ext.withY(0).addXY(-5, 5);
                    }
                  });

                  __varRecorder__$r.connect(changeCwdButton, "extent", changeCwdButton, "topRight", {
                    converter: function converter() {
                      return self.extent.withY(0).addXY(-5, 5);
                    },
                    varMapping: {
                      self: self
                    }
                  });

                  __varRecorder__$r.connect(changeCwdButton, "fire", this, "execCommand", {
                    converter: function converter() {
                      return "[shell] change working directory";
                    }
                  });

                  this.layout = new __varRecorder__$r.GridLayout({
                    grid: [["output"], ["input"]],
                    rows: [1, {
                      fixed: 25
                    }],
                    groups: {
                      output: {
                        align: "topLeft",
                        resize: true
                      },
                      input: {
                        align: "topLeft",
                        resize: true
                      }
                    }
                  });
                }
              },
              ui: {
                derived: true,
                readOnly: true,
                after: ["submorphs"],
                get: function get() {
                  var _this$submorphs = _slicedToArray(this.submorphs, 3),
                      output = _this$submorphs[0],
                      input = _this$submorphs[1],
                      changeCwdButton = _this$submorphs[2];

                  return {
                    output: output,
                    input: input,
                    changeCwdButton: changeCwdButton
                  };
                }
              },
              command: {
                derived: true,
                after: ["shellPlugin"],
                get: function get() {
                  return this.shellPlugin.command;
                },
                set: function set(cmd) {
                  if (this.command && this.command.isRunning()) {
                    throw new Error("".concat(this.command, " still running"));
                  }

                  this.shellPlugin.command = cmd;
                  cmd.stdout && this.addOutput(cmd.stdout);
                  cmd.stdout && this.addOutput(cmd.stderr);

                  __varRecorder__$r.connect(cmd, "stdout", this, "addOutput");

                  __varRecorder__$r.connect(cmd, "stderr", this, "addOutput");

                  __varRecorder__$r.connect(cmd, "error", this, "addOutput");

                  __varRecorder__$r.connect(cmd, "pid", this, "updateWindowTitle");

                  __varRecorder__$r.connect(cmd, "close", this, "updateWindowTitle");

                  __varRecorder__$r.connect(cmd, "close", this, "updateTextMode");

                  this.updateWindowTitle();
                  this.updateTextMode();
                }
              },
              cwd: {
                derived: true,
                after: ["shellPlugin"],
                get: function get() {
                  return this.shellPlugin.cwd;
                },
                set: function set(cwd) {
                  return this.shellPlugin.cwd = cwd;
                }
              },
              shellPlugin: {
                derived: true,
                readOnly: true,
                after: ["submorphs"],
                get: function get() {
                  var i = this.ui.input;
                  var p = i.pluginFind(function (ea) {
                    return ea.isShellEditorPlugin;
                  });
                  if (p) return p;
                  p = i.addPlugin(new __varRecorder__$r.ShellEditorPlugin());

                  __varRecorder__$r.connect(p, "cwd", this.ui.changeCwdButton, "label");

                  return p;
                }
              },
              input: {
                derived: true,
                after: ["submorphs"],
                set: function set(val) {
                  this.ui.input.input = val;
                },
                get: function get() {
                  return this.ui.input.input;
                }
              }
            };
          }
        }], __lively_classholder__, {
          pathInPackage: function pathInPackage() {
            return "./shell/terminal.js";
          },
          unsubscribeFromToplevelDefinitionChanges: function unsubscribeFromToplevelDefinitionChanges() {
            return function () {};
          },
          subscribeToToplevelDefinitionChanges: function subscribeToToplevelDefinitionChanges() {
            return function () {};
          },
          "package": function _package() {
            return {
              name: "lively.ide",
              version: "0.1.0"
            };
          }
        }, {
          start: 1062,
          end: 12740
        });
      }(__varRecorder__$r.Morph));
      __varRecorder__$r["default"] = Terminal;

      var terminal = /*#__PURE__*/Object.freeze({
        __proto__: null,
        'default': Terminal
      });

      var __varRecorder__$q = lively.FreezerRuntime.recorderFor("lively.project/project.js");
      __varRecorder__$q.localInterface = localInterface;
      __varRecorder__$q.resource = resource;
      __varRecorder__$q.defaultDirectory = defaultDirectory;
      __varRecorder__$q.loadPackage = loadPackage;
      __varRecorder__$q.workflowDefinition = workflowDefinition;
      __varRecorder__$q.VersionChecker = VersionChecker;
      __varRecorder__$q.StatusMessageConfirm = StatusMessageConfirm;
      __varRecorder__$q.StatusMessageError = StatusMessageError;
      __varRecorder__$q.join = join;
      __varRecorder__$q.runCommand = runCommand$1;
      __varRecorder__$q.ShellClientResource = ShellClientResource;
      __varRecorder__$q.semver = exports$1;
      __varRecorder__$q.currentUserToken = currentUserToken;
      __varRecorder__$q.isUserLoggedIn = isUserLoggedIn;
      __varRecorder__$q.currentUser = currentUser;
      __varRecorder__$q.currentUsername = currentUsername;
      __varRecorder__$q.reloadPackage = reloadPackage;
      __varRecorder__$q.buildScriptShell = buildScriptShell;
      __varRecorder__$q.buildScript = buildScript;
      __varRecorder__$q.buildRemoteScript = buildRemoteScript;
      __varRecorder__$q.deployScript = deployScript;
      __varRecorder__$q.Terminal = Terminal;
      __varRecorder__$q.pt = pt;
      __varRecorder__$q.arr = arr;
      __varRecorder__$q.obj = obj;
      __varRecorder__$q.addOrChangeCSSDeclaration = addOrChangeCSSDeclaration;
      __varRecorder__$q.generateFontFaceString = generateFontFaceString;
      __varRecorder__$q.repositoryOwnerAndNameRegex = /\.com\/(.+)\/(.*)/;
      __varRecorder__$q.fontCSSWarningString = "/*\nDO NOT CHANGE THE CONTENTS OF THIS FILE!\nIts content is managed automatically by lively.next. It will automatically be loaded/bundled together with this project!\n*/\n\n";
      var Project = exports('P', /*#__PURE__*/function () {
        _createClass(Project, [{
          key: "hasRemoteConfigured",
          value: function () {
            var _hasRemoteConfigured = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee() {
              return regeneratorRuntime.wrap(function _callee$(_context) {
                while (1) {
                  switch (_context.prev = _context.next) {
                    case 0:
                      _context.next = 2;
                      return this.gitResource.hasRemote();

                    case 2:
                      return _context.abrupt("return", _context.sent);

                    case 3:
                    case "end":
                      return _context.stop();
                  }
                }
              }, _callee, this);
            }));

            function hasRemoteConfigured() {
              return _hasRemoteConfigured.apply(this, arguments);
            }

            return hasRemoteConfigured;
          }()
        }, {
          key: "hasUncommitedChanges",
          value: function () {
            var _hasUncommitedChanges = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee2() {
              return regeneratorRuntime.wrap(function _callee2$(_context2) {
                while (1) {
                  switch (_context2.prev = _context2.next) {
                    case 0:
                      _context2.next = 2;
                      return this.gitResource.hasUncommitedChanges();

                    case 2:
                      return _context2.abrupt("return", _context2.sent);

                    case 3:
                    case "end":
                      return _context2.stop();
                  }
                }
              }, _callee2, this);
            }));

            function hasUncommitedChanges() {
              return _hasUncommitedChanges.apply(this, arguments);
            }

            return hasUncommitedChanges;
          }()
        }, {
          key: "changeRepositoryVisibility",
          value: function () {
            var _changeRepositoryVisibility = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee3(visibility) {
              return regeneratorRuntime.wrap(function _callee3$(_context3) {
                while (1) {
                  switch (_context3.prev = _context3.next) {
                    case 0:
                      this.config.lively.repositoryIsPrivate = visibility === "private";
                      _context3.next = 3;
                      return this.gitResource.changeRemoteVisibility(__varRecorder__$q.currentUserToken(), this.name, this.repoOwner, visibility);

                    case 3:
                      return _context3.abrupt("return", _context3.sent);

                    case 4:
                    case "end":
                      return _context3.stop();
                  }
                }
              }, _callee3, this);
            }));

            function changeRepositoryVisibility(_x) {
              return _changeRepositoryVisibility.apply(this, arguments);
            }

            return changeRepositoryVisibility;
          }()
        }, {
          key: "name",
          get: function get() {
            return this.config.name;
          }
        }, {
          key: "canDeployToPages",
          get: function get() {
            return this.config.lively.canUsePages;
          }
        }, {
          key: "repoOwner",
          get: function get() {
            return this.config.repository.url.match(__varRecorder__$q.repositoryOwnerAndNameRegex)[1];
          }
        }], [{
          key: "retrieveAvailableProjectsCache",
          value: function retrieveAvailableProjectsCache() {
            return JSON.parse(localStorage.getItem("available_lively_projects"));
          }
        }, {
          key: "projectDirectory",
          value: function () {
            var _projectDirectory = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee4() {
              var baseURL;
              return regeneratorRuntime.wrap(function _callee4$(_context4) {
                while (1) {
                  switch (_context4.prev = _context4.next) {
                    case 0:
                      _context4.next = 2;
                      return __varRecorder__$q.Project.systemInterface.getConfig().baseURL;

                    case 2:
                      baseURL = _context4.sent;
                      return _context4.abrupt("return", __varRecorder__$q.resource(baseURL).join("local_projects").asDirectory());

                    case 4:
                    case "end":
                      return _context4.stop();
                  }
                }
              }, _callee4);
            }));

            function projectDirectory() {
              return _projectDirectory.apply(this, arguments);
            }

            return projectDirectory;
          }()
        }, {
          key: "systemInterface",
          get: function get() {
            return __varRecorder__$q.localInterface.coreInterface;
          }
        }]);

        function Project(name) {
          var opts = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {
            author: "anon",
            description: "",
            repoOwner: "anon"
          };

          _classCallCheck(this, Project);

          var author = opts.author,
              description = opts.description,
              repoOwner = opts.repoOwner;
          this.config = {
            name: name || "new world",
            author: {
              name: author
            },
            description: description,
            repository: {
              type: "git",
              url: "https://github.com/".concat(repoOwner, "/").concat(name)
            },
            scripts: {
              build: "rm -rf build/* && export MINIFY='' && ./tools/build.sh",
              "build-minified": "rm -rf build/* && export MINIFY=true && ./tools/build.sh"
            },
            dependencies: {
              "@rollup/plugin-json": "4.1.0",
              rollup: "^2.70.2",
              "rollup-plugin-export-default": "1.4.0",
              "rollup-plugin-polyfill-node": "0.9.0"
            },
            lively: {
              projectDependencies: []
            },
            version: "0.1.0"
          };
        }

        _createClass(Project, [{
          key: "showDiffSummary",
          value: function showDiffSummary() {
            var term = __varRecorder__$q.Terminal.runCommand("git reset 1>/dev/null && git diff-files --stat && git add * 2>/dev/null || true && echo '' && git status --short", {
              cwd: this.gitResource.url,
              position: __varRecorder__$q.pt(100, 100)
            });

            term.position = __varRecorder__$q.pt(100, 100);
            return term;
          }
        }, {
          key: "checkPagesSupport",
          value: function () {
            var _checkPagesSupport = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee5() {
              var currUser, currUserName, checkOrgPlanCmd;
              return regeneratorRuntime.wrap(function _callee5$(_context5) {
                while (1) {
                  switch (_context5.prev = _context5.next) {
                    case 0:
                      currUser = __varRecorder__$q.currentUser();
                      currUserName = currUser.login;
                      if (!this.config.lively.repositoryIsPrivate) this.config.lively.canUsePages = true;

                      if (this.repoOwner === currUserName && this.config.lively.repositoryIsPrivate) {
                        if (currUser.plan.name !== "free") this.config.lively.canUsePages = true;else this.config.lively.canUsePages = false;
                      }

                      if (!this.config.lively.repoBelongsToOrg) {
                        _context5.next = 9;
                        break;
                      }

                      checkOrgPlanCmd = __varRecorder__$q.runCommand("curl -L         -H \"Accept: application/vnd.github+json\"         -H \"Authorization: Bearer ".concat(__varRecorder__$q.currentUserToken(), "\"         -H \"X-GitHub-Api-Version: 2022-11-28\"         https://api.github.com/orgs/").concat(this.repoOwner, "\n      "), {
                        l2lClient: __varRecorder__$q.ShellClientResource.defaultL2lClient
                      });
                      _context5.next = 8;
                      return checkOrgPlanCmd.whenDone();

                    case 8:
                      if (checkOrgPlanCmd.exitCode !== 0) this.config.lively.canUsePages = false;else {
                        if (JSON.parse(checkOrgPlanCmd.stdout).plan.name !== "free") this.config.lively.canUsePages = true;else this.config.lively.canUsePages = false;
                      }

                    case 9:
                    case "end":
                      return _context5.stop();
                  }
                }
              }, _callee5, this);
            }));

            function checkPagesSupport() {
              return _checkPagesSupport.apply(this, arguments);
            }

            return checkPagesSupport;
          }()
        }, {
          key: "saveConfigData",
          value: function () {
            var _saveConfigData = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee6() {
              var nameToRecover;
              return regeneratorRuntime.wrap(function _callee6$(_context6) {
                while (1) {
                  switch (_context6.prev = _context6.next) {
                    case 0:
                      _context6.next = 2;
                      return this.checkPagesSupport();

                    case 2:
                      _context6.next = 4;
                      return this.removeUnusedProjectDependencies();

                    case 4:
                      _context6.next = 6;
                      return this.addMissingProjectDependencies();

                    case 6:
                      if (this.configFile) {
                        _context6.next = 8;
                        break;
                      }

                      throw Error("No config file found. Should never happen.");

                    case 8:
                      nameToRecover = this.config.name;
                      _context6.prev = 9;
                      this.config.name = "".concat(this.repoOwner, "--").concat(nameToRecover);
                      _context6.next = 13;
                      return this.configFile.write(JSON.stringify(this.config, null, 2));

                    case 13:
                      _context6.next = 18;
                      break;

                    case 15:
                      _context6.prev = 15;
                      _context6.t0 = _context6["catch"](9);
                      throw Error("Error writing config file", {
                        cause: _context6.t0
                      });

                    case 18:
                      _context6.prev = 18;
                      this.config.name = nameToRecover;
                      return _context6.finish(18);

                    case 21:
                    case "end":
                      return _context6.stop();
                  }
                }
              }, _callee6, this, [[9, 15, 18, 21]]);
            }));

            function saveConfigData() {
              return _saveConfigData.apply(this, arguments);
            }

            return saveConfigData;
          }()
        }, {
          key: "increaseVersion",
          value: function increaseVersion() {
            var increaseLevel = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : "patch";

            var version = __varRecorder__$q.semver.coerce(this.config.version);

            this.config.version = __varRecorder__$q.semver.inc(version, increaseLevel);
          }
        }, {
          key: "bindAgainstCurrentLivelyVersion",
          value: function () {
            var _bindAgainstCurrentLivelyVersion = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee7(knownCompatibleVersion) {
              var onlyLoadNotOpen,
                  _yield$__varRecorder_,
                  comparison,
                  comparisonBetweenVersions,
                  confirmed,
                  currentCommit,
                  _args7 = arguments;

              return regeneratorRuntime.wrap(function _callee7$(_context7) {
                while (1) {
                  switch (_context7.prev = _context7.next) {
                    case 0:
                      onlyLoadNotOpen = _args7.length > 1 && _args7[1] !== undefined ? _args7[1] : false;
                      _context7.next = 3;
                      return __varRecorder__$q.VersionChecker.checkVersionRelation(knownCompatibleVersion, true);

                    case 3:
                      _yield$__varRecorder_ = _context7.sent;
                      comparison = _yield$__varRecorder_.comparison;
                      comparisonBetweenVersions = __varRecorder__$q.VersionChecker.parseHashComparison(comparison);

                      if (!(comparisonBetweenVersions > 0 && onlyLoadNotOpen)) {
                        _context7.next = 9;
                        break;
                      }

                      console.warn("A loaded project expects a different lively version than the one currently running.");
                      return _context7.abrupt("return");

                    case 9:
                      _context7.t0 = comparisonBetweenVersions;
                      _context7.next = _context7.t0 === 0 ? 12 : _context7.t0 === 1 ? 14 : _context7.t0 === -1 ? 30 : _context7.t0 === 2 ? 30 : 32;
                      break;

                    case 12:
                      if (!onlyLoadNotOpen) $world.setStatusMessage("Already using the latest lively version. All good!", __varRecorder__$q.StatusMessageConfirm);
                      return _context7.abrupt("return", "SUCCESS");

                    case 14:
                      _context7.next = 16;
                      return $world.confirm("This changes the required version of lively.next for this project.\n Are you sure you want to proceed?");

                    case 16:
                      confirmed = _context7.sent;

                      if (confirmed) {
                        _context7.next = 22;
                        break;
                      }

                      $world.setStatusMessage("Changing the required version of lively.next has been canceled.", __varRecorder__$q.StatusMessageError);
                      return _context7.abrupt("return", "CANCELED");

                    case 22:
                      $world.setStatusMessage("Updated the required version of lively.next for ".concat(this.config.name, "."), __varRecorder__$q.StatusMessageConfirm);
                      _context7.next = 25;
                      return __varRecorder__$q.VersionChecker.currentLivelyVersion(true);

                    case 25:
                      currentCommit = _context7.sent;
                      this.config.lively.boundLivelyVersion = currentCommit;
                      _context7.next = 29;
                      return this.saveConfigData();

                    case 29:
                      return _context7.abrupt("return", "UPDATED");

                    case 30:
                      $world.setStatusMessage("You do not have the version of lively.next necessary to open this project. Please get version ".concat(knownCompatibleVersion, " of lively.next"), __varRecorder__$q.StatusMessageError);
                      return _context7.abrupt("return", "OUTDATED");

                    case 32:
                    case "end":
                      return _context7.stop();
                  }
                }
              }, _callee7, this);
            }));

            function bindAgainstCurrentLivelyVersion(_x2) {
              return _bindAgainstCurrentLivelyVersion.apply(this, arguments);
            }

            return bindAgainstCurrentLivelyVersion;
          }()
        }, {
          key: "setCIDefaults",
          value: function setCIDefaults() {
            var livelyConfig = this.config.lively;
            livelyConfig.testActionEnabled = true;
            livelyConfig.buildActionEnabled = false;
            livelyConfig.deployActionEnabled = this.canDeployToPages;
            livelyConfig.testOnPush = true;
            livelyConfig.buildOnPush = false;
            livelyConfig.deployOnPush = false;
          }
        }, {
          key: "create",
          value: function () {
            var _create = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee8() {
              var withRemote,
                  gitHubUser,
                  priv,
                  system,
                  projectDir,
                  createForOrg,
                  pkg,
                  saveSuccess,
                  _args8 = arguments;
              return regeneratorRuntime.wrap(function _callee8$(_context8) {
                while (1) {
                  switch (_context8.prev = _context8.next) {
                    case 0:
                      withRemote = _args8.length > 0 && _args8[0] !== undefined ? _args8[0] : false;
                      gitHubUser = _args8.length > 1 ? _args8[1] : undefined;
                      priv = _args8.length > 2 ? _args8[2] : undefined;
                      this.gitResource = null;
                      system = __varRecorder__$q.Project.systemInterface;
                      _context8.next = 7;
                      return __varRecorder__$q.Project.projectDirectory();

                    case 7:
                      _context8.t0 = gitHubUser + "--" + this.name;
                      projectDir = _context8.sent.join(_context8.t0);
                      this.url = projectDir.url;
                      createForOrg = gitHubUser !== __varRecorder__$q.currentUsername();
                      _context8.prev = 11;
                      _context8.next = 14;
                      return system.resourceCreateFiles(projectDir, {
                        "index.js": "'format esm';\nexport async function main () {\n    // THIS FUNCTION IS THE ENTRY POINT IN THE BUNDLED APPLICATION!\n}",
                        "package.json": "",
                        ".gitignore": "node_modules/\nbuild/",
                        "README.md": "# ".concat(this.name, "\n\nNo description for package ").concat(this.name, " yet.\n"),
                        tools: {
                          "build.sh": "",
                          "build.mjs": ""
                        },
                        build: {},
                        tests: {
                          "test.js": "/* global describe,it */\nimport { expect } from \"mocha-es6\";\ndescribe(\"".concat(this.name, "\", () => {\n  it(\"works\", () => {\n    expect(1 + 2).equals(3);\n  });\n});")
                        },
                        ui: {
                          "components.cp.js": "'format esm';\n"
                        },
                        workspaces: {
                          "default.workspace.js": ""
                        },
                        "index.css": "/* Use this file to add custom CSS to be used for this project. */\n/* Do NOT create other CSS files in this folder, as they will not be available in the bundled application! */\n/* `@imports` fetching remote CSS are okay. */",
                        "fonts.css": __varRecorder__$q.fontCSSWarningString
                      });

                    case 14:
                      _context8.next = 16;
                      return this.generateBuildScripts();

                    case 16:
                      _context8.t1 = __varRecorder__$q;
                      _context8.next = 19;
                      return __varRecorder__$q.defaultDirectory();

                    case 19:
                      _context8.t2 = _context8.sent;
                      _context8.t3 = "git/" + _context8.t2;
                      _context8.t4 = gitHubUser + "--" + this.name;
                      _context8.next = 24;
                      return _context8.t1.resource.call(_context8.t1, _context8.t3).join("..").join("local_projects").join(_context8.t4).withRelativePartsResolved().asDirectory();

                    case 24:
                      this.gitResource = _context8.sent;
                      _context8.next = 27;
                      return __varRecorder__$q.resource(projectDir.join("package.json").url);

                    case 27:
                      this.configFile = _context8.sent;
                      _context8.next = 30;
                      return this.gitResource.initializeGitRepository();

                    case 30:
                      this.config.lively.repositoryIsPrivate = !!priv;
                      this.config.lively.repoBelongsToOrg = createForOrg;
                      _context8.next = 34;
                      return this.saveConfigData();

                    case 34:
                      _context8.next = 36;
                      return __varRecorder__$q.loadPackage(system, {
                        name: this.name,
                        url: this.url,
                        address: this.url,
                        configFile: projectDir.join("package.json").url,
                        main: projectDir.join("index.js").url,
                        test: projectDir.join("tests/test.js").url,
                        type: "package"
                      });

                    case 36:
                      pkg = _context8.sent;
                      this["package"] = pkg;
                      _context8.next = 43;
                      break;

                    case 40:
                      _context8.prev = 40;
                      _context8.t5 = _context8["catch"](11);
                      throw Error("Error creating project files", {
                        cause: _context8.t5
                      });

                    case 43:
                      _context8.next = 45;
                      return __varRecorder__$q.Project.installCSSForProject(this.url, true, {
                        repoOwner: gitHubUser,
                        name: this.name
                      }, this);

                    case 45:
                      if (!withRemote) {
                        _context8.next = 56;
                        break;
                      }

                      _context8.prev = 46;
                      _context8.next = 49;
                      return this.regeneratePipelines();

                    case 49:
                      _context8.next = 51;
                      return this.gitResource.createAndAddRemoteToGitRepository(__varRecorder__$q.currentUserToken(), this.config.name, gitHubUser, this.config.description, createForOrg, priv);

                    case 51:
                      _context8.next = 56;
                      break;

                    case 53:
                      _context8.prev = 53;
                      _context8.t6 = _context8["catch"](46);
                      throw Error("Error setting up remote", {
                        cause: _context8.t6
                      });

                    case 56:
                      this.setCIDefaults();
                      _context8.next = 59;
                      return this.save({
                        message: "Initial Commit"
                      });

                    case 59:
                      saveSuccess = _context8.sent;
                      if (!saveSuccess) $world.setStatusMessage("Error saving the project!", __varRecorder__$q.StatusMessageError);
                      return _context8.abrupt("return", this);

                    case 62:
                    case "end":
                      return _context8.stop();
                  }
                }
              }, _callee8, this, [[11, 40], [46, 53]]);
            }));

            function create() {
              return _create.apply(this, arguments);
            }

            return create;
          }()
        }, {
          key: "reloadPackage",
          value: function reloadPackage() {
            __varRecorder__$q.reloadPackage(System, this["package"].url);
          }
        }, {
          key: "regeneratePipelines",
          value: function () {
            var _regeneratePipelines = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee9() {
              var pipelineFile, content, livelyConfig;
              return regeneratorRuntime.wrap(function _callee9$(_context9) {
                while (1) {
                  switch (_context9.prev = _context9.next) {
                    case 0:
                      _context9.next = 2;
                      return this.gitResource.activateGitHubPages(__varRecorder__$q.currentUserToken(), this.name, this.repoOwner);

                    case 2:
                      livelyConfig = this.config.lively;
                      pipelineFile = __varRecorder__$q.join(this.url, ".github/workflows/ci-tests.yml");

                      if (!livelyConfig.testActionEnabled) {
                        _context9.next = 13;
                        break;
                      }

                      content = this.fillPipelineTemplate(__varRecorder__$q.workflowDefinition, livelyConfig.testOnPush);
                      _context9.next = 8;
                      return __varRecorder__$q.resource(pipelineFile).ensureExistance();

                    case 8:
                      _context9.t0 = content;
                      _context9.next = 11;
                      return _context9.sent.write(_context9.t0);

                    case 11:
                      _context9.next = 18;
                      break;

                    case 13:
                      _context9.next = 15;
                      return __varRecorder__$q.resource(pipelineFile).exists();

                    case 15:
                      if (!_context9.sent) {
                        _context9.next = 18;
                        break;
                      }

                      _context9.next = 18;
                      return __varRecorder__$q.resource(pipelineFile).remove();

                    case 18:
                      pipelineFile = __varRecorder__$q.join(this.url, ".github/workflows/build-upload-action.yml");

                      if (!livelyConfig.buildActionEnabled) {
                        _context9.next = 28;
                        break;
                      }

                      content = this.fillPipelineTemplate(__varRecorder__$q.buildRemoteScript, livelyConfig.buildOnPush);
                      _context9.next = 23;
                      return __varRecorder__$q.resource(pipelineFile).ensureExistance();

                    case 23:
                      _context9.t1 = content;
                      _context9.next = 26;
                      return _context9.sent.write(_context9.t1);

                    case 26:
                      _context9.next = 33;
                      break;

                    case 28:
                      _context9.next = 30;
                      return __varRecorder__$q.resource(pipelineFile).exists();

                    case 30:
                      if (!_context9.sent) {
                        _context9.next = 33;
                        break;
                      }

                      _context9.next = 33;
                      return __varRecorder__$q.resource(pipelineFile).remove();

                    case 33:
                      pipelineFile = __varRecorder__$q.join(this.url, ".github/workflows/deploy-pages-action.yml");

                      if (!(livelyConfig.deployActionEnabled && this.canDeployToPages)) {
                        _context9.next = 43;
                        break;
                      }

                      content = this.fillPipelineTemplate(__varRecorder__$q.deployScript, livelyConfig.deployOnPush);
                      _context9.next = 38;
                      return __varRecorder__$q.resource(pipelineFile).ensureExistance();

                    case 38:
                      _context9.t2 = content;
                      _context9.next = 41;
                      return _context9.sent.write(_context9.t2);

                    case 41:
                      _context9.next = 48;
                      break;

                    case 43:
                      _context9.next = 45;
                      return __varRecorder__$q.resource(pipelineFile).exists();

                    case 45:
                      if (!_context9.sent) {
                        _context9.next = 48;
                        break;
                      }

                      _context9.next = 48;
                      return __varRecorder__$q.resource(pipelineFile).remove();

                    case 48:
                    case "end":
                      return _context9.stop();
                  }
                }
              }, _callee9, this);
            }));

            function regeneratePipelines() {
              return _regeneratePipelines.apply(this, arguments);
            }

            return regeneratePipelines;
          }()
        }, {
          key: "fillPipelineTemplate",
          value: function fillPipelineTemplate(workflowDefinition) {
            var triggerOnPush = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : false;
            var livelyConf = this.config.lively;
            var definition = workflowDefinition.replaceAll("%LIVELY_VERSION%", livelyConf.boundLivelyVersion);

            if (triggerOnPush) {
              definition = definition.replace("%ACTION_TRIGGER%", "\n  push:\n    branches:\n      - main");
            } else definition = definition.replace("%ACTION_TRIGGER%", "");

            if (livelyConf.repositoryIsPrivate && livelyConf.canUsePages) definition = definition.replace("%TOKEN_PERMISSIONS%", "\n  contents: read");else definition = definition.replace("%TOKEN_PERMISSIONS%", "");
            return definition.replaceAll("%PROJECT_NAME%", "".concat(this.repoOwner, "--").concat(this.name));
          }
        }, {
          key: "generateBuildScripts",
          value: function () {
            var _generateBuildScripts = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee10() {
              var shellBuildScript, mjsBuildScript, content, shellBuildScriptOrigin, scriptDir, cmd;
              return regeneratorRuntime.wrap(function _callee10$(_context10) {
                while (1) {
                  switch (_context10.prev = _context10.next) {
                    case 0:
                      shellBuildScript = __varRecorder__$q.join(this.url, "tools/build.sh");
                      _context10.next = 3;
                      return __varRecorder__$q.resource(shellBuildScript).ensureExistance();

                    case 3:
                      _context10.t0 = __varRecorder__$q.buildScriptShell;
                      _context10.next = 6;
                      return _context10.sent.write(_context10.t0);

                    case 6:
                      mjsBuildScript = __varRecorder__$q.join(this.url, "tools/build.mjs");
                      content = __varRecorder__$q.buildScript;
                      content = content.replaceAll("%PROJECT_NAME%", this.name);
                      _context10.next = 11;
                      return __varRecorder__$q.resource(mjsBuildScript).ensureExistance();

                    case 11:
                      _context10.t1 = content;
                      _context10.next = 14;
                      return _context10.sent.write(_context10.t1);

                    case 14:
                      shellBuildScriptOrigin = new URL(shellBuildScript).origin;
                      scriptDir = shellBuildScript.replace(shellBuildScriptOrigin + "/", "").replace("/build.sh", "");
                      cmd = __varRecorder__$q.runCommand("cd ../".concat(scriptDir, " && chmod a+x build.sh"), {
                        l2lClient: __varRecorder__$q.ShellClientResource.defaultL2lClient
                      });
                      _context10.next = 19;
                      return cmd.whenDone();

                    case 19:
                      return _context10.abrupt("return", cmd.exitCode);

                    case 20:
                    case "end":
                      return _context10.stop();
                  }
                }
              }, _callee10, this);
            }));

            function generateBuildScripts() {
              return _generateBuildScripts.apply(this, arguments);
            }

            return generateBuildScripts;
          }()
        }, {
          key: "save",
          value: function () {
            var _save = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee11() {
              var opts,
                  message,
                  increaseLevel,
                  tag,
                  filesToCommit,
                  _args11 = arguments;
              return regeneratorRuntime.wrap(function _callee11$(_context11) {
                while (1) {
                  switch (_context11.prev = _context11.next) {
                    case 0:
                      opts = _args11.length > 0 && _args11[0] !== undefined ? _args11[0] : {};

                      if (__varRecorder__$q.isUserLoggedIn()) {
                        _context11.next = 4;
                        break;
                      }

                      $world.setStatusMessage("Please log in.");
                      return _context11.abrupt("return", false);

                    case 4:
                      message = opts.message, increaseLevel = opts.increaseLevel, tag = opts.tag, filesToCommit = opts.filesToCommit;
                      message = message.trim();
                      message = message + "\nCommited from within lively.next.";
                      this.increaseVersion(increaseLevel);
                      _context11.prev = 8;
                      _context11.next = 11;
                      return this.saveConfigData();

                    case 11:
                      _context11.next = 13;
                      return this.gitResource.hasRemote();

                    case 13:
                      if (!_context11.sent) {
                        _context11.next = 26;
                        break;
                      }

                      _context11.next = 16;
                      return this.gitResource.pullRepo();

                    case 16:
                      _context11.next = 18;
                      return this.regeneratePipelines();

                    case 18:
                      _context11.next = 20;
                      return this.gitResource.commitRepo(message, tag, this.config.version, filesToCommit);

                    case 20:
                      _context11.next = 22;
                      return this.gitResource.pushRepo();

                    case 22:
                      _context11.next = 24;
                      return this.reloadPackage();

                    case 24:
                      _context11.next = 28;
                      break;

                    case 26:
                      _context11.next = 28;
                      return this.gitResource.commitRepo(message, tag, this.config.version);

                    case 28:
                      return _context11.abrupt("return", true);

                    case 31:
                      _context11.prev = 31;
                      _context11.t0 = _context11["catch"](8);
                      $world.setStatusMessage(_context11.t0);
                      return _context11.abrupt("return", false);

                    case 35:
                    case "end":
                      return _context11.stop();
                  }
                }
              }, _callee11, this, [[8, 31]]);
            }));

            function save() {
              return _save.apply(this, arguments);
            }

            return save;
          }()
        }, {
          key: "ensureDependenciesExist",
          value: function () {
            var _ensureDependenciesExist = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee12() {
              var _this = this;

              var dependencyMap, availableProjects, depsToEnsure, _loop, _ret;

              return regeneratorRuntime.wrap(function _callee12$(_context13) {
                while (1) {
                  switch (_context13.prev = _context13.next) {
                    case 0:
                      dependencyMap = {};
                      availableProjects = __varRecorder__$q.Project.retrieveAvailableProjectsCache();
                      depsToEnsure = this.config.lively.projectDependencies.map(function (dep) {
                        return {
                          name: dep.name,
                          version: dep.version,
                          requester: _this.name
                        };
                      });
                      _loop = /*#__PURE__*/regeneratorRuntime.mark(function _loop() {
                        var depToEnsure, dependerArray, depExists, depName, depRepoOwner, cmd, transitiveDepsOfDepToEnsure, adr;
                        return regeneratorRuntime.wrap(function _loop$(_context12) {
                          while (1) {
                            switch (_context12.prev = _context12.next) {
                              case 0:
                                depToEnsure = depsToEnsure[0];

                                if (!dependencyMap[depToEnsure.name]) {
                                  _context12.next = 5;
                                  break;
                                }

                                if (dependencyMap[depToEnsure.name][depToEnsure.version]) {
                                  dependerArray = dependencyMap[depToEnsure.name][depToEnsure.version];
                                  if (!dependerArray.includes(depToEnsure.requester)) dependerArray.push(depToEnsure.requester);
                                } else dependencyMap[depToEnsure.name][depToEnsure.version] = [depToEnsure.requester];

                                depsToEnsure.shift();
                                return _context12.abrupt("return", "continue");

                              case 5:
                                depExists = availableProjects.some(function (proj) {
                                  return "".concat(proj.projectRepoOwner, "--").concat(proj.name) === depToEnsure.name;
                                });

                                if (depExists) {
                                  _context12.next = 17;
                                  break;
                                }

                                depName = depToEnsure.name.match(/[a-zA-Z\d]*--(.*)/)[1];
                                depRepoOwner = depToEnsure.name.match(/([a-zA-Z\d]*)--/)[1];
                                cmd = __varRecorder__$q.runCommand("cd ../local_projects/ && git clone https://".concat(__varRecorder__$q.currentUserToken(), "@github.com/").concat(depRepoOwner, "/").concat(depName, " ").concat(depRepoOwner, "--").concat(depName), {
                                  l2lClient: __varRecorder__$q.ShellClientResource.defaultL2lClient
                                });
                                _context12.next = 12;
                                return cmd.whenDone();

                              case 12:
                                if (!(cmd.exitCode !== 0)) {
                                  _context12.next = 14;
                                  break;
                                }

                                throw Error("Error cloning uninstalled dependency project.");

                              case 14:
                                _context12.next = 16;
                                return __varRecorder__$q.Project.listAvailableProjects();

                              case 16:
                                availableProjects = _context12.sent;

                              case 17:
                                transitiveDepsOfDepToEnsure = availableProjects.find(function (proj) {
                                  return "".concat(proj.projectRepoOwner, "--").concat(proj.name) === depToEnsure.name;
                                }).lively.projectDependencies.map(function (dep) {
                                  return {
                                    name: dep.name,
                                    version: dep.version,
                                    requester: depToEnsure.name
                                  };
                                });
                                transitiveDepsOfDepToEnsure.forEach(function (dep) {
                                  return dep.requester = depToEnsure.name;
                                });
                                depsToEnsure = depsToEnsure.concat(transitiveDepsOfDepToEnsure);
                                _context12.next = 22;
                                return __varRecorder__$q.Project.projectDirectory();

                              case 22:
                                _context12.t0 = depToEnsure.name;
                                adr = _context12.sent.join(_context12.t0);
                                _context12.next = 26;
                                return __varRecorder__$q.loadPackage(__varRecorder__$q.Project.systemInterface, {
                                  name: depToEnsure.name,
                                  url: adr.url,
                                  address: adr.url,
                                  type: "package"
                                });

                              case 26:
                                __varRecorder__$q.Project.installCSSForProject(adr.url, false, {
                                  name: depToEnsure.name
                                });

                                dependencyMap[depToEnsure.name] = _defineProperty({}, String(depToEnsure.version), [depToEnsure.requester]);
                                depsToEnsure.shift();

                              case 29:
                              case "end":
                                return _context12.stop();
                            }
                          }
                        }, _loop);
                      });

                    case 4:
                      if (!(depsToEnsure.length > 0)) {
                        _context13.next = 11;
                        break;
                      }

                      return _context13.delegateYield(_loop(), "t0", 6);

                    case 6:
                      _ret = _context13.t0;

                      if (!(_ret === "continue")) {
                        _context13.next = 9;
                        break;
                      }

                      return _context13.abrupt("continue", 4);

                    case 9:
                      _context13.next = 4;
                      break;

                    case 11:
                      this.dependencyMap = dependencyMap;

                    case 12:
                    case "end":
                      return _context13.stop();
                  }
                }
              }, _callee12, this);
            }));

            function ensureDependenciesExist() {
              return _ensureDependenciesExist.apply(this, arguments);
            }

            return ensureDependenciesExist;
          }()
        }, {
          key: "checkVersionCompatibilityOfProjectDependencies",
          value: function () {
            var _checkVersionCompatibilityOfProjectDependencies = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee13() {
              var onlyLoadNotOpen,
                  dependencyMap,
                  dependencyStatusReport,
                  availableProjects,
                  showStatusReport,
                  _loop2,
                  dep,
                  _args14 = arguments;

              return regeneratorRuntime.wrap(function _callee13$(_context14) {
                while (1) {
                  switch (_context14.prev = _context14.next) {
                    case 0:
                      onlyLoadNotOpen = _args14.length > 0 && _args14[0] !== undefined ? _args14[0] : false;
                      dependencyMap = this.dependencyMap;
                      dependencyStatusReport = [];
                      availableProjects = __varRecorder__$q.Project.retrieveAvailableProjectsCache();
                      showStatusReport = false;

                      _loop2 = function _loop2(dep) {
                        var installedDep = availableProjects.find(function (proj) {
                          return "".concat(proj.projectRepoOwner, "--").concat(proj.name) === dep;
                        });

                        for (var depVersion in dependencyMap[dep]) {
                          var requesterOfDepVersion = dependencyMap[dep][depVersion].join(" ");

                          var versionStatus = __varRecorder__$q.semver.satisfies(__varRecorder__$q.semver.coerce(installedDep.version), __varRecorder__$q.semver.validRange(depVersion));

                          if (versionStatus === true) dependencyStatusReport = dependencyStatusReport.concat(["\u2714\uFE0F Loaded ".concat(dep, " with version ").concat(installedDep.version, " (").concat(depVersion, " required by [").concat(requesterOfDepVersion, "]).\n"), null]);else {
                            showStatusReport = true;
                            dependencyStatusReport = dependencyStatusReport.concat(["\u26A0\uFE0F Loaded ".concat(dep, " with version ").concat(installedDep.version, ", but ").concat(depVersion, " required by [").concat(requesterOfDepVersion, "].\n"), null]);
                          }
                        }
                      };

                      for (dep in dependencyMap) {
                        _loop2(dep);
                      }

                      if (showStatusReport && !onlyLoadNotOpen) $world.inform("Dependency Status", {
                        additionalText: dependencyStatusReport.concat(["Loading has been successful, but be cautious.", {
                          fontWeight: 700
                        }])
                      });
                      if (showStatusReport && onlyLoadNotOpen) console.warn("A loaded project introduced a dependency version conflict.");
                      this.dependencyMap = null;

                    case 10:
                    case "end":
                      return _context14.stop();
                  }
                }
              }, _callee13, this);
            }));

            function checkVersionCompatibilityOfProjectDependencies() {
              return _checkVersionCompatibilityOfProjectDependencies.apply(this, arguments);
            }

            return checkVersionCompatibilityOfProjectDependencies;
          }()
        }, {
          key: "addDependencyToProject",
          value: function () {
            var _addDependencyToProject = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee14(owner, name) {
              var ownerAndNameString, dep, version, addedSemver, newDepVersion, deps, alreadyDependent;
              return regeneratorRuntime.wrap(function _callee14$(_context15) {
                while (1) {
                  switch (_context15.prev = _context15.next) {
                    case 0:
                      ownerAndNameString = "".concat(owner, "--").concat(name);
                      dep = __varRecorder__$q.Project.retrieveAvailableProjectsCache().find(function (proj) {
                        return ownerAndNameString === "".concat(proj.projectRepoOwner, "--").concat(proj.name);
                      });

                      if (dep) {
                        _context15.next = 4;
                        break;
                      }

                      throw Error("Dependency is not available!");

                    case 4:
                      _context15.prev = 4;
                      _context15.next = 7;
                      return __varRecorder__$q.Project.loadProject(name, owner, true);

                    case 7:
                      _context15.next = 12;
                      break;

                    case 9:
                      _context15.prev = 9;
                      _context15.t0 = _context15["catch"](4);
                      throw Error("Error loading and adding dependency package", {
                        cause: _context15.t0
                      });

                    case 12:
                      version = dep.version;
                      addedSemver = __varRecorder__$q.semver.coerce(version);
                      newDepVersion = "".concat(addedSemver.major, ".").concat(addedSemver.minor, ".x");
                      deps = this.config.lively.projectDependencies;
                      alreadyDependent = deps.find(function (dep) {
                        return dep.name === ownerAndNameString;
                      });

                      if (alreadyDependent) {
                        alreadyDependent.version = newDepVersion;
                      } else this.config.lively.projectDependencies.push({
                        name: ownerAndNameString,
                        version: newDepVersion
                      });

                    case 18:
                    case "end":
                      return _context15.stop();
                  }
                }
              }, _callee14, this, [[4, 9]]);
            }));

            function addDependencyToProject(_x3, _x4) {
              return _addDependencyToProject.apply(this, arguments);
            }

            return addDependencyToProject;
          }()
        }, {
          key: "removeDependencyFromProject",
          value: function removeDependencyFromProject(owner, name) {
            var deps = this.config.lively.projectDependencies;
            this.config.lively.projectDependencies = deps.filter(function (dep) {
              return dep.name !== "".concat(owner, "--").concat(name);
            });
          }
        }, {
          key: "addMissingProjectDependencies",
          value: function () {
            var _addMissingProjectDependencies = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee15() {
              var _this2 = this;

              var availableDeps, currentDeps, filesInPackage, jsFilesInPackage, _iterator, _step, _loop3;

              return regeneratorRuntime.wrap(function _callee15$(_context17) {
                while (1) {
                  switch (_context17.prev = _context17.next) {
                    case 0:
                      availableDeps = __varRecorder__$q.Project.retrieveAvailableProjectsCache().map(function (proj) {
                        return {
                          name: "".concat(proj.projectRepoOwner, "--").concat(proj.name),
                          version: proj.version
                        };
                      });
                      currentDeps = this.config.lively.projectDependencies.slice();
                      _context17.next = 4;
                      return __varRecorder__$q.resource(this.url).asDirectory().dirList("infinity");

                    case 4:
                      filesInPackage = _context17.sent;
                      jsFilesInPackage = filesInPackage.filter(function (p) {
                        return p.url.endsWith(".js") && !p.url.includes("/build");
                      });
                      _iterator = _createForOfIteratorHelper(jsFilesInPackage);
                      _context17.prev = 7;
                      _loop3 = /*#__PURE__*/regeneratorRuntime.mark(function _loop3() {
                        var jsFile, content;
                        return regeneratorRuntime.wrap(function _loop3$(_context16) {
                          while (1) {
                            switch (_context16.prev = _context16.next) {
                              case 0:
                                jsFile = _step.value;
                                _context16.next = 3;
                                return jsFile.read();

                              case 3:
                                content = _context16.sent;
                                availableDeps.forEach(function (dep) {
                                  if (content.includes(dep.name) && !currentDeps.some(function (alreadyPresentDeps) {
                                    return dep.name === alreadyPresentDeps.name;
                                  }) && "".concat(_this2.repoOwner, "--").concat(_this2.name) !== dep.name) currentDeps.push(dep);
                                });

                              case 5:
                              case "end":
                                return _context16.stop();
                            }
                          }
                        }, _loop3);
                      });

                      _iterator.s();

                    case 10:
                      if ((_step = _iterator.n()).done) {
                        _context17.next = 14;
                        break;
                      }

                      return _context17.delegateYield(_loop3(), "t0", 12);

                    case 12:
                      _context17.next = 10;
                      break;

                    case 14:
                      _context17.next = 19;
                      break;

                    case 16:
                      _context17.prev = 16;
                      _context17.t1 = _context17["catch"](7);

                      _iterator.e(_context17.t1);

                    case 19:
                      _context17.prev = 19;

                      _iterator.f();

                      return _context17.finish(19);

                    case 22:
                      currentDeps = __varRecorder__$q.arr.uniqBy(currentDeps, __varRecorder__$q.obj.equals);
                      this.config.lively.projectDependencies = currentDeps;
                      return _context17.abrupt("return", currentDeps);

                    case 25:
                    case "end":
                      return _context17.stop();
                  }
                }
              }, _callee15, this, [[7, 16, 19, 22]]);
            }));

            function addMissingProjectDependencies() {
              return _addMissingProjectDependencies.apply(this, arguments);
            }

            return addMissingProjectDependencies;
          }()
        }, {
          key: "removeUnusedProjectDependencies",
          value: function () {
            var _removeUnusedProjectDependencies = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee16() {
              var usedDeps, currentDeps, filesInPackage, jsFilesInPackage, _iterator2, _step2, _loop4;

              return regeneratorRuntime.wrap(function _callee16$(_context19) {
                while (1) {
                  switch (_context19.prev = _context19.next) {
                    case 0:
                      usedDeps = [];
                      currentDeps = this.config.lively.projectDependencies;
                      _context19.next = 4;
                      return __varRecorder__$q.resource(this.url).asDirectory().dirList("infinity");

                    case 4:
                      filesInPackage = _context19.sent;
                      jsFilesInPackage = filesInPackage.filter(function (p) {
                        return p.url.endsWith(".js") && !p.url.includes("/build");
                      });
                      _iterator2 = _createForOfIteratorHelper(jsFilesInPackage);
                      _context19.prev = 7;
                      _loop4 = /*#__PURE__*/regeneratorRuntime.mark(function _loop4() {
                        var jsFile, content;
                        return regeneratorRuntime.wrap(function _loop4$(_context18) {
                          while (1) {
                            switch (_context18.prev = _context18.next) {
                              case 0:
                                jsFile = _step2.value;
                                _context18.next = 3;
                                return jsFile.read();

                              case 3:
                                content = _context18.sent;
                                currentDeps.forEach(function (dep) {
                                  if (content.includes(dep.name)) usedDeps.push(dep);
                                });

                              case 5:
                              case "end":
                                return _context18.stop();
                            }
                          }
                        }, _loop4);
                      });

                      _iterator2.s();

                    case 10:
                      if ((_step2 = _iterator2.n()).done) {
                        _context19.next = 14;
                        break;
                      }

                      return _context19.delegateYield(_loop4(), "t0", 12);

                    case 12:
                      _context19.next = 10;
                      break;

                    case 14:
                      _context19.next = 19;
                      break;

                    case 16:
                      _context19.prev = 16;
                      _context19.t1 = _context19["catch"](7);

                      _iterator2.e(_context19.t1);

                    case 19:
                      _context19.prev = 19;

                      _iterator2.f();

                      return _context19.finish(19);

                    case 22:
                      this.config.lively.projectDependencies = usedDeps;
                      return _context19.abrupt("return", usedDeps);

                    case 24:
                    case "end":
                      return _context19.stop();
                  }
                }
              }, _callee16, this, [[7, 16, 19, 22]]);
            }));

            function removeUnusedProjectDependencies() {
              return _removeUnusedProjectDependencies.apply(this, arguments);
            }

            return removeUnusedProjectDependencies;
          }()
        }, {
          key: "addCustomFontFace",
          value: function () {
            var _addCustomFontFace = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee17(customFontObj) {
              var fontCSS, fontCSSContent, fontCSSToAdd;
              return regeneratorRuntime.wrap(function _callee17$(_context20) {
                while (1) {
                  switch (_context20.prev = _context20.next) {
                    case 0:
                      fontCSS = __varRecorder__$q.resource(this.url).join("fonts.css");
                      _context20.next = 3;
                      return fontCSS.read();

                    case 3:
                      fontCSSContent = _context20.sent;
                      fontCSSToAdd = __varRecorder__$q.generateFontFaceString(customFontObj);
                      fontCSSContent = fontCSSContent + fontCSSToAdd;
                      _context20.next = 8;
                      return fontCSS.write(fontCSSContent);

                    case 8:
                    case "end":
                      return _context20.stop();
                  }
                }
              }, _callee17, this);
            }));

            function addCustomFontFace(_x5) {
              return _addCustomFontFace.apply(this, arguments);
            }

            return addCustomFontFace;
          }()
        }, {
          key: "deleteCustomFont",
          value: function () {
            var _deleteCustomFont = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee18(fontObjToDelete) {
              var deleteFile,
                  currentProjFonts,
                  fontFileToDelete,
                  newProjFonts,
                  cssString,
                  fontCSS,
                  _args21 = arguments;
              return regeneratorRuntime.wrap(function _callee18$(_context21) {
                while (1) {
                  switch (_context21.prev = _context21.next) {
                    case 0:
                      deleteFile = _args21.length > 1 && _args21[1] !== undefined ? _args21[1] : false;
                      _context21.next = 3;
                      return this.retrieveProjectFontsFromCSS();

                    case 3:
                      currentProjFonts = _context21.sent;
                      fontFileToDelete = __varRecorder__$q.resource($world.openedProject.url).join("assets/" + fontObjToDelete.fileName + ".woff2");
                      newProjFonts = currentProjFonts.filter(function (projFont) {
                        return !__varRecorder__$q.obj.equals(projFont, fontObjToDelete);
                      });
                      cssString = newProjFonts.map(function (f) {
                        return __varRecorder__$q.generateFontFaceString(f);
                      }).join("\n");
                      cssString = __varRecorder__$q.fontCSSWarningString + cssString;
                      fontCSS = __varRecorder__$q.resource(this.url).join("fonts.css");

                      if (!deleteFile) {
                        _context21.next = 12;
                        break;
                      }

                      _context21.next = 12;
                      return fontFileToDelete.remove();

                    case 12:
                      _context21.next = 14;
                      return fontCSS.write(cssString);

                    case 14:
                    case "end":
                      return _context21.stop();
                  }
                }
              }, _callee18, this);
            }));

            function deleteCustomFont(_x6) {
              return _deleteCustomFont.apply(this, arguments);
            }

            return deleteCustomFont;
          }()
        }, {
          key: "retrieveProjectFontsFromCSS",
          value: function () {
            var _retrieveProjectFontsFromCSS = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee19() {
              var fontObjects, fontCSS, fontCSSContent, matches, _iterator3, _step3, _fontString$match, _fontString$match2, match, fontString;

              return regeneratorRuntime.wrap(function _callee19$(_context22) {
                while (1) {
                  switch (_context22.prev = _context22.next) {
                    case 0:
                      fontObjects = [];
                      fontCSS = __varRecorder__$q.resource(this.url).join("fonts.css");
                      _context22.next = 4;
                      return fontCSS.read();

                    case 4:
                      fontCSSContent = _context22.sent.replaceAll(/\s+/g, " ");
                      matches = fontCSSContent.matchAll(/@font-face {([^}]*)}/gm);
                      _iterator3 = _createForOfIteratorHelper(matches);

                      try {
                        for (_iterator3.s(); !(_step3 = _iterator3.n()).done;) {
                          match = _step3.value;
                          fontString = match[1].replaceAll(/\s+/g, " ");
                          fontObjects.push({
                            fileName: fontString.match(/url\('.*\/(.*)\.woff2'\);/)[1],
                            fontName: fontString.match(/font-family: '(.*)'; src/)[1],
                            fontWeight: ((_fontString$match = fontString.match(/font-weight: ([\s\d]*);/)) === null || _fontString$match === void 0 ? void 0 : _fontString$match[1].split(" ").map(function (i) {
                              return Number.parseInt(i);
                            })) || [],
                            fontStyle: fontString.match(/font-style: ([a-z]*);/)[1],
                            unicodeRange: ((_fontString$match2 = fontString.match(/unicode-range: ([^;]*)/)) === null || _fontString$match2 === void 0 ? void 0 : _fontString$match2[1]) || "''"
                          });
                        }
                      } catch (err) {
                        _iterator3.e(err);
                      } finally {
                        _iterator3.f();
                      }

                      this._fonts = fontObjects || [];
                      return _context22.abrupt("return", fontObjects);

                    case 10:
                    case "end":
                      return _context22.stop();
                  }
                }
              }, _callee19, this);
            }));

            function retrieveProjectFontsFromCSS() {
              return _retrieveProjectFontsFromCSS.apply(this, arguments);
            }

            return retrieveProjectFontsFromCSS;
          }()
        }, {
          key: "projectFonts",
          get: function get() {
            var fonts = this._fonts;
            var fontItems = fonts.map(function (fontObj) {
              var name = fontObj.fontName;
              if (fontObj.fontWeight.length === 1) return {
                name: name,
                supportedWeights: fontObj.fontWeight
              };
              var supportedWeights = [];

              if (fontObj.fontWeight.length === 2) {
                var range = fontObj.fontWeight;

                for (var i = Number(range[0]); i <= range[1]; i += 100) {
                  supportedWeights.push(i);
                }

                return {
                  name: name,
                  supportedWeights: supportedWeights
                };
              } else return {
                name: name,
                supportedWeights: []
              };
            }).filter(function (value) {
              return Object.keys(value).length !== 0;
            });
            var unifiedFontItems = fontItems.reduce(function (collection, currentValue) {
              var _findExistingEntry$su;

              var findExistingEntry = collection.find(function (v) {
                return v.name === currentValue.name;
              });
              if (findExistingEntry) (_findExistingEntry$su = findExistingEntry.supportedWeights).push.apply(_findExistingEntry$su, _toConsumableArray(currentValue.supportedWeights));else collection.push(currentValue);
              return collection;
            }, []);
            unifiedFontItems.forEach(function (fontItem) {
              return fontItem.supportedWeights = __varRecorder__$q.arr.uniq(fontItem.supportedWeights.sort(), true);
            });
            return unifiedFontItems;
          }
        }], [{
          key: "listAvailableProjects",
          value: function () {
            var _listAvailableProjects = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee21() {
              var baseURL, projectsDir, projectsCandidates, packageJSONStrings, packageJSONObjects, validPackageJSONObjects;
              return regeneratorRuntime.wrap(function _callee21$(_context24) {
                while (1) {
                  switch (_context24.prev = _context24.next) {
                    case 0:
                      _context24.next = 2;
                      return __varRecorder__$q.Project.systemInterface.getConfig();

                    case 2:
                      baseURL = _context24.sent.baseURL;

                      if (!lively.FreezerRuntime) {
                        _context24.next = 7;
                        break;
                      }

                      _context24.t0 = __varRecorder__$q.resource(baseURL).join("../local_projects").withRelativePartsResolved().asDirectory();
                      _context24.next = 10;
                      break;

                    case 7:
                      _context24.next = 9;
                      return __varRecorder__$q.Project.projectDirectory();

                    case 9:
                      _context24.t0 = _context24.sent;

                    case 10:
                      projectsDir = _context24.t0;
                      _context24.next = 13;
                      return __varRecorder__$q.resource(projectsDir).dirList(2, {
                        exclude: function exclude(dir) {
                          return dir.isFile() && !dir.name().endsWith("package.json");
                        }
                      });

                    case 13:
                      projectsCandidates = _context24.sent;
                      _context24.prev = 14;
                      projectsCandidates = projectsCandidates.filter(function (dir) {
                        return dir.name().endsWith("package.json");
                      }).map(function (f) {
                        return f.parent();
                      });
                      _context24.next = 18;
                      return Promise.all(projectsCandidates.map( /*#__PURE__*/function () {
                        var _ref = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee20(projectDir) {
                          return regeneratorRuntime.wrap(function _callee20$(_context23) {
                            while (1) {
                              switch (_context23.prev = _context23.next) {
                                case 0:
                                  _context23.next = 2;
                                  return __varRecorder__$q.resource(projectDir.join("package.json")).read();

                                case 2:
                                  return _context23.abrupt("return", _context23.sent);

                                case 3:
                                case "end":
                                  return _context23.stop();
                              }
                            }
                          }, _callee20);
                        }));

                        return function (_x7) {
                          return _ref.apply(this, arguments);
                        };
                      }()));

                    case 18:
                      packageJSONStrings = _context24.sent;
                      packageJSONObjects = packageJSONStrings.flatMap(function (s) {
                        try {
                          return JSON.parse(s);
                        } catch (e) {
                          console.error("An invalid lively Project was encountered (no valid `package.json`)!");
                          return [];
                        }
                      });
                      validPackageJSONObjects = [];
                      packageJSONObjects.forEach(function (pkg) {
                        try {
                          pkg.projectRepoOwner = pkg.repository.url.match(__varRecorder__$q.repositoryOwnerAndNameRegex)[1];
                          pkg.url = projectsDir.url + pkg.name;
                          pkg.name = pkg.name.replace(/[a-zA-Z\d]*--/, "");
                          validPackageJSONObjects.push(pkg);
                        } catch (e) {
                          console.error("An invalid lively Project was encountered (`package.json` probably does not conform to `lively.project` standard)!");
                        }
                      });
                      localStorage.setItem("available_lively_projects", JSON.stringify(validPackageJSONObjects));
                      return _context24.abrupt("return", validPackageJSONObjects);

                    case 26:
                      _context24.prev = 26;
                      _context24.t1 = _context24["catch"](14);
                      throw Error("Error listing local projects", {
                        cause: _context24.t1
                      });

                    case 29:
                    case "end":
                      return _context24.stop();
                  }
                }
              }, _callee21, null, [[14, 26]]);
            }));

            function listAvailableProjects() {
              return _listAvailableProjects.apply(this, arguments);
            }

            return listAvailableProjects;
          }()
        }, {
          key: "fromRemote",
          value: function () {
            var _fromRemote = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee22(remote) {
              var li, remoteUrl, userToken, projectName, projectRepoOwner, cmd, loadedProject;
              return regeneratorRuntime.wrap(function _callee22$(_context25) {
                while (1) {
                  switch (_context25.prev = _context25.next) {
                    case 0:
                      li = $world.showLoadingIndicatorFor($world, "Fetching Project...");
                      if (remote.endsWith("/")) remote = remote.slice(0, -1);
                      remoteUrl = new URL(remote);
                      userToken = __varRecorder__$q.currentUserToken();
                      projectName = remote.match(__varRecorder__$q.repositoryOwnerAndNameRegex)[2];
                      projectRepoOwner = remote.match(__varRecorder__$q.repositoryOwnerAndNameRegex)[1];
                      cmd = __varRecorder__$q.runCommand("cd ../local_projects/ && git clone https://".concat(userToken, "@github.com").concat(remoteUrl.pathname, " ").concat(projectRepoOwner, "--").concat(projectName), {
                        l2lClient: __varRecorder__$q.ShellClientResource.defaultL2lClient
                      });
                      _context25.next = 9;
                      return cmd.whenDone();

                    case 9:
                      if (!(cmd.exitCode !== 0)) {
                        _context25.next = 11;
                        break;
                      }

                      throw Error("Error cloning repository");

                    case 11:
                      li.remove();
                      _context25.next = 14;
                      return __varRecorder__$q.Project.loadProject(projectName, projectRepoOwner);

                    case 14:
                      loadedProject = _context25.sent;
                      return _context25.abrupt("return", loadedProject);

                    case 16:
                    case "end":
                      return _context25.stop();
                  }
                }
              }, _callee22);
            }));

            function fromRemote(_x8) {
              return _fromRemote.apply(this, arguments);
            }

            return fromRemote;
          }()
        }, {
          key: "deleteProject",
          value: function () {
            var _deleteProject = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee23(name, repoOwner) {
              var baseURL, projectsDir;
              return regeneratorRuntime.wrap(function _callee23$(_context26) {
                while (1) {
                  switch (_context26.prev = _context26.next) {
                    case 0:
                      _context26.next = 2;
                      return __varRecorder__$q.Project.systemInterface.getConfig();

                    case 2:
                      baseURL = _context26.sent.baseURL;

                      if (!lively.FreezerRuntime) {
                        _context26.next = 7;
                        break;
                      }

                      _context26.t0 = __varRecorder__$q.resource(baseURL).join("../local_projects/".concat(repoOwner, "--").concat(name)).withRelativePartsResolved().asDirectory();
                      _context26.next = 11;
                      break;

                    case 7:
                      _context26.next = 9;
                      return __varRecorder__$q.Project.projectDirectory();

                    case 9:
                      _context26.t1 = "/".concat(repoOwner, "--").concat(name);
                      _context26.t0 = _context26.sent.join(_context26.t1).asDirectory();

                    case 11:
                      projectsDir = _context26.t0;
                      _context26.prev = 12;
                      _context26.next = 15;
                      return projectsDir.remove();

                    case 15:
                      _context26.next = 20;
                      break;

                    case 17:
                      _context26.prev = 17;
                      _context26.t2 = _context26["catch"](12);
                      throw Error("Error deleting project", {
                        cause: _context26.t2
                      });

                    case 20:
                    case "end":
                      return _context26.stop();
                  }
                }
              }, _callee23, null, [[12, 17]]);
            }));

            function deleteProject(_x9, _x10) {
              return _deleteProject.apply(this, arguments);
            }

            return deleteProject;
          }()
        }, {
          key: "loadProject",
          value: function () {
            var _loadProject = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee24(name, repoOwner) {
              var onlyLoadNotOpen,
                  li,
                  loadedProject,
                  address,
                  url,
                  configContent,
                  checkLivelyCompatibility,
                  pkg,
                  _args27 = arguments;
              return regeneratorRuntime.wrap(function _callee24$(_context27) {
                while (1) {
                  switch (_context27.prev = _context27.next) {
                    case 0:
                      onlyLoadNotOpen = _args27.length > 2 && _args27[2] !== undefined ? _args27[2] : false;
                      if (!onlyLoadNotOpen && $world) li = $world.showLoadingIndicatorFor($world, "Loading Project...");
                      loadedProject = new __varRecorder__$q.Project(name);
                      _context27.next = 5;
                      return __varRecorder__$q.Project.projectDirectory();

                    case 5:
                      _context27.t0 = repoOwner + "--" + name;
                      address = _context27.sent.join(_context27.t0);
                      url = address.url;
                      loadedProject.url = url;
                      _context27.next = 11;
                      return __varRecorder__$q.resource(address.join("package.json").url);

                    case 11:
                      loadedProject.configFile = _context27.sent;

                      if (onlyLoadNotOpen) {
                        _context27.next = 31;
                        break;
                      }

                      _context27.t1 = __varRecorder__$q;
                      _context27.next = 16;
                      return __varRecorder__$q.defaultDirectory();

                    case 16:
                      _context27.t2 = _context27.sent;
                      _context27.t3 = "git/" + _context27.t2;
                      _context27.t4 = repoOwner + "--" + name;
                      _context27.next = 21;
                      return _context27.t1.resource.call(_context27.t1, _context27.t3).join("..").join("local_projects").join(_context27.t4).withRelativePartsResolved().asDirectory();

                    case 21:
                      loadedProject.gitResource = _context27.sent;
                      _context27.next = 24;
                      return loadedProject.gitResource.resetFile("package.json");

                    case 24:
                      _context27.next = 26;
                      return loadedProject.gitResource.resetFile(".github/workflows/ci-tests.yml");

                    case 26:
                      _context27.next = 28;
                      return loadedProject.gitResource.hasRemote();

                    case 28:
                      if (!_context27.sent) {
                        _context27.next = 31;
                        break;
                      }

                      _context27.next = 31;
                      return loadedProject.gitResource.pullRepo();

                    case 31:
                      _context27.next = 33;
                      return loadedProject.configFile.read();

                    case 33:
                      configContent = _context27.sent;
                      loadedProject.config = JSON.parse(configContent);
                      loadedProject.config.name = name;
                      _context27.next = 38;
                      return loadedProject.bindAgainstCurrentLivelyVersion(loadedProject.config.lively.boundLivelyVersion, onlyLoadNotOpen);

                    case 38:
                      checkLivelyCompatibility = _context27.sent;

                      if (onlyLoadNotOpen) {
                        _context27.next = 46;
                        break;
                      }

                      loadedProject.addMissingProjectDependencies();
                      _context27.t5 = checkLivelyCompatibility;
                      _context27.next = _context27.t5 === "CANCELED" ? 44 : _context27.t5 === "OUTDATED" ? 44 : 46;
                      break;

                    case 44:
                      _context27.next = 46;
                      return $world.inform("The required lively version of this project conflicts with the running one.", {
                        additionalText: "You can proceed with OK, but be aware that some expected behaviour might differ or not work."
                      });

                    case 46:
                      _context27.prev = 46;
                      _context27.next = 49;
                      return loadedProject.ensureDependenciesExist();

                    case 49:
                      _context27.next = 51;
                      return loadedProject.checkVersionCompatibilityOfProjectDependencies(onlyLoadNotOpen);

                    case 51:
                      _context27.next = 65;
                      break;

                    case 53:
                      _context27.prev = 53;
                      _context27.t6 = _context27["catch"](46);

                      if (onlyLoadNotOpen) {
                        _context27.next = 63;
                        break;
                      }

                      _context27.next = 58;
                      return $world.inform("The projects dependencies cannot be found.\n This session will now close.");

                    case 58:
                      _context27.next = 60;
                      return __varRecorder__$q.Project.systemInterface.getConfig().baseURL;

                    case 60:
                      window.location.href = _context27.sent;
                      _context27.next = 64;
                      break;

                    case 63:
                      $world.setStatusMessage("Project could not be loaded due to missing dependencies!", __varRecorder__$q.StatusMessageError);

                    case 64:
                      throw new Error({
                        cause: _context27.t6
                      });

                    case 65:
                      _context27.next = 67;
                      return __varRecorder__$q.loadPackage(__varRecorder__$q.Project.systemInterface, {
                        name: name,
                        url: url,
                        address: url,
                        configFile: address.join("package.json").url,
                        main: loadedProject.config.main ? address.join(loadedProject.config.main).url : address.join("index.js").url,
                        type: "package"
                      });

                    case 67:
                      pkg = _context27.sent;
                      loadedProject["package"] = pkg;
                      _context27.next = 71;
                      return __varRecorder__$q.Project.installCSSForProject(url, !onlyLoadNotOpen, {
                        repoOwner: repoOwner,
                        name: name
                      }, !onlyLoadNotOpen ? loadedProject : null);

                    case 71:
                      if (onlyLoadNotOpen) {
                        _context27.next = 75;
                        break;
                      }

                      $world.openedProject = loadedProject;
                      _context27.next = 75;
                      return loadedProject.retrieveProjectFontsFromCSS();

                    case 75:
                      if (li) li.remove();
                      return _context27.abrupt("return", loadedProject);

                    case 77:
                    case "end":
                      return _context27.stop();
                  }
                }
              }, _callee24, null, [[46, 53]]);
            }));

            function loadProject(_x11, _x12) {
              return _loadProject.apply(this, arguments);
            }

            return loadProject;
          }()
        }, {
          key: "installCSSForProject",
          value: function () {
            var _installCSSForProject = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee26(projectUrl, forProject, opts, projectRef) {
              var indexCSSResource, indexCSS, updateProjectCSS;
              return regeneratorRuntime.wrap(function _callee26$(_context29) {
                while (1) {
                  switch (_context29.prev = _context29.next) {
                    case 0:
                      indexCSSResource = __varRecorder__$q.resource(projectUrl).join("index.css");
                      _context29.next = 3;
                      return indexCSSResource.read();

                    case 3:
                      indexCSS = _context29.sent;

                      if (!forProject) {
                        _context29.next = 14;
                        break;
                      }

                      indexCSS = "@import '/local_projects/".concat(opts.repoOwner, "--").concat(opts.name, "/fonts.css';\n") + indexCSS;

                      __varRecorder__$q.addOrChangeCSSDeclaration("CSS-for-project-".concat(opts.name), indexCSS);

                      updateProjectCSS = /*#__PURE__*/function () {
                        var _ref2 = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee25() {
                          var cssContents;
                          return regeneratorRuntime.wrap(function _callee25$(_context28) {
                            while (1) {
                              switch (_context28.prev = _context28.next) {
                                case 0:
                                  _context28.next = 2;
                                  return indexCSSResource.read();

                                case 2:
                                  cssContents = _context28.sent;
                                  cssContents = "@import '/local_projects/".concat(opts.repoOwner, "--").concat(opts.name, "/fonts.css';\n") + cssContents;

                                  __varRecorder__$q.addOrChangeCSSDeclaration("CSS-for-project-".concat(opts.name), cssContents);

                                  _context28.next = 7;
                                  return projectRef.retrieveProjectFontsFromCSS();

                                case 7:
                                case "end":
                                  return _context28.stop();
                              }
                            }
                          }, _callee25);
                        }));

                        return function updateProjectCSS() {
                          return _ref2.apply(this, arguments);
                        };
                      }();

                      $world.fileWatcher.registerFileAction(indexCSSResource, updateProjectCSS);
                      $world.fileWatcher.registerFileAction(__varRecorder__$q.resource(projectUrl).join("fonts.css"), updateProjectCSS);
                      _context29.next = 12;
                      return updateProjectCSS();

                    case 12:
                      _context29.next = 16;
                      break;

                    case 14:
                      indexCSS = "@import '/local_projects/".concat(opts.name, "/fonts.css';\n") + indexCSS;

                      __varRecorder__$q.addOrChangeCSSDeclaration("CSS-for-dependency-".concat(opts.name), indexCSS);

                    case 16:
                    case "end":
                      return _context29.stop();
                  }
                }
              }, _callee26);
            }));

            function installCSSForProject(_x13, _x14, _x15, _x16) {
              return _installCSSForProject.apply(this, arguments);
            }

            return installCSSForProject;
          }()
        }]);

        return Project;
      }());
      __varRecorder__$q.Project = Project;

      var __captured1__ = /*#__PURE__*/Object.freeze({
        __proto__: null,
        Project: Project
      });

      var __varRecorder__$p = lively.FreezerRuntime.recorderFor("lively.project/helpers.js");

      function projectAsset(fileName) {
        var _callStack$match;

        if (lively.FreezerRuntime) {
          return "./assets/" + fileName;
        }

        var callStack = new Error().stack;
        var callingProject = (_callStack$match = callStack.match( /*#__PURE__*/_wrapRegExp(/\(.*\/local_projects\/([A-Z\\_a-z]+)\/.*\.js/m, {
          callingProject: 1
        }))) === null || _callStack$match === void 0 ? void 0 : _callStack$match.groups.callingProject;
        return "/local_projects/" + callingProject + "/assets/" + fileName;
      }

      __varRecorder__$p.projectAsset = projectAsset;
      __varRecorder__$p.projectAsset = projectAsset;

      var __captured2__ = /*#__PURE__*/Object.freeze({
        __proto__: null,
        projectAsset: projectAsset
      });

      var __varRecorder__$o = lively.FreezerRuntime.recorderFor("lively.project/index.js");
      __varRecorder__$o.registerExtension = registerExtension;
      __varRecorder__$o.gitResourceExtension = gitResourceExtension;

      __varRecorder__$o.registerExtension(__varRecorder__$o.gitResourceExtension);
      Object.assign(__varRecorder__$o, __captured1__);
      Object.assign(__varRecorder__$o, __captured2__);

      var __varRecorder__$n = lively.FreezerRuntime.recorderFor("lively.ide/studio/world-browser.cp.js");
      __varRecorder__$n.easings = easings;
      __varRecorder__$n.ViewModel = ViewModel;
      __varRecorder__$n.touchInputDevice = touchInputDevice;
      __varRecorder__$n.morph = morph;
      __varRecorder__$n.World = World;
      __varRecorder__$n.MorphicDB = MorphicDB;
      __varRecorder__$n.Image = Image;
      __varRecorder__$n.HTMLMorph = HTMLMorph;
      __varRecorder__$n.Morph = Morph;
      __varRecorder__$n.Icon = Icon;
      __varRecorder__$n.TilingLayout = TilingLayout;
      __varRecorder__$n.Label = Label;
      __varRecorder__$n.ConstraintLayout = ConstraintLayout;
      __varRecorder__$n.ShadowObject = ShadowObject;
      __varRecorder__$n.component = component;
      __varRecorder__$n.part = part;
      __varRecorder__$n.moduleManager = modules;
      __varRecorder__$n.Color = Color;
      __varRecorder__$n.LinearGradient = LinearGradient;
      __varRecorder__$n.rect = rect;
      __varRecorder__$n.pt = pt;
      __varRecorder__$n.arr = arr;
      __varRecorder__$n.promise = promise;
      __varRecorder__$n.fun = fun;
      __varRecorder__$n.graph = graph;
      __varRecorder__$n.date = date;
      __varRecorder__$n.string = string;
      __varRecorder__$n.GreenButton = GreenButton;
      __varRecorder__$n.ConfirmPrompt = ConfirmPrompt;
      __varRecorder__$n.RedButton = RedButton;
      __varRecorder__$n.PlainButton = PlainButton;
      __varRecorder__$n.MorphList = MorphList;
      __varRecorder__$n.LoadingIndicator = LoadingIndicator;
      __varRecorder__$n.Spinner = Spinner;
      __varRecorder__$n.SystemList = SystemList;
      __varRecorder__$n.ModeSelector = ModeSelector;
      __varRecorder__$n.SearchField = SearchField;
      __varRecorder__$n.Project = Project;
      __varRecorder__$n.LivelyWorld = LivelyWorld;
      __varRecorder__$n.without = without;
      __varRecorder__$n.add = add;
      __varRecorder__$n.Text = Text;
      __varRecorder__$n.Path = Path;
      var missingSVG = "data:image/svg+xml;utf8,\n<svg aria-hidden=\"true\" focusable=\"false\" data-prefix=\"far\" data-icon=\"question-circle\" class=\"svg-inline--fa fa-question-circle fa-w-16\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 512 512\"><path fill=\"lightgray\" d=\"M256 8C119.043 8 8 119.083 8 256c0 136.997 111.043 248 248 248s248-111.003 248-248C504 119.083 392.957 8 256 8zm0 448c-110.532 0-200-89.431-200-200 0-110.495 89.472-200 200-200 110.491 0 200 89.471 200 200 0 110.53-89.431 200-200 200zm107.244-255.2c0 67.052-72.421 68.084-72.421 92.863V300c0 6.627-5.373 12-12 12h-45.647c-6.627 0-12-5.373-12-12v-8.659c0-35.745 27.1-50.034 47.579-61.516 17.561-9.845 28.324-16.541 28.324-29.579 0-17.246-21.999-28.693-39.784-28.693-23.189 0-33.894 10.977-48.942 29.969-4.057 5.12-11.46 6.071-16.666 2.124l-27.824-21.098c-5.107-3.872-6.251-11.066-2.644-16.363C184.846 131.491 214.94 112 261.794 112c49.071 0 101.45 38.304 101.45 88.8zM298 368c0 23.159-18.841 42-42 42s-42-18.841-42-42 18.841-42 42-42 42 18.841 42 42z\"></path></svg>\n";
      __varRecorder__$n.missingSVG = missingSVG;
      __varRecorder__$n.missingSVG = missingSVG;

      (function (superclass) {
        var __lively_classholder__ = lively.FreezerRuntime.recorderFor("lively.ide/studio/world-browser.cp.js");

        var __lively_class__ = __lively_classholder__.hasOwnProperty("WorldVersion") && typeof __lively_classholder__.WorldVersion === "function" ? __lively_classholder__.WorldVersion : __lively_classholder__.WorldVersion = function WorldVersion(__first_arg__) {
          if (__first_arg__ && __first_arg__[Symbol["for"]("lively-instance-restorer")]) ; else {
            return this[Symbol["for"]("lively-instance-initialize")].apply(this, arguments);
          }
        };

        return initializeClass(__lively_class__, superclass, [{
          key: "update",
          value: function WorldVersion_update_() {
            var _this$submorphs = _slicedToArray(this.submorphs, 2),
                preview = _this$submorphs[0],
                infoLabel = _this$submorphs[1];

            preview.imageUrl = this.commit.preview || __varRecorder__$n.missingSVG;
            infoLabel.textAndAttributes = this.info;
            infoLabel.fontColor = this.selected ? __varRecorder__$n.Color.white : __varRecorder__$n.Color.darkGray;
          }
        }], [{
          key: Symbol["for"]("__LivelyClassName__"),
          get: function get() {
            return "WorldVersion";
          }
        }, {
          key: "properties",
          get: function get() {
            return {
              commit: {},
              fill: {
                defaultValue: __varRecorder__$n.Color.transparent
              },
              info: {
                derived: true,
                get: function get() {
                  var _this$commit = this.commit,
                      _id = _this$commit._id,
                      message = _this$commit.message,
                      name = _this$commit.name,
                      timestamp = _this$commit.timestamp;
                  return ["".concat(_id.slice(0, 6), " "), {
                    fontWeight: "bold"
                  }, "".concat(__varRecorder__$n.string.truncate(message.split("\n")[0], 40), " "), {}, " (".concat(name, " "), {}, "".concat(__varRecorder__$n.date.format(new Date(timestamp), "yyyy-mm-dd HH:MM Z")), {}];
                }
              },
              selected: {
                set: function set(active) {
                  this.setProperty("selected", active);
                  this.update();
                }
              },
              layout: {
                initialize: function initialize() {
                  this.layout = new __varRecorder__$n.TilingLayout({
                    axis: "column",
                    align: "left",
                    wrapSubmorphs: true,
                    spacing: 5
                  });
                }
              },
              submorphs: {
                initialize: function initialize() {
                  this.submorphs = [{
                    type: "image",
                    extent: __varRecorder__$n.pt(30, 30),
                    name: "preview",
                    reactsToPointer: false
                  }, {
                    reactsToPointer: false,
                    type: "label",
                    fill: null,
                    name: "commit info",
                    fontFamily: "IBM Plex Sans",
                    fontColor: __varRecorder__$n.Color.gray
                  }];
                }
              }
            };
          }
        }], __lively_classholder__, {
          pathInPackage: function pathInPackage() {
            return "./studio/world-browser.cp.js";
          },
          unsubscribeFromToplevelDefinitionChanges: function unsubscribeFromToplevelDefinitionChanges() {
            return function () {};
          },
          subscribeToToplevelDefinitionChanges: function subscribeToToplevelDefinitionChanges() {
            return function () {};
          },
          "package": function _package() {
            return {
              name: "lively.ide",
              version: "0.1.0"
            };
          }
        }, {
          start: 2223,
          end: 3856
        });
      })(__varRecorder__$n.Morph);

      var WorldVersionViewer = function (superclass) {
        var __lively_classholder__ = lively.FreezerRuntime.recorderFor("lively.ide/studio/world-browser.cp.js");

        var __lively_class__ = __lively_classholder__.hasOwnProperty("WorldVersionViewer") && typeof __lively_classholder__.WorldVersionViewer === "function" ? __lively_classholder__.WorldVersionViewer : __lively_classholder__.WorldVersionViewer = function WorldVersionViewer(__first_arg__) {
          if (__first_arg__ && __first_arg__[Symbol["for"]("lively-instance-restorer")]) ; else {
            return this[Symbol["for"]("lively-instance-initialize")].apply(this, arguments);
          }
        };

        return initializeClass(__lively_class__, superclass, [{
          key: "reset",
          value: function WorldVersionViewer_reset_() {
            this.getSubmorphNamed("version list").items = [];
            this.getSubmorphNamed("version list spinner").visible = false;
            this.visible = false;
            this.layoutable = false;
          }
        }, {
          key: "onMouseDown",
          value: function WorldVersionViewer_onMouseDown_(evt) {
            switch (evt.targetMorph.name) {
              case "visit button":
                this.visitSelectedCommit();
                break;

              case "revert button":
                this.revertToSelectedCommit();
                break;
            }
          }
        }, {
          key: "visitSelectedCommit",
          value: function () {
            var _WorldVersionViewer_visitSelectedCommit_ = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee() {
              var commit, i, oldWorld, morphicDB, commitId, newWorld;
              return regeneratorRuntime.wrap(function _callee$(_context) {
                while (1) {
                  switch (_context.prev = _context.next) {
                    case 0:
                      commit = this.get("version list").selection;
                      i = __varRecorder__$n.LoadingIndicator.open("Loading ".concat(commit.name, "..."));
                      oldWorld = $world;
                      morphicDB = this.db || __varRecorder__$n.MorphicDB["default"];
                      commitId = commit._id;
                      _context.prev = 5;

                      if (!commitId) {
                        _context.next = 12;
                        break;
                      }

                      _context.next = 9;
                      return __varRecorder__$n.World.loadFromCommit(commitId, undefined, {
                        morphicDB: morphicDB
                      });

                    case 9:
                      _context.t0 = _context.sent;
                      _context.next = 15;
                      break;

                    case 12:
                      _context.next = 14;
                      return __varRecorder__$n.World.loadFromDB(commit.name, commit.ref, undefined, {
                        morphicDB: morphicDB
                      });

                    case 14:
                      _context.t0 = _context.sent;

                    case 15:
                      newWorld = _context.t0;
                      return _context.abrupt("return", newWorld);

                    case 19:
                      _context.prev = 19;
                      _context.t1 = _context["catch"](5);
                      console.error(_context.t1);
                      oldWorld.showError("Error loading world:" + _context.t1);

                    case 23:
                      _context.prev = 23;
                      i.remove();
                      return _context.finish(23);

                    case 26:
                    case "end":
                      return _context.stop();
                  }
                }
              }, _callee, this, [[5, 19, 23, 26]]);
            }));

            function WorldVersionViewer_visitSelectedCommit_() {
              return _WorldVersionViewer_visitSelectedCommit_.apply(this, arguments);
            }

            return WorldVersionViewer_visitSelectedCommit_;
          }()
        }, {
          key: "revertToSelectedCommit",
          value: function () {
            var _WorldVersionViewer_revertToSelectedCommit_ = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee2() {
              var commit, db, _id, name, type;

              return regeneratorRuntime.wrap(function _callee2$(_context2) {
                while (1) {
                  switch (_context2.prev = _context2.next) {
                    case 0:
                      commit = this.get("version list").selection;

                      if (commit) {
                        _context2.next = 3;
                        break;
                      }

                      return _context2.abrupt("return");

                    case 3:
                      db = this.db || __varRecorder__$n.MorphicDB["default"];
                      _id = commit._id, name = commit.name, type = commit.type;
                      _context2.next = 7;
                      return db.revert(type, name, _id, "HEAD");

                    case 7:
                      return _context2.abrupt("return", this.initializeFromStartCommit(commit, db, {
                        showRevertButton: true
                      }));

                    case 8:
                    case "end":
                      return _context2.stop();
                  }
                }
              }, _callee2, this);
            }));

            function WorldVersionViewer_revertToSelectedCommit_() {
              return _WorldVersionViewer_revertToSelectedCommit_.apply(this, arguments);
            }

            return WorldVersionViewer_revertToSelectedCommit_;
          }()
        }, {
          key: "initializeFromStartCommit",
          value: function () {
            var _WorldVersionViewer_initializeFromStartCommit_ = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee3(startCommit) {
              var db,
                  opts,
                  _opts$indicateStartCo,
                  indicateStartCommit,
                  _opts$showRefs,
                  showRefs,
                  _this$startCommit,
                  _id,
                  type,
                  name,
                  spinner,
                  _yield$db$history,
                  refs,
                  history,
                  startCommitId,
                  fwdHist,
                  ancestors,
                  knownCommits,
                  ancestorCommits,
                  _iterator,
                  _step,
                  id,
                  newCommits,
                  newestCommit,
                  commits,
                  shaToRef,
                  maxRefLength,
                  ref,
                  items,
                  _args3 = arguments;

              return regeneratorRuntime.wrap(function _callee3$(_context3) {
                while (1) {
                  switch (_context3.prev = _context3.next) {
                    case 0:
                      db = _args3.length > 1 && _args3[1] !== undefined ? _args3[1] : __varRecorder__$n.MorphicDB["default"];
                      opts = _args3.length > 2 && _args3[2] !== undefined ? _args3[2] : {};
                      _opts$indicateStartCo = opts.indicateStartCommit, indicateStartCommit = _opts$indicateStartCo === void 0 ? true : _opts$indicateStartCo, _opts$showRefs = opts.showRefs, showRefs = _opts$showRefs === void 0 ? true : _opts$showRefs;
                      _this$startCommit = this.startCommit = startCommit, _id = _this$startCommit._id, type = _this$startCommit.type, name = _this$startCommit.name;
                      spinner = this.getSubmorphNamed("version list spinner");
                      spinner.visible = true;
                      spinner.center = this.get("version list").center;
                      this.db = db;
                      _context3.next = 10;
                      return db.history(type, name);

                    case 10:
                      _yield$db$history = _context3.sent;
                      refs = _yield$db$history.refs;
                      history = _yield$db$history.history;
                      startCommitId = _id;
                      fwdHist = __varRecorder__$n.graph.invert(history);
                      ancestors = __varRecorder__$n.graph.hull(fwdHist, _id);
                      knownCommits = {
                        _id: true
                      };
                      ancestorCommits = [startCommit];
                      _iterator = _createForOfIteratorHelper(ancestors);
                      _context3.prev = 19;

                      _iterator.s();

                    case 21:
                      if ((_step = _iterator.n()).done) {
                        _context3.next = 30;
                        break;
                      }

                      id = _step.value;
                      _context3.next = 25;
                      return db.log(id, undefined, true, knownCommits);

                    case 25:
                      newCommits = _context3.sent;
                      ancestorCommits.push.apply(ancestorCommits, _toConsumableArray(newCommits));
                      newCommits.forEach(function (ea) {
                        return knownCommits[ea._id] = true;
                      });

                    case 28:
                      _context3.next = 21;
                      break;

                    case 30:
                      _context3.next = 35;
                      break;

                    case 32:
                      _context3.prev = 32;
                      _context3.t0 = _context3["catch"](19);

                      _iterator.e(_context3.t0);

                    case 35:
                      _context3.prev = 35;

                      _iterator.f();

                      return _context3.finish(35);

                    case 38:
                      newestCommit = __varRecorder__$n.arr.max(ancestorCommits, function (ea) {
                        return ea.timestamp;
                      });
                      startCommitId = newestCommit._id;
                      _context3.next = 42;
                      return db.log(startCommitId, undefined, true);

                    case 42:
                      commits = _context3.sent;
                      shaToRef = {};
                      maxRefLength = 0;

                      if (showRefs) {
                        for (ref in refs) {
                          shaToRef[refs[ref]] = ref;
                          maxRefLength = Math.max(ref.length, maxRefLength);
                        }
                      }

                      if (indicateStartCommit) {
                        if (shaToRef[_id]) shaToRef[_id] = "=> " + shaToRef[_id];else shaToRef[_id] = "=>";
                        maxRefLength = Math.max(shaToRef[_id].length, maxRefLength);
                      }

                      items = commits.map(function (ea) {
                        var morph = new __varRecorder__$n.WorldVersion({
                          reactsToPointer: false,
                          commit: ea
                        });
                        morph.update();
                        return {
                          isListItem: true,
                          morph: morph,
                          value: ea
                        };
                      });
                      this.get("version list").items = items;
                      spinner.visible = false;

                    case 50:
                    case "end":
                      return _context3.stop();
                  }
                }
              }, _callee3, this, [[19, 32, 35, 38]]);
            }));

            function WorldVersionViewer_initializeFromStartCommit_(_x) {
              return _WorldVersionViewer_initializeFromStartCommit_.apply(this, arguments);
            }

            return WorldVersionViewer_initializeFromStartCommit_;
          }()
        }], [{
          key: Symbol["for"]("__LivelyClassName__"),
          get: function get() {
            return "WorldVersionViewer";
          }
        }], __lively_classholder__, {
          pathInPackage: function pathInPackage() {
            return "./studio/world-browser.cp.js";
          },
          unsubscribeFromToplevelDefinitionChanges: function unsubscribeFromToplevelDefinitionChanges() {
            return function () {};
          },
          subscribeToToplevelDefinitionChanges: function subscribeToToplevelDefinitionChanges() {
            return function () {};
          },
          "package": function _package() {
            return {
              name: "lively.ide",
              version: "0.1.0"
            };
          }
        }, {
          start: 3873,
          end: 7952
        });
      }(__varRecorder__$n.Morph);
      var TitleWrapper = function (superclass) {
        var __lively_classholder__ = lively.FreezerRuntime.recorderFor("lively.ide/studio/world-browser.cp.js");

        var __lively_class__ = __lively_classholder__.hasOwnProperty("TitleWrapper") && typeof __lively_classholder__.TitleWrapper === "function" ? __lively_classholder__.TitleWrapper : __lively_classholder__.TitleWrapper = function TitleWrapper(__first_arg__) {
          if (__first_arg__ && __first_arg__[Symbol["for"]("lively-instance-restorer")]) ; else {
            return this[Symbol["for"]("lively-instance-initialize")].apply(this, arguments);
          }
        };

        return initializeClass(__lively_class__, superclass, [{
          key: "startMovingRight",
          value: function TitleWrapper_startMovingRight_() {
            var _this = this;

            this.animate({
              customTween: function customTween(p) {
                _this._hoverDelta = p;
              }
            });
          }
        }, {
          key: "stopMovingRight",
          value: function TitleWrapper_stopMovingRight_() {
            var _this2 = this;

            this.animate({
              customTween: function customTween(p) {
                _this2._hoverDelta = 1 - p;
              }
            });
          }
        }, {
          key: "startMovingLeft",
          value: function TitleWrapper_startMovingLeft_() {
            var _this3 = this;

            this.animate({
              customTween: function customTween(p) {
                _this3._hoverDelta = -p;
              }
            });
          }
        }, {
          key: "stopMovingLeft",
          value: function TitleWrapper_stopMovingLeft_() {
            var _this4 = this;

            this.animate({
              customTween: function customTween(p) {
                _this4._hoverDelta = -1 + p;
              }
            });
          }
        }, {
          key: "startOnce",
          value: function () {
            var _TitleWrapper_startOnce_ = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee4(fn) {
              return regeneratorRuntime.wrap(function _callee4$(_context4) {
                while (1) {
                  switch (_context4.prev = _context4.next) {
                    case 0:
                      if (!this._fn) {
                        _context4.next = 2;
                        break;
                      }

                      return _context4.abrupt("return");

                    case 2:
                      this._fn = fn;
                      _context4.next = 5;
                      return fn();

                    case 5:
                      this._fn = null;

                    case 6:
                    case "end":
                      return _context4.stop();
                  }
                }
              }, _callee4, this);
            }));

            function TitleWrapper_startOnce_(_x2) {
              return _TitleWrapper_startOnce_.apply(this, arguments);
            }

            return TitleWrapper_startOnce_;
          }()
        }, {
          key: "updateTitle",
          value: function TitleWrapper_updateTitle_() {
            var _this5 = this;

            if (!this.title) return;

            var _this$submorphs2 = _slicedToArray(this.submorphs, 1),
                title = _this$submorphs2[0];

            title.left += this._hoverDelta;

            if (title.right < this.width - 20 && this._hoverDelta === -1) {
              this.startOnce( /*#__PURE__*/_asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee5() {
                return regeneratorRuntime.wrap(function _callee5$(_context5) {
                  while (1) {
                    switch (_context5.prev = _context5.next) {
                      case 0:
                        _context5.next = 2;
                        return _this5.stopMovingLeft();

                      case 2:
                        _context5.next = 4;
                        return _this5.startMovingRight();

                      case 4:
                      case "end":
                        return _context5.stop();
                    }
                  }
                }, _callee5);
              })));
            } else if (title.left > 20 && this._hoverDelta === 1) {
              this.startOnce( /*#__PURE__*/_asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee6() {
                return regeneratorRuntime.wrap(function _callee6$(_context6) {
                  while (1) {
                    switch (_context6.prev = _context6.next) {
                      case 0:
                        _context6.next = 2;
                        return _this5.stopMovingRight();

                      case 2:
                        _context6.next = 4;
                        return _this5.startMovingLeft();

                      case 4:
                      case "end":
                        return _context6.stop();
                    }
                  }
                }, _callee6);
              })));
            }
          }
        }, {
          key: "startShowingFullTitle",
          value: function () {
            var _TitleWrapper_startShowingFullTitle_ = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee7() {
              var _this$submorphs3, title;

              return regeneratorRuntime.wrap(function _callee7$(_context7) {
                while (1) {
                  switch (_context7.prev = _context7.next) {
                    case 0:
                      if (this.title) {
                        _context7.next = 2;
                        break;
                      }

                      return _context7.abrupt("return");

                    case 2:
                      _this$submorphs3 = _slicedToArray(this.submorphs, 1), title = _this$submorphs3[0];
                      title.textString = this.title;
                      this._hoverDelta = 0;
                      this.startStepping("updateTitle");

                      if (title.right > this.width) {
                        this.startMovingLeft();
                      }

                    case 7:
                    case "end":
                      return _context7.stop();
                  }
                }
              }, _callee7, this);
            }));

            function TitleWrapper_startShowingFullTitle_() {
              return _TitleWrapper_startShowingFullTitle_.apply(this, arguments);
            }

            return TitleWrapper_startShowingFullTitle_;
          }()
        }, {
          key: "stopShowingFullTitle",
          value: function TitleWrapper_stopShowingFullTitle_() {
            if (!this.title) return;
            var title = this.submorphs[0];
            title.textString = __varRecorder__$n.string.truncate(this.title, 18, "...");
            this.stopStepping("updateTitle");
            this._hoverDelta = 0;
            title.left = 0;
          }
        }, {
          key: "onHoverIn",
          value: function TitleWrapper_onHoverIn_(evt) {
            initializeClass._get(Object.getPrototypeOf(__lively_class__.prototype), "onHoverIn", this).call(this, evt);

            this.startShowingFullTitle();
          }
        }, {
          key: "onHoverOut",
          value: function TitleWrapper_onHoverOut_(evt) {
            initializeClass._get(Object.getPrototypeOf(__lively_class__.prototype), "onHoverOut", this).call(this, evt);

            this.stopShowingFullTitle();
          }
        }], [{
          key: Symbol["for"]("__LivelyClassName__"),
          get: function get() {
            return "TitleWrapper";
          }
        }, {
          key: "properties",
          get: function get() {
            return {
              title: {
                derived: true,
                set: function set(title) {
                  this.setProperty("title", title);

                  if (title) {
                    this.submorphs[0].textString = __varRecorder__$n.string.truncate(title, 18, "...");
                  }
                }
              }
            };
          }
        }], __lively_classholder__, {
          pathInPackage: function pathInPackage() {
            return "./studio/world-browser.cp.js";
          },
          unsubscribeFromToplevelDefinitionChanges: function unsubscribeFromToplevelDefinitionChanges() {
            return function () {};
          },
          subscribeToToplevelDefinitionChanges: function subscribeToToplevelDefinitionChanges() {
            return function () {};
          },
          "package": function _package() {
            return {
              name: "lively.ide",
              version: "0.1.0"
            };
          }
        }, {
          start: 7960,
          end: 10149
        });
      }(__varRecorder__$n.Morph);
      __varRecorder__$n.TitleWrapper = TitleWrapper;
      __varRecorder__$n.TitleWrapper = TitleWrapper;
      var StaticText = function (superclass) {
        var __lively_classholder__ = lively.FreezerRuntime.recorderFor("lively.ide/studio/world-browser.cp.js");

        var __lively_class__ = __lively_classholder__.hasOwnProperty("StaticText") && typeof __lively_classholder__.StaticText === "function" ? __lively_classholder__.StaticText : __lively_classholder__.StaticText = function StaticText(__first_arg__) {
          if (__first_arg__ && __first_arg__[Symbol["for"]("lively-instance-restorer")]) ; else {
            return this[Symbol["for"]("lively-instance-initialize")].apply(this, arguments);
          }
        };

        return initializeClass(__lively_class__, superclass, [{
          key: "refresh",
          value: function StaticText_refresh_() {
            this.html = "<span style=\"line-height: 1.3; font-size: ".concat(this.fontSize, "px; color: ").concat(this.fontColor, "; font-family: ").concat(this.fontFamily, "\">").concat(this.value, "</span>");
          }
        }], [{
          key: Symbol["for"]("__LivelyClassName__"),
          get: function get() {
            return "StaticText";
          }
        }, {
          key: "properties",
          get: function get() {
            return {
              html: {
                isStyleProp: false
              },
              fontSize: {
                type: "Number",
                set: function set(s) {
                  this.setProperty("fontSize", s);
                  this.refresh();
                }
              },
              fontColor: {
                type: "Color",
                set: function set(c) {
                  this.setProperty("fontColor", c);
                  this.refresh();
                }
              },
              fontFamily: {
                type: "Enum",
                set: function set(f) {
                  this.setProperty("fontFamily", f);
                  this.refresh();
                }
              },
              value: {
                set: function set(v) {
                  this.setProperty("value", v);
                  this.refresh();
                }
              }
            };
          }
        }], __lively_classholder__, {
          pathInPackage: function pathInPackage() {
            return "./studio/world-browser.cp.js";
          },
          unsubscribeFromToplevelDefinitionChanges: function unsubscribeFromToplevelDefinitionChanges() {
            return function () {};
          },
          subscribeToToplevelDefinitionChanges: function subscribeToToplevelDefinitionChanges() {
            return function () {};
          },
          "package": function _package() {
            return {
              name: "lively.ide",
              version: "0.1.0"
            };
          }
        }, {
          start: 10157,
          end: 11045
        });
      }(__varRecorder__$n.HTMLMorph);
      __varRecorder__$n.StaticText = StaticText;
      __varRecorder__$n.StaticText = StaticText;
      var WorldBrowserModel = function (superclass) {
        var __lively_classholder__ = lively.FreezerRuntime.recorderFor("lively.ide/studio/world-browser.cp.js");

        var __lively_class__ = __lively_classholder__.hasOwnProperty("WorldBrowserModel") && typeof __lively_classholder__.WorldBrowserModel === "function" ? __lively_classholder__.WorldBrowserModel : __lively_classholder__.WorldBrowserModel = function WorldBrowserModel(__first_arg__) {
          if (__first_arg__ && __first_arg__[Symbol["for"]("lively-instance-restorer")]) ; else {
            return this[Symbol["for"]("lively-instance-initialize")].apply(this, arguments);
          }
        };

        return initializeClass(__lively_class__, superclass, [{
          key: "onRefresh",
          value: function () {
            var _WorldBrowserModel_onRefresh_ = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee8(prop) {
              return regeneratorRuntime.wrap(function _callee8$(_context8) {
                while (1) {
                  switch (_context8.prev = _context8.next) {
                    case 0:
                      if (prop == "showCloseButton" && this.ui.closeButton) {
                        this.updateCloseButtonVisibility();
                      }

                    case 1:
                    case "end":
                      return _context8.stop();
                  }
                }
              }, _callee8, this);
            }));

            function WorldBrowserModel_onRefresh_(_x3) {
              return _WorldBrowserModel_onRefresh_.apply(this, arguments);
            }

            return WorldBrowserModel_onRefresh_;
          }()
        }, {
          key: "confirm",
          value: function () {
            var _WorldBrowserModel_confirm_ = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee9(label) {
              var prompt;
              return regeneratorRuntime.wrap(function _callee9$(_context9) {
                while (1) {
                  switch (_context9.prev = _context9.next) {
                    case 0:
                      prompt = __varRecorder__$n.part(__varRecorder__$n.ConfirmPrompt, {
                        viewModel: {
                          label: label
                        }
                      }).openInWorld();
                      prompt.center = this.view.center;
                      return _context9.abrupt("return", __varRecorder__$n.promise(prompt.activate()));

                    case 3:
                    case "end":
                      return _context9.stop();
                  }
                }
              }, _callee9, this);
            }));

            function WorldBrowserModel_confirm_(_x4) {
              return _WorldBrowserModel_confirm_.apply(this, arguments);
            }

            return WorldBrowserModel_confirm_;
          }()
        }, {
          key: "toggleFader",
          value: function () {
            var _WorldBrowserModel_toggleFader_ = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee10(onlyOff) {
              return regeneratorRuntime.wrap(function _callee10$(_context10) {
                while (1) {
                  switch (_context10.prev = _context10.next) {
                    case 0:
                      if (!this.fader) {
                        _context10.next = 8;
                        break;
                      }

                      _context10.next = 3;
                      return this.fader.animate({
                        duration: 500,
                        easing: __varRecorder__$n.easings.inOutSine,
                        opacity: 0
                      });

                    case 3:
                      this.fader.remove();
                      this.fader = null;
                      return _context10.abrupt("return", false);

                    case 8:
                      if (!onlyOff) {
                        _context10.next = 10;
                        break;
                      }

                      return _context10.abrupt("return", false);

                    case 10:
                      this.fader = new __varRecorder__$n.Morph({
                        name: "world browser fader",
                        extent: this.view.extent,
                        position: this.view.position,
                        hasFixedPosition: true,
                        fill: __varRecorder__$n.Color.black,
                        borderRadius: this.view.borderRadius,
                        opacity: 0
                      }).openInWorld();
                      this.fader.bringToFront();
                      _context10.next = 14;
                      return this.fader.animate({
                        duration: 200,
                        easing: __varRecorder__$n.easings.inOutSine,
                        opacity: 0.6
                      });

                    case 14:
                      return _context10.abrupt("return", true);

                    case 15:
                    case "end":
                      return _context10.stop();
                  }
                }
              }, _callee10, this);
            }));

            function WorldBrowserModel_toggleFader_(_x5) {
              return _WorldBrowserModel_toggleFader_.apply(this, arguments);
            }

            return WorldBrowserModel_toggleFader_;
          }()
        }, {
          key: "updateCloseButtonVisibility",
          value: function () {
            var _WorldBrowserModel_updateCloseButtonVisibility_ = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee11() {
              return regeneratorRuntime.wrap(function _callee11$(_context11) {
                while (1) {
                  switch (_context11.prev = _context11.next) {
                    case 0:
                      _context11.next = 2;
                      return this.ui.closeButton.whenRendered();

                    case 2:
                      this.ui.closeButton.visible = this.showCloseButton;

                    case 3:
                    case "end":
                      return _context11.stop();
                  }
                }
              }, _callee11, this);
            }));

            function WorldBrowserModel_updateCloseButtonVisibility_() {
              return _WorldBrowserModel_updateCloseButtonVisibility_.apply(this, arguments);
            }

            return WorldBrowserModel_updateCloseButtonVisibility_;
          }()
        }, {
          key: "close",
          value: function WorldBrowserModel_close_() {
            if (this.showCloseButton === false) return;
            this.toggleFader(true);
            this.view.remove();
          }
        }, {
          key: "viewDidLoad",
          value: function WorldBrowserModel_viewDidLoad_() {
            this.displayItems();
            this.onRefresh("showCloseButton");
          }
        }, {
          key: "modeChanged",
          value: function WorldBrowserModel_modeChanged_(mode) {
            var label = this.ui.newProjectButton.submorphs[0];

            if (mode === "Playgrounds") {
              this.playgroundsMode = true;
              label.textAndAttributes = label.textAndAttributes.slice(0, -1).concat("NEW PLAYGROUND");
            }

            if (mode === "Projects") {
              this.playgroundsMode = false;
              label.textAndAttributes = label.textAndAttributes.slice(0, -1).concat("NEW PROJECT");
            }

            this.displayItems();
          }
        }, {
          key: "beforePublish",
          value: function WorldBrowserModel_beforePublish_() {
            this.reset();
          }
        }, {
          key: "reset",
          value: function WorldBrowserModel_reset_() {
            this.ui.worldList.items = [];
            this.ui.noWorldWarning.visible = false;
            this.previews = [];
          }
        }, {
          key: "relayout",
          value: function WorldBrowserModel_relayout_() {
            this.alignInWorld();
          }
        }, {
          key: "alignInWorld",
          value: function WorldBrowserModel_alignInWorld_() {
            var world = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : $world;
            var view = this.view;
            if (view.owner !== world) world.addMorph(view);
            view.center = world.visibleBounds().center();
          }
        }, {
          key: "sortAndFilterPreviews",
          value: function WorldBrowserModel_sortAndFilterPreviews_(previews) {
            var _this6 = this;

            return previews.filter(function (p) {
              var _p$_project;

              return _this6.ui.searchField.matches(((_p$_project = p._project) === null || _p$_project === void 0 ? void 0 : _p$_project.name) || p._commit.name + p._commit.description);
            });
          }
        }, {
          key: "updateList",
          value: function WorldBrowserModel_updateList_() {
            var _this7 = this;

            if (!this.previews) return;

            __varRecorder__$n.fun.debounceNamed("update item list", 150, function () {
              _this7.ui.worldList.items = _this7.sortAndFilterPreviews(_this7.previews);

              if (_this7.ui.worldList.items.length === 0) {
                _this7.ui.noWorldWarning.center = _this7.view.innerBounds().center();

                _this7.ui.noWorldWarning.animate({
                  visible: true,
                  duration: 300
                });
              } else _this7.ui.noWorldWarning.visible = false;
            })();
          }
        }, {
          key: "displayItems",
          value: function () {
            var _WorldBrowserModel_displayItems_ = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee12() {
              var _this8 = this;

              var loadingIndicator, entities;
              return regeneratorRuntime.wrap(function _callee12$(_context12) {
                while (1) {
                  switch (_context12.prev = _context12.next) {
                    case 0:
                      this.reset();
                      loadingIndicator = this.ui.loadingIndicator;
                      loadingIndicator.position = __varRecorder__$n.pt(this.view.width / 2 - loadingIndicator.width / 2, this.view.height / 2 - loadingIndicator.height / 2);
                      loadingIndicator.animate({
                        opacity: 1,
                        duration: 300
                      });

                      if (!this.playgroundsMode) {
                        _context12.next = 10;
                        break;
                      }

                      _context12.next = 7;
                      return this.db.latestCommits("world");

                    case 7:
                      _context12.t0 = _context12.sent;
                      _context12.next = 13;
                      break;

                    case 10:
                      _context12.next = 12;
                      return __varRecorder__$n.Project.listAvailableProjects();

                    case 12:
                      _context12.t0 = _context12.sent;

                    case 13:
                      entities = _context12.t0;
                      if ($world && $world.openedProject) entities = entities.filter(function (availableProject) {
                        return availableProject.name !== $world.openedProject.config.name;
                      });
                      this.previews = entities.map(function (entity) {
                        var placeholder = __varRecorder__$n.part(__varRecorder__$n.Placeholder);

                        if (_this8.playgroundsMode) placeholder._commit = entity;else placeholder._project = entity;

                        placeholder.displayPreview = function () {
                          var preview = _this8.playgroundsMode ? __varRecorder__$n.part(__varRecorder__$n.WorldPreviewTile, {
                            defaultViewModel: __varRecorder__$n.WorldPreviewModel,
                            viewModel: {
                              _commit: entity,
                              _worldBrowser: _this8
                            }
                          }) : __varRecorder__$n.part(__varRecorder__$n.ProjectPreviewTile, {
                            viewModel: {
                              _project: entity,
                              _worldBrowser: _this8
                            }
                          });
                          preview.dropShadow = null;
                          preview.opacity = 0;
                          preview.clipMode = "hidden";
                          placeholder.addMorph(preview);
                          preview.displayPreview();
                          preview.position = __varRecorder__$n.pt(0, 0);
                          placeholder.layout = new __varRecorder__$n.TilingLayout({
                            axis: "column",
                            reactToSubmorphAnimations: true
                          });
                        };

                        return placeholder;
                      });
                      _context12.next = 18;
                      return loadingIndicator.animate({
                        opacity: 0,
                        duration: 300
                      });

                    case 18:
                      this.updateList();

                    case 19:
                    case "end":
                      return _context12.stop();
                  }
                }
              }, _callee12, this);
            }));

            function WorldBrowserModel_displayItems_() {
              return _WorldBrowserModel_displayItems_.apply(this, arguments);
            }

            return WorldBrowserModel_displayItems_;
          }()
        }, {
          key: "createNewProject",
          value: function () {
            var _WorldBrowserModel_createNewProject_ = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee13() {
              return regeneratorRuntime.wrap(function _callee13$(_context13) {
                while (1) {
                  switch (_context13.prev = _context13.next) {
                    case 0:
                      if (this.playgroundsMode) document.location = "/worlds/load?name=__newWorld__";else document.location = "/projects/load?name=__newProject__";

                    case 1:
                    case "end":
                      return _context13.stop();
                  }
                }
              }, _callee13, this);
            }));

            function WorldBrowserModel_createNewProject_() {
              return _WorldBrowserModel_createNewProject_.apply(this, arguments);
            }

            return WorldBrowserModel_createNewProject_;
          }()
        }, {
          key: "allFontsLoaded",
          value: function WorldBrowserModel_allFontsLoaded_() {
            return this.ui.newProjectButton.submorphs[0].whenFontLoaded();
          }
        }, {
          key: "keybindings",
          get: function get() {
            return [{
              keys: "Escape",
              command: "close"
            }];
          }
        }, {
          key: "commands",
          get: function get() {
            var _this9 = this;

            return [{
              name: "close",
              exec: function exec() {
                return _this9.close();
              }
            }];
          }
        }], [{
          key: Symbol["for"]("__LivelyClassName__"),
          get: function get() {
            return "WorldBrowserModel";
          }
        }, {
          key: "properties",
          get: function get() {
            return {
              expose: {
                get: function get() {
                  return ["alignInWorld", "keybindings", "commands", "displayItems", "allFontsLoaded"];
                }
              },
              bindings: {
                get: function get() {
                  return [{
                    target: "close button",
                    signal: "onMouseDown",
                    handler: "close"
                  }, {
                    target: "search field",
                    signal: "searchInput",
                    handler: "displayItems"
                  }, {
                    target: "new project button",
                    signal: "onMouseDown",
                    handler: "createNewProject"
                  }, {
                    target: "mode selector",
                    signal: "selectionChanged",
                    handler: "modeChanged"
                  }];
                }
              },
              playgroundsMode: {
                defaultValue: false
              },
              showCloseButton: {
                defaultValue: true
              },
              db: {
                serialize: false,
                get: function get() {
                  return __varRecorder__$n.MorphicDB["default"];
                }
              }
            };
          }
        }], __lively_classholder__, {
          pathInPackage: function pathInPackage() {
            return "./studio/world-browser.cp.js";
          },
          unsubscribeFromToplevelDefinitionChanges: function unsubscribeFromToplevelDefinitionChanges() {
            return function () {};
          },
          subscribeToToplevelDefinitionChanges: function subscribeToToplevelDefinitionChanges() {
            return function () {};
          },
          "package": function _package() {
            return {
              name: "lively.ide",
              version: "0.1.0"
            };
          }
        }, {
          start: 11053,
          end: 17217
        });
      }(__varRecorder__$n.ViewModel);
      __varRecorder__$n.WorldBrowserModel = WorldBrowserModel;
      __varRecorder__$n.WorldBrowserModel = WorldBrowserModel;
      var GrowingWorldList = function (superclass) {
        var __lively_classholder__ = lively.FreezerRuntime.recorderFor("lively.ide/studio/world-browser.cp.js");

        var __lively_class__ = __lively_classholder__.hasOwnProperty("GrowingWorldList") && typeof __lively_classholder__.GrowingWorldList === "function" ? __lively_classholder__.GrowingWorldList : __lively_classholder__.GrowingWorldList = function GrowingWorldList(__first_arg__) {
          if (__first_arg__ && __first_arg__[Symbol["for"]("lively-instance-restorer")]) ; else {
            return this[Symbol["for"]("lively-instance-initialize")].apply(this, arguments);
          }
        };

        return initializeClass(__lively_class__, superclass, [{
          key: "onLoad",
          value: function GrowingWorldList_onLoad_() {
            this.clipMode = "auto";
          }
        }, {
          key: "onScroll",
          value: function GrowingWorldList_onScroll_(evt) {
            initializeClass._get(Object.getPrototypeOf(__lively_class__.prototype), "onScroll", this).call(this, evt);

            this.update();
          }
        }, {
          key: "onChange",
          value: function GrowingWorldList_onChange_(change) {
            initializeClass._get(Object.getPrototypeOf(__lively_class__.prototype), "onChange", this).call(this, change);

            if (change.prop === "extent") {
              this.update(true);
            }
          }
        }, {
          key: "onHoverIn",
          value: function GrowingWorldList_onHoverIn_(evt) {
            this.clipMode = "auto";
          }
        }, {
          key: "onHoverOut",
          value: function GrowingWorldList_onHoverOut_(evt) {
            if (!__varRecorder__$n.touchInputDevice) this.clipMode = "hidden";
          }
        }, {
          key: "update",
          value: function GrowingWorldList_update_(sort) {
            var items = this.items;
            if (!items || items.length === 0) return;
            var scrollContainer = this.scrollContainer;
            var layoutSpacing = scrollContainer.layout.spacing;
            scrollContainer.extent = this.extent;
            var _this$ui = this.ui,
                bufferTop = _this$ui.bufferTop,
                bufferBottom = _this$ui.bufferBottom;
            bufferTop = bufferTop || scrollContainer.addMorph({
              fill: null,
              name: "buffer top",
              height: 34
            });
            bufferBottom = bufferBottom || scrollContainer.addMorph({
              fill: null,
              name: "buffer bottom",
              height: 10
            });
            bufferTop.width = bufferBottom.width = this.width - 100;
            scrollContainer.layout.disable();
            var sample = items[0];
            var itemsPerRow = Math.floor(this.width / (sample.width + layoutSpacing));
            var rowsInView = Math.ceil((this.scroll.y + this.height) / (sample.height + layoutSpacing)) + 1;
            var itemsInView = items.slice(0, itemsPerRow * rowsInView);
            var itemsToBeAdded = itemsInView.filter(function (m) {
              return m.owner !== scrollContainer;
            });
            var newItemOffset = this.scroll.y + 2 * this.height;

            var _iterator2 = _createForOfIteratorHelper(itemsToBeAdded),
                _step2;

            try {
              for (_iterator2.s(); !(_step2 = _iterator2.n()).done;) {
                var item = _step2.value;
                newItemOffset++;
                item.top = newItemOffset;
                scrollContainer.addMorph(item, scrollContainer.get("buffer bottom"));

                if (!item._initialized) {
                  item._initialized = true;
                  item.displayPreview();
                }
              }
            } catch (err) {
              _iterator2.e(err);
            } finally {
              _iterator2.f();
            }

            if (sort) {
              bufferTop.position = __varRecorder__$n.pt(0, 0);
              items.forEach(function (m, i) {
                return m.position = __varRecorder__$n.pt(i + 1, i + 1);
              });
              bufferBottom.position = __varRecorder__$n.pt(items.length + 2, items.length + 2);
            }

            scrollContainer.layout.enable();

            if (sort || itemsToBeAdded.length > 0) {
              bufferBottom.top = this.submorphBounds().height;
              scrollContainer.layout.apply();
            }
          }
        }], [{
          key: Symbol["for"]("__LivelyClassName__"),
          get: function get() {
            return "GrowingWorldList";
          }
        }, {
          key: "properties",
          get: function get() {
            return {
              scrollContainer: {
                get: function get() {
                  return this.getSubmorphNamed("scroll container") || this.addMorph({
                    name: "scroll container",
                    fill: null,
                    reactsToPointer: false,
                    renderOnGPU: true,
                    layout: new __varRecorder__$n.TilingLayout({
                      spacing: 25,
                      align: "center",
                      autoResize: true
                    })
                  });
                }
              },
              ui: {
                get: function get() {
                  return {
                    bufferTop: this.getSubmorphNamed("buffer top"),
                    bufferBottom: this.getSubmorphNamed("buffer bottom")
                  };
                }
              },
              items: {
                after: ["layout", "scrollContainer"],
                set: function set(items) {
                  this.setProperty("items", items);
                  var scrollContainer = this.scrollContainer;
                  scrollContainer.layout && scrollContainer.layout.disable();
                  var _this$ui2 = this.ui,
                      bufferTop = _this$ui2.bufferTop,
                      bufferBottom = _this$ui2.bufferBottom;

                  __varRecorder__$n.arr.withoutAll(scrollContainer.submorphs, [].concat(_toConsumableArray(items), [bufferTop, bufferBottom])).forEach(function (m) {
                    return m.remove();
                  });

                  this.update(true);
                }
              }
            };
          }
        }], __lively_classholder__, {
          pathInPackage: function pathInPackage() {
            return "./studio/world-browser.cp.js";
          },
          unsubscribeFromToplevelDefinitionChanges: function unsubscribeFromToplevelDefinitionChanges() {
            return function () {};
          },
          subscribeToToplevelDefinitionChanges: function subscribeToToplevelDefinitionChanges() {
            return function () {};
          },
          "package": function _package() {
            return {
              name: "lively.ide",
              version: "0.1.0"
            };
          }
        }, {
          start: 17225,
          end: 20896
        });
      }(__varRecorder__$n.Morph);
      __varRecorder__$n.GrowingWorldList = GrowingWorldList;
      __varRecorder__$n.GrowingWorldList = GrowingWorldList;
      var WorldPreviewModel = function (superclass) {
        var __lively_classholder__ = lively.FreezerRuntime.recorderFor("lively.ide/studio/world-browser.cp.js");

        var __lively_class__ = __lively_classholder__.hasOwnProperty("WorldPreviewModel") && typeof __lively_classholder__.WorldPreviewModel === "function" ? __lively_classholder__.WorldPreviewModel : __lively_classholder__.WorldPreviewModel = function WorldPreviewModel(__first_arg__) {
          if (__first_arg__ && __first_arg__[Symbol["for"]("lively-instance-restorer")]) ; else {
            return this[Symbol["for"]("lively-instance-initialize")].apply(this, arguments);
          }
        };

        return initializeClass(__lively_class__, superclass, [{
          key: "relayout",
          value: function WorldPreviewModel_relayout_() {
            this.view.setBounds(this.world().visibleBounds());
          }
        }, {
          key: "displayPreview",
          value: function () {
            var _WorldPreviewModel_displayPreview_ = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee14() {
              return regeneratorRuntime.wrap(function _callee14$(_context14) {
                while (1) {
                  switch (_context14.prev = _context14.next) {
                    case 0:
                      _context14.next = 2;
                      return this.initWithCommit(this._commit);

                    case 2:
                    case "end":
                      return _context14.stop();
                  }
                }
              }, _callee14, this);
            }));

            function WorldPreviewModel_displayPreview_() {
              return _WorldPreviewModel_displayPreview_.apply(this, arguments);
            }

            return WorldPreviewModel_displayPreview_;
          }()
        }, {
          key: "initWithCommit",
          value: function () {
            var _WorldPreviewModel_initWithCommit_ = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee15(commit) {
              var _this$ui3, preview, timestamp, title, description, titleWrapper, authorName;

              return regeneratorRuntime.wrap(function _callee15$(_context15) {
                while (1) {
                  switch (_context15.prev = _context15.next) {
                    case 0:
                      _this$ui3 = this.ui, preview = _this$ui3.preview, timestamp = _this$ui3.timestamp, title = _this$ui3.title, description = _this$ui3.description, titleWrapper = _this$ui3.titleWrapper;
                      this.opacity = 0.5;
                      preview.imageUrl = commit.preview || __varRecorder__$n.missingSVG;
                      authorName = commit.author.name;
                      authorName = authorName.startsWith("guest") ? "guest" : authorName;
                      timestamp.value = [authorName, {
                        fontSize: 13,
                        fontWeight: "bold",
                        paddingTop: "1px"
                      }, __varRecorder__$n.date.format(commit.timestamp, " - d.m.yy HH:MM"), {
                        fontWeight: "bold",
                        fontSize: 12,
                        paddingTop: "2px"
                      }];
                      title.value = titleWrapper.title = commit.name;
                      description.value = commit.description;
                      this.view.animate({
                        opacity: 1,
                        duration: 300
                      });

                    case 9:
                    case "end":
                      return _context15.stop();
                  }
                }
              }, _callee15, this);
            }));

            function WorldPreviewModel_initWithCommit_(_x6) {
              return _WorldPreviewModel_initWithCommit_.apply(this, arguments);
            }

            return WorldPreviewModel_initWithCommit_;
          }()
        }, {
          key: "openAnimated",
          value: function () {
            var _WorldPreviewModel_openAnimated_ = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee16() {
              var targetBounds,
                  copy,
                  duration,
                  _args16 = arguments;
              return regeneratorRuntime.wrap(function _callee16$(_context16) {
                while (1) {
                  switch (_context16.prev = _context16.next) {
                    case 0:
                      targetBounds = _args16.length > 0 && _args16[0] !== undefined ? _args16[0] : $world.visibleBounds();
                      copy = __varRecorder__$n.morph(Object.assign({}, this.view.spec(), {
                        reactsToPointer: false,
                        renderOnGPU: true,
                        submorphs: [this.ui.spinner.spec()]
                      })).openInWorld();
                      copy.hasFixedPosition = true;
                      copy.globalPosition = this.view.globalPosition;
                      copy.opacity = 0;
                      _context16.next = 7;
                      return copy.animate({
                        opacity: 1,
                        duration: 300
                      });

                    case 7:
                      duration = 500;
                      copy.dropShadow = false;
                      copy.animate({
                        bounds: targetBounds,
                        borderRadius: 0,
                        duration: duration,
                        easing: __varRecorder__$n.easings.inOutQuint
                      });
                      copy.respondsToVisibleWindow = true;
                      _context16.next = 13;
                      return copy.get("spinner").animate({
                        center: copy.innerBounds().center(),
                        easing: __varRecorder__$n.easings.inOutQuint,
                        duration: duration
                      });

                    case 13:
                      return _context16.abrupt("return", copy);

                    case 14:
                    case "end":
                      return _context16.stop();
                  }
                }
              }, _callee16, this);
            }));

            function WorldPreviewModel_openAnimated_() {
              return _WorldPreviewModel_openAnimated_.apply(this, arguments);
            }

            return WorldPreviewModel_openAnimated_;
          }()
        }, {
          key: "openEntity",
          value: function () {
            var _WorldPreviewModel_openEntity_ = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee17() {
              return regeneratorRuntime.wrap(function _callee17$(_context17) {
                while (1) {
                  switch (_context17.prev = _context17.next) {
                    case 0:
                      _context17.next = 2;
                      return this.openAnimated();

                    case 2:
                      this.loadEntity();

                    case 3:
                    case "end":
                      return _context17.stop();
                  }
                }
              }, _callee17, this);
            }));

            function WorldPreviewModel_openEntity_() {
              return _WorldPreviewModel_openEntity_.apply(this, arguments);
            }

            return WorldPreviewModel_openEntity_;
          }()
        }, {
          key: "loadEntity",
          value: function () {
            var _WorldPreviewModel_loadEntity_ = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee18() {
              var _id;

              return regeneratorRuntime.wrap(function _callee18$(_context18) {
                while (1) {
                  switch (_context18.prev = _context18.next) {
                    case 0:
                      _id = this._commit._id;

                      if (!lively.FreezerRuntime) {
                        _context18.next = 5;
                        break;
                      }

                      this.transitionToLivelyWorld(document.location.origin, this._commit);
                      _context18.next = 7;
                      break;

                    case 5:
                      _context18.next = 7;
                      return __varRecorder__$n.World.loadFromCommit(_id, undefined, {
                        morphicDB: __varRecorder__$n.MorphicDB["default"],
                        moduleManager: __varRecorder__$n.moduleManager
                      });

                    case 7:
                    case "end":
                      return _context18.stop();
                  }
                }
              }, _callee18, this);
            }));

            function WorldPreviewModel_loadEntity_() {
              return _WorldPreviewModel_loadEntity_.apply(this, arguments);
            }

            return WorldPreviewModel_loadEntity_;
          }()
        }, {
          key: "transitionToLivelyWorld",
          value: function () {
            var _WorldPreviewModel_transitionToLivelyWorld_ = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee19(baseURL, commit, projectName, projectRepoOwner) {
              var _yield$import, bootstrap, _yield$import2, ProgressIndicator, progress;

              return regeneratorRuntime.wrap(function _callee19$(_context19) {
                while (1) {
                  switch (_context19.prev = _context19.next) {
                    case 0:
                      _context19.next = 2;
                      return module.import('./bootstrap-eae411bd.js');

                    case 2:
                      _yield$import = _context19.sent;
                      bootstrap = _yield$import.bootstrap;
                      _context19.next = 6;
                      return module.import('./loading-screen.cp-57f76c89.js');

                    case 6:
                      _yield$import2 = _context19.sent;
                      ProgressIndicator = _yield$import2.ProgressIndicator;
                      progress = __varRecorder__$n.part(ProgressIndicator, {
                        opacity: 0,
                        hasFixedPosition: true
                      }).openInWorld();
                      progress.startStepping("updateProgressBar");

                      if (!projectName) {
                        _context19.next = 15;
                        break;
                      }

                      _context19.next = 13;
                      return bootstrap({
                        projectName: projectName,
                        projectRepoOwner: projectRepoOwner,
                        progress: progress
                      });

                    case 13:
                      _context19.next = 17;
                      break;

                    case 15:
                      _context19.next = 17;
                      return bootstrap({
                        commit: commit,
                        progress: progress
                      });

                    case 17:
                    case "end":
                      return _context19.stop();
                  }
                }
              }, _callee19);
            }));

            function WorldPreviewModel_transitionToLivelyWorld_(_x7, _x8, _x9, _x10) {
              return _WorldPreviewModel_transitionToLivelyWorld_.apply(this, arguments);
            }

            return WorldPreviewModel_transitionToLivelyWorld_;
          }()
        }, {
          key: "showVersions",
          value: function () {
            var _WorldPreviewModel_showVersions_ = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee20() {
              var duration, easing, _this$ui4, previewContainer, versionContainer;

              return regeneratorRuntime.wrap(function _callee20$(_context20) {
                while (1) {
                  switch (_context20.prev = _context20.next) {
                    case 0:
                      duration = 200;
                      easing = __varRecorder__$n.easings.inOutExpo;
                      _this$ui4 = this.ui, previewContainer = _this$ui4.previewContainer, versionContainer = _this$ui4.versionContainer;
                      versionContainer.reactsToPointer = versionContainer.visible = true;
                      versionContainer.initializeFromStartCommit(this._commit);
                      this.view.animate({
                        width: 515,
                        duration: duration,
                        easing: easing
                      });
                      previewContainer.animate({
                        opacity: 0,
                        duration: duration
                      });
                      _context20.next = 9;
                      return versionContainer.animate({
                        opacity: 1,
                        duration: duration
                      });

                    case 9:
                      previewContainer.reactsToPointer = previewContainer.visible = false;

                    case 10:
                    case "end":
                      return _context20.stop();
                  }
                }
              }, _callee20, this);
            }));

            function WorldPreviewModel_showVersions_() {
              return _WorldPreviewModel_showVersions_.apply(this, arguments);
            }

            return WorldPreviewModel_showVersions_;
          }()
        }, {
          key: "hideVersions",
          value: function () {
            var _WorldPreviewModel_hideVersions_ = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee21() {
              var duration, easing, _this$ui5, previewContainer, versionContainer;

              return regeneratorRuntime.wrap(function _callee21$(_context21) {
                while (1) {
                  switch (_context21.prev = _context21.next) {
                    case 0:
                      duration = 200;
                      easing = __varRecorder__$n.easings.inOutExpo;
                      _this$ui5 = this.ui, previewContainer = _this$ui5.previewContainer, versionContainer = _this$ui5.versionContainer;
                      previewContainer.reactsToPointer = previewContainer.visible = true;
                      this.view.animate({
                        width: 245,
                        duration: duration,
                        easing: easing
                      });
                      previewContainer.animate({
                        opacity: 1,
                        duration: duration
                      });
                      _context21.next = 8;
                      return versionContainer.animate({
                        opacity: 0,
                        duration: duration
                      });

                    case 8:
                      versionContainer.reset();

                    case 9:
                    case "end":
                      return _context21.stop();
                  }
                }
              }, _callee21, this);
            }));

            function WorldPreviewModel_hideVersions_() {
              return _WorldPreviewModel_hideVersions_.apply(this, arguments);
            }

            return WorldPreviewModel_hideVersions_;
          }()
        }, {
          key: "toggleDeleteButton",
          value: function WorldPreviewModel_toggleDeleteButton_(active) {
            var deleteButton = this.ui.deleteButton;
            deleteButton.visible = deleteButton.reactsToPointer = active;
          }
        }, {
          key: "tryToDelete",
          value: function () {
            var _WorldPreviewModel_tryToDelete_ = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee22() {
              var proceed;
              return regeneratorRuntime.wrap(function _callee22$(_context22) {
                while (1) {
                  switch (_context22.prev = _context22.next) {
                    case 0:
                      _context22.next = 2;
                      return this._worldBrowser.confirm(["Delete World\n", {}, "Do you really want to remove this world from the database? This step can not be undone.", {
                        fontWeight: "normal",
                        fontSize: 16
                      }]);

                    case 2:
                      proceed = _context22.sent;

                      if (!proceed) {
                        _context22.next = 6;
                        break;
                      }

                      _context22.next = 6;
                      return this.confirmDelete();

                    case 6:
                    case "end":
                      return _context22.stop();
                  }
                }
              }, _callee22, this);
            }));

            function WorldPreviewModel_tryToDelete_() {
              return _WorldPreviewModel_tryToDelete_.apply(this, arguments);
            }

            return WorldPreviewModel_tryToDelete_;
          }()
        }, {
          key: "confirmDelete",
          value: function () {
            var _WorldPreviewModel_confirmDelete_ = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee23() {
              return regeneratorRuntime.wrap(function _callee23$(_context23) {
                while (1) {
                  switch (_context23.prev = _context23.next) {
                    case 0:
                      _context23.next = 2;
                      return __varRecorder__$n.MorphicDB["default"].commit(Object.assign({}, this._commit, {
                        content: undefined,
                        snapshot: null
                      }));

                    case 2:
                      this._worldBrowser.displayItems();

                    case 3:
                    case "end":
                      return _context23.stop();
                  }
                }
              }, _callee23, this);
            }));

            function WorldPreviewModel_confirmDelete_() {
              return _WorldPreviewModel_confirmDelete_.apply(this, arguments);
            }

            return WorldPreviewModel_confirmDelete_;
          }()
        }], [{
          key: Symbol["for"]("__LivelyClassName__"),
          get: function get() {
            return "WorldPreviewModel";
          }
        }, {
          key: "properties",
          get: function get() {
            return {
              bindingsToInherit: {
                defaultValue: [{
                  target: "delete button",
                  signal: "onMouseDown",
                  handler: "tryToDelete"
                }, {
                  target: "open button",
                  signal: "onMouseDown",
                  handler: "openEntity"
                }, {
                  signal: "onHoverIn",
                  handler: "toggleDeleteButton",
                  converter: function converter() {
                    return true;
                  }
                }, {
                  signal: "onHoverOut",
                  handler: "toggleDeleteButton",
                  converter: function converter() {
                    return false;
                  }
                }]
              },
              bindings: {
                get: function get() {
                  return [].concat(_toConsumableArray(this.bindingsToInherit), [{
                    target: "close versions button",
                    signal: "onMouseDown",
                    handler: "hideVersions"
                  }, {
                    target: "version button",
                    signal: "onMouseDown",
                    handler: "showVersions"
                  }]);
                }
              },
              _commit: {},
              _worldBrowser: {},
              expose: {
                get: function get() {
                  return ["relayout", "displayPreview", "_commit"];
                }
              }
            };
          }
        }], __lively_classholder__, {
          pathInPackage: function pathInPackage() {
            return "./studio/world-browser.cp.js";
          },
          unsubscribeFromToplevelDefinitionChanges: function unsubscribeFromToplevelDefinitionChanges() {
            return function () {};
          },
          subscribeToToplevelDefinitionChanges: function subscribeToToplevelDefinitionChanges() {
            return function () {};
          },
          "package": function _package() {
            return {
              name: "lively.ide",
              version: "0.1.0"
            };
          }
        }, {
          start: 20904,
          end: 26626
        });
      }(__varRecorder__$n.ViewModel);
      __varRecorder__$n.WorldPreviewModel = WorldPreviewModel;
      __varRecorder__$n.WorldPreviewModel = WorldPreviewModel;

      (function (superclass) {
        var __lively_classholder__ = lively.FreezerRuntime.recorderFor("lively.ide/studio/world-browser.cp.js");

        var __lively_class__ = __lively_classholder__.hasOwnProperty("ProjectPreviewModel") && typeof __lively_classholder__.ProjectPreviewModel === "function" ? __lively_classholder__.ProjectPreviewModel : __lively_classholder__.ProjectPreviewModel = function ProjectPreviewModel(__first_arg__) {
          if (__first_arg__ && __first_arg__[Symbol["for"]("lively-instance-restorer")]) ; else {
            return this[Symbol["for"]("lively-instance-initialize")].apply(this, arguments);
          }
        };

        return initializeClass(__lively_class__, superclass, [{
          key: "displayPreview",
          value: function () {
            var _ProjectPreviewModel_displayPreview_ = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee24() {
              return regeneratorRuntime.wrap(function _callee24$(_context24) {
                while (1) {
                  switch (_context24.prev = _context24.next) {
                    case 0:
                      _context24.next = 2;
                      return this.initWithProject(this._project);

                    case 2:
                    case "end":
                      return _context24.stop();
                  }
                }
              }, _callee24, this);
            }));

            function ProjectPreviewModel_displayPreview_() {
              return _ProjectPreviewModel_displayPreview_.apply(this, arguments);
            }

            return ProjectPreviewModel_displayPreview_;
          }()
        }, {
          key: "initWithProject",
          value: function ProjectPreviewModel_initWithProject_(project) {
            var _this$ui6 = this.ui,
                timestamp = _this$ui6.timestamp,
                title = _this$ui6.title,
                description = _this$ui6.description,
                titleWrapper = _this$ui6.titleWrapper;
            this.opacity = 0.5;
            var authorName = project.author.name;
            authorName = authorName.startsWith("guest") ? "guest" : authorName;
            timestamp.value = [project.projectRepoOwner + " - " + authorName, {
              fontSize: 13,
              fontWeight: "bold",
              paddingTop: "1px"
            }];
            if (project.projectRepoOwner === authorName) timestamp.value = [authorName, {
              fontSize: 13,
              fontWeight: "bold",
              paddingTop: "1px"
            }];
            timestamp.tooltip = "Project ".concat(project.name, " was created by ").concat(authorName, ".\nIts repository belongs to ").concat(project.projectRepoOwner, ".");
            title.value = titleWrapper.title = project.name;
            description.value = project.description;
            this.view.animate({
              opacity: 1,
              duration: 300
            });
          }
        }, {
          key: "loadEntity",
          value: function () {
            var _ProjectPreviewModel_loadEntity_ = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee25() {
              var _this$_project, name, projectRepoOwner, li;

              return regeneratorRuntime.wrap(function _callee25$(_context25) {
                while (1) {
                  switch (_context25.prev = _context25.next) {
                    case 0:
                      _this$_project = this._project, name = _this$_project.name, projectRepoOwner = _this$_project.projectRepoOwner;

                      if (!lively.FreezerRuntime) {
                        _context25.next = 5;
                        break;
                      }

                      this.transitionToLivelyWorld(document.location.origin, null, name, projectRepoOwner);
                      _context25.next = 9;
                      break;

                    case 5:
                      li = __varRecorder__$n.LoadingIndicator.open("loading " + name);
                      _context25.next = 8;
                      return __varRecorder__$n.World.loadWorld(new __varRecorder__$n.LivelyWorld({
                        projectToBeOpened: name,
                        projectRepoOwner: projectRepoOwner
                      }), $world);

                    case 8:
                      li.remove();

                    case 9:
                    case "end":
                      return _context25.stop();
                  }
                }
              }, _callee25, this);
            }));

            function ProjectPreviewModel_loadEntity_() {
              return _ProjectPreviewModel_loadEntity_.apply(this, arguments);
            }

            return ProjectPreviewModel_loadEntity_;
          }()
        }, {
          key: "tryToDelete",
          value: function () {
            var _ProjectPreviewModel_tryToDelete_ = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee26() {
              var proceed;
              return regeneratorRuntime.wrap(function _callee26$(_context26) {
                while (1) {
                  switch (_context26.prev = _context26.next) {
                    case 0:
                      _context26.next = 2;
                      return this._worldBrowser.confirm(["Delete Project\n", {}, "Do you really want to remove this project from this system? This step can not be undone.", {
                        fontWeight: "normal",
                        fontSize: 16
                      }]);

                    case 2:
                      proceed = _context26.sent;

                      if (!proceed) {
                        _context26.next = 6;
                        break;
                      }

                      _context26.next = 6;
                      return this.confirmDelete();

                    case 6:
                    case "end":
                      return _context26.stop();
                  }
                }
              }, _callee26, this);
            }));

            function ProjectPreviewModel_tryToDelete_() {
              return _ProjectPreviewModel_tryToDelete_.apply(this, arguments);
            }

            return ProjectPreviewModel_tryToDelete_;
          }()
        }, {
          key: "confirmDelete",
          value: function () {
            var _ProjectPreviewModel_confirmDelete_ = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee27() {
              var _this$_project2, projectRepoOwner, name;

              return regeneratorRuntime.wrap(function _callee27$(_context27) {
                while (1) {
                  switch (_context27.prev = _context27.next) {
                    case 0:
                      _this$_project2 = this._project, projectRepoOwner = _this$_project2.projectRepoOwner, name = _this$_project2.name;
                      _context27.next = 3;
                      return __varRecorder__$n.Project.deleteProject(name, projectRepoOwner);

                    case 3:
                      this._worldBrowser.displayItems();

                    case 4:
                    case "end":
                      return _context27.stop();
                  }
                }
              }, _callee27, this);
            }));

            function ProjectPreviewModel_confirmDelete_() {
              return _ProjectPreviewModel_confirmDelete_.apply(this, arguments);
            }

            return ProjectPreviewModel_confirmDelete_;
          }()
        }], [{
          key: Symbol["for"]("__LivelyClassName__"),
          get: function get() {
            return "ProjectPreviewModel";
          }
        }, {
          key: "properties",
          get: function get() {
            return {
              bindings: {
                get: function get() {
                  return _toConsumableArray(this.bindingsToInherit);
                }
              },
              _project: {}
            };
          }
        }], __lively_classholder__, {
          pathInPackage: function pathInPackage() {
            return "./studio/world-browser.cp.js";
          },
          unsubscribeFromToplevelDefinitionChanges: function unsubscribeFromToplevelDefinitionChanges() {
            return function () {};
          },
          subscribeToToplevelDefinitionChanges: function subscribeToToplevelDefinitionChanges() {
            return function () {};
          },
          "package": function _package() {
            return {
              name: "lively.ide",
              version: "0.1.0"
            };
          }
        }, {
          start: 26628,
          end: 28954
        });
      })(__varRecorder__$n.WorldPreviewModel);

      __varRecorder__$n.Placeholder = __varRecorder__$n.component["for"](function () {
        return __varRecorder__$n.component({
          reactsToPointer: false,
          fill: __varRecorder__$n.Color.transparent,
          dropShadow: new __varRecorder__$n.ShadowObject({
            distance: 20,
            rotation: 75,
            color: __varRecorder__$n.Color.rgba(0, 0, 0, 0.11),
            blur: 50
          }),
          extent: __varRecorder__$n.pt(245, 368.2)
        });
      }, {
        module: "lively.ide/studio/world-browser.cp.js",
        "export": "Placeholder",
        range: {
          start: 28962,
          end: 29194
        }
      }, __varRecorder__$n.Placeholder);
      __varRecorder__$n.WorldPreviewTile = __varRecorder__$n.component["for"](function () {
        return __varRecorder__$n.component({
          name: "world preview",
          defaultViewModel: __varRecorder__$n.ProjectPreviewModel,
          borderRadius: 5,
          dropShadow: new __varRecorder__$n.ShadowObject({
            distance: 20,
            rotation: 75,
            color: __varRecorder__$n.Color.rgba(0, 0, 0, 0.11),
            blur: 50
          }),
          extent: __varRecorder__$n.pt(245, 368.2),
          fill: __varRecorder__$n.Color.rgb(253, 254, 254),
          position: __varRecorder__$n.pt(1109.2, 43.8),
          submorphs: [{
            name: "preview container",
            extent: __varRecorder__$n.pt(244.5, 130),
            fill: __varRecorder__$n.Color.rgba(46, 75, 223, 0),
            position: __varRecorder__$n.pt(0, 0),
            submorphs: [__varRecorder__$n.part(__varRecorder__$n.PlainButton, {
              name: "version button",
              extent: __varRecorder__$n.pt(85, 31),
              position: __varRecorder__$n.pt(148, 316.7),
              submorphs: [{
                name: "label",
                fontFamily: "\"IBM Plex Sans\"",
                fontWeight: 600,
                textAndAttributes: ["VERSIONS", null]
              }]
            }), __varRecorder__$n.part(__varRecorder__$n.GreenButton, {
              name: "open button",
              extent: __varRecorder__$n.pt(122, 30),
              position: __varRecorder__$n.pt(14.6, 317),
              submorphs: [{
                name: "label",
                fontWeight: 600,
                textAndAttributes: ["OPEN WORLD", null]
              }]
            }), __varRecorder__$n.part(__varRecorder__$n.Spinner, {
              name: "spinner",
              extent: __varRecorder__$n.pt(55.3, 66.9),
              position: __varRecorder__$n.pt(111.3, 158.1),
              visible: false
            }), {
              name: "preview frame",
              borderColor: __varRecorder__$n.Color.rgb(23, 160, 251),
              clipMode: "hidden",
              extent: __varRecorder__$n.pt(210.4, 184),
              fill: __varRecorder__$n.Color.rgba(0, 0, 0, 0),
              position: __varRecorder__$n.pt(16, 16.2),
              submorphs: [{
                type: __varRecorder__$n.Image,
                name: "preview",
                extent: __varRecorder__$n.pt(210, 216.6),
                imageUrl: "",
                naturalExtent: __varRecorder__$n.pt(200, 200)
              }]
            }, {
              type: __varRecorder__$n.Label,
              name: "delete button",
              dropShadow: false,
              fontColor: __varRecorder__$n.Color.rgb(231, 76, 60),
              fontSize: 25.108,
              nativeCursor: "pointer",
              position: __varRecorder__$n.pt(212.1, 11.9),
              textAndAttributes: __varRecorder__$n.Icon.textAttribute("trash-alt"),
              visible: false
            }, {
              type: __varRecorder__$n.Label,
              name: "timestamp",
              borderRadius: 30,
              fill: __varRecorder__$n.Color.rgba(0, 0, 0, 0.36),
              fontColor: __varRecorder__$n.Color.rgb(253, 254, 254),
              fontSize: 17,
              nativeCursor: "pointer",
              padding: __varRecorder__$n.rect(10, 3, 0, 2),
              position: __varRecorder__$n.pt(16.7, 167.8),
              textAndAttributes: ["robin.schreiber", {
                fontSize: 13,
                fontWeight: "bold",
                paddingTop: "1px"
              }, " - 3.1.19 19:30", {
                fontSize: 12,
                fontWeight: "bold",
                paddingTop: "2px"
              }]
            }, {
              type: __varRecorder__$n.StaticText,
              name: "description",
              clipMode: "hidden",
              extent: __varRecorder__$n.pt(199.9, 70.3),
              fill: __varRecorder__$n.Color.rgba(255, 255, 255, 0),
              fontColor: __varRecorder__$n.Color.rgb(97, 106, 107),
              fontFamily: "IBM Plex Sans",
              fontSize: 17,
              html: "<span style=\"line-height: 1.3; font-size: 17px; color: rgb(97,106,107); font-family: IBM Plex Sans\">An interactive essay abouy eyesight.</span>",
              position: __varRecorder__$n.pt(18.9, 238.9),
              renderOnGPU: true,
              value: "An interactive essay abouy eyesight."
            }, {
              type: __varRecorder__$n.TitleWrapper,
              name: "title wrapper",
              borderColor: __varRecorder__$n.Color.rgb(23, 160, 251),
              clipMode: "hidden",
              extent: __varRecorder__$n.pt(217.4, 32.5),
              fill: __varRecorder__$n.Color.rgba(0, 0, 0, 0),
              position: __varRecorder__$n.pt(12.3, 205.3),
              submorphs: [{
                type: __varRecorder__$n.Label,
                name: "title",
                fill: __varRecorder__$n.Color.rgba(255, 255, 255, 0),
                fontColor: __varRecorder__$n.Color.rgb(64, 64, 64),
                fontSize: 22,
                fontWeight: "bold",
                nativeCursor: "pointer",
                padding: __varRecorder__$n.rect(4, 3, 1, 0),
                textAndAttributes: ["Title", null]
              }]
            }]
          }, {
            type: __varRecorder__$n.WorldVersionViewer,
            name: "version container",
            draggable: true,
            extent: __varRecorder__$n.pt(515.7, 365.6),
            fill: __varRecorder__$n.Color.rgb(253, 254, 254),
            grabbable: true,
            position: __varRecorder__$n.pt(0, 0),
            visible: false,
            layoutable: false,
            submorphs: [{
              type: __varRecorder__$n.MorphList,
              name: "version list",
              clipMode: "hidden",
              master: __varRecorder__$n.SystemList,
              extent: __varRecorder__$n.pt(475.6, 285),
              itemHeight: 45,
              padding: __varRecorder__$n.rect(1, 1, 0, -1),
              position: __varRecorder__$n.pt(20.1, 16.8),
              touchInput: false
            }, __varRecorder__$n.part(__varRecorder__$n.Spinner, {
              name: "version list spinner",
              extent: __varRecorder__$n.pt(55.3, 66.9),
              position: __varRecorder__$n.pt(244, 166.1),
              scale: 0.5,
              visible: false,
              reactsToPointer: false
            }), __varRecorder__$n.part(__varRecorder__$n.PlainButton, {
              name: "close versions button",
              dropShadow: new __varRecorder__$n.ShadowObject({
                distance: 3,
                color: __varRecorder__$n.Color.rgba(0, 0, 0, 0.26),
                blur: 10
              }),
              extent: __varRecorder__$n.pt(84, 31),
              fill: __varRecorder__$n.Color.rgb(81, 90, 90),
              position: __varRecorder__$n.pt(20.7, 317.2),
              submorphs: [{
                name: "label",
                fontFamily: "\"IBM Plex Sans\"",
                fontWeight: 600,
                textAndAttributes: ["CLOSE", null]
              }]
            }), __varRecorder__$n.part(__varRecorder__$n.RedButton, {
              name: "revert button",
              extent: __varRecorder__$n.pt(84, 31),
              position: __varRecorder__$n.pt(312.4, 316.2),
              submorphs: [{
                name: "label",
                fontWeight: 600,
                textAndAttributes: ["REVERT", null]
              }]
            }), __varRecorder__$n.part(__varRecorder__$n.GreenButton, {
              name: "visit button",
              dropShadow: new __varRecorder__$n.ShadowObject({
                distance: 3,
                color: __varRecorder__$n.Color.rgba(0, 0, 0, 0.26),
                blur: 10
              }),
              extent: __varRecorder__$n.pt(84, 31),
              label: "VISIT",
              position: __varRecorder__$n.pt(413, 315.6),
              submorphs: [{
                name: "label",
                fontWeight: 600,
                textAndAttributes: ["VISIT", null]
              }]
            })]
          }]
        });
      }, {
        module: "lively.ide/studio/world-browser.cp.js",
        "export": "WorldPreviewTile",
        range: {
          start: 29202,
          end: 34363
        }
      }, __varRecorder__$n.WorldPreviewTile);
      __varRecorder__$n.ProjectIcon = __varRecorder__$n.component["for"](function () {
        return __varRecorder__$n.component({
          name: "aMorph",
          borderColor: __varRecorder__$n.Color.rgb(56, 175, 249),
          borderRadius: 5,
          borderWidth: 6,
          extent: __varRecorder__$n.pt(155, 155),
          position: __varRecorder__$n.pt(26.5, 5.4),
          submorphs: [{
            type: __varRecorder__$n.Path,
            name: "aPath2",
            borderColor: __varRecorder__$n.Color.rgba(4, 28, 43, 0.5),
            borderWidth: 4,
            extent: __varRecorder__$n.pt(6, 132),
            position: __varRecorder__$n.pt(25, 10),
            vertices: [{
              position: __varRecorder__$n.pt(0, 0),
              isSmooth: false,
              controlPoints: {
                next: __varRecorder__$n.pt(0, 0),
                previous: __varRecorder__$n.pt(0, 0)
              }
            }, {
              position: __varRecorder__$n.pt(0, 131.99999999999991),
              isSmooth: false,
              controlPoints: {
                next: __varRecorder__$n.pt(0, 0),
                previous: __varRecorder__$n.pt(0, 0)
              }
            }]
          }, {
            type: __varRecorder__$n.Path,
            name: "aPath3",
            borderColor: __varRecorder__$n.Color.rgba(4, 28, 43, 0.5),
            borderWidth: 4,
            extent: __varRecorder__$n.pt(1, 132),
            position: __varRecorder__$n.pt(46, 10),
            vertices: [{
              position: __varRecorder__$n.pt(0, 0),
              isSmooth: false,
              controlPoints: {
                next: __varRecorder__$n.pt(0, 0),
                previous: __varRecorder__$n.pt(0, 0)
              }
            }, {
              position: __varRecorder__$n.pt(0, 132),
              isSmooth: false,
              controlPoints: {
                next: __varRecorder__$n.pt(0, 0),
                previous: __varRecorder__$n.pt(0, 0)
              }
            }]
          }, {
            type: __varRecorder__$n.Path,
            name: "aPath4",
            borderColor: __varRecorder__$n.Color.rgba(4, 28, 43, 0.5),
            borderWidth: 4,
            extent: __varRecorder__$n.pt(1, 132),
            position: __varRecorder__$n.pt(67, 10),
            vertices: [{
              position: __varRecorder__$n.pt(0, 0),
              isSmooth: false,
              controlPoints: {
                next: __varRecorder__$n.pt(0, 0),
                previous: __varRecorder__$n.pt(0, 0)
              }
            }, {
              position: __varRecorder__$n.pt(0, 132),
              isSmooth: false,
              controlPoints: {
                next: __varRecorder__$n.pt(0, 0),
                previous: __varRecorder__$n.pt(0, 0)
              }
            }]
          }, {
            type: __varRecorder__$n.Path,
            name: "aPath5",
            borderColor: __varRecorder__$n.Color.rgba(4, 28, 43, 0.5),
            borderWidth: 4,
            extent: __varRecorder__$n.pt(1, 132),
            position: __varRecorder__$n.pt(88, 10),
            vertices: [{
              position: __varRecorder__$n.pt(0, 0),
              isSmooth: false,
              controlPoints: {
                next: __varRecorder__$n.pt(0, 0),
                previous: __varRecorder__$n.pt(0, 0)
              }
            }, {
              position: __varRecorder__$n.pt(0, 132),
              isSmooth: false,
              controlPoints: {
                next: __varRecorder__$n.pt(0, 0),
                previous: __varRecorder__$n.pt(0, 0)
              }
            }]
          }, {
            type: __varRecorder__$n.Path,
            name: "aPath6",
            borderColor: __varRecorder__$n.Color.rgba(4, 28, 43, 0.5),
            borderWidth: 4,
            extent: __varRecorder__$n.pt(1, 132),
            position: __varRecorder__$n.pt(108, 10),
            vertices: [{
              position: __varRecorder__$n.pt(0, 0),
              isSmooth: false,
              controlPoints: {
                next: __varRecorder__$n.pt(0, 0),
                previous: __varRecorder__$n.pt(0, 0)
              }
            }, {
              position: __varRecorder__$n.pt(0, 132),
              isSmooth: false,
              controlPoints: {
                next: __varRecorder__$n.pt(0, 0),
                previous: __varRecorder__$n.pt(0, 0)
              }
            }]
          }, {
            type: __varRecorder__$n.Path,
            name: "aPath1",
            borderColor: __varRecorder__$n.Color.rgba(4, 28, 43, 0.5),
            borderWidth: 4,
            extent: __varRecorder__$n.pt(1, 132),
            position: __varRecorder__$n.pt(130, 10),
            vertices: [{
              position: __varRecorder__$n.pt(0, 0),
              isSmooth: false,
              controlPoints: {
                next: __varRecorder__$n.pt(0, 0),
                previous: __varRecorder__$n.pt(0, 0)
              }
            }, {
              position: __varRecorder__$n.pt(0, 132),
              isSmooth: false,
              controlPoints: {
                next: __varRecorder__$n.pt(0, 0),
                previous: __varRecorder__$n.pt(0, 0)
              }
            }]
          }, {
            name: "aMorph3",
            borderColor: __varRecorder__$n.Color.rgb(23, 160, 251),
            borderRadius: 8,
            extent: __varRecorder__$n.pt(91, 6),
            fill: __varRecorder__$n.Color.rgb(77, 175, 243),
            position: __varRecorder__$n.pt(9.5, 20)
          }, {
            name: "aMorph1",
            borderColor: __varRecorder__$n.Color.rgb(23, 160, 251),
            borderRadius: 8,
            extent: __varRecorder__$n.pt(61, 6),
            fill: __varRecorder__$n.Color.rgb(77, 175, 243),
            position: __varRecorder__$n.pt(33.5, 60)
          }, {
            name: "aMorph2",
            borderColor: __varRecorder__$n.Color.rgb(23, 160, 251),
            borderRadius: 8,
            extent: __varRecorder__$n.pt(61, 6),
            fill: __varRecorder__$n.Color.rgb(77, 175, 243),
            position: __varRecorder__$n.pt(73, 89)
          }, __varRecorder__$n.add({
            name: "background remover",
            borderColor: __varRecorder__$n.Color.rgb(23, 160, 251),
            extent: __varRecorder__$n.pt(30.5, 33.5),
            position: __varRecorder__$n.pt(20.5, 104.5)
          }, "aText"), {
            type: __varRecorder__$n.Text,
            name: "aText",
            fontWeight: 700,
            borderColor: __varRecorder__$n.Color.rgb(23, 160, 251),
            cursorWidth: 1.5,
            dynamicCursorColoring: true,
            extent: __varRecorder__$n.pt(48, 49),
            fill: __varRecorder__$n.Color.rgba(255, 255, 255, 0),
            fixedHeight: true,
            fixedWidth: true,
            fontColor: __varRecorder__$n.Color.rgb(92, 175, 238),
            fontSize: 42,
            lineWrapping: "by-words",
            padding: __varRecorder__$n.rect(1, 1, 0, 0),
            position: __varRecorder__$n.pt(98.5, 21),
            textAndAttributes: ["\uF00C", {
              fontFamily: "\"Font Awesome 6 Free\", \"Font Awesome 6 Brands\"",
              fontWeight: "900"
            }, " ", {}]
          }, __varRecorder__$n.add({
            type: __varRecorder__$n.Text,
            name: "aText2",
            lineHeight: 1,
            borderColor: __varRecorder__$n.Color.rgb(23, 160, 251),
            cursorWidth: 1.5,
            dynamicCursorColoring: true,
            extent: __varRecorder__$n.pt(61.5, 55),
            fill: __varRecorder__$n.Color.rgba(255, 255, 255, 0),
            fixedHeight: true,
            fixedWidth: true,
            fontColor: __varRecorder__$n.Color.rgb(77, 175, 243),
            fontSize: 62,
            lineWrapping: "by-words",
            padding: __varRecorder__$n.rect(0, 0, 1, 0),
            position: __varRecorder__$n.pt(3.5, 89),
            textAndAttributes: ["\uEA57", {
              fontFamily: "Tabler Icons",
              fontWeight: "900"
            }]
          })]
        });
      }, {
        module: "lively.ide/studio/world-browser.cp.js",
        "export": "ProjectIcon",
        range: {
          start: 34547,
          end: 39232
        }
      }, __varRecorder__$n.ProjectIcon);
      __varRecorder__$n.ProjectPreviewTile = __varRecorder__$n.component["for"](function () {
        return __varRecorder__$n.component(__varRecorder__$n.WorldPreviewTile, {
          defaultViewModel: __varRecorder__$n.ProjectPreviewModel,
          submorphs: [{
            name: "preview container",
            submorphs: [{
              name: "open button",
              submorphs: [{
                name: "label",
                textAndAttributes: ["OPEN PROJECT", null]
              }]
            }, __varRecorder__$n.without("version button"), {
              name: "preview frame",
              clipMode: "visible",
              submorphs: [__varRecorder__$n.without("preview"), __varRecorder__$n.add(__varRecorder__$n.part(__varRecorder__$n.ProjectIcon)), __varRecorder__$n.without("version container")]
            }]
          }]
        });
      }, {
        module: "lively.ide/studio/world-browser.cp.js",
        "export": "ProjectPreviewTile",
        range: {
          start: 39240,
          end: 39809
        }
      }, __varRecorder__$n.ProjectPreviewTile);
      __varRecorder__$n.WorldBrowser = __varRecorder__$n.component["for"](function () {
        return __varRecorder__$n.component({
          defaultViewModel: __varRecorder__$n.WorldBrowserModel,
          name: "world browser",
          borderRadius: 10,
          clipMode: "hidden",
          draggable: true,
          dropShadow: new __varRecorder__$n.ShadowObject({
            color: __varRecorder__$n.Color.rgba(0, 0, 0, 0.52),
            blur: 15
          }),
          extent: __varRecorder__$n.pt(870, 570),
          fill: __varRecorder__$n.Color.rgb(112, 123, 124),
          layout: new __varRecorder__$n.ConstraintLayout({
            lastExtent: {
              x: 870,
              y: 570
            },
            reactToSubmorphAnimations: false,
            submorphSettings: [["world list", {
              x: "resize",
              y: "resize"
            }], ["fader top", {
              x: "resize",
              y: "fixed"
            }], ["search field", {
              x: "move",
              y: "fixed"
            }], ["fader bottom", {
              x: "resize",
              y: "move"
            }], ["close button", {
              x: "fixed",
              y: "move"
            }]]
          }),
          position: __varRecorder__$n.pt(1182.2, 536.7),
          renderOnGPU: true,
          submorphs: [{
            type: __varRecorder__$n.Label,
            name: "no world warning",
            visible: false,
            fontColor: __varRecorder__$n.Color.rgb(189, 195, 199),
            fontSize: 30,
            fontWeight: "bold",
            position: __varRecorder__$n.pt(170.8, 265.5),
            reactsToPointer: false,
            textAndAttributes: ["There are no projects yet. Create one!", null]
          }, {
            type: __varRecorder__$n.GrowingWorldList,
            name: "world list",
            clipMode: "hidden",
            extent: __varRecorder__$n.pt(869.6, 568.7),
            fill: __varRecorder__$n.Color.rgba(46, 75, 223, 0),
            items: [],
            scrollContainer: null,
            submorphs: [{
              name: "scroll container",
              extent: __varRecorder__$n.pt(868.9, 75),
              fill: __varRecorder__$n.Color.transparent,
              layout: new __varRecorder__$n.TilingLayout({
                align: "center",
                hugContentsVertically: true,
                orderByIndex: true,
                padding: __varRecorder__$n.rect(0, 0, 0, 30),
                reactToSubmorphAnimations: true,
                spacing: 25,
                wrapSubmorphs: true
              }),
              reactsToPointer: false,
              submorphs: [{
                name: "buffer top",
                extent: __varRecorder__$n.pt(768.9, 34),
                fill: __varRecorder__$n.Color.transparent
              }, {
                name: "buffer bottom",
                extent: __varRecorder__$n.pt(768.9, 10),
                fill: __varRecorder__$n.Color.transparent
              }]
            }]
          }, {
            name: "fader top",
            extent: __varRecorder__$n.pt(871.9, 63.9),
            fill: new __varRecorder__$n.LinearGradient({
              stops: [{
                offset: 0,
                color: __varRecorder__$n.Color.rgb(112, 123, 124)
              }, {
                offset: 1,
                color: __varRecorder__$n.Color.rgba(112, 123, 124, 0)
              }],
              vector: __varRecorder__$n.rect(0, 0, 0, 1)
            }),
            submorphs: [__varRecorder__$n.part(__varRecorder__$n.GreenButton, {
              name: "new project button",
              extent: __varRecorder__$n.pt(163, 30),
              position: __varRecorder__$n.pt(19.8, 17),
              submorphs: [{
                name: "label",
                fontWeight: 600,
                textAndAttributes: [].concat(_toConsumableArray(__varRecorder__$n.Icon.textAttribute("plus-circle", {
                  paddingTop: "2px",
                  paddingRight: "5px"
                })), [" NEW PROJECT"])
              }]
            }), __varRecorder__$n.part(__varRecorder__$n.ModeSelector, {
              name: "mode selector",
              extent: __varRecorder__$n.pt(150, 30),
              position: __varRecorder__$n.pt(195, 17.5),
              borderColor: __varRecorder__$n.Color.white,
              fill: __varRecorder__$n.Color.rgba(114, 123, 124, 0),
              borderRadius: 5,
              viewModel: {
                items: [{
                  text: "Projects",
                  name: "Projects",
                  tooltip: "Create or Open a Project"
                }, {
                  text: "Playgrounds",
                  name: "Playgrounds",
                  tooltip: "Create or Open a Playground (Legacy/Prototyping Mode)"
                }]
              }
            })]
          }, __varRecorder__$n.part(__varRecorder__$n.SearchField, {
            name: "search field",
            borderStyle: "hidden",
            layout: new __varRecorder__$n.TilingLayout({
              align: "center",
              axisAlign: "center",
              orderByIndex: true,
              padding: __varRecorder__$n.rect(6, 0, 4, 0),
              resizePolicies: [["search input", {
                height: "fill",
                width: "fill"
              }]]
            }),
            borderRadius: 30,
            viewModel: {
              fuzzy: true
            },
            extent: __varRecorder__$n.pt(285.1, 34),
            fill: __varRecorder__$n.Color.rgb(234, 237, 237),
            position: __varRecorder__$n.pt(574.3, 13.6),
            submorphs: [{
              name: "search input",
              layout: new __varRecorder__$n.ConstraintLayout({
                lastExtent: {
                  x: 271,
                  y: 36
                },
                reactToSubmorphAnimations: false,
                submorphSettings: []
              }),
              selectionColor: __varRecorder__$n.Color.rgba(64, 196, 255, 0.4),
              fontSize: 20,
              submorphs: [{
                name: "placeholder",
                textAndAttributes: ["Search Projects", {
                  fontSize: 22
                }]
              }]
            }, {
              name: "placeholder icon",
              padding: __varRecorder__$n.rect(2, 2, -2, -2),
              fontSize: 18
            }]
          }), {
            name: "fader bottom",
            extent: __varRecorder__$n.pt(871.9, 63.9),
            fill: new __varRecorder__$n.LinearGradient({
              stops: [{
                offset: 0,
                color: __varRecorder__$n.Color.rgb(112, 123, 124)
              }, {
                offset: 0.9073299632352941,
                color: __varRecorder__$n.Color.rgba(127, 127, 127, 0)
              }],
              vector: __varRecorder__$n.rect(0.498247508317511, 0.9999969287634702, 0.003504983364977972, -0.9999938575269406)
            }),
            position: __varRecorder__$n.pt(0, 506)
          }, __varRecorder__$n.part(__varRecorder__$n.RedButton, {
            name: "close button",
            extent: __varRecorder__$n.pt(94.6, 30),
            position: __varRecorder__$n.pt(14.9, 531),
            submorphs: [{
              name: "label",
              textAndAttributes: ["CLOSE", null]
            }]
          }), {
            name: "loading indicator",
            layout: new __varRecorder__$n.TilingLayout({
              align: "center",
              axisAlign: "center",
              hugContentsHorizontally: true,
              hugContentsVertically: true,
              orderByIndex: true,
              padding: __varRecorder__$n.rect(10, 5, 0, 0),
              spacing: 7
            }),
            borderRadius: 30,
            extent: __varRecorder__$n.pt(90.5, 10),
            fill: __varRecorder__$n.Color.rgba(0, 0, 0, 0.36),
            opacity: 1,
            position: __varRecorder__$n.pt(353.5, 253),
            submorphs: [__varRecorder__$n.part(__varRecorder__$n.Spinner, {
              name: "loading spinner",
              extent: __varRecorder__$n.pt(68.2, 70.2)
            }), {
              type: __varRecorder__$n.Label,
              name: "loading label",
              fontColor: __varRecorder__$n.Color.rgb(253, 254, 254),
              fontFamily: "\"IBM Plex Sans\"",
              fontSize: 23,
              fontWeight: "500",
              textString: "Loading..."
            }]
          }]
        });
      }, {
        module: "lively.ide/studio/world-browser.cp.js",
        "export": "WorldBrowser",
        range: {
          start: 39817,
          end: 45275
        }
      }, __varRecorder__$n.WorldBrowser);
      var WorldBrowser = __varRecorder__$n.WorldBrowser;
      __varRecorder__$n.WorldBrowser = WorldBrowser;
      __varRecorder__$n["default"] = WorldVersionViewer;

      var __varRecorder__$m = lively.FreezerRuntime.recorderFor("lively.ide/debug/console.cp.js");

      function formatTemplateString() {
        var template = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : "";
        var string = template;

        for (var _len = arguments.length, args = new Array(_len > 1 ? _len - 1 : 0), _key = 1; _key < _len; _key++) {
          args[_key - 1] = arguments[_key];
        }

        for (var i = 0; i < args.length; i++) {
          var idx = string.indexOf("%s");
          if (idx > -1) string = string.slice(0, idx) + String(args[i]) + string.slice(idx + 2);else string = string + " " + String(args[i]);
        }

        return string;
      }

      __varRecorder__$m.formatTemplateString = formatTemplateString;

      function installErrorCapture(target) {
        var _window = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : window;

        if (!target._errorHandler) {
          target._errorHandler = function errorHandler(errEvent, url, lineNumber, column, errorObj) {
            var err = errEvent.error || errEvent;
            var msg;
            if (err.stack) msg = String(err.stack);else if (url) msg = "".concat(err, " ").concat(url, ":").concat(lineNumber);else msg = String(err);
            if (typeof target.error === "function") target.error(msg);
          };

          _window.addEventListener("error", target._errorHandler);
        }

        if (!target._errorHandlerForPromises) {
          target._errorHandlerForPromises = function unhandledPromiseRejection(evt) {
            if (typeof target.error === "function") {
              target.error("unhandled promise rejection:\n" + evt.reason);
            }
          };

          _window.addEventListener("unhandledrejection", target._errorHandlerForPromises);
        }
      }

      __varRecorder__$m.installErrorCapture = installErrorCapture;

      function removeErrorCapture(target) {
        var _window = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : window;

        if (target._errorHandler) {
          _window.removeEventListener("error", target._errorHandler);

          delete target._errorHandler;
        }

        if (!target._errorHandlerForPromises) {
          _window.removeEventListener("unhandledrejection", target._errorHandlerForPromises);

          delete target._errorHandlerForPromises;
        }
      }

      __varRecorder__$m.removeErrorCapture = removeErrorCapture;

      function prepareConsole(platformConsole) {
        var consoleMethods = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : __varRecorder__$m.defaultConsoleMethods;

        var _window = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : window;

        var consumers = platformConsole.consumers = [];
        var simpleConsumers = platformConsole.simpleConsumers = [];

        function emptyFunc() {}

        function addWrappers() {
          if (platformConsole.wasWrapped) return;
          platformConsole.wasWrapped = true;
          var exceptions = ["removeWrappers", "addWrappers", "addConsumer", "removeConsumer"];
          var methods = Object.keys(platformConsole).filter(function (name) {
            return typeof platformConsole[name] === "function" && !name.startsWith("$") && !platformConsole.hasOwnProperty("$" + name) && !exceptions.includes(name);
          });
          var activationState = {};
          methods.forEach(function (name) {
            platformConsole["$" + name] = platformConsole[name];

            platformConsole[name] = function () {
              if (activationState[name]) return;
              activationState[name] = true;

              try {
                platformConsole["$" + name].apply(platformConsole, arguments);

                for (var i = 0; i < consumers.length; i++) {
                  var consumerFunc = consumers[i][name];

                  if (typeof consumerFunc === "function") {
                    consumerFunc.apply(consumers[i], arguments);
                  }
                }

                for (var _i = 0; _i < simpleConsumers.length; _i++) {
                  var _consumerFunc = simpleConsumers[_i][name];

                  if (typeof _consumerFunc === "function") {
                    _consumerFunc.call(simpleConsumers[_i], __varRecorder__$m.formatTemplateString.apply(null, arguments));
                  }
                }
              } finally {
                activationState[name] = false;
              }
            };
          });
        }

        function removeWrappers() {
          for (var name in platformConsole) {
            if (name[0] !== "$") continue;
            var realName = name.substring(1, name.length);
            platformConsole[realName] = platformConsole[name];
            delete platformConsole[name];
          }

          platformConsole.wasWrapped = true;
        }

        if (platformConsole.wasPrepared) return;
        platformConsole.wasPrepared = true;

        for (var i = 0; i < consoleMethods.length; i++) {
          if (!platformConsole[consoleMethods[i]]) {
            platformConsole[consoleMethods[i]] = emptyFunc;
          }
        }

        platformConsole.wasWrapped = false;
        platformConsole.removeWrappers = removeWrappers;
        platformConsole.addWrappers = addWrappers;

        platformConsole.addConsumer = function (c) {
          var simple = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : false;
          var subscribers = simple ? simpleConsumers : consumers;

          if (!subscribers.includes(c)) {
            subscribers.push(c);
            addWrappers();
          }

          __varRecorder__$m.installErrorCapture(c, _window);
        };

        platformConsole.removeConsumer = function (c) {
          var idx = consumers.indexOf(c);
          if (idx >= 0) consumers.splice(idx, 1);
          var idx2 = simpleConsumers.indexOf(c);
          if (idx2 >= 0) simpleConsumers.splice(idx2, 1);

          if (!consumers.length && !simpleConsumers.length) {
            removeWrappers();
          }

          __varRecorder__$m.removeErrorCapture(c, _window);
        };
      }

      __varRecorder__$m.prepareConsole = prepareConsole;
      __varRecorder__$m.ViewModel = ViewModel;
      __varRecorder__$m.Text = Text;
      __varRecorder__$m.component = component;
      __varRecorder__$m.obj = obj;
      __varRecorder__$m.string = string;
      __varRecorder__$m.pt = pt;
      __varRecorder__$m.Color = Color;
      __varRecorder__$m.defaultConsoleMethods = ["log", "group", "groupEnd", "warn", "assert", "error"];
      __varRecorder__$m.prepareConsole = prepareConsole;

      (function (superclass) {
        var __lively_classholder__ = lively.FreezerRuntime.recorderFor("lively.ide/debug/console.cp.js");

        var __lively_class__ = __lively_classholder__.hasOwnProperty("LocalJSConsoleModel") && typeof __lively_classholder__.LocalJSConsoleModel === "function" ? __lively_classholder__.LocalJSConsoleModel : __lively_classholder__.LocalJSConsoleModel = function LocalJSConsoleModel(__first_arg__) {
          if (__first_arg__ && __first_arg__[Symbol["for"]("lively-instance-restorer")]) ; else {
            return this[Symbol["for"]("lively-instance-initialize")].apply(this, arguments);
          }
        };

        return initializeClass(__lively_class__, superclass, [{
          key: "reset",
          value: function LocalJSConsoleModel_reset_() {
            this.logLimit = 1000;
            this.clear();
          }
        }, {
          key: "viewDidLoad",
          value: function LocalJSConsoleModel_viewDidLoad_() {
            console.wasWrapped = false;
            this.install();
          }
        }, {
          key: "onWindowClose",
          value: function LocalJSConsoleModel_onWindowClose_() {
            this.uninstall();
          }
        }, {
          key: "install",
          value: function LocalJSConsoleModel_install_() {
            if (!console.addConsumer) __varRecorder__$m.prepareConsole(console);
            console.addConsumer(this);
          }
        }, {
          key: "uninstall",
          value: function LocalJSConsoleModel_uninstall_() {
            if (console.removeConsumer) {
              console.removeConsumer(this);
            }
          }
        }, {
          key: "maybeTemplateMessage",
          value: function LocalJSConsoleModel_maybeTemplateMessage_(arg) {
            for (var _len2 = arguments.length, args = new Array(_len2 > 1 ? _len2 - 1 : 0), _key2 = 1; _key2 < _len2; _key2++) {
              args[_key2 - 1] = arguments[_key2];
            }

            var msg;

            if (typeof arg !== "string") {
              msg = __varRecorder__$m.obj.inspect(arg, {
                maxDepth: 2
              });
            } else if (args.length) {
              msg = __varRecorder__$m.string.formatFromArray(Array.from(arguments));
            } else msg = String(arg);

            return msg;
          }
        }, {
          key: "clear",
          value: function LocalJSConsoleModel_clear_() {
            this.view.textString = "";
          }
        }, {
          key: "log",
          value: function LocalJSConsoleModel_log_() {
            this.addLog(this.maybeTemplateMessage.apply(this, arguments));
          }
        }, {
          key: "warn",
          value: function LocalJSConsoleModel_warn_(template) {
            for (var _len3 = arguments.length, args = new Array(_len3 > 1 ? _len3 - 1 : 0), _key3 = 1; _key3 < _len3; _key3++) {
              args[_key3 - 1] = arguments[_key3];
            }

            this.addLog(this.maybeTemplateMessage.apply(this, arguments), {
              fontColor: "orange"
            });
          }
        }, {
          key: "error",
          value: function LocalJSConsoleModel_error_(template) {
            for (var _len4 = arguments.length, args = new Array(_len4 > 1 ? _len4 - 1 : 0), _key4 = 1; _key4 < _len4; _key4++) {
              args[_key4 - 1] = arguments[_key4];
            }

            this.addLog(this.maybeTemplateMessage.apply(this, arguments), {
              fontColor: "red",
              fontWeight: "bold"
            });
          }
        }, {
          key: "group",
          value: function LocalJSConsoleModel_group_(msg) {
            this.addLog("=> ".concat(msg));
          }
        }, {
          key: "groupEnd",
          value: function LocalJSConsoleModel_groupEnd_(msg) {
            this.addLog("<= ".concat(msg));
          }
        }, {
          key: "assert",
          value: function LocalJSConsoleModel_assert_(test, msg) {
            if (!test) this.error("Assert failed: " + msg);
          }
        }, {
          key: "keybindings",
          get: function get() {
            var _this = this;

            var viewKeybindings = this.withoutExposedPropsDo(function () {
              return _this.view.keybindings;
            });
            return [{
              keys: {
                mac: "Meta-K",
                win: "Ctrl-Alt-K"
              },
              command: "[console] clear"
            }].concat(_toConsumableArray(viewKeybindings));
          }
        }, {
          key: "commands",
          get: function get() {
            var _this2 = this;

            var viewCommands = this.withoutExposedPropsDo(function () {
              return _this2.view.commands;
            });
            return [{
              name: "[console] clear",
              exec: function exec() {
                _this2.clear();

                return true;
              }
            }].concat(_toConsumableArray(viewCommands));
          }
        }, {
          key: "menuItems",
          value: function () {
            var _LocalJSConsoleModel_menuItems_ = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee() {
              var _this3 = this;

              var viewItems;
              return regeneratorRuntime.wrap(function _callee$(_context) {
                while (1) {
                  switch (_context.prev = _context.next) {
                    case 0:
                      _context.next = 2;
                      return this.withoutExposedPropsDo(function () {
                        return _this3.view.menuItems();
                      });

                    case 2:
                      viewItems = _context.sent;
                      return _context.abrupt("return", [{
                        command: "[console] clear",
                        target: this,
                        alias: "clear"
                      }, {
                        isDivider: true
                      }].concat(_toConsumableArray(viewItems)));

                    case 4:
                    case "end":
                      return _context.stop();
                  }
                }
              }, _callee, this);
            }));

            function LocalJSConsoleModel_menuItems_() {
              return _LocalJSConsoleModel_menuItems_.apply(this, arguments);
            }

            return LocalJSConsoleModel_menuItems_;
          }()
        }, {
          key: "addLog",
          value: function LocalJSConsoleModel_addLog_(string, attr) {
            if (!string.endsWith("\n")) string += "\n";
            var t = this.view;
            var end = t.documentEndPosition;
            var scrollToEnd = t.cursorPosition.row === end.row;
            if (end.column > 0) end = {
              row: end.row + 1,
              column: 0
            };
            t.insertText(attr ? [string, attr] : string, end, false);

            if (t.lineCount() > this.logLimit) {
              t.deleteText({
                start: {
                  row: 0,
                  column: 0
                },
                end: {
                  row: t.lineCount() - this.logLimit,
                  column: 0
                }
              });
            }

            if (scrollToEnd) {
              t.gotoDocumentEnd();
              t.scrollCursorIntoView();
            }
          }
        }], [{
          key: Symbol["for"]("__LivelyClassName__"),
          get: function get() {
            return "LocalJSConsoleModel";
          }
        }, {
          key: "properties",
          get: function get() {
            return {
              logLimit: {
                defaultValue: 1000
              },
              expose: {
                get: function get() {
                  return ["onWindowClose", "clear", "commands", "menuItems", "keybindings"];
                }
              }
            };
          }
        }], __lively_classholder__, {
          pathInPackage: function pathInPackage() {
            return "./debug/console.cp.js";
          },
          unsubscribeFromToplevelDefinitionChanges: function unsubscribeFromToplevelDefinitionChanges() {
            return function () {};
          },
          subscribeToToplevelDefinitionChanges: function subscribeToToplevelDefinitionChanges() {
            return function () {};
          },
          "package": function _package() {
            return {
              name: "lively.ide",
              version: "0.1.0"
            };
          }
        }, {
          start: 6741,
          end: 10481
        });
      })(__varRecorder__$m.ViewModel);

      __varRecorder__$m.Console = __varRecorder__$m.component["for"](function () {
        return __varRecorder__$m.component({
          type: __varRecorder__$m.Text,
          name: "debug console",
          defaultViewModel: __varRecorder__$m.LocalJSConsoleModel,
          lineWrapping: "by-words",
          needsDocument: true,
          fixedWidth: true,
          fixedHeight: true,
          selectionMode: "native",
          extent: __varRecorder__$m.pt(500, 400),
          fill: __varRecorder__$m.Color.black.withA(0.9),
          fontColor: __varRecorder__$m.Color.white,
          clipMode: "auto"
        });
      }, {
        module: "lively.ide/debug/console.cp.js",
        "export": "Console",
        range: {
          start: 10489,
          end: 10812
        }
      }, __varRecorder__$m.Console);
      var Console = __varRecorder__$m.Console;
      __varRecorder__$m.Console = Console;

      var __varRecorder__$l = lively.FreezerRuntime.recorderFor("lively.ide/window-switcher.cp.js");
      __varRecorder__$l.component = component;
      __varRecorder__$l.ShadowObject = ShadowObject;
      __varRecorder__$l.Icon = Icon;
      __varRecorder__$l.Ellipse = Ellipse;
      __varRecorder__$l.Text = Text;
      __varRecorder__$l.easings = easings;
      __varRecorder__$l.part = part;
      __varRecorder__$l.TilingLayout = TilingLayout;
      __varRecorder__$l.HTMLMorph = HTMLMorph;
      __varRecorder__$l.ViewModel = ViewModel;
      __varRecorder__$l.Color = Color;
      __varRecorder__$l.Rectangle = Rectangle;
      __varRecorder__$l.rect = rect;
      __varRecorder__$l.pt = pt;
      __varRecorder__$l.InputLineDark = InputLineDark;

      (function (superclass) {
        var __lively_classholder__ = lively.FreezerRuntime.recorderFor("lively.ide/window-switcher.cp.js");

        var __lively_class__ = __lively_classholder__.hasOwnProperty("WindowPreviewModel") && typeof __lively_classholder__.WindowPreviewModel === "function" ? __lively_classholder__.WindowPreviewModel : __lively_classholder__.WindowPreviewModel = function WindowPreviewModel(__first_arg__) {
          if (__first_arg__ && __first_arg__[Symbol["for"]("lively-instance-restorer")]) ; else {
            return this[Symbol["for"]("lively-instance-initialize")].apply(this, arguments);
          }
        };

        return initializeClass(__lively_class__, superclass, [{
          key: "viewDidLoad",
          value: function WindowPreviewModel_viewDidLoad_() {
            this.view.withAllSubmorphsDo(function (m) {
              return m.halosEnabled = false;
            });
          }
        }, {
          key: "closeWindow",
          value: function WindowPreviewModel_closeWindow_(evt) {
            var _this = this;

            this.view.remove();
            this.windowSwitcher.windowsData = this.windowSwitcher.windowsData.filter(function (wD) {
              return wD.window !== _this.window;
            });
            this.window.close(false);
            this.windowSwitcher.closeIfNoWindowsAreDisplayed();
          }
        }, {
          key: "html",
          set: function set(val) {
            this.ui.htmlMorph.html = val;
          }
        }, {
          key: "html",
          get: function get() {
            return this.ui.htmlMorph.html;
          }
        }, {
          key: "onMouseDown",
          value: function WindowPreviewModel_onMouseDown_(evt) {
            if (evt.targetMorph === this.ui.closeButton) return;
            var window = this.window,
                windowSwitcher = this.windowSwitcher;
            windowSwitcher.close();
            window.activate(null, true);
            var translatedPos = window.world().visibleBoundsExcludingTopBar().translateForInclusion(window.bounds()).topLeft();
            window.topLeft = translatedPos;
          }
        }, {
          key: "onHoverIn",
          value: function WindowPreviewModel_onHoverIn_() {
            this.view.animate({
              dropShadow: {
                blur: 15,
                color: __varRecorder__$l.Color.rgba(0, 0, 0, 0.68),
                distance: 2,
                spread: 10,
                fast: false
              },
              duration: 200,
              easing: __varRecorder__$l.easings.inOut
            });
            this.ui.htmlMorph.animate({
              scale: 1.2,
              center: this.ui.htmlMorph.center,
              duration: 200,
              easing: __varRecorder__$l.easings.inOut
            });
            this.windowSwitcher.ui.hoveredWindowTitle.visible = true;
            this.windowSwitcher.ui.hoveredWindowTitle.textString = this.title;
            this.windowSwitcher.layoutTitlePreview();
          }
        }, {
          key: "onHoverOut",
          value: function WindowPreviewModel_onHoverOut_() {
            this.view.animate({
              dropShadow: {
                blur: 15,
                color: __varRecorder__$l.Color.transparent,
                distance: 0,
                spread: 0,
                fast: false
              },
              duration: 200,
              easing: __varRecorder__$l.easings.inOut
            });
            this.ui.htmlMorph.animate({
              scale: 1,
              center: this.ui.htmlMorph.center,
              duration: 200,
              easing: __varRecorder__$l.easings.inOut
            });
            this.windowSwitcher.ui.hoveredWindowTitle.visible = false;
          }
        }], [{
          key: Symbol["for"]("__LivelyClassName__"),
          get: function get() {
            return "WindowPreviewModel";
          }
        }, {
          key: "properties",
          get: function get() {
            return {
              windowSwitcher: {},
              window: {},
              title: {},
              expose: {
                get: function get() {
                  return ["html"];
                }
              },
              bindings: {
                get: function get() {
                  return [{
                    signal: "onHoverIn",
                    handler: "onHoverIn"
                  }, {
                    signal: "onHoverOut",
                    handler: "onHoverOut"
                  }, {
                    signal: "onMouseDown",
                    handler: "onMouseDown"
                  }, {
                    target: "close button",
                    signal: "onMouseDown",
                    handler: "closeWindow"
                  }];
                }
              }
            };
          }
        }], __lively_classholder__, {
          pathInPackage: function pathInPackage() {
            return "./window-switcher.cp.js";
          },
          unsubscribeFromToplevelDefinitionChanges: function unsubscribeFromToplevelDefinitionChanges() {
            return function () {};
          },
          subscribeToToplevelDefinitionChanges: function subscribeToToplevelDefinitionChanges() {
            return function () {};
          },
          "package": function _package() {
            return {
              name: "lively.ide",
              version: "0.1.0"
            };
          }
        }, {
          start: 274,
          end: 2793
        });
      })(__varRecorder__$l.ViewModel);

      __varRecorder__$l.WindowPreview = __varRecorder__$l.component["for"](function () {
        return __varRecorder__$l.component({
          name: "window preview",
          defaultViewModel: __varRecorder__$l.WindowPreviewModel,
          extent: __varRecorder__$l.pt(130, 130),
          fill: __varRecorder__$l.Color.transparent,
          submorphs: [{
            type: __varRecorder__$l.HTMLMorph,
            name: "html morph",
            extent: __varRecorder__$l.pt(100, 100),
            fill: __varRecorder__$l.Color.transparent
          }, {
            name: "overlay",
            fill: __varRecorder__$l.Color.transparent,
            extent: __varRecorder__$l.pt(130, 130),
            nativeCursor: "pointer"
          }, {
            name: "close button",
            type: __varRecorder__$l.Ellipse,
            position: __varRecorder__$l.pt(-15, -15),
            extent: __varRecorder__$l.pt(20, 20),
            fill: __varRecorder__$l.Color.black.withA(0.6),
            nativeCursor: "pointer",
            submorphs: [{
              type: "text",
              reactsToPointer: false,
              name: "label",
              lineHeight: 1,
              fontColor: __varRecorder__$l.Color.white,
              fill: __varRecorder__$l.Color.transparent,
              fontSize: 15,
              padding: __varRecorder__$l.rect(5, 3, -2.5, 0),
              textAndAttributes: __varRecorder__$l.Icon.textAttribute("times")
            }]
          }]
        });
      }, {
        module: "lively.ide/window-switcher.cp.js",
        "export": "WindowPreview",
        range: {
          start: 2839,
          end: 3671
        }
      }, __varRecorder__$l.WindowPreview);

      (function (superclass) {
        var __lively_classholder__ = lively.FreezerRuntime.recorderFor("lively.ide/window-switcher.cp.js");

        var __lively_class__ = __lively_classholder__.hasOwnProperty("WindowSwitcherModel") && typeof __lively_classholder__.WindowSwitcherModel === "function" ? __lively_classholder__.WindowSwitcherModel : __lively_classholder__.WindowSwitcherModel = function WindowSwitcherModel(__first_arg__) {
          if (__first_arg__ && __first_arg__[Symbol["for"]("lively-instance-restorer")]) ; else {
            return this[Symbol["for"]("lively-instance-initialize")].apply(this, arguments);
          }
        };

        return initializeClass(__lively_class__, superclass, [{
          key: "onMouseDown",
          value: function WindowSwitcherModel_onMouseDown_(evt) {
            if (evt.targetMorph === this.view) this.close();
          }
        }, {
          key: "closeIfNoWindowsAreDisplayed",
          value: function WindowSwitcherModel_closeIfNoWindowsAreDisplayed_() {
            if (this.windowsData.length === 0) this.close();
          }
        }, {
          key: "filterWindows",
          value: function WindowSwitcherModel_filterWindows_() {
            var _this2 = this;

            var input = this.ui.searchField.textString;

            if (!input) {
              this.ui.clearButton.visible = false;
              this.windowsData.forEach(function (winData) {
                if (!winData.preview.world()) _this2.ui.previewHolder.addMorph(winData.preview);
              });
              return;
            }

            this.ui.clearButton.visible = true;
            this.windowsData.forEach(function (winData) {
              if (!winData.title.toLowerCase().includes(input.toLowerCase())) winData.preview.remove();else _this2.ui.previewHolder.addMorph(winData.preview);
            });
          }
        }, {
          key: "clearSearch",
          value: function WindowSwitcherModel_clearSearch_() {
            this.ui.searchField.textString = "";
          }
        }, {
          key: "arrangeWindows",
          value: function WindowSwitcherModel_arrangeWindows_() {
            var _this3 = this;

            var windows = $world.submorphs.filter(function (_ref) {
              var isWindow = _ref.isWindow;
              return isWindow;
            });
            this.windowsData = windows.map(function (win) {
              return {
                render: win.minimized ? win._previewHTML : win.generatePreviewHTML(),
                title: win.title,
                window: win
              };
            });
            this.windowsData.forEach(function (winData) {
              winData.preview = __varRecorder__$l.part(__varRecorder__$l.WindowPreview, {
                viewModel: {
                  windowSwitcher: _this3,
                  window: winData.window,
                  title: winData.title
                }
              });
              winData.preview.html = winData.render;
            });
            this.windowsData.forEach(function (winData) {
              return _this3.ui.previewHolder.addMorph(winData.preview);
            });
          }
        }, {
          key: "viewDidLoad",
          value: function WindowSwitcherModel_viewDidLoad_() {
            this.reopenSceneGraph = $world.activeSideBars.includes("scene graph");
            this.reopenPropertiesPanel = $world.activeSideBars.includes("properties panel");
            if (this.reopenSceneGraph) $world.sceneGraphFlap.executeAction();
            if (this.reopenPropertiesPanel) $world.propertiesPanelFlap.executeAction();
            this.view.position = __varRecorder__$l.pt(0, 0), this.view.extent = __varRecorder__$l.pt($world.width, $world.height);
            this.layoutPreviewHolder();
            this.layoutSearchBar();
            $world.blur = 20;
            this.ui.searchField.focus();
            this.arrangeWindows();
          }
        }, {
          key: "layoutTitlePreview",
          value: function WindowSwitcherModel_layoutTitlePreview_() {
            var title = this.ui.hoveredWindowTitle;
            title.center = this.view.center;
            title.top = 150;
          }
        }, {
          key: "layoutSearchBar",
          value: function WindowSwitcherModel_layoutSearchBar_() {
            var searchBar = this.ui.searchField;
            searchBar.center = this.view.center;
            searchBar.position.y = 60;
            var clearButton = this.ui.clearButton;
            clearButton.top = searchBar.position.y + (65 / 2 - 35 / 2);
            clearButton.left = searchBar.right - 35 - 35 / 2;
          }
        }, {
          key: "layoutPreviewHolder",
          value: function WindowSwitcherModel_layoutPreviewHolder_() {
            var previewHolder = this.ui.previewHolder;
            var extent = this.view.extent;
            previewHolder.extent = __varRecorder__$l.pt(extent.x - 80, extent.y - 230);
            previewHolder.position = __varRecorder__$l.pt(40, 200);
          }
        }, {
          key: "close",
          value: function WindowSwitcherModel_close_() {
            if (this.reopenSceneGraph) $world.sceneGraphFlap.executeAction();
            if (this.reopenPropertiesPanel) $world.propertiesPanelFlap.executeAction();
            this.view.remove();
            $world.blur = 0;
            $world.focus();
          }
        }, {
          key: "keybindings",
          get: function get() {
            return [{
              keys: "Escape",
              command: "close"
            }];
          }
        }, {
          key: "commands",
          get: function get() {
            var _this4 = this;

            return [{
              name: "close",
              exec: function exec() {
                return _this4.close();
              }
            }];
          }
        }], [{
          key: Symbol["for"]("__LivelyClassName__"),
          get: function get() {
            return "WindowSwitcherModel";
          }
        }, {
          key: "properties",
          get: function get() {
            return {
              bindings: {
                get: function get() {
                  return [{
                    target: "search field",
                    signal: "inputChanged",
                    handler: "filterWindows"
                  }, {
                    target: "clear button",
                    signal: "onMouseDown",
                    handler: "clearSearch"
                  }, {
                    signal: "onMouseDown",
                    handler: "onMouseDown"
                  }];
                }
              },
              expose: {
                get: function get() {
                  return ["arrangeWindows", "keybindings", "commands", "close", "layoutTitlePreview", "windowsData"];
                }
              }
            };
          }
        }], __lively_classholder__, {
          pathInPackage: function pathInPackage() {
            return "./window-switcher.cp.js";
          },
          unsubscribeFromToplevelDefinitionChanges: function unsubscribeFromToplevelDefinitionChanges() {
            return function () {};
          },
          subscribeToToplevelDefinitionChanges: function subscribeToToplevelDefinitionChanges() {
            return function () {};
          },
          "package": function _package() {
            return {
              name: "lively.ide",
              version: "0.1.0"
            };
          }
        }, {
          start: 3674,
          end: 7436
        });
      })(__varRecorder__$l.ViewModel);

      var WindowSwitcher = __varRecorder__$l.component["for"](function () {
        return __varRecorder__$l.component({
          name: "window switcher",
          hasFixedPosition: true,
          defaultViewModel: __varRecorder__$l.WindowSwitcherModel,
          halosEnabled: false,
          fill: __varRecorder__$l.Color.rgb(30, 30, 30).withA(0.2),
          position: __varRecorder__$l.pt(0, 0),
          extent: __varRecorder__$l.pt(1600, 900),
          submorphs: [__varRecorder__$l.part(__varRecorder__$l.InputLineDark, {
            name: "search field",
            placeholder: "Search Windows...",
            fontSize: 40,
            borderRadius: 15,
            extent: __varRecorder__$l.pt(650, 65),
            position: __varRecorder__$l.pt(650, 230),
            dropShadow: new __varRecorder__$l.ShadowObject({
              distance: 3,
              rotation: 75,
              color: __varRecorder__$l.Color.rgba(0, 0, 0, 0.2),
              blur: 20
            }),
            haloShadow: new __varRecorder__$l.ShadowObject({
              distance: 4,
              color: __varRecorder__$l.Color.rgb(52, 152, 219),
              blur: 20
            })
          }), {
            name: "clear button",
            type: __varRecorder__$l.Ellipse,
            extent: __varRecorder__$l.pt(35, 35),
            visible: false,
            fill: __varRecorder__$l.Color.rgb(30, 30, 30).withA(0.6),
            halosEnabled: false,
            submorphs: [{
              type: "text",
              reactsToPointer: false,
              name: "label",
              fontColor: __varRecorder__$l.Color.white,
              fill: __varRecorder__$l.Color.transparent,
              fontSize: 30,
              halosEnabled: false,
              autoWidth: true,
              padding: __varRecorder__$l.rect(8, 2, -8, -6),
              textAndAttributes: __varRecorder__$l.Icon.textAttribute("times")
            }]
          }, {
            name: "preview holder",
            extent: __varRecorder__$l.pt(1000, 500),
            position: __varRecorder__$l.pt(30, 40),
            borderRadius: 3,
            fill: __varRecorder__$l.Color.transparent,
            reactsToPointer: false,
            layout: new __varRecorder__$l.TilingLayout({
              wrapSubmorphs: true,
              padding: __varRecorder__$l.Rectangle.inset(10, 10, 10, 10)
            }),
            clipMode: "auto",
            halosEnabled: false
          }, {
            name: "hovered window title",
            type: __varRecorder__$l.Text,
            padding: 5,
            borderRadius: 3,
            visible: false,
            fill: __varRecorder__$l.Color.rgba(0, 0, 0, 0.68),
            fontColor: __varRecorder__$l.Color.white,
            fontSize: 20,
            autoWidth: true
          }]
        });
      }, {
        module: "lively.ide/window-switcher.cp.js",
        "export": "WindowSwitcher",
        range: {
          start: 7451,
          end: 9159
        }
      }, __varRecorder__$l.WindowSwitcher);
      __varRecorder__$l.WindowSwitcher = WindowSwitcher;
      __varRecorder__$l.WindowSwitcher = WindowSwitcher;

      var __varRecorder__$k = lively.FreezerRuntime.recorderFor("lively.user/user-flap.cp.js");
      __varRecorder__$k.ViewModel = ViewModel;
      __varRecorder__$k.ShadowObject = ShadowObject;
      __varRecorder__$k.Image = Image;
      __varRecorder__$k.Icon = Icon;
      __varRecorder__$k.Label = Label;
      __varRecorder__$k.TilingLayout = TilingLayout;
      __varRecorder__$k.component = component;
      __varRecorder__$k.pt = pt;
      __varRecorder__$k.Color = Color;
      __varRecorder__$k.currentUser = currentUser;
      __varRecorder__$k.isUserLoggedIn = isUserLoggedIn;
      __varRecorder__$k.clearUserData = clearUserData;
      __varRecorder__$k.clearAllUserData = clearAllUserData;
      __varRecorder__$k.storeCurrentUser = storeCurrentUser;
      __varRecorder__$k.storeCurrentUsersOrganizations = storeCurrentUsersOrganizations;
      __varRecorder__$k.currentUserToken = currentUserToken;
      __varRecorder__$k.storeCurrentUserToken = storeCurrentUserToken;
      __varRecorder__$k.signal = signal;
      __varRecorder__$k.runCommand = runCommand;
      __varRecorder__$k.StatusMessageError = StatusMessageError;
      __varRecorder__$k.part = part;
      __varRecorder__$k.Spinner = Spinner;
      __varRecorder__$k.rect = rect;
      __varRecorder__$k.waitFor = waitFor;
      __varRecorder__$k.delay = delay;
      __varRecorder__$k.timeToRun = timeToRun;
      __varRecorder__$k.DarkPrompt = DarkPrompt;
      __varRecorder__$k.ConfirmPrompt = ConfirmPrompt;
      __varRecorder__$k.SystemButton = SystemButton;
      __varRecorder__$k.livelyAuthGithubAppId = "d523a69022b9ef6be515";
      __varRecorder__$k.CompactConfirmPrompt = __varRecorder__$k.component["for"](function () {
        return __varRecorder__$k.component(__varRecorder__$k.ConfirmPrompt, {
          master: __varRecorder__$k.DarkPrompt,
          layout: new __varRecorder__$k.TilingLayout({
            align: "center",
            axis: "column",
            axisAlign: "center",
            hugContentsHorizontally: true,
            hugContentsVertically: true,
            orderByIndex: true,
            padding: __varRecorder__$k.rect(15, 15, 0, 0),
            resizePolicies: [["prompt title", {
              height: "fixed",
              width: "fill"
            }], ["button wrapper", {
              height: "fixed",
              width: "fill"
            }]],
            spacing: 16
          }),
          submorphs: [{
            name: "prompt title",
            fixedWidth: true,
            fixedHeight: true,
            height: 90
          }]
        });
      }, {
        module: "lively.user/user-flap.cp.js",
        "export": "CompactConfirmPrompt",
        range: {
          start: 956,
          end: 1543
        }
      }, __varRecorder__$k.CompactConfirmPrompt);

      (function (superclass) {
        var __lively_classholder__ = lively.FreezerRuntime.recorderFor("lively.user/user-flap.cp.js");

        var __lively_class__ = __lively_classholder__.hasOwnProperty("UserFlapModel") && typeof __lively_classholder__.UserFlapModel === "function" ? __lively_classholder__.UserFlapModel : __lively_classholder__.UserFlapModel = function UserFlapModel(__first_arg__) {
          if (__first_arg__ && __first_arg__[Symbol["for"]("lively-instance-restorer")]) ; else {
            return this[Symbol["for"]("lively-instance-initialize")].apply(this, arguments);
          }
        };

        return initializeClass(__lively_class__, superclass, [{
          key: "update",
          value: function () {
            var _UserFlapModel_update_ = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee() {
              return regeneratorRuntime.wrap(function _callee$(_context) {
                while (1) {
                  switch (_context.prev = _context.next) {
                    case 0:
                      __varRecorder__$k.clearUserData();

                      _context.next = 3;
                      return this.retrieveGithubUserData();

                    case 3:
                      this.showUserData();

                    case 4:
                    case "end":
                      return _context.stop();
                  }
                }
              }, _callee, this);
            }));

            function UserFlapModel_update_() {
              return _UserFlapModel_update_.apply(this, arguments);
            }

            return UserFlapModel_update_;
          }()
        }, {
          key: "leftUserLabelClicked",
          value: function UserFlapModel_leftUserLabelClicked_() {
            if (!__varRecorder__$k.isUserLoggedIn()) this.login();
          }
        }, {
          key: "rightUserLabelClicked",
          value: function UserFlapModel_rightUserLabelClicked_() {
            if (__varRecorder__$k.isUserLoggedIn()) this.logout();
          }
        }, {
          key: "toggleLoadingAnimation",
          value: function UserFlapModel_toggleLoadingAnimation_() {
            var _this$ui = this.ui,
                spinner = _this$ui.spinner,
                avatar = _this$ui.avatar;
            spinner.visible = !spinner.visible;
            avatar.visible = this.withLoginButton ? false : !avatar.visible;
          }
        }, {
          key: "viewDidLoad",
          value: function () {
            var _UserFlapModel_viewDidLoad_ = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee2() {
              var _this$ui2, loginButton, leftUserLabel, rightUserLabel, avatar;

              return regeneratorRuntime.wrap(function _callee2$(_context2) {
                while (1) {
                  switch (_context2.prev = _context2.next) {
                    case 0:
                      _this$ui2 = this.ui, loginButton = _this$ui2.loginButton, leftUserLabel = _this$ui2.leftUserLabel, rightUserLabel = _this$ui2.rightUserLabel, avatar = _this$ui2.avatar;

                      if (__varRecorder__$k.isUserLoggedIn()) {
                        _context2.next = 5;
                        break;
                      }

                      if (this.withLoginButton) {
                        avatar.visible = false;
                        loginButton.visible = loginButton.isLayoutable = true;
                        leftUserLabel.visible = rightUserLabel.visible = false;
                      } else {
                        leftUserLabel.tooltip = "Login with GitHub";
                        rightUserLabel.tooltip = "";
                      }

                      _context2.next = 12;
                      break;

                    case 5:
                      _context2.next = 7;
                      return this.update();

                    case 7:
                      this.showUserData();
                      leftUserLabel.tooltip = "";
                      rightUserLabel.tooltip = "Logout";
                      rightUserLabel.nativeCursor = "pointer";
                      leftUserLabel.nativeCursor = "auto";

                    case 12:
                    case "end":
                      return _context2.stop();
                  }
                }
              }, _callee2, this);
            }));

            function UserFlapModel_viewDidLoad_() {
              return _UserFlapModel_viewDidLoad_.apply(this, arguments);
            }

            return UserFlapModel_viewDidLoad_;
          }()
        }, {
          key: "login",
          value: function () {
            var _UserFlapModel_login_ = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee3() {
              var cmdString, _yield$__varRecorder_, resOne, deviceCodeMatch, userCodeMatch, deviceCode, userCode, interval, confirm, curlCmd, loginSuccessful, i, elapsedTimeWaitingForGitHub, _$world$get, _curlCmd, resTwo, userToken;

              return regeneratorRuntime.wrap(function _callee3$(_context3) {
                while (1) {
                  switch (_context3.prev = _context3.next) {
                    case 0:
                      if (!$world.get("github login prompt")) {
                        _context3.next = 2;
                        break;
                      }

                      return _context3.abrupt("return");

                    case 2:
                      cmdString = "curl -X POST -F 'client_id=".concat(__varRecorder__$k.livelyAuthGithubAppId, "' -F 'scope=user,repo,workflow' https://github.com/login/device/code");
                      _context3.next = 5;
                      return __varRecorder__$k.runCommand(cmdString).whenDone();

                    case 5:
                      _yield$__varRecorder_ = _context3.sent;
                      resOne = _yield$__varRecorder_.stdout;

                      if (!(resOne === "")) {
                        _context3.next = 10;
                        break;
                      }

                      $world.setStatusMessage("You seem to be offline.", __varRecorder__$k.StatusMessageError);
                      return _context3.abrupt("return");

                    case 10:
                      if (!(resOne === "NOT FOUND")) {
                        _context3.next = 13;
                        break;
                      }

                      $world.setStatusMessage("An unexpected error occured. Please contact the lively.next team.", __varRecorder__$k.StatusMessageError);
                      return _context3.abrupt("return");

                    case 13:
                      deviceCodeMatch = resOne.match(new RegExp("device_code=(.*)&e"));
                      userCodeMatch = resOne.match(new RegExp("user_code=(.*)&"));

                      if (!(!deviceCodeMatch || !userCodeMatch)) {
                        _context3.next = 18;
                        break;
                      }

                      $world.setStatusMessage("An unexpected error occured. Please contact the lively.next team.", __varRecorder__$k.StatusMessageError);
                      return _context3.abrupt("return");

                    case 18:
                      deviceCode = deviceCodeMatch[1];
                      userCode = userCodeMatch[1];
                      interval = resOne.match(/interval=(\d*)&/)[1];
                      this.toggleLoadingAnimation();
                      window.open("https://github.com/login/device", "Github Authentification", "width=500,height=600,top=100,left=100");
                      $world.confirm(["Enter \n", null, "".concat(userCode), {
                        fontColor: __varRecorder__$k.Color.lively
                      }, "\nin the popup to login!", null], {
                        name: "github login prompt",
                        customize: function customize(prompt) {
                          prompt.master = __varRecorder__$k.CompactConfirmPrompt;
                          prompt.width = 300;
                          prompt.position = $world.visibleBounds().center().subXY(150, prompt.height / 2);
                        }
                      }).then(function (conf) {
                        confirm = conf;
                      });
                      cmdString = "curl -X POST -F 'client_id=".concat(__varRecorder__$k.livelyAuthGithubAppId, "' -F 'device_code=").concat(deviceCode, "' -F 'grant_type=urn:ietf:params:oauth:grant-type:device_code' https://github.com/login/oauth/access_token");
                      loginSuccessful = false;
                      i = 0;

                    case 27:
                      if (!(i < 20)) {
                        _context3.next = 49;
                        break;
                      }

                      _context3.next = 30;
                      return __varRecorder__$k.timeToRun(__varRecorder__$k.waitFor(interval * 1000, function () {
                        return confirm !== undefined;
                      }, false));

                    case 30:
                      elapsedTimeWaitingForGitHub = _context3.sent;

                      if (!(confirm === true)) {
                        _context3.next = 35;
                        break;
                      }

                      if (!(elapsedTimeWaitingForGitHub < interval * 1000)) {
                        _context3.next = 35;
                        break;
                      }

                      _context3.next = 35;
                      return __varRecorder__$k.delay(interval * 1000 - elapsedTimeWaitingForGitHub);

                    case 35:
                      if (!(confirm === false)) {
                        _context3.next = 39;
                        break;
                      }

                      this.toggleLoadingAnimation();
                      $world.setStatusMessage("Login aborted by user.");
                      return _context3.abrupt("return");

                    case 39:
                      _context3.next = 41;
                      return __varRecorder__$k.runCommand(cmdString).whenDone();

                    case 41:
                      curlCmd = _context3.sent;

                      if (!(curlCmd.exitCode === 0 && !curlCmd.stdout.includes("error"))) {
                        _context3.next = 46;
                        break;
                      }

                      loginSuccessful = true;
                      (_$world$get = $world.get("github login prompt")) === null || _$world$get === void 0 ? void 0 : _$world$get.remove();
                      return _context3.abrupt("break", 49);

                    case 46:
                      i++;
                      _context3.next = 27;
                      break;

                    case 49:
                      if (loginSuccessful) {
                        _context3.next = 53;
                        break;
                      }

                      this.toggleLoadingAnimation();
                      $world.setStatusMessage("Login failed.", __varRecorder__$k.StatusMessageError);
                      return _context3.abrupt("return");

                    case 53:
                      _curlCmd = curlCmd, resTwo = _curlCmd.stdout;
                      userToken = resTwo.match(new RegExp("access_token=(.*)&s"))[1];

                      if (userToken) {
                        _context3.next = 59;
                        break;
                      }

                      this.toggleLoadingAnimation();
                      $world.setStatusMessage("An unexpected error occured. Please contact the lively.next team.", __varRecorder__$k.StatusMessageError);
                      return _context3.abrupt("return");

                    case 59:
                      __varRecorder__$k.storeCurrentUserToken(userToken);

                      _context3.next = 62;
                      return this.retrieveGithubUserData();

                    case 62:
                      this.toggleLoadingAnimation();
                      this.showLoggedInUser();

                    case 64:
                    case "end":
                      return _context3.stop();
                  }
                }
              }, _callee3, this);
            }));

            function UserFlapModel_login_() {
              return _UserFlapModel_login_.apply(this, arguments);
            }

            return UserFlapModel_login_;
          }()
        }, {
          key: "showLoggedInUser",
          value: function UserFlapModel_showLoggedInUser_() {
            var _this$ui3 = this.ui,
                leftUserLabel = _this$ui3.leftUserLabel,
                rightUserLabel = _this$ui3.rightUserLabel,
                avatar = _this$ui3.avatar,
                loginButton = _this$ui3.loginButton;
            leftUserLabel.visible = rightUserLabel.visible = avatar.visible = true;
            loginButton.visible = loginButton.isLayoutable = false;
            this.showUserData();

            __varRecorder__$k.signal(this.view, "onLogin");

            rightUserLabel.tooltip = "Logout";
            leftUserLabel.tooltip = "";
            rightUserLabel.nativeCursor = "pointer";
            leftUserLabel.nativeCursor = "auto";
          }
        }, {
          key: "retrieveGithubUserData",
          value: function () {
            var _UserFlapModel_retrieveGithubUserData_ = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee4() {
              var token, cmdString, _yield$__varRecorder_2, userRes, organizationCmdString, _yield$__varRecorder_3, orgsResForUser, orgNames;

              return regeneratorRuntime.wrap(function _callee4$(_context4) {
                while (1) {
                  switch (_context4.prev = _context4.next) {
                    case 0:
                      token = __varRecorder__$k.currentUserToken();
                      cmdString = "curl -H \"Accept: application/vnd.github+json\" -H \"Authorization: Bearer ".concat(token, "\" https://api.github.com/user");
                      _context4.next = 4;
                      return __varRecorder__$k.runCommand(cmdString).whenDone();

                    case 4:
                      _yield$__varRecorder_2 = _context4.sent;
                      userRes = _yield$__varRecorder_2.stdout;

                      if (!(!userRes || userRes === "")) {
                        _context4.next = 9;
                        break;
                      }

                      $world.setStatusMessage("An unexpected error occured. Please check your connection.", __varRecorder__$k.StatusMessageError);
                      return _context4.abrupt("return");

                    case 9:
                      organizationCmdString = "curl -L       -H \"Accept: application/vnd.github+json\"       -H \"Authorization: Bearer ".concat(token, "\"      -H \"X-GitHub-Api-Version: 2022-11-28\"       https://api.github.com/user/orgs");
                      _context4.next = 12;
                      return __varRecorder__$k.runCommand(organizationCmdString).whenDone();

                    case 12:
                      _yield$__varRecorder_3 = _context4.sent;
                      orgsResForUser = _yield$__varRecorder_3.stdout;

                      if (!(!userRes || userRes === "")) {
                        _context4.next = 17;
                        break;
                      }

                      $world.setStatusMessage("An unexpected error occured. Please check your connection.", __varRecorder__$k.StatusMessageError);
                      return _context4.abrupt("return");

                    case 17:
                      orgNames = JSON.parse(orgsResForUser).map(function (org) {
                        return org.login;
                      });

                      __varRecorder__$k.storeCurrentUsersOrganizations(orgNames);

                      __varRecorder__$k.storeCurrentUser(userRes);

                    case 20:
                    case "end":
                      return _context4.stop();
                  }
                }
              }, _callee4);
            }));

            function UserFlapModel_retrieveGithubUserData_() {
              return _UserFlapModel_retrieveGithubUserData_.apply(this, arguments);
            }

            return UserFlapModel_retrieveGithubUserData_;
          }()
        }, {
          key: "logout",
          value: function UserFlapModel_logout_() {
            __varRecorder__$k.clearAllUserData();

            this.showGuestUser();

            __varRecorder__$k.signal(this.view, "onLogout");

            $world.setStatusMessage("Logged out. No git operations possible.");
          }
        }, {
          key: "showGuestUser",
          value: function UserFlapModel_showGuestUser_() {
            var _this$ui4 = this.ui,
                loginButton = _this$ui4.loginButton,
                leftUserLabel = _this$ui4.leftUserLabel,
                rightUserLabel = _this$ui4.rightUserLabel,
                avatar = _this$ui4.avatar;

            if (this.withLoginButton) {
              leftUserLabel.visible = rightUserLabel.visible = avatar.visible = false;
              loginButton.visible = loginButton.isLayoutable = true;
            } else {
              leftUserLabel.tooltip = "Login with GitHub";
              rightUserLabel.tooltip = "";
              leftUserLabel.nativeCursor = "pointer";
              rightUserLabel.nativeCursor = "auto";
              leftUserLabel.textAndAttributes = __varRecorder__$k.Icon.textAttribute("github");
              rightUserLabel.textString = "guest";
              avatar.loadUrl("https://s.gravatar.com/avatar/d41d8cd98f00b204e9800998ecf8427e?s=160", false);
            }
          }
        }, {
          key: "showUserData",
          value: function UserFlapModel_showUserData_() {
            var _this$ui5 = this.ui,
                avatar = _this$ui5.avatar,
                leftUserLabel = _this$ui5.leftUserLabel,
                rightUserLabel = _this$ui5.rightUserLabel;

            try {
              var userData = __varRecorder__$k.currentUser();

              if (!__varRecorder__$k.isUserLoggedIn()) return;
              avatar.loadUrl(userData.avatar_url, false);
              leftUserLabel.textString = userData.login;
              rightUserLabel.textAndAttributes = __varRecorder__$k.Icon.textAttribute("right-from-bracket");
            } catch (err) {
              $world.setStatusMessage("An unexpected error occured. Please contact the lively.next team.", __varRecorder__$k.StatusMessageError);
            }
          }
        }, {
          key: "updateNetworkIndicator",
          value: function UserFlapModel_updateNetworkIndicator_(l2lClient) {
            var color = "red";

            if (l2lClient) {
              if (l2lClient.isOnline()) color = "yellow";
              if (l2lClient.isRegistered()) color = "green";
            }

            this.ui.networkIndicator.animate({
              fill: __varRecorder__$k.Color[color],
              duration: 300
            });
          }
        }], [{
          key: Symbol["for"]("__LivelyClassName__"),
          get: function get() {
            return "UserFlapModel";
          }
        }, {
          key: "properties",
          get: function get() {
            return {
              withLoginButton: {
                defaultValue: false
              },
              bindings: {
                get: function get() {
                  return [{
                    target: "login button",
                    signal: "onMouseDown",
                    handler: "login"
                  }, {
                    target: "left user label",
                    signal: "onMouseDown",
                    handler: "leftUserLabelClicked"
                  }, {
                    target: "right user label",
                    signal: "onMouseDown",
                    handler: "rightUserLabelClicked"
                  }];
                }
              },
              expose: {
                get: function get() {
                  return ["updateNetworkIndicator", "showUserData", "onLogin", "showLoggedInUser", "showGuestUser", "toggleLoadingAnimation", "login", "update"];
                }
              }
            };
          }
        }], __lively_classholder__, {
          pathInPackage: function pathInPackage() {
            return "./user-flap.cp.js";
          },
          unsubscribeFromToplevelDefinitionChanges: function unsubscribeFromToplevelDefinitionChanges() {
            return function () {};
          },
          subscribeToToplevelDefinitionChanges: function subscribeToToplevelDefinitionChanges() {
            return function () {};
          },
          "package": function _package() {
            return {
              name: "lively.user",
              version: "2.0.0"
            };
          }
        }, {
          start: 1546,
          end: 10465
        });
      })(__varRecorder__$k.ViewModel);

      var UserFlap = __varRecorder__$k.component["for"](function () {
        return __varRecorder__$k.component({
          name: "user flap",
          defaultViewModel: __varRecorder__$k.UserFlapModel,
          borderWidth: 0,
          position: __varRecorder__$k.pt(580.2, 897.3),
          borderRadius: 7,
          clipMode: "hidden",
          extent: __varRecorder__$k.pt(362.3, 52.3),
          fill: __varRecorder__$k.Color.transparent,
          fontColor: __varRecorder__$k.Color.rgb(102, 102, 102),
          layout: new __varRecorder__$k.TilingLayout({
            align: "right",
            axisAlign: "center",
            hugContentsHorizontally: true,
            orderByIndex: true,
            padding: __varRecorder__$k.rect(10, 10, 0, 0),
            spacing: 10
          }),
          submorphs: [{
            name: "network-indicator",
            borderRadius: 5,
            extent: __varRecorder__$k.pt(5, 5),
            fill: __varRecorder__$k.Color.rgb(0, 204, 0),
            reactsToPointer: false
          }, {
            type: __varRecorder__$k.Label,
            name: "left user label",
            draggable: true,
            fontColor: {
              onlyAtInstantiation: true,
              value: __varRecorder__$k.Color.rgb(102, 102, 102)
            },
            fontSize: 16,
            nativeCursor: "pointer",
            textAndAttributes: __varRecorder__$k.Icon.textAttribute("github")
          }, {
            type: __varRecorder__$k.Label,
            name: "right user label",
            fontColor: __varRecorder__$k.Color.rgb(102, 102, 102),
            fontSize: 16,
            textAndAttributes: ["guest", null]
          }, {
            type: __varRecorder__$k.Image,
            name: "avatar",
            borderRadius: 25,
            clipMode: "hidden",
            dropShadow: new __varRecorder__$k.ShadowObject({
              rotation: 72,
              color: __varRecorder__$k.Color.rgba(0, 0, 0, 0.47),
              blur: 5
            }),
            extent: __varRecorder__$k.pt(30, 30),
            fill: __varRecorder__$k.Color.transparent,
            imageUrl: "https://s.gravatar.com/avatar/d41d8cd98f00b204e9800998ecf8427e?s=160",
            naturalExtent: __varRecorder__$k.pt(160, 160)
          }, __varRecorder__$k.part(__varRecorder__$k.Spinner, {
            viewModel: {
              color: "black"
            },
            name: "spinner",
            visible: false,
            position: __varRecorder__$k.pt(5.3, 4.2),
            scale: 0.3
          }), __varRecorder__$k.part(__varRecorder__$k.SystemButton, {
            name: "login button",
            extent: __varRecorder__$k.pt(230, 40),
            isLayoutable: false,
            visible: false,
            submorphs: [{
              name: "label",
              fontSize: 18,
              fontWeight: 900,
              textAndAttributes: ["To proceed, login with", null, " \uF09B", {
                fontFamily: "\"Font Awesome 6 Free\", \"Font Awesome 6 Brands\""
              }]
            }]
          })]
        });
      }, {
        module: "lively.user/user-flap.cp.js",
        "export": "UserFlap",
        range: {
          start: 10480,
          end: 12390
        }
      }, __varRecorder__$k.UserFlap);
      __varRecorder__$k.UserFlap = UserFlap;
      __varRecorder__$k.UserFlap = UserFlap;

      var __varRecorder__$j = lively.FreezerRuntime.recorderFor("lively.project/prompts.cp.js");
      __varRecorder__$j.component = component;
      __varRecorder__$j.ShadowObject = ShadowObject;
      __varRecorder__$j.TilingLayout = TilingLayout;
      __varRecorder__$j.add = add;
      __varRecorder__$j.part = part;
      __varRecorder__$j.AbstractPromptModel = AbstractPromptModel;
      __varRecorder__$j.OKCancelButtonWrapper = OKCancelButtonWrapper;
      __varRecorder__$j.LightPrompt = LightPrompt;
      __varRecorder__$j.Color = Color;
      __varRecorder__$j.pt = pt;
      __varRecorder__$j.InputLineDefault = InputLineDefault;
      __varRecorder__$j.InformIconOnLight = InformIconOnLight;
      __varRecorder__$j.UserFlap = UserFlap;
      __varRecorder__$j.rect = rect;
      __varRecorder__$j.SaveWorldDialog = SaveWorldDialog;
      __varRecorder__$j.without = without;
      __varRecorder__$j.Label = Label;
      __varRecorder__$j.Checkbox = Checkbox;
      __varRecorder__$j.LabeledCheckboxLight = LabeledCheckboxLight;
      __varRecorder__$j.currentUserToken = currentUserToken;
      __varRecorder__$j.currentUsersOrganizations = currentUsersOrganizations;
      __varRecorder__$j.currentUsername = currentUsername;
      __varRecorder__$j.Project = Project;
      __varRecorder__$j.StatusMessageError = StatusMessageError;
      __varRecorder__$j.StatusMessageConfirm = StatusMessageConfirm;
      __varRecorder__$j.EnumSelector = EnumSelector;
      __varRecorder__$j.Spinner = Spinner;
      __varRecorder__$j.SystemList = SystemList;
      __varRecorder__$j.SystemButton = SystemButton;
      __varRecorder__$j.SystemButtonDark = SystemButtonDark;
      __varRecorder__$j.VersionChecker = VersionChecker;
      __varRecorder__$j.once = once;
      __varRecorder__$j.ModeSelector = ModeSelector;
      __varRecorder__$j.fun = fun;

      (function (superclass) {
        var __lively_classholder__ = lively.FreezerRuntime.recorderFor("lively.project/prompts.cp.js");

        var __lively_class__ = __lively_classholder__.hasOwnProperty("ProjectSettingsPromptModel") && typeof __lively_classholder__.ProjectSettingsPromptModel === "function" ? __lively_classholder__.ProjectSettingsPromptModel : __lively_classholder__.ProjectSettingsPromptModel = function ProjectSettingsPromptModel(__first_arg__) {
          if (__first_arg__ && __first_arg__[Symbol["for"]("lively-instance-restorer")]) ; else {
            return this[Symbol["for"]("lively-instance-initialize")].apply(this, arguments);
          }
        };

        return initializeClass(__lively_class__, superclass, [{
          key: "resolve",
          value: function ProjectSettingsPromptModel_resolve_() {
            var _this$ui = this.ui,
                testCheck = _this$ui.testCheck,
                buildCheck = _this$ui.buildCheck,
                deployCheck = _this$ui.deployCheck,
                testModeSelector = _this$ui.testModeSelector,
                buildModeSelector = _this$ui.buildModeSelector,
                deployModeSelector = _this$ui.deployModeSelector;
            var conf = this.project.config.lively;
            conf.testActionEnabled = testCheck.checked;
            conf.buildActionEnabled = buildCheck.checked;
            conf.deployActionEnabled = deployCheck.checked;
            conf.testOnPush = testModeSelector.selectedItem === "push";
            conf.buildOnPush = buildModeSelector.selectedItem === "push";
            conf.deployOnPush = deployModeSelector.selectedItem === "push";

            initializeClass._get(Object.getPrototypeOf(__lively_class__.prototype), "resolve", this).call(this, true);
          }
        }, {
          key: "viewDidLoad",
          value: function ProjectSettingsPromptModel_viewDidLoad_() {
            var _this$ui2 = this.ui,
                testCheck = _this$ui2.testCheck,
                buildCheck = _this$ui2.buildCheck,
                deployCheck = _this$ui2.deployCheck,
                testModeSelector = _this$ui2.testModeSelector,
                buildModeSelector = _this$ui2.buildModeSelector,
                deployModeSelector = _this$ui2.deployModeSelector,
                visibilitySelector = _this$ui2.visibilitySelector;
            var conf = this.project.config.lively;

            if (conf.repositoryIsPrivate) {
              visibilitySelector.selectedItem = "private";

              if (!this.project.canDeployToPages) {
                deployCheck.disable();
                deployModeSelector.enabled = false;
              }
            }

            testCheck.checked = conf.testActionEnabled;
            buildCheck.checked = conf.buildActionEnabled;
            deployCheck.checked = conf.deployActionEnabled;
            if (conf.testOnPush) testModeSelector.select("push");
            if (conf.buildOnPush) buildModeSelector.select("push");
            if (conf.deployOnPush) deployModeSelector.select("push");
          }
        }], [{
          key: Symbol["for"]("__LivelyClassName__"),
          get: function get() {
            return "ProjectSettingsPromptModel";
          }
        }, {
          key: "properties",
          get: function get() {
            return {
              bindings: {
                get: function get() {
                  var _this = this;

                  return [{
                    model: "cancel button",
                    signal: "fire",
                    handler: function handler() {
                      _this.view.remove();
                    }
                  }, {
                    model: "test check",
                    signal: "checked",
                    handler: function handler(val) {
                      return _this.ui.testModeSelector.enabled = val;
                    }
                  }, {
                    model: "build check",
                    signal: "checked",
                    handler: function handler(val) {
                      return _this.ui.buildModeSelector.enabled = val;
                    }
                  }, {
                    model: "deploy check",
                    signal: "checked",
                    handler: function handler(val) {
                      if (_this.project.canDeployToPages) _this.ui.deployModeSelector.enabled = val;
                    }
                  }, {
                    model: "ok button",
                    signal: "fire",
                    handler: "resolve"
                  }, {
                    target: "visibility selector",
                    signal: "selectionChanged",
                    handler: function () {
                      var _handler = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee(visibility) {
                        var _this$ui3, spinner, visibilitySelector, deployCheck, deployModeSelector, res;

                        return regeneratorRuntime.wrap(function _callee$(_context) {
                          while (1) {
                            switch (_context.prev = _context.next) {
                              case 0:
                                _this$ui3 = _this.ui, spinner = _this$ui3.spinner, visibilitySelector = _this$ui3.visibilitySelector, deployCheck = _this$ui3.deployCheck, deployModeSelector = _this$ui3.deployModeSelector;
                                spinner.opacity = 1;
                                visibilitySelector.enabled = false;
                                _context.next = 5;
                                return _this.project.changeRepositoryVisibility(visibility);

                              case 5:
                                res = _context.sent;

                                if (res) {
                                  _context.next = 9;
                                  break;
                                }

                                $world.setStatusMessage("Error changing Repository visibility.", __varRecorder__$j.StatusMessageError);
                                return _context.abrupt("return");

                              case 9:
                                _context.next = 11;
                                return _this.project.checkPagesSupport();

                              case 11:
                                if (_this.project.canDeployToPages) {
                                  deployCheck.enable();
                                  deployModeSelector.enabled = true;
                                } else {
                                  deployCheck.disable();
                                  deployModeSelector.enabled = false;
                                }

                                spinner.opacity = 0;
                                visibilitySelector.enabled = true;

                              case 14:
                              case "end":
                                return _context.stop();
                            }
                          }
                        }, _callee);
                      }));

                      function handler(_x) {
                        return _handler.apply(this, arguments);
                      }

                      return handler;
                    }()
                  }];
                }
              },
              project: {}
            };
          }
        }], __lively_classholder__, {
          pathInPackage: function pathInPackage() {
            return "./prompts.cp.js";
          },
          unsubscribeFromToplevelDefinitionChanges: function unsubscribeFromToplevelDefinitionChanges() {
            return function () {};
          },
          subscribeToToplevelDefinitionChanges: function subscribeToToplevelDefinitionChanges() {
            return function () {};
          },
          "package": function _package() {
            return {
              name: "lively.project",
              version: "0.1.0"
            };
          }
        }, {
          start: 1426,
          end: 4883
        });
      })(__varRecorder__$j.AbstractPromptModel);

      (function (superclass) {
        var __lively_classholder__ = lively.FreezerRuntime.recorderFor("lively.project/prompts.cp.js");

        var __lively_class__ = __lively_classholder__.hasOwnProperty("ProjectCreationPromptModel") && typeof __lively_classholder__.ProjectCreationPromptModel === "function" ? __lively_classholder__.ProjectCreationPromptModel : __lively_classholder__.ProjectCreationPromptModel = function ProjectCreationPromptModel(__first_arg__) {
          if (__first_arg__ && __first_arg__[Symbol["for"]("lively-instance-restorer")]) ; else {
            return this[Symbol["for"]("lively-instance-initialize")].apply(this, arguments);
          }
        };

        return initializeClass(__lively_class__, superclass, [{
          key: "reject",
          value: function ProjectCreationPromptModel_reject_() {}
        }, {
          key: "checkValidity",
          value: function ProjectCreationPromptModel_checkValidity_() {
            var onlyCheck = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : false;
            var _this$ui4 = this.ui,
                okButton = _this$ui4.okButton,
                remoteUrl = _this$ui4.remoteUrl,
                projectName = _this$ui4.projectName;

            if (this.fromRemote) {
              try {
                var url = new URL(remoteUrl.textString);

                if (url.host !== "github.com") {
                  remoteUrl.indicateError("enter github url");
                  if (!onlyCheck) okButton.disable();
                  return false;
                }
              } catch (err) {
                remoteUrl.indicateError("enter valid url");
                if (!onlyCheck) okButton.disable();
                return false;
              }
            } else {
              if (!projectName.textString || !projectName.textString.match(/^[\da-zA-Z-_]*$/)) {
                projectName.indicateError("enter valid name");
                if (!onlyCheck) okButton.disable();
                return false;
              }
            }

            if (!onlyCheck) okButton.enable();
            return true;
          }
        }, {
          key: "resolve",
          value: function () {
            var _ProjectCreationPromptModel_resolve_ = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee3() {
              var _this2 = this;

              return regeneratorRuntime.wrap(function _callee3$(_context3) {
                while (1) {
                  switch (_context3.prev = _context3.next) {
                    case 0:
                      _context3.next = 2;
                      return __varRecorder__$j.fun.guardNamed("resolve-project-creation", /*#__PURE__*/_asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee2() {
                        var li, _this2$ui, remoteUrl, projectName, createRemoteCheckbox, privateCheckbox, userSelector, description, createdProject, urlString, createNewRemote, priv, _userSelector$selecti, repoOwner, isOrg, currentLivelyVersion, _li;

                        return regeneratorRuntime.wrap(function _callee2$(_context2) {
                          while (1) {
                            switch (_context2.prev = _context2.next) {
                              case 0:
                                _this2.disableButtons();

                                _this2$ui = _this2.ui, remoteUrl = _this2$ui.remoteUrl, projectName = _this2$ui.projectName, createRemoteCheckbox = _this2$ui.createRemoteCheckbox, privateCheckbox = _this2$ui.privateCheckbox, userSelector = _this2$ui.userSelector, description = _this2$ui.description;

                                if (_this2.checkValidity(true)) {
                                  _context2.next = 4;
                                  break;
                                }

                                return _context2.abrupt("return");

                              case 4:
                                if (!_this2.fromRemote) {
                                  _context2.next = 20;
                                  break;
                                }

                                _context2.prev = 5;
                                urlString = remoteUrl.textString;
                                if (urlString.endsWith(".git")) urlString = urlString.replace(".git", "");
                                _context2.next = 10;
                                return __varRecorder__$j.Project.fromRemote(urlString);

                              case 10:
                                createdProject = _context2.sent;

                                initializeClass._get(Object.getPrototypeOf(__lively_class__.prototype), "resolve", _this2).call(_this2, createdProject);

                                _context2.next = 18;
                                break;

                              case 14:
                                _context2.prev = 14;
                                _context2.t0 = _context2["catch"](5);

                                _this2.enableButtons();

                                _this2.view.setStatusMessage("Error fetching Project from remote.", __varRecorder__$j.StatusMessageError);

                              case 18:
                                _context2.next = 41;
                                break;

                              case 20:
                                li = $world.showLoadingIndicatorFor(_this2.view, "Creating Project...");
                                createNewRemote = createRemoteCheckbox.checked;
                                priv = privateCheckbox.checked;
                                _userSelector$selecti = userSelector.selection, repoOwner = _userSelector$selecti.name, isOrg = _userSelector$selecti.isOrg;
                                createdProject = new __varRecorder__$j.Project(projectName.textString, {
                                  author: __varRecorder__$j.currentUsername(),
                                  description: description.textString,
                                  repoOwner: repoOwner
                                });
                                _context2.next = 27;
                                return __varRecorder__$j.VersionChecker.currentLivelyVersion(true);

                              case 27:
                                currentLivelyVersion = _context2.sent;
                                createdProject.config.lively.boundLivelyVersion = currentLivelyVersion;
                                _context2.prev = 29;
                                _context2.next = 32;
                                return createdProject.create(createNewRemote, isOrg ? repoOwner : __varRecorder__$j.currentUsername(), priv);

                              case 32:
                                li.remove();

                                initializeClass._get(Object.getPrototypeOf(__lively_class__.prototype), "resolve", _this2).call(_this2, createdProject);

                                _context2.next = 41;
                                break;

                              case 36:
                                _context2.prev = 36;
                                _context2.t1 = _context2["catch"](29);

                                _this2.enableButtons();

                                (_li = li) === null || _li === void 0 ? void 0 : _li.remove();

                                _this2.view.setStatusMessage("There was an error initializing the project or its remote.", __varRecorder__$j.StatusMessageError);

                              case 41:
                                _this2.enableButtons();

                              case 42:
                              case "end":
                                return _context2.stop();
                            }
                          }
                        }, _callee2, null, [[5, 14], [29, 36]]);
                      })))();

                    case 2:
                    case "end":
                      return _context3.stop();
                  }
                }
              }, _callee3);
            }));

            function ProjectCreationPromptModel_resolve_() {
              return _ProjectCreationPromptModel_resolve_.apply(this, arguments);
            }

            return ProjectCreationPromptModel_resolve_;
          }()
        }, {
          key: "viewDidLoad",
          value: function () {
            var _ProjectCreationPromptModel_viewDidLoad_ = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee4() {
              var _this$ui5, promptTitle, cancelButton, okButton, userFlap, privateCheckbox, li;

              return regeneratorRuntime.wrap(function _callee4$(_context4) {
                while (1) {
                  switch (_context4.prev = _context4.next) {
                    case 0:
                      _this$ui5 = this.ui, promptTitle = _this$ui5.promptTitle, cancelButton = _this$ui5.cancelButton, okButton = _this$ui5.okButton, userFlap = _this$ui5.userFlap, privateCheckbox = _this$ui5.privateCheckbox;
                      okButton.disable();
                      privateCheckbox.disable();
                      cancelButton.disable();

                      if (__varRecorder__$j.currentUserToken()) {
                        _context4.next = 8;
                        break;
                      }

                      this.waitForLogin();
                      _context4.next = 16;
                      break;

                    case 8:
                      li = $world.showLoadingIndicatorFor(this.view);
                      li.center = $world.visibleBounds().center();
                      li.hasFixedPosition = true;

                      __varRecorder__$j.once(this.view, "activate", function () {
                        return li.bringToFront();
                      });

                      _context4.next = 14;
                      return userFlap.update();

                    case 14:
                      li.remove();
                      this.projectNameMode();

                    case 16:
                      promptTitle.textString = "Configure new Project";

                    case 17:
                    case "end":
                      return _context4.stop();
                  }
                }
              }, _callee4, this);
            }));

            function ProjectCreationPromptModel_viewDidLoad_() {
              return _ProjectCreationPromptModel_viewDidLoad_.apply(this, arguments);
            }

            return ProjectCreationPromptModel_viewDidLoad_;
          }()
        }, {
          key: "waitForLogin",
          value: function ProjectCreationPromptModel_waitForLogin_() {
            var _$world$get,
                _this3 = this;

            var _this$ui6 = this.ui,
                remoteUrl = _this$ui6.remoteUrl,
                projectName = _this$ui6.projectName,
                description = _this$ui6.description,
                createRemoteCheckbox = _this$ui6.createRemoteCheckbox,
                userSelector = _this$ui6.userSelector,
                userFlapContainer = _this$ui6.userFlapContainer;
            (_$world$get = $world.get("lively top bar")) === null || _$world$get === void 0 ? void 0 : _$world$get.get("user flap").showGuestUser();
            remoteUrl.clearError();
            projectName.clearError();
            projectName.deactivate();
            remoteUrl.deactivate();
            description.deactivate();
            createRemoteCheckbox.disable();
            userSelector.disable();
            this.ui.userFlapContainer.animate({
              duration: 500,
              borderColor: __varRecorder__$j.Color.red
            }).then(function () {
              return userFlapContainer.animate({
                duration: 500,
                borderColor: __varRecorder__$j.Color.transparent
              });
            }).then(function () {
              return userFlapContainer.animate({
                duration: 500,
                borderColor: __varRecorder__$j.Color.red
              });
            }).then(function () {
              return userFlapContainer.animate({
                duration: 500,
                borderColor: __varRecorder__$j.Color.transparent
              });
            });
            this.withoutBindingsDo(function () {
              return _this3.ui.fromRemoteCheckbox.disable();
            });
          }
        }, {
          key: "onLogin",
          value: function ProjectCreationPromptModel_onLogin_() {
            var _this4 = this;

            $world.get("user flap").showLoggedInUser();
            this.withoutBindingsDo(function () {
              return _this4.ui.fromRemoteCheckbox.enable();
            });
            this.projectNameMode();
          }
        }, {
          key: "onCheckbox",
          value: function ProjectCreationPromptModel_onCheckbox_(fromRemote) {
            this.ui.remoteUrl.clearError();
            this.ui.projectName.clearError();

            if (fromRemote) {
              this.remoteUrlMode();
            } else {
              this.projectNameMode();
            }
          }
        }, {
          key: "projectNameMode",
          value: function ProjectCreationPromptModel_projectNameMode_() {
            var _this$ui7 = this.ui,
                projectName = _this$ui7.projectName,
                userSelector = _this$ui7.userSelector,
                description = _this$ui7.description,
                createRemoteCheckbox = _this$ui7.createRemoteCheckbox,
                remoteUrl = _this$ui7.remoteUrl;
            this.fromRemote = false;
            projectName.activate();
            userSelector.enable();
            description.activate();
            createRemoteCheckbox.enable();
            remoteUrl.deactivate();
            projectName.indicateError("required", "only - and letters are allowed");

            var ownerOptions = __varRecorder__$j.currentUsersOrganizations().map(function (orgName) {
              return {
                string: orgName,
                value: {
                  name: orgName,
                  isOrg: true
                },
                isListItem: true
              };
            });

            userSelector.items = [{
              string: __varRecorder__$j.currentUsername(),
              value: {
                name: __varRecorder__$j.currentUsername(),
                isOrg: false
              },
              isListItem: true
            }].concat(ownerOptions);
            userSelector.selection = userSelector.items[0].value;
          }
        }, {
          key: "remoteUrlMode",
          value: function ProjectCreationPromptModel_remoteUrlMode_() {
            var _this$ui8 = this.ui,
                projectName = _this$ui8.projectName,
                userSelector = _this$ui8.userSelector,
                description = _this$ui8.description,
                createRemoteCheckbox = _this$ui8.createRemoteCheckbox,
                remoteUrl = _this$ui8.remoteUrl;
            this.fromRemote = true;
            createRemoteCheckbox.disable();
            createRemoteCheckbox.checked = false;
            projectName.deactivate();
            userSelector.disable();
            description.deactivate();
            remoteUrl.activate();
            remoteUrl.indicateError("required", "must be the url to a github repository");
          }
        }], [{
          key: Symbol["for"]("__LivelyClassName__"),
          get: function get() {
            return "ProjectCreationPromptModel";
          }
        }, {
          key: "properties",
          get: function get() {
            return {
              bindings: {
                get: function get() {
                  var _this5 = this;

                  return [{
                    target: "user flap",
                    signal: "onLogin",
                    handler: "onLogin"
                  }, {
                    target: "user flap",
                    signal: "onLogout",
                    handler: "waitForLogin"
                  }, {
                    model: "ok button",
                    signal: "fire",
                    handler: "resolve"
                  }, {
                    target: "from remote checkbox",
                    signal: "checked",
                    handler: "onCheckbox"
                  }, {
                    target: "create remote checkbox",
                    signal: "checked",
                    handler: function handler(checked) {
                      var privateCheckbox = _this5.ui.privateCheckbox;
                      if (checked) privateCheckbox.enable();else privateCheckbox.disable();
                    }
                  }, {
                    target: "remote url",
                    signal: "onInputChanged",
                    handler: "checkValidity",
                    converter: "() => false"
                  }, {
                    target: "project name",
                    signal: "onInputChanged",
                    handler: "checkValidity",
                    converter: "() => false"
                  }];
                }
              },
              label: "Create new Project"
            };
          }
        }], __lively_classholder__, {
          pathInPackage: function pathInPackage() {
            return "./prompts.cp.js";
          },
          unsubscribeFromToplevelDefinitionChanges: function unsubscribeFromToplevelDefinitionChanges() {
            return function () {};
          },
          subscribeToToplevelDefinitionChanges: function subscribeToToplevelDefinitionChanges() {
            return function () {};
          },
          "package": function _package() {
            return {
              name: "lively.project",
              version: "0.1.0"
            };
          }
        }, {
          start: 4885,
          end: 12426
        });
      })(__varRecorder__$j.AbstractPromptModel);

      (function (superclass) {
        var __lively_classholder__ = lively.FreezerRuntime.recorderFor("lively.project/prompts.cp.js");

        var __lively_class__ = __lively_classholder__.hasOwnProperty("RepoCreationPromptModel") && typeof __lively_classholder__.RepoCreationPromptModel === "function" ? __lively_classholder__.RepoCreationPromptModel : __lively_classholder__.RepoCreationPromptModel = function RepoCreationPromptModel(__first_arg__) {
          if (__first_arg__ && __first_arg__[Symbol["for"]("lively-instance-restorer")]) ; else {
            return this[Symbol["for"]("lively-instance-initialize")].apply(this, arguments);
          }
        };

        return initializeClass(__lively_class__, superclass, [{
          key: "resolve",
          value: function () {
            var _RepoCreationPromptModel_resolve_ = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee6() {
              var _this6 = this;

              return regeneratorRuntime.wrap(function _callee6$(_context6) {
                while (1) {
                  switch (_context6.prev = _context6.next) {
                    case 0:
                      _context6.next = 2;
                      return __varRecorder__$j.fun.guardNamed("resolve-repository-creation", /*#__PURE__*/_asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee5() {
                        var li, privateCheckbox, privateRepo, proj, repoInOrg, _li2;

                        return regeneratorRuntime.wrap(function _callee5$(_context5) {
                          while (1) {
                            switch (_context5.prev = _context5.next) {
                              case 0:
                                _this6.disableButtons();

                                li = $world.showLoadingIndicatorFor(_this6.view, "Creating Repository...");
                                privateCheckbox = _this6.ui.privateCheckbox;
                                privateRepo = !!privateCheckbox.checked;
                                _context5.prev = 4;
                                proj = _this6.project;
                                repoInOrg = __varRecorder__$j.currentUsername() !== __varRecorder__$j.currentUsername();
                                _context5.next = 9;
                                return proj.gitResource.createAndAddRemoteToGitRepository(__varRecorder__$j.currentUserToken(), proj.name, proj.repoOwner, proj.config.description, repoInOrg, privateRepo);

                              case 9:
                                li.remove();
                                li = $world.showLoadingIndicatorFor(_this6.view, "Setting up Defaults...");
                                proj.setCIDefaults();
                                proj.config.lively.repositoryIsPrivate = privateRepo;
                                proj.config.lively.repoBelongsToOrg = repoInOrg;
                                li.remove();
                                li = $world.showLoadingIndicatorFor(_this6.view, "Uploading Project...");
                                _context5.next = 18;
                                return proj.save({
                                  message: "Enabling remote repository.",
                                  filesToCommit: "package.json .github/*"
                                });

                              case 18:
                                li.remove();
                                $world.setStatusMessage("Project uploaded!", __varRecorder__$j.StatusMessageConfirm);

                                initializeClass._get(Object.getPrototypeOf(__lively_class__.prototype), "resolve", _this6).call(_this6, true);

                                _context5.next = 28;
                                break;

                              case 23:
                                _context5.prev = 23;
                                _context5.t0 = _context5["catch"](4);

                                _this6.enableButtons();

                                (_li2 = li) === null || _li2 === void 0 ? void 0 : _li2.remove();

                                _this6.view.setStatusMessage("There was an error creating the repository.", __varRecorder__$j.StatusMessageError);

                              case 28:
                                _this6.enableButtons();

                              case 29:
                              case "end":
                                return _context5.stop();
                            }
                          }
                        }, _callee5, null, [[4, 23]]);
                      })))();

                    case 2:
                    case "end":
                      return _context6.stop();
                  }
                }
              }, _callee6);
            }));

            function RepoCreationPromptModel_resolve_() {
              return _RepoCreationPromptModel_resolve_.apply(this, arguments);
            }

            return RepoCreationPromptModel_resolve_;
          }()
        }], [{
          key: Symbol["for"]("__LivelyClassName__"),
          get: function get() {
            return "RepoCreationPromptModel";
          }
        }, {
          key: "properties",
          get: function get() {
            return {
              project: {},
              bindings: {
                get: function get() {
                  {
                    return [{
                      model: "ok button",
                      signal: "fire",
                      handler: "resolve"
                    }, {
                      model: "cancel button",
                      signal: "fire",
                      handler: "reject"
                    }];
                  }
                }
              }
            };
          }
        }], __lively_classholder__, {
          pathInPackage: function pathInPackage() {
            return "./prompts.cp.js";
          },
          unsubscribeFromToplevelDefinitionChanges: function unsubscribeFromToplevelDefinitionChanges() {
            return function () {};
          },
          subscribeToToplevelDefinitionChanges: function subscribeToToplevelDefinitionChanges() {
            return function () {};
          },
          "package": function _package() {
            return {
              name: "lively.project",
              version: "0.1.0"
            };
          }
        }, {
          start: 12428,
          end: 14324
        });
      })(__varRecorder__$j.AbstractPromptModel);

      (function (superclass) {
        var __lively_classholder__ = lively.FreezerRuntime.recorderFor("lively.project/prompts.cp.js");

        var __lively_class__ = __lively_classholder__.hasOwnProperty("ProjectSavePrompt") && typeof __lively_classholder__.ProjectSavePrompt === "function" ? __lively_classholder__.ProjectSavePrompt : __lively_classholder__.ProjectSavePrompt = function ProjectSavePrompt(__first_arg__) {
          if (__first_arg__ && __first_arg__[Symbol["for"]("lively-instance-restorer")]) ; else {
            return this[Symbol["for"]("lively-instance-initialize")].apply(this, arguments);
          }
        };

        return initializeClass(__lively_class__, superclass, [{
          key: "viewDidLoad",
          value: function () {
            var _ProjectSavePrompt_viewDidLoad_ = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee7() {
              return regeneratorRuntime.wrap(function _callee7$(_context7) {
                while (1) {
                  switch (_context7.prev = _context7.next) {
                    case 0:
                      this.ui.diffButton.disable();
                      _context7.next = 3;
                      return this.project.saveConfigData();

                    case 3:
                      _context7.next = 5;
                      return this.project.regeneratePipelines();

                    case 5:
                      this.ui.diffButton.enable();

                    case 6:
                    case "end":
                      return _context7.stop();
                  }
                }
              }, _callee7, this);
            }));

            function ProjectSavePrompt_viewDidLoad_() {
              return _ProjectSavePrompt_viewDidLoad_.apply(this, arguments);
            }

            return ProjectSavePrompt_viewDidLoad_;
          }()
        }, {
          key: "resolve",
          value: function () {
            var _ProjectSavePrompt_resolve_ = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee9() {
              var _this7 = this;

              return regeneratorRuntime.wrap(function _callee9$(_context9) {
                while (1) {
                  switch (_context9.prev = _context9.next) {
                    case 0:
                      _context9.next = 2;
                      return __varRecorder__$j.fun.guardNamed("resolve-project-saving", /*#__PURE__*/_asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee8() {
                        var _this7$terminalWindow;

                        var description, message, increaseLevel, li, success;
                        return regeneratorRuntime.wrap(function _callee8$(_context8) {
                          while (1) {
                            switch (_context8.prev = _context8.next) {
                              case 0:
                                _this7.disableButtons();

                                description = _this7.ui.description;
                                message = description.textString;
                                if (_this7.increaseMajor) increaseLevel = "major";else if (_this7.increaseMinor) increaseLevel = "minor";else increaseLevel = "patch";
                                li = $world.showLoadingIndicatorFor(_this7.view, "Saving Project...");
                                _context8.next = 7;
                                return _this7.project.save({
                                  increaseLevel: increaseLevel,
                                  message: message,
                                  tag: _this7.tag
                                });

                              case 7:
                                success = _context8.sent;
                                li.remove();
                                (_this7$terminalWindow = _this7.terminalWindow) === null || _this7$terminalWindow === void 0 ? void 0 : _this7$terminalWindow.close();
                                if (success) $world.setStatusMessage("Project saved!", __varRecorder__$j.StatusMessageConfirm);else $world.setStatusMessage("Save unsuccessful", __varRecorder__$j.StatusMessageError);

                                initializeClass._get(Object.getPrototypeOf(__lively_class__.prototype), "resolve", _this7).call(_this7, success);

                              case 12:
                              case "end":
                                return _context8.stop();
                            }
                          }
                        }, _callee8);
                      })))();

                    case 2:
                    case "end":
                      return _context9.stop();
                  }
                }
              }, _callee9);
            }));

            function ProjectSavePrompt_resolve_() {
              return _ProjectSavePrompt_resolve_.apply(this, arguments);
            }

            return ProjectSavePrompt_resolve_;
          }()
        }], [{
          key: Symbol["for"]("__LivelyClassName__"),
          get: function get() {
            return "ProjectSavePrompt";
          }
        }, {
          key: "properties",
          get: function get() {
            return {
              project: {},
              bindings: {
                get: function get() {
                  var _this8 = this;

                  return [{
                    model: "ok button",
                    signal: "fire",
                    handler: "resolve"
                  }, {
                    model: "cancel button",
                    signal: "fire",
                    handler: function handler() {
                      var _this8$terminalWindow;

                      _this8.view.remove();

                      (_this8$terminalWindow = _this8.terminalWindow) === null || _this8$terminalWindow === void 0 ? void 0 : _this8$terminalWindow.close();
                    }
                  }, {
                    target: "minor check",
                    signal: "checked",
                    handler: function handler(status) {
                      return _this8.increaseMinor = status;
                    }
                  }, {
                    target: "major check",
                    signal: "checked",
                    handler: function handler(status) {
                      return _this8.increaseMajor = status;
                    }
                  }, {
                    target: "tag check",
                    signal: "checked",
                    handler: function handler(status) {
                      return _this8.tag = status;
                    }
                  }, {
                    target: "diff button",
                    signal: "onMouseDown",
                    handler: function handler() {
                      _this8.terminalWindow = _this8.project.showDiffSummary();
                    }
                  }];
                }
              }
            };
          }
        }], __lively_classholder__, {
          pathInPackage: function pathInPackage() {
            return "./prompts.cp.js";
          },
          unsubscribeFromToplevelDefinitionChanges: function unsubscribeFromToplevelDefinitionChanges() {
            return function () {};
          },
          subscribeToToplevelDefinitionChanges: function subscribeToToplevelDefinitionChanges() {
            return function () {};
          },
          "package": function _package() {
            return {
              name: "lively.project",
              version: "0.1.0"
            };
          }
        }, {
          start: 14326,
          end: 16448
        });
      })(__varRecorder__$j.AbstractPromptModel);

      var ProjectSettingsPrompt = __varRecorder__$j.component["for"](function () {
        return __varRecorder__$j.component(__varRecorder__$j.LightPrompt, {
          defaultViewModel: __varRecorder__$j.ProjectSettingsPromptModel,
          extent: __varRecorder__$j.pt(385, 244),
          layout: new __varRecorder__$j.TilingLayout({
            align: "center",
            axis: "column",
            axisAlign: "center",
            hugContentsHorizontally: true,
            hugContentsVertically: true,
            orderByIndex: true,
            padding: __varRecorder__$j.rect(15, 15, 0, 0),
            spacing: 16
          }),
          submorphs: [{
            name: "prompt title",
            nativeCursor: "text",
            textAndAttributes: ["Project Settings", null]
          }, __varRecorder__$j.add({
            name: "prompt contents",
            layout: new __varRecorder__$j.TilingLayout({
              align: "center",
              axis: "column",
              axisAlign: "center",
              orderByIndex: true,
              spacing: 20
            }),
            fill: __varRecorder__$j.Color.transparent,
            extent: __varRecorder__$j.pt(327.5, 105.5),
            submorphs: [{
              name: "ci settings",
              fill: __varRecorder__$j.Color.rgba(255, 255, 255, 0),
              layout: new __varRecorder__$j.TilingLayout({
                align: "center",
                axis: "column",
                axisAlign: "center",
                orderByIndex: true
              }),
              submorphs: [{
                type: __varRecorder__$j.Label,
                textString: "GitHub Actions Settings",
                fontSize: 15,
                fontWeight: "600"
              }, {
                name: "row 11",
                fill: __varRecorder__$j.Color.rgba(255, 255, 255, 0),
                extent: __varRecorder__$j.pt(480, 42),
                layout: new __varRecorder__$j.TilingLayout({
                  align: "center",
                  axisAlign: "center",
                  orderByIndex: true,
                  spacing: 20
                }),
                submorphs: [{
                  name: "wrapper 11",
                  borderColor: __varRecorder__$j.Color.rgba(255, 255, 255, 0),
                  layout: new __varRecorder__$j.TilingLayout({
                    axisAlign: "center",
                    orderByIndex: true
                  }),
                  fill: __varRecorder__$j.Color.transparent,
                  borderWidth: 0,
                  extent: __varRecorder__$j.pt(195.5, 28.5),
                  submorphs: [__varRecorder__$j.part(__varRecorder__$j.LabeledCheckboxLight, {
                    name: "test check",
                    viewModel: {
                      label: "Run Tests Remotely:"
                    }
                  }), {
                    extent: __varRecorder__$j.pt(64, 12),
                    fill: __varRecorder__$j.Color.transparent,
                    borderWidth: 0
                  }]
                }, __varRecorder__$j.part(__varRecorder__$j.ModeSelector, {
                  name: "test mode selector",
                  viewModel: {
                    items: [{
                      text: "Manually",
                      name: "manual"
                    }, {
                      text: "On each push to `main` branch",
                      name: "push"
                    }],
                    tooltips: ["Only run tests when triggered manually on GitHub", "Run each time a push to the projects main branch is performed."]
                  }
                })]
              }, {
                name: "row 21",
                fill: __varRecorder__$j.Color.rgba(255, 255, 255, 0),
                extent: __varRecorder__$j.pt(297, 29),
                layout: new __varRecorder__$j.TilingLayout({
                  align: "center",
                  axisAlign: "center",
                  orderByIndex: true,
                  spacing: 20
                }),
                submorphs: [{
                  name: "wrapper 21",
                  layout: new __varRecorder__$j.TilingLayout({
                    orderByIndex: true,
                    axisAlign: "center"
                  }),
                  fill: __varRecorder__$j.Color.transparent,
                  borderWidth: 0,
                  extent: __varRecorder__$j.pt(195.5, 28.5),
                  submorphs: [__varRecorder__$j.part(__varRecorder__$j.LabeledCheckboxLight, {
                    name: "build check",
                    viewModel: {
                      label: "Build Project Remotely:"
                    }
                  }), {
                    extent: __varRecorder__$j.pt(47.5, 12),
                    fill: __varRecorder__$j.Color.transparent,
                    borderWidth: 0
                  }]
                }, __varRecorder__$j.part(__varRecorder__$j.ModeSelector, {
                  name: "build mode selector",
                  viewModel: {
                    items: [{
                      text: "Manually",
                      name: "manual"
                    }, {
                      text: "On each push to `main` branch",
                      name: "push"
                    }],
                    tooltips: ["Only run build when triggered manually on GitHub", "Run each time a push to the projects main branch is performed."]
                  }
                })]
              }, {
                name: "row 31",
                fill: __varRecorder__$j.Color.rgba(255, 255, 255, 0),
                extent: __varRecorder__$j.pt(480, 41.5),
                layout: new __varRecorder__$j.TilingLayout({
                  align: "center",
                  axisAlign: "center",
                  orderByIndex: true,
                  spacing: 20
                }),
                submorphs: [{
                  name: "wrapper 31",
                  layout: new __varRecorder__$j.TilingLayout({
                    axisAlign: "center",
                    orderByIndex: true,
                    spacing: 5
                  }),
                  fill: __varRecorder__$j.Color.transparent,
                  borderWidth: 0,
                  extent: __varRecorder__$j.pt(195.5, 28.5),
                  submorphs: [__varRecorder__$j.part(__varRecorder__$j.LabeledCheckboxLight, {
                    name: "deploy check",
                    viewModel: {
                      label: "Deploy Build to GitHub Pages:"
                    }
                  }), __varRecorder__$j.part(__varRecorder__$j.InformIconOnLight, {
                    viewModel: {
                      information: "Deploying to GitHub Pages is only available for public repositories or with a paid GitHub plan."
                    }
                  })]
                }, __varRecorder__$j.part(__varRecorder__$j.ModeSelector, {
                  name: "deploy mode selector",
                  viewModel: {
                    items: [{
                      text: "Manually",
                      name: "manual"
                    }, {
                      text: "On each push to `main` branch",
                      name: "push"
                    }],
                    tooltips: ["Only deploy when triggered manually on GitHub", "Deploy each time a push to the projects main branch is performed."]
                  }
                })]
              }]
            }, {
              name: "repo settings",
              fill: __varRecorder__$j.Color.rgba(255, 255, 255, 0),
              layout: new __varRecorder__$j.TilingLayout({
                align: "center",
                axis: "column",
                axisAlign: "center",
                orderByIndex: true
              }),
              submorphs: [{
                type: __varRecorder__$j.Label,
                textString: "Repository Settings",
                fontSize: 15,
                fontWeight: "600"
              }, {
                name: "row 12",
                fill: __varRecorder__$j.Color.rgba(255, 255, 255, 0),
                extent: __varRecorder__$j.pt(480, 42),
                layout: new __varRecorder__$j.TilingLayout({
                  axisAlign: "center",
                  orderByIndex: true,
                  spacing: 20
                }),
                submorphs: [{
                  name: "wrapper 12",
                  layout: new __varRecorder__$j.TilingLayout({
                    orderByIndex: true,
                    axisAlign: "center",
                    spacing: 20
                  }),
                  fill: __varRecorder__$j.Color.transparent,
                  borderWidth: 0,
                  extent: __varRecorder__$j.pt(195.5, 28.5),
                  submorphs: [{
                    type: __varRecorder__$j.Label,
                    textString: "Repository Visibility:"
                  }, __varRecorder__$j.part(__varRecorder__$j.Spinner, {
                    name: "spinner",
                    viewModel: {
                      color: "black"
                    },
                    scale: 0.3,
                    opacity: 0
                  })]
                }, __varRecorder__$j.part(__varRecorder__$j.ModeSelector, {
                  name: "visibility selector",
                  viewModel: {
                    items: [{
                      text: "Public",
                      name: "public"
                    }, {
                      text: "Private",
                      name: "private"
                    }]
                  }
                })]
              }]
            }]
          }), __varRecorder__$j.add(__varRecorder__$j.part(__varRecorder__$j.OKCancelButtonWrapper, {
            name: "button wrapper"
          }))]
        });
      }, {
        module: "lively.project/prompts.cp.js",
        "export": "ProjectSettingsPrompt",
        range: {
          start: 16463,
          end: 23144
        }
      }, __varRecorder__$j.ProjectSettingsPrompt);
      __varRecorder__$j.ProjectSettingsPrompt = ProjectSettingsPrompt;
      __varRecorder__$j.ProjectSettingsPrompt = ProjectSettingsPrompt;
      __varRecorder__$j.RepoSettings = __varRecorder__$j.component["for"](function () {
        return __varRecorder__$j.component({
          name: "repo settings",
          fill: __varRecorder__$j.Color.transparent,
          layout: new __varRecorder__$j.TilingLayout({
            axis: "column",
            hugContentsHorizontally: true,
            orderByIndex: true,
            spacing: 5
          }),
          submorphs: [{
            name: "user holder",
            fill: __varRecorder__$j.Color.transparent,
            layout: new __varRecorder__$j.TilingLayout({
              align: "center",
              axisAlign: "center",
              orderByIndex: true,
              spacing: 5
            }),
            submorphs: [__varRecorder__$j.part(__varRecorder__$j.EnumSelector, {
              name: "user selector",
              master: __varRecorder__$j.SystemButton,
              layout: new __varRecorder__$j.TilingLayout({
                align: "center",
                axisAlign: "center",
                justifySubmorphs: "spaced",
                orderByIndex: true,
                padding: __varRecorder__$j.rect(5, 0, 5, 0),
                resizePolicies: [["label", [{
                  height: "fixed",
                  width: "fill"
                }]]]
              }),
              viewModel: {
                listMaster: __varRecorder__$j.SystemList,
                openListInWorld: true,
                listAlign: "selection"
              }
            }), __varRecorder__$j.part(__varRecorder__$j.InformIconOnLight, {
              viewModel: {
                information: "For which entity should the project be created? This corresponds to the repository owner on GitHub."
              },
              name: "label_1"
            })]
          }, {
            name: "remote holder",
            fill: __varRecorder__$j.Color.transparent,
            layout: new __varRecorder__$j.TilingLayout({
              align: "center",
              axisAlign: "center",
              spacing: 5
            }),
            submorphs: [__varRecorder__$j.part(__varRecorder__$j.LabeledCheckboxLight, {
              name: "create remote checkbox",
              viewModel: {
                label: "Create new GitHub repository?"
              }
            }), __varRecorder__$j.part(__varRecorder__$j.InformIconOnLight, {
              viewModel: {
                information: "Should a new GitHub repository with the projects name automatically be created under the specified GitHub entity?"
              }
            })]
          }, {
            name: "private repo holder",
            fill: __varRecorder__$j.Color.transparent,
            layout: new __varRecorder__$j.TilingLayout({
              align: "center",
              axisAlign: "center",
              spacing: 5
            }),
            submorphs: [__varRecorder__$j.part(__varRecorder__$j.LabeledCheckboxLight, {
              name: "private checkbox",
              viewModel: {
                label: "Should the new GitHub repository be private?"
              }
            }), __varRecorder__$j.part(__varRecorder__$j.InformIconOnLight, {
              viewModel: {
                information: "Should the new GitHub repository for the project be private?"
              }
            })]
          }]
        });
      }, {
        module: "lively.project/prompts.cp.js",
        "export": "RepoSettings",
        range: {
          start: 23152,
          end: 25323
        }
      }, __varRecorder__$j.RepoSettings);
      var RepoCreationPrompt = __varRecorder__$j.component["for"](function () {
        return __varRecorder__$j.component(__varRecorder__$j.LightPrompt, {
          defaultViewModel: __varRecorder__$j.RepoCreationPromptModel,
          submorphs: [{
            name: "prompt title",
            padding: __varRecorder__$j.rect(10, 0, 10, 0),
            textAndAttributes: ["Create GitHub Repository for Project", null]
          }, __varRecorder__$j.add(__varRecorder__$j.part(__varRecorder__$j.RepoSettings, {
            name: "repo settings",
            submorphs: [__varRecorder__$j.without("user holder"), __varRecorder__$j.without("remote holder"), {
              layout: new __varRecorder__$j.TilingLayout({
                axisAlign: "center",
                orderByIndex: true,
                spacing: 5
              }),
              name: "private repo holder",
              extent: __varRecorder__$j.pt(332, 21),
              submorphs: [{
                layout: new __varRecorder__$j.TilingLayout({
                  orderByIndex: true,
                  spacing: 5
                }),
                name: "private checkbox"
              }]
            }]
          })), __varRecorder__$j.add(__varRecorder__$j.part(__varRecorder__$j.OKCancelButtonWrapper, {
            name: "button wrapper"
          }))]
        });
      }, {
        module: "lively.project/prompts.cp.js",
        "export": "RepoCreationPrompt",
        range: {
          start: 25338,
          end: 26134
        }
      }, __varRecorder__$j.RepoCreationPrompt);
      __varRecorder__$j.RepoCreationPrompt = RepoCreationPrompt;
      __varRecorder__$j.RepoCreationPrompt = RepoCreationPrompt;
      var ProjectCreationPrompt = __varRecorder__$j.component["for"](function () {
        return __varRecorder__$j.component(__varRecorder__$j.LightPrompt, {
          defaultViewModel: __varRecorder__$j.ProjectCreationPromptModel,
          extent: __varRecorder__$j.pt(385, 345),
          layout: new __varRecorder__$j.TilingLayout({
            align: "center",
            axis: "column",
            axisAlign: "center",
            hugContentsHorizontally: true,
            hugContentsVertically: true,
            orderByIndex: true,
            padding: __varRecorder__$j.rect(15, 15, 0, 0),
            spacing: 16
          }),
          epiMorph: false,
          hasFixedPosition: true,
          viewModel: {
            label: ["Create New Project\n", {
              fontWeight: "bold"
            }]
          },
          submorphs: [__varRecorder__$j.add({
            name: "project creation form",
            extent: __varRecorder__$j.pt(318, 200),
            fill: __varRecorder__$j.Color.transparent,
            layout: new __varRecorder__$j.TilingLayout({
              axis: "column",
              hugContentsHorizontally: true,
              orderByIndex: true,
              spacing: 5
            }),
            submorphs: [{
              name: "user flap container",
              borderColor: __varRecorder__$j.Color.rgba(255, 255, 255, 0),
              clipMode: "hidden",
              borderRadius: 20,
              borderWidth: 2,
              layout: new __varRecorder__$j.TilingLayout({
                align: "center",
                orderByIndex: true
              }),
              extent: __varRecorder__$j.pt(318, 48.9),
              fill: __varRecorder__$j.Color.transparent,
              submorphs: [__varRecorder__$j.part(__varRecorder__$j.UserFlap, {
                viewModel: {
                  withLoginButton: true
                }
              })]
            }, {
              fill: __varRecorder__$j.Color.transparent,
              layout: new __varRecorder__$j.TilingLayout({
                align: "center",
                axisAlign: "center",
                spacing: 5
              }),
              submorphs: [__varRecorder__$j.part(__varRecorder__$j.LabeledCheckboxLight, {
                name: "from remote checkbox",
                viewModel: {
                  label: "Initialize from Remote?"
                }
              }), __varRecorder__$j.part(__varRecorder__$j.InformIconOnLight, {
                viewModel: {
                  information: "Should the project be initialized from an existing remote repository?"
                }
              })]
            }, __varRecorder__$j.part(__varRecorder__$j.InputLineDefault, {
              name: "remote url",
              placeholder: "URL"
            }), __varRecorder__$j.part(__varRecorder__$j.InputLineDefault, {
              name: "project name",
              placeholder: "Project Name",
              submorphs: [{
                name: "placeholder",
                extent: __varRecorder__$j.pt(142, 34),
                fontFamily: "IBM Plex Sans",
                nativeCursor: "text",
                textAndAttributes: ["Project Name", null]
              }]
            }), __varRecorder__$j.part(__varRecorder__$j.RepoSettings), __varRecorder__$j.part(__varRecorder__$j.InputLineDefault, {
              name: "description",
              extent: __varRecorder__$j.pt(318.1, 106.3),
              placeholder: "Project Description",
              lineWrapping: "by-words",
              submorphs: [{
                name: "placeholder",
                visible: false,
                extent: __varRecorder__$j.pt(148, 34),
                fontFamily: "IBM Plex Sans",
                nativeCursor: "text"
              }]
            })]
          }), __varRecorder__$j.add(__varRecorder__$j.part(__varRecorder__$j.OKCancelButtonWrapper))]
        });
      }, {
        module: "lively.project/prompts.cp.js",
        "export": "ProjectCreationPrompt",
        range: {
          start: 26149,
          end: 28618
        }
      }, __varRecorder__$j.ProjectCreationPrompt);
      __varRecorder__$j.ProjectCreationPrompt = ProjectCreationPrompt;
      __varRecorder__$j.ProjectCreationPrompt = ProjectCreationPrompt;
      var SaveProjectDialog = __varRecorder__$j.component["for"](function () {
        return __varRecorder__$j.component(__varRecorder__$j.SaveWorldDialog, {
          defaultViewModel: __varRecorder__$j.ProjectSavePrompt,
          extent: __varRecorder__$j.pt(500, 367),
          submorphs: [{
            name: "prompt title",
            nativeCursor: "text",
            textAndAttributes: ["Save Project", null]
          }, {
            name: "prompt controls",
            extent: __varRecorder__$j.pt(455.5, 285),
            submorphs: [__varRecorder__$j.without("third row"), __varRecorder__$j.without("second row"), __varRecorder__$j.without("first row"), __varRecorder__$j.add({
              name: "second row",
              extent: __varRecorder__$j.pt(450, 76.8),
              fill: __varRecorder__$j.Color.transparent,
              layout: new __varRecorder__$j.TilingLayout({
                align: "right",
                axis: "column",
                orderByIndex: true,
                padding: __varRecorder__$j.rect(0, 15, 0, -15),
                spacing: 11
              }),
              position: __varRecorder__$j.pt(-146, 28),
              submorphs: [{
                name: "aMorph",
                borderColor: __varRecorder__$j.Color.rgba(23, 160, 251, 0),
                borderWidth: 1,
                extent: __varRecorder__$j.pt(256.5, 31),
                fill: __varRecorder__$j.Color.rgba(255, 255, 255, 0),
                layout: new __varRecorder__$j.TilingLayout({
                  axisAlign: "center",
                  orderByIndex: true,
                  spacing: 10
                }),
                position: __varRecorder__$j.pt(0, -1),
                submorphs: [{
                  type: __varRecorder__$j.Label,
                  name: "description label",
                  fill: __varRecorder__$j.Color.rgba(255, 255, 255, 0),
                  fontColor: __varRecorder__$j.Color.rgb(255, 255, 255),
                  fontFamily: "\"IBM Plex Sans\"",
                  fontSize: 15,
                  nativeCursor: "pointer",
                  textAndAttributes: ["Bump Minor Version:", null]
                }, __varRecorder__$j.part(__varRecorder__$j.Checkbox, {
                  name: "minor check",
                  padding: __varRecorder__$j.rect(0, -3, 0, 3),
                  position: __varRecorder__$j.pt(139, 0)
                })]
              }, {
                name: "aMorph1",
                borderColor: __varRecorder__$j.Color.rgba(23, 160, 251, 0),
                borderWidth: 1,
                extent: __varRecorder__$j.pt(256.5, 29.5),
                fill: __varRecorder__$j.Color.rgba(255, 255, 255, 0),
                layout: new __varRecorder__$j.TilingLayout({
                  axisAlign: "center",
                  orderByIndex: true,
                  spacing: 10
                }),
                position: __varRecorder__$j.pt(0, 63),
                submorphs: [{
                  type: __varRecorder__$j.Label,
                  name: "description label",
                  fill: __varRecorder__$j.Color.rgba(255, 255, 255, 0),
                  fontColor: __varRecorder__$j.Color.rgb(255, 255, 255),
                  fontFamily: "\"IBM Plex Sans\"",
                  fontSize: 15,
                  nativeCursor: "pointer",
                  textAndAttributes: ["Bump Major Version:", null]
                }, __varRecorder__$j.part(__varRecorder__$j.Checkbox, {
                  name: "major check",
                  position: __varRecorder__$j.pt(139, 0)
                })]
              }, {
                name: "tag row",
                fill: __varRecorder__$j.Color.rgba(255, 255, 255, 0),
                borderColor: __varRecorder__$j.Color.rgba(23, 160, 251, 0),
                extent: __varRecorder__$j.pt(256.5, 29.5),
                layout: new __varRecorder__$j.TilingLayout({
                  axisAlign: "center",
                  orderByIndex: true,
                  spacing: 10
                }),
                position: __varRecorder__$j.pt(-82, 26),
                submorphs: [{
                  type: __varRecorder__$j.Label,
                  name: "tag label",
                  fill: __varRecorder__$j.Color.rgba(255, 255, 255, 0),
                  fontColor: __varRecorder__$j.Color.rgb(255, 255, 255),
                  fontFamily: "\"IBM Plex Sans\"",
                  fontSize: 15,
                  nativeCursor: "pointer",
                  textAndAttributes: ["Tag this Version as Release:", null]
                }, __varRecorder__$j.part(__varRecorder__$j.Checkbox, {
                  name: "tag check",
                  position: __varRecorder__$j.pt(179, 0)
                })]
              }, __varRecorder__$j.part(__varRecorder__$j.SystemButtonDark, {
                name: "diff button",
                extent: __varRecorder__$j.pt(449.5, 27),
                submorphs: [{
                  name: "label",
                  textAndAttributes: ["Show Summary of Changes (Advanced Operation)", null, "\uF296", {
                    fontFamily: "Tabler Icons",
                    fontWeight: "900"
                  }, " ", {}]
                }]
              })]
            }), {
              name: "fourth row",
              submorphs: [{
                name: "description",
                dropShadow: new __varRecorder__$j.ShadowObject({
                  distance: 4,
                  color: __varRecorder__$j.Color.rgba(0, 0, 0, 0.26),
                  blur: 10
                }),
                textAndAttributes: ["", null]
              }]
            }]
          }, {
            name: "button wrapper",
            layout: new __varRecorder__$j.TilingLayout({
              align: "center",
              axisAlign: "center",
              orderByIndex: true,
              padding: __varRecorder__$j.rect(12, 12, 0, 0),
              spacing: 12
            })
          }]
        });
      }, {
        module: "lively.project/prompts.cp.js",
        "export": "SaveProjectDialog",
        range: {
          start: 28633,
          end: 32502
        }
      }, __varRecorder__$j.SaveProjectDialog);
      __varRecorder__$j.SaveProjectDialog = SaveProjectDialog;
      __varRecorder__$j.SaveProjectDialog = SaveProjectDialog;

      var __varRecorder__$i = lively.FreezerRuntime.recorderFor("lively.components/responsive.cp.js");

      function getColorForBreakpoint(idx, align) {
        var colorCycles = {
          horizontal: [0, 14, 12, 13].map(function (i) {
            return __varRecorder__$i.Color.rgbHex(__varRecorder__$i.materialDesignColors[i * 15]);
          }),
          vertical: [9, 2, 5, 2].map(function (i) {
            return __varRecorder__$i.Color.rgbHex(__varRecorder__$i.materialDesignColors[i * 15]);
          })
        };
        return colorCycles[align][idx % 4];
      }

      __varRecorder__$i.getColorForBreakpoint = getColorForBreakpoint;
      __varRecorder__$i.component = component;
      __varRecorder__$i.without = without;
      __varRecorder__$i.Color = Color;
      __varRecorder__$i.materialDesignColors = materialDesignColors;
      __varRecorder__$i.rect = rect;
      __varRecorder__$i.pt = pt;
      __varRecorder__$i.Icon = Icon;
      __varRecorder__$i.Path = Path;
      __varRecorder__$i.easings = easings;
      __varRecorder__$i.ViewModel = ViewModel;
      __varRecorder__$i.part = part;
      __varRecorder__$i.TilingLayout = TilingLayout;
      __varRecorder__$i.Label = Label;
      __varRecorder__$i.num = num;
      __varRecorder__$i.arr = arr;
      __varRecorder__$i.signal = signal;
      __varRecorder__$i.disconnect = disconnect;
      __varRecorder__$i.epiConnect = epiConnect;
      __varRecorder__$i.PolicyApplicator = PolicyApplicator;
      __varRecorder__$i.BreakpointStore = BreakpointStore;
      var Arrow = function (superclass) {
        var __lively_classholder__ = lively.FreezerRuntime.recorderFor("lively.components/responsive.cp.js");

        var __lively_class__ = __lively_classholder__.hasOwnProperty("Arrow") && typeof __lively_classholder__.Arrow === "function" ? __lively_classholder__.Arrow : __lively_classholder__.Arrow = function Arrow(__first_arg__) {
          if (__first_arg__ && __first_arg__[Symbol["for"]("lively-instance-restorer")]) ; else {
            return this[Symbol["for"]("lively-instance-initialize")].apply(this, arguments);
          }
        };

        return initializeClass(__lively_class__, superclass, [{
          key: "onHoverIn",
          value: function Arrow_onHoverIn_(evt) {
            this.showControlPoints = true;
          }
        }, {
          key: "onHoverOut",
          value: function Arrow_onHoverOut_(evt) {
            this.showControlPoints = false;
          }
        }], [{
          key: Symbol["for"]("__LivelyClassName__"),
          get: function get() {
            return "Arrow";
          }
        }], __lively_classholder__, {
          pathInPackage: function pathInPackage() {
            return "./responsive.cp.js";
          },
          unsubscribeFromToplevelDefinitionChanges: function unsubscribeFromToplevelDefinitionChanges() {
            return function () {};
          },
          subscribeToToplevelDefinitionChanges: function subscribeToToplevelDefinitionChanges() {
            return function () {};
          },
          "package": function _package() {
            return {
              name: "lively.components",
              version: "0.1.0"
            };
          }
        }, {
          start: 439,
          end: 587
        });
      }(__varRecorder__$i.Path);
      __varRecorder__$i.Arrow = Arrow;
      __varRecorder__$i.Arrow = Arrow;
      __varRecorder__$i.getColorForBreakpoint = getColorForBreakpoint;
      var BreakpointSliderModel = function (superclass) {
        var __lively_classholder__ = lively.FreezerRuntime.recorderFor("lively.components/responsive.cp.js");

        var __lively_class__ = __lively_classholder__.hasOwnProperty("BreakpointSliderModel") && typeof __lively_classholder__.BreakpointSliderModel === "function" ? __lively_classholder__.BreakpointSliderModel : __lively_classholder__.BreakpointSliderModel = function BreakpointSliderModel(__first_arg__) {
          if (__first_arg__ && __first_arg__[Symbol["for"]("lively-instance-restorer")]) ; else {
            return this[Symbol["for"]("lively-instance-initialize")].apply(this, arguments);
          }
        };

        return initializeClass(__lively_class__, superclass, [{
          key: "alignInHalo",
          value: function BreakpointSliderModel_alignInHalo_(offset, halo) {
            this.view.owner;

            if (this.orientation === "vertical") {
              var _halo$viewModel;

              (_halo$viewModel = halo.viewModel) === null || _halo$viewModel === void 0 ? void 0 : _halo$viewModel.alignBreakpointSliderVertically(this.view, offset);
            }

            if (this.orientation === "horizontal") {
              var _halo$viewModel2;

              (_halo$viewModel2 = halo.viewModel) === null || _halo$viewModel2 === void 0 ? void 0 : _halo$viewModel2.alignBreakpointSliderHorizontally(this.view, offset);
            }

            this.ui.userAgentIcon.value = this.getIconForOffset(offset);
            this.ui.pixelView.value = "".concat(offset.toFixed(), " px");
          }
        }, {
          key: "getIconForOffset",
          value: function BreakpointSliderModel_getIconForOffset_(offset) {
            var sections = {
              horizontal: [0, "mobile-screen", 768, "mi-tablet", 1024, "desktop"],
              vertical: [0, "mobile-screen", 1024, "mi-tablet", 1440, "desktop"]
            };

            var ranges = __varRecorder__$i.arr.toTuples(sections[this.orientation], 2).toReversed();

            return __varRecorder__$i.Icon.textAttribute(ranges.find(function (t) {
              return offset >= t[0];
            })[1]);
          }
        }, {
          key: "onDrag",
          value: function BreakpointSliderModel_onDrag_(evt) {
            __varRecorder__$i.signal(this.view, "sliderDrag", evt.state.dragDelta);
          }
        }], [{
          key: Symbol["for"]("__LivelyClassName__"),
          get: function get() {
            return "BreakpointSliderModel";
          }
        }, {
          key: "properties",
          get: function get() {
            return {
              orientation: {
                type: "Enum",
                values: ["vertical", "horizontal"],
                after: ["submorphs", "layout"],
                set: function set(direction) {
                  this.setProperty("orientation", direction);
                }
              },
              breakpointIndex: {},
              expose: {
                get: function get() {
                  return ["onDrag", "breakpointIndex", "alignInHalo", "orientation"];
                }
              }
            };
          }
        }], __lively_classholder__, {
          pathInPackage: function pathInPackage() {
            return "./responsive.cp.js";
          },
          unsubscribeFromToplevelDefinitionChanges: function unsubscribeFromToplevelDefinitionChanges() {
            return function () {};
          },
          subscribeToToplevelDefinitionChanges: function subscribeToToplevelDefinitionChanges() {
            return function () {};
          },
          "package": function _package() {
            return {
              name: "lively.components",
              version: "0.1.0"
            };
          }
        }, {
          start: 922,
          end: 2317
        });
      }(__varRecorder__$i.ViewModel);
      __varRecorder__$i.BreakpointSliderModel = BreakpointSliderModel;
      __varRecorder__$i.BreakpointSliderModel = BreakpointSliderModel;
      __varRecorder__$i.BreakpointHorizontal = __varRecorder__$i.component["for"](function () {
        return __varRecorder__$i.component({
          defaultViewModel: __varRecorder__$i.BreakpointSliderModel,
          clipMode: "hidden",
          rotation: __varRecorder__$i.num.toRadians(0),
          draggable: true,
          extent: __varRecorder__$i.pt(72, 97.1),
          fill: __varRecorder__$i.Color.rgba(46, 75, 223, 0),
          layout: new __varRecorder__$i.TilingLayout({
            align: "right",
            axis: "column",
            axisAlign: "center",
            orderByIndex: true,
            spacing: 5
          }),
          nativeCursor: "grab",
          position: __varRecorder__$i.pt(-86.5, 387.2),
          submorphs: [{
            type: __varRecorder__$i.Label,
            name: "user agent icon",
            fixedHeight: true,
            extent: __varRecorder__$i.pt(21.7, 36.4),
            fontSize: 30.108,
            reactsToPointer: false,
            textAndAttributes: __varRecorder__$i.Icon.textAttribute("mobile")
          }, {
            type: __varRecorder__$i.Label,
            name: "pixel view",
            borderRadius: 7,
            draggable: true,
            fill: __varRecorder__$i.Color.rgba(0, 0, 0, 0.381),
            fontColor: __varRecorder__$i.Color.rgb(255, 255, 255),
            fontSize: 16,
            grabbable: true,
            nativeCursor: "pointer",
            padding: __varRecorder__$i.rect(10, 0, 3, 0),
            reactsToPointer: false,
            textAndAttributes: ["320 px", null]
          }, {
            name: "pin wrapper",
            fill: __varRecorder__$i.Color.rgba(255, 255, 255, 0),
            borderStyle: "none",
            borderColor: __varRecorder__$i.Color.rgb(23, 160, 251),
            borderWidth: 1,
            extent: __varRecorder__$i.pt(30.2, 20.7),
            position: __varRecorder__$i.pt(-8, 27),
            reactsToPointer: false,
            submorphs: [{
              type: __varRecorder__$i.Arrow,
              name: "breakpoint pin",
              origin: __varRecorder__$i.pt(6.9, -2.1),
              borderColor: __varRecorder__$i.Color.rgb(0, 0, 0),
              borderWidth: 2,
              extent: __varRecorder__$i.pt(16.9, 16.6),
              fill: __varRecorder__$i.Color.transparent,
              position: __varRecorder__$i.pt(8.3, 5.1),
              reactsToPointer: false,
              rotation: 0.7853981633974483,
              startMarker: {
                children: [{
                  d: "M0,0 L10,5 L0,10 z",
                  tagName: "path"
                }],
                id: "start-marker",
                markerHeight: "5",
                markerWidth: "5",
                orient: "auto",
                refX: "5",
                refY: "5",
                tagName: "marker",
                viewBox: "0 0 10 10"
              },
              vertices: [{
                position: __varRecorder__$i.pt(0, 0),
                isSmooth: false,
                controlPoints: {
                  next: __varRecorder__$i.pt(0, 0),
                  previous: __varRecorder__$i.pt(0, 0)
                }
              }, {
                position: __varRecorder__$i.pt(16.9, 16.6),
                isSmooth: false,
                controlPoints: {
                  next: __varRecorder__$i.pt(0, 0),
                  previous: __varRecorder__$i.pt(0, 0)
                }
              }]
            }]
          }]
        });
      }, {
        module: "lively.components/responsive.cp.js",
        "export": "BreakpointHorizontal",
        range: {
          start: 2324,
          end: 4503
        }
      }, __varRecorder__$i.BreakpointHorizontal);
      __varRecorder__$i.BreakpointVertical = __varRecorder__$i.component["for"](function () {
        return __varRecorder__$i.component(__varRecorder__$i.BreakpointHorizontal, {
          layout: new __varRecorder__$i.TilingLayout({
            align: "right",
            axisAlign: "center",
            spacing: 5
          }),
          extent: __varRecorder__$i.pt(135, 40),
          submorphs: [{
            name: "user agent icon"
          }, {
            name: "pixel view",
            padding: __varRecorder__$i.rect(10, 0, 0, 0)
          }, {
            name: "pin wrapper",
            extent: __varRecorder__$i.pt(31.9, 30.1),
            rotation: __varRecorder__$i.num.toRadians(-90),
            submorphs: [{
              name: "breakpoint pin",
              origin: __varRecorder__$i.pt(-3.8, -4),
              position: __varRecorder__$i.pt(-0.5, -6.4),
              vertices: [{
                position: __varRecorder__$i.pt(0, 0),
                isSmooth: false,
                controlPoints: {
                  next: __varRecorder__$i.pt(0, 0),
                  previous: __varRecorder__$i.pt(0, 0)
                }
              }, {
                position: __varRecorder__$i.pt(16.9, 16.6),
                isSmooth: false,
                controlPoints: {
                  next: __varRecorder__$i.pt(0, 0),
                  previous: __varRecorder__$i.pt(0, 0)
                }
              }]
            }]
          }]
        });
      }, {
        module: "lively.components/responsive.cp.js",
        "export": "BreakpointVertical",
        range: {
          start: 4511,
          end: 5339
        }
      }, __varRecorder__$i.BreakpointVertical);

      (function (superclass) {
        var __lively_classholder__ = lively.FreezerRuntime.recorderFor("lively.components/responsive.cp.js");

        var __lively_class__ = __lively_classholder__.hasOwnProperty("BreakpointRangeModel") && typeof __lively_classholder__.BreakpointRangeModel === "function" ? __lively_classholder__.BreakpointRangeModel : __lively_classholder__.BreakpointRangeModel = function BreakpointRangeModel(__first_arg__) {
          if (__first_arg__ && __first_arg__[Symbol["for"]("lively-instance-restorer")]) ; else {
            return this[Symbol["for"]("lively-instance-initialize")].apply(this, arguments);
          }
        };

        return initializeClass(__lively_class__, superclass, [{
          key: "onRemoveClicked",
          value: function BreakpointRangeModel_onRemoveClicked_() {
            __varRecorder__$i.signal(this.view, "requestRemove", this.breakpointIndex);
          }
        }], [{
          key: Symbol["for"]("__LivelyClassName__"),
          get: function get() {
            return "BreakpointRangeModel";
          }
        }, {
          key: "properties",
          get: function get() {
            return {
              breakpointIndex: {},
              expose: {
                get: function get() {
                  return ["breakpointIndex"];
                }
              },
              bindings: {
                get: function get() {
                  return [{
                    target: "remove breakpoint",
                    signal: "onMouseDown",
                    handler: "onRemoveClicked"
                  }];
                }
              }
            };
          }
        }], __lively_classholder__, {
          pathInPackage: function pathInPackage() {
            return "./responsive.cp.js";
          },
          unsubscribeFromToplevelDefinitionChanges: function unsubscribeFromToplevelDefinitionChanges() {
            return function () {};
          },
          subscribeToToplevelDefinitionChanges: function subscribeToToplevelDefinitionChanges() {
            return function () {};
          },
          "package": function _package() {
            return {
              name: "lively.components",
              version: "0.1.0"
            };
          }
        }, {
          start: 5342,
          end: 5902
        });
      })(__varRecorder__$i.ViewModel);

      __varRecorder__$i.BreakpointRange = __varRecorder__$i.component["for"](function () {
        return __varRecorder__$i.component({
          defaultViewModel: __varRecorder__$i.BreakpointRangeModel,
          clipMode: "hidden",
          extent: __varRecorder__$i.pt(200, 20),
          layout: new __varRecorder__$i.TilingLayout({
            align: "center",
            axisAlign: "center",
            orderByIndex: true,
            padding: __varRecorder__$i.rect(2, 2, 0, 0),
            spacing: 2
          }),
          submorphs: [{
            type: __varRecorder__$i.Label,
            name: "remove breakpoint",
            nativeCursor: "pointer",
            fontSize: 17,
            textAndAttributes: __varRecorder__$i.Icon.textAttribute("times"),
            tooltip: "remove breakpoint"
          }]
        });
      }, {
        module: "lively.components/responsive.cp.js",
        "export": "BreakpointRange",
        range: {
          start: 5910,
          end: 6381
        }
      }, __varRecorder__$i.BreakpointRange);
      __varRecorder__$i.BreakpointControl = __varRecorder__$i.component["for"](function () {
        return __varRecorder__$i.component({
          name: "breakpoint control",
          clipMode: "hidden",
          borderRadius: 5,
          extent: __varRecorder__$i.pt(545, 20),
          fill: __varRecorder__$i.Color.rgba(81, 90, 90, 0),
          layout: new __varRecorder__$i.TilingLayout({
            align: "top",
            hugContentsHorizontally: true,
            hugContentsVertically: true,
            orderByIndex: true
          }),
          position: __varRecorder__$i.pt(34.4, 1.2),
          submorphs: [__varRecorder__$i.part(__varRecorder__$i.BreakpointRange, {
            name: "base breakpoint",
            extent: __varRecorder__$i.pt(345.4, 20),
            fill: __varRecorder__$i.Color.rgb(244, 67, 54),
            opacity: 0.5,
            submorphs: [__varRecorder__$i.without("remove breakpoint")]
          }), __varRecorder__$i.part(__varRecorder__$i.BreakpointRange, {
            name: "next breakpoint",
            fill: __varRecorder__$i.Color.rgb(255, 152, 0)
          })]
        });
      }, {
        module: "lively.components/responsive.cp.js",
        "export": "BreakpointControl",
        range: {
          start: 6389,
          end: 7013
        }
      }, __varRecorder__$i.BreakpointControl);
      var ResponsiveLayoutHaloModel = function (superclass) {
        var __lively_classholder__ = lively.FreezerRuntime.recorderFor("lively.components/responsive.cp.js");

        var __lively_class__ = __lively_classholder__.hasOwnProperty("ResponsiveLayoutHaloModel") && typeof __lively_classholder__.ResponsiveLayoutHaloModel === "function" ? __lively_classholder__.ResponsiveLayoutHaloModel : __lively_classholder__.ResponsiveLayoutHaloModel = function ResponsiveLayoutHaloModel(__first_arg__) {
          if (__first_arg__ && __first_arg__[Symbol["for"]("lively-instance-restorer")]) ; else {
            return this[Symbol["for"]("lively-instance-initialize")].apply(this, arguments);
          }
        };

        return initializeClass(__lively_class__, superclass, [{
          key: "alignBreakpointSliderVertically",
          value: function ResponsiveLayoutHaloModel_alignBreakpointSliderVertically_(bp, offset) {
            var control = this.ui.verticalBreakpointControl;

            if (!control.env.renderer.getNodeForMorph(control)) {
              control.env.forceUpdate(control);
            }

            var locBounds = control.transformRectToMorph(this.view, control.innerBounds());
            bp.rightCenter = __varRecorder__$i.pt(locBounds.right(), offset + locBounds.top());
          }
        }, {
          key: "alignBreakpointSliderHorizontally",
          value: function ResponsiveLayoutHaloModel_alignBreakpointSliderHorizontally_(bp, offset) {
            var control = this.ui.horizontalBreakpointControl;

            if (!control.env.renderer.getNodeForMorph(control)) {
              control.env.forceUpdate();
            }

            var locBounds = control.transformRectToMorph(this.view, control.innerBounds());

            if (!control.env.renderer.getNodeForMorph(control)) {
              control.env.forceUpdate(control);
            }

            bp.bottomCenter = __varRecorder__$i.pt(offset + locBounds.left(), locBounds.bottom());
          }
        }, {
          key: "ensureStore",
          value: function ResponsiveLayoutHaloModel_ensureStore_() {
            if (!this.target.master) this.target.master = new __varRecorder__$i.PolicyApplicator({
              breakpoints: []
            });
            if (!this.store) this.targetStylePolicy._breakpointStore = new __varRecorder__$i.BreakpointStore();
          }
        }, {
          key: "focusOn",
          value: function ResponsiveLayoutHaloModel_focusOn_(target) {
            this.target = target;
            this.target._responsiveHalo = this.view;

            __varRecorder__$i.epiConnect(target, "onChange", this, "relayout");

            this.update();
          }
        }, {
          key: "close",
          value: function ResponsiveLayoutHaloModel_close_() {
            this.view.remove();

            __varRecorder__$i.disconnect(this.target, "onChange", this, "relayout");

            delete this.target._responsiveHalo;
          }
        }, {
          key: "jumpToHorizontalBreakpoint",
          value: function ResponsiveLayoutHaloModel_jumpToHorizontalBreakpoint_(elem) {
            var bps = this.horizontalBreakpoints;
            var maxLength = this.ui.horizontalBreakpointControl.width;
            var idx = this.ui.horizontalBreakpointControl.submorphs.indexOf(elem);
            if (idx < 0) return;
            this.target.animate({
              width: __varRecorder__$i.num.interpolate(0.9, bps[idx], bps[idx + 1] || maxLength),
              easing: __varRecorder__$i.easings.outExpo,
              duration: 200
            });
          }
        }, {
          key: "jumpToVerticalBreakpoint",
          value: function ResponsiveLayoutHaloModel_jumpToVerticalBreakpoint_(elem) {
            var bps = this.verticalBreakpoints;
            var maxLength = this.ui.verticalBreakpointControl.width;
            var idx = this.ui.verticalBreakpointControl.submorphs.indexOf(elem);
            if (idx < 0) return;
            this.target.animate({
              height: __varRecorder__$i.num.interpolate(0.9, bps[idx], bps[idx + 1] || maxLength),
              easing: __varRecorder__$i.easings.outExpo,
              duration: 200
            });
          }
        }, {
          key: "relayout",
          value: function ResponsiveLayoutHaloModel_relayout_() {
            var _this = this;

            var _this$ui = this.ui,
                horizontalBreakpointControl = _this$ui.horizontalBreakpointControl,
                verticalBreakpointControl = _this$ui.verticalBreakpointControl,
                addHorizontalBreakpointBtn = _this$ui.addHorizontalBreakpointBtn,
                addVerticalBreakpointBtn = _this$ui.addVerticalBreakpointBtn;
            var verticalBreakpoints = this.verticalBreakpoints,
                horizontalBreakpoints = this.horizontalBreakpoints,
                verticalSliders = this.verticalSliders,
                horizontalSliders = this.horizontalSliders,
                view = this.view;
            var padding = 10;
            view.position = this.target.globalPosition.subPt(__varRecorder__$i.pt(27, 33));

            var _iterator = _createForOfIteratorHelper(horizontalSliders),
                _step;

            try {
              for (_iterator.s(); !(_step = _iterator.n()).done;) {
                var slider = _step.value;
                slider.alignInHalo(horizontalBreakpoints[slider.breakpointIndex] || 0, this.view);
              }
            } catch (err) {
              _iterator.e(err);
            } finally {
              _iterator.f();
            }

            var _iterator2 = _createForOfIteratorHelper(verticalSliders),
                _step2;

            try {
              for (_iterator2.s(); !(_step2 = _iterator2.n()).done;) {
                var _slider = _step2.value;

                _slider.alignInHalo(verticalBreakpoints[_slider.breakpointIndex] || 0, this.view);
              }
            } catch (err) {
              _iterator2.e(err);
            } finally {
              _iterator2.f();
            }

            verticalBreakpointControl.submorphs.forEach(function (v, i) {
              var vOffset = (verticalBreakpoints[v.breakpointIndex + 1] || 0) - verticalBreakpoints[v.breakpointIndex];
              v.width = vOffset;

              if (__varRecorder__$i.num.between(_this.target.height, verticalBreakpoints[i] || 0, verticalBreakpoints[i + 1] || _this.target.height + padding)) {
                v.opacity = 1;
              } else v.opacity = 0.5;
            });
            horizontalBreakpointControl.submorphs.forEach(function (h, i) {
              var hOffset = (horizontalBreakpoints[h.breakpointIndex + 1] || 0) - horizontalBreakpoints[h.breakpointIndex];
              h.width = hOffset;

              if (__varRecorder__$i.num.between(_this.target.width, horizontalBreakpoints[i], horizontalBreakpoints[i + 1] || _this.target.width + padding)) {
                h.opacity = 1;
              } else h.opacity = 0.5;
            });

            var lastV = __varRecorder__$i.arr.last(verticalBreakpointControl.submorphs);

            lastV.width = Math.max(200, this.target.height - (__varRecorder__$i.arr.last(verticalBreakpoints) || 0) + padding);

            var lastH = __varRecorder__$i.arr.last(horizontalBreakpointControl.submorphs);

            lastH.width = Math.max(200, this.target.width - (__varRecorder__$i.arr.last(horizontalBreakpoints) || 0) + padding);
            addVerticalBreakpointBtn.top = verticalBreakpointControl.bottom + 10;
            addHorizontalBreakpointBtn.left = horizontalBreakpointControl.right + 10;
          }
        }, {
          key: "updateBreakpoints",
          value: function ResponsiveLayoutHaloModel_updateBreakpoints_(control, breakpoints, align) {
            var _this2 = this;

            var newElems = __varRecorder__$i.arr.range(0, Math.max(0, breakpoints.length - 1)).map(function (i) {
              if (i > 0) {
                _this2.view.addMorph(__varRecorder__$i.part(align === "horizontal" ? __varRecorder__$i.BreakpointHorizontal : __varRecorder__$i.BreakpointVertical, {
                  name: align + " slider " + (i - 1),
                  position: __varRecorder__$i.pt(0, 0),
                  tooltip: "Drag to change the breakpoint position.",
                  viewModel: {
                    orientation: align,
                    breakpointIndex: i
                  }
                }));
              }

              return __varRecorder__$i.part(__varRecorder__$i.BreakpointRange, {
                name: align + " breakpoint " + i,
                position: __varRecorder__$i.pt(0, 0),
                fill: __varRecorder__$i.getColorForBreakpoint(i, align),
                viewModel: {
                  breakpointIndex: i
                },
                submorphs: i == 0 ? [__varRecorder__$i.without("remove breakpoint")] : []
              });
            });

            control.submorphs = newElems;
          }
        }, {
          key: "update",
          value: function ResponsiveLayoutHaloModel_update_() {
            var _this$ui2 = this.ui,
                verticalBreakpointControl = _this$ui2.verticalBreakpointControl,
                horizontalBreakpointControl = _this$ui2.horizontalBreakpointControl;
            var verticalBreakpoints = this.verticalBreakpoints,
                horizontalBreakpoints = this.horizontalBreakpoints,
                sliders = this.sliders;
            sliders.forEach(function (slider) {
              return slider.remove();
            });
            this.updateBreakpoints(verticalBreakpointControl, verticalBreakpoints, "vertical");
            this.updateBreakpoints(horizontalBreakpointControl, horizontalBreakpoints, "horizontal");
            this.relayout();
          }
        }, {
          key: "addHorizontalBreakpoint",
          value: function ResponsiveLayoutHaloModel_addHorizontalBreakpoint_() {
            var horizontalBreakpointControl = this.ui.horizontalBreakpointControl;
            this.ensureStore();
            this.store.addHorizontalBreakpoint(horizontalBreakpointControl.width);
            this.update();

            __varRecorder__$i.signal(this.target, "breakpoint added");

            this.refreshChangeTrackers();
          }
        }, {
          key: "addVerticalBreakpoint",
          value: function ResponsiveLayoutHaloModel_addVerticalBreakpoint_() {
            var verticalBreakpointControl = this.ui.verticalBreakpointControl;
            this.ensureStore();
            this.store.addVerticalBreakpoint(verticalBreakpointControl.width);
            this.update();

            __varRecorder__$i.signal(this.target, "breakpoint added");

            this.refreshChangeTrackers();
          }
        }, {
          key: "removeHorizontalBreakpoint",
          value: function ResponsiveLayoutHaloModel_removeHorizontalBreakpoint_(idx) {
            this.store.removeHorizontalBreakpoint(idx);
            this.update();

            __varRecorder__$i.signal(this.target, "breakpoint removed");

            this.refreshChangeTrackers();
          }
        }, {
          key: "removeVerticalBreakpoint",
          value: function ResponsiveLayoutHaloModel_removeVerticalBreakpoint_(idx) {
            this.store.removeVerticalBreakpoint(idx);
            this.update();

            __varRecorder__$i.signal(this.target, "breakpoint removed");

            this.refreshChangeTrackers();
          }
        }, {
          key: "onSliderDrag",
          value: function ResponsiveLayoutHaloModel_onSliderDrag_(slider, dragDelta) {
            var orientation = slider.orientation;
            var breakpointAccessor = orientation + "Breakpoints";
            var axis = orientation === "horizontal" ? "x" : "y";
            var delta = dragDelta[axis];
            var idx = slider.breakpointIndex;
            var bps = this.store["_" + breakpointAccessor];
            var lowerBound = bps[idx - 1] || 0;
            var upperBound = bps[idx + 1] || Infinity;
            bps[idx] += delta;
            if (bps[idx] < lowerBound) bps[idx] = lowerBound + 1;
            if (bps[idx] > upperBound) bps[idx] = upperBound - 1;
            this.relayout();

            __varRecorder__$i.signal(this.target, "breakpoint changed");

            this.refreshChangeTrackers();
            this.target.master.applyIfNeeded(true);
          }
        }, {
          key: "refreshChangeTrackers",
          value: function ResponsiveLayoutHaloModel_refreshChangeTrackers_() {
            if (!this.target._changeTracker) return;

            this.target._changeTracker.processChangeInComponent({
              prop: "master",
              meta: {
                reconcileChanges: true
              },
              target: this.target,
              value: this.targetStylePolicy
            });
          }
        }], [{
          key: Symbol["for"]("__LivelyClassName__"),
          get: function get() {
            return "ResponsiveLayoutHaloModel";
          }
        }, {
          key: "properties",
          get: function get() {
            return {
              horizontalBreakpoints: {
                get: function get() {
                  var _this$store;

                  return ((_this$store = this.store) === null || _this$store === void 0 ? void 0 : _this$store._horizontalBreakpoints) || [0];
                }
              },
              verticalBreakpoints: {
                get: function get() {
                  var _this$store2;

                  return ((_this$store2 = this.store) === null || _this$store2 === void 0 ? void 0 : _this$store2._verticalBreakpoints) || [0];
                }
              },
              store: {
                get: function get() {
                  var _this$targetStylePoli;

                  return (_this$targetStylePoli = this.targetStylePolicy) === null || _this$targetStylePoli === void 0 ? void 0 : _this$targetStylePoli._breakpointStore;
                }
              },
              targetStylePolicy: {
                get: function get() {
                  var stylePolicy = this.target.master;
                  if (stylePolicy.overriddenMaster) stylePolicy = stylePolicy.overriddenMaster;
                  return stylePolicy;
                }
              },
              sliders: {
                get: function get() {
                  return this.view.getAllNamed(/slider/);
                }
              },
              verticalSliders: {
                get: function get() {
                  return this.sliders.filter(function (slider) {
                    return slider.orientation === "vertical";
                  });
                }
              },
              horizontalSliders: {
                get: function get() {
                  return this.sliders.filter(function (slider) {
                    return slider.orientation === "horizontal";
                  });
                }
              },
              target: {},
              isHaloItem: {
                get: function get() {
                  return true;
                }
              },
              expose: {
                get: function get() {
                  return ["focusOn", "close", "isHaloItem", "alignBreakpointSliderVertically", "alignBreakpointSliderHorizontally"];
                }
              },
              bindings: {
                get: function get() {
                  return [{
                    target: "add vertical breakpoint btn",
                    signal: "onMouseDown",
                    handler: "addVerticalBreakpoint"
                  }, {
                    target: "add horizontal breakpoint btn",
                    signal: "onMouseDown",
                    handler: "addHorizontalBreakpoint"
                  }, {
                    target: /horizontal breakpoint/,
                    signal: "onMouseDown",
                    handler: "jumpToHorizontalBreakpoint",
                    converter: "() => source"
                  }, {
                    target: /vertical breakpoint/,
                    signal: "onMouseDown",
                    handler: "jumpToVerticalBreakpoint",
                    converter: "() => source"
                  }, {
                    target: /vertical breakpoint/,
                    signal: "requestRemove",
                    handler: "removeVerticalBreakpoint"
                  }, {
                    target: /horizontal breakpoint/,
                    signal: "requestRemove",
                    handler: "removeHorizontalBreakpoint"
                  }, {
                    target: /slider/,
                    signal: "sliderDrag",
                    handler: "onSliderDrag",
                    updater: "($upd, dragDelta) => { $upd(source, dragDelta)}"
                  }];
                }
              }
            };
          }
        }], __lively_classholder__, {
          pathInPackage: function pathInPackage() {
            return "./responsive.cp.js";
          },
          unsubscribeFromToplevelDefinitionChanges: function unsubscribeFromToplevelDefinitionChanges() {
            return function () {};
          },
          subscribeToToplevelDefinitionChanges: function subscribeToToplevelDefinitionChanges() {
            return function () {};
          },
          "package": function _package() {
            return {
              name: "lively.components",
              version: "0.1.0"
            };
          }
        }, {
          start: 7022,
          end: 17259
        });
      }(__varRecorder__$i.ViewModel);
      __varRecorder__$i.ResponsiveLayoutHaloModel = ResponsiveLayoutHaloModel;
      __varRecorder__$i.ResponsiveLayoutHaloModel = ResponsiveLayoutHaloModel;
      var ResponsiveLayoutHalo = __varRecorder__$i.component["for"](function () {
        return __varRecorder__$i.component({
          defaultViewModel: __varRecorder__$i.ResponsiveLayoutHaloModel,
          name: "responsive layout halo",
          hasFixedPosition: true,
          styleClasses: ["Halo"],
          borderColor: __varRecorder__$i.Color.rgb(230, 126, 34),
          draggable: true,
          extent: __varRecorder__$i.pt(35.1, 35),
          fill: __varRecorder__$i.Color.rgba(46, 75, 223, 0),
          grabbable: true,
          position: __varRecorder__$i.pt(1272.9, 345.2),
          submorphs: [__varRecorder__$i.part(__varRecorder__$i.BreakpointVertical, {
            name: "vertical slider",
            viewModel: {
              orientation: "vertical"
            },
            position: __varRecorder__$i.pt(-120.4, 343)
          }), __varRecorder__$i.part(__varRecorder__$i.BreakpointHorizontal, {
            name: "horizontal slider",
            viewModel: {
              orientation: "horizontal"
            },
            position: __varRecorder__$i.pt(336.1, -92.5)
          }), {
            name: "horizontal control wrapper",
            borderStyle: "none",
            fill: __varRecorder__$i.Color.rgba(255, 255, 255, 0),
            layout: new __varRecorder__$i.TilingLayout({
              axisAlign: "center",
              hugContentsHorizontally: true,
              hugContentsVertically: true,
              orderByIndex: true,
              spacing: 7
            }),
            borderColor: __varRecorder__$i.Color.rgb(23, 160, 251),
            borderWidth: 1,
            extent: __varRecorder__$i.pt(581, 41),
            position: __varRecorder__$i.pt(26.8, -8.2),
            submorphs: [__varRecorder__$i.part(__varRecorder__$i.BreakpointControl, {
              name: "horizontal breakpoint control",
              position: __varRecorder__$i.pt(9.2, 14.7),
              reactsToPointer: false
            }), {
              type: __varRecorder__$i.Label,
              name: "add horizontal breakpoint btn",
              fontSize: 30.108,
              nativeCursor: "pointer",
              position: __varRecorder__$i.pt(565.2, 11.2),
              textAndAttributes: __varRecorder__$i.Icon.textAttribute("plus-circle"),
              tooltip: "Add a horizontal breakpoint"
            }]
          }, {
            name: "vertical control wrapper",
            borderStyle: "none",
            fill: __varRecorder__$i.Color.rgba(255, 255, 255, 0),
            layout: new __varRecorder__$i.TilingLayout({
              axis: "column",
              axisAlign: "center",
              hugContentsHorizontally: true,
              hugContentsVertically: true,
              orderByIndex: true
            }),
            borderColor: __varRecorder__$i.Color.rgb(23, 160, 251),
            borderWidth: 1,
            extent: __varRecorder__$i.pt(137.2, 537.8),
            position: __varRecorder__$i.pt(-14.2, 32.6),
            submorphs: [__varRecorder__$i.part(__varRecorder__$i.BreakpointControl, {
              name: "vertical breakpoint control",
              extent: __varRecorder__$i.pt(548, 20),
              position: __varRecorder__$i.pt(78.8, 5.3),
              rotation: 1.570796326794897,
              submorphs: [{
                name: "base breakpoint",
                extent: __varRecorder__$i.pt(331.2, 20),
                fill: __varRecorder__$i.Color.rgb(76, 175, 80)
              }, {
                name: "next breakpoint",
                extent: __varRecorder__$i.pt(194.9, 20),
                fill: __varRecorder__$i.Color.rgb(156, 39, 176),
                opacity: 0.5
              }]
            }), {
              type: __varRecorder__$i.Label,
              name: "add vertical breakpoint btn",
              padding: __varRecorder__$i.rect(5, 0, 0, 0),
              fontSize: 30.108,
              nativeCursor: "pointer",
              position: __varRecorder__$i.pt(-3.2, 527.4),
              textAndAttributes: __varRecorder__$i.Icon.textAttribute("plus-circle"),
              tooltip: "Add a vertical breakpoint"
            }]
          }]
        });
      }, {
        module: "lively.components/responsive.cp.js",
        "export": "ResponsiveLayoutHalo",
        range: {
          start: 17273,
          end: 19920
        }
      }, __varRecorder__$i.ResponsiveLayoutHalo);
      __varRecorder__$i.ResponsiveLayoutHalo = ResponsiveLayoutHalo;
      __varRecorder__$i.ResponsiveLayoutHalo = ResponsiveLayoutHalo;

      var _this = undefined;

      var __varRecorder__$h = lively.FreezerRuntime.recorderFor("lively.ide/world-commands.js");
      __varRecorder__$h.Rectangle = Rectangle;
      __varRecorder__$h.rect = rect;
      __varRecorder__$h.Color = Color;
      __varRecorder__$h.pt = pt;
      __varRecorder__$h.tree = tree;
      __varRecorder__$h.date = date;
      __varRecorder__$h.arr = arr;
      __varRecorder__$h.string = string;
      __varRecorder__$h.obj = obj;
      __varRecorder__$h.inspect = inspect;
      __varRecorder__$h.morph = morph;
      __varRecorder__$h.Text = Text;
      __varRecorder__$h.config = config;
      __varRecorder__$h.part = part;
      __varRecorder__$h.KeyHandler = KeyHandler;
      __varRecorder__$h.interactivelySaveWorld = interactivelySaveWorld;
      __varRecorder__$h.show = show;
      __varRecorder__$h.showAndSnapToGuides = showAndSnapToGuides;
      __varRecorder__$h.removeSnapToGuidesOf = removeSnapToGuidesOf;
      __varRecorder__$h.LoadingIndicator = LoadingIndicator;
      __varRecorder__$h.createMorphSnapshot = createMorphSnapshot;
      __varRecorder__$h.BrowserModuleTranslationCache = BrowserModuleTranslationCache;
      __varRecorder__$h.modules = modules;
      __varRecorder__$h.once = once;
      __varRecorder__$h.CodeSearch = CodeSearch;
      __varRecorder__$h.WorldBrowser = WorldBrowser;
      __varRecorder__$h.WorldBrowserModel = WorldBrowserModel;
      __varRecorder__$h.Console = Console;
      __varRecorder__$h.WindowSwitcher = WindowSwitcher;
      __varRecorder__$h.browserForFile = browserForFile;
      __varRecorder__$h.SaveProjectDialog = SaveProjectDialog;
      __varRecorder__$h.Project = Project;
      __varRecorder__$h.StatusMessageConfirm = StatusMessageConfirm;
      __varRecorder__$h.ResponsiveLayoutHalo = ResponsiveLayoutHalo;
      __varRecorder__$h.commands = [{
        name: "clear storage and reload",
        exec: function () {
          var _exec = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee() {
            var proceed, browserModule;
            return regeneratorRuntime.wrap(function _callee$(_context) {
              while (1) {
                switch (_context.prev = _context.next) {
                  case 0:
                    _context.next = 2;
                    return $world.confirm(["Caution\n", {}, "Proceeding will clear all local storage and reload the page! Make sure if you want to save your world before you continue.", {
                      fontSize: 15,
                      fontWeight: "normal"
                    }], {
                      width: 400
                    });

                  case 2:
                    proceed = _context.sent;

                    if (proceed) {
                      localStorage.clear();
                      browserModule = new __varRecorder__$h.BrowserModuleTranslationCache("2");
                      browserModule.closeDb();
                      browserModule.deleteDb();
                      window.location.reload(true);
                    }

                  case 4:
                  case "end":
                    return _context.stop();
                }
              }
            }, _callee);
          }));

          function exec() {
            return _exec.apply(this, arguments);
          }

          return exec;
        }()
      }, {
        name: "undo",
        exec: function exec(world) {
          if (world.focusedMorph && world.focusedMorph !== world && world.focusedMorph.undoManager) return false;
          world.env.undoManager.undo();
          return true;
        }
      }, {
        name: "redo",
        exec: function exec(world) {
          if (world.focusedMorph && world.focusedMorph !== world && world.focusedMorph.undoManager) return false;
          world.env.undoManager.redo();
          return true;
        }
      }, {
        name: "run command",
        handlesCount: true,
        exec: function () {
          var _exec2 = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee2(world, args, count) {
            var target, items, _yield$world$filterab, _yield$world$filterab2, cmd;

            return regeneratorRuntime.wrap(function _callee2$(_context2) {
              while (1) {
                switch (_context2.prev = _context2.next) {
                  case 0:
                    target = world.focusedMorph || world;
                    items = __varRecorder__$h.KeyHandler.generateCommandToKeybindingMap(target, true).map(function (ea) {
                      var prettyKeys = ea.prettyKeys,
                          target = ea.target,
                          name = ea.command.name;
                      var targetName = target.constructor.name;
                      var keysPrinted = prettyKeys ? prettyKeys.join(", ") : "";
                      return {
                        isListItem: true,
                        value: ea,
                        label: ["".concat(targetName), {
                          fontSize: "80%",
                          textStyleClasses: ["v-center-text"],
                          paddingRight: "10px"
                        }, "".concat(name), null],
                        annotation: [keysPrinted, {
                          fontSize: "80%",
                          textStyleClasses: ["truncated-text"],
                          paddingRight: "5px",
                          maxWidth: 140
                        }]
                      };
                    });
                    _context2.next = 4;
                    return world.filterableListPrompt("Run command", items, {
                      historyId: "lively.morphic-run command",
                      requester: target,
                      extent: __varRecorder__$h.pt(700, 600)
                    });

                  case 4:
                    _yield$world$filterab = _context2.sent;
                    _yield$world$filterab2 = _slicedToArray(_yield$world$filterab.selected, 1);
                    cmd = _yield$world$filterab2[0];
                    return _context2.abrupt("return", cmd ? cmd.target.execCommand(cmd.command, args, count) : true);

                  case 8:
                  case "end":
                    return _context2.stop();
                }
              }
            }, _callee2);
          }));

          function exec(_x, _x2, _x3) {
            return _exec2.apply(this, arguments);
          }

          return exec;
        }()
      }, {
        name: "show command history",
        exec: function exec(world, args) {
          var handler = world.commandHandler;

          var items = __varRecorder__$h.arr.sortBy(handler.history, function (ea) {
            return -ea.time;
          }).map(function (cmd) {
            return {
              isListItem: true,
              string: handler.printCommand(cmd),
              value: cmd
            };
          });

          $world.editListPrompt("select commands", items, {
            multiSelect: true,
            requester: world
          });
          return true;
        }
      }, {
        name: "show halo for focused morph",
        exec: function exec(world) {
          var morph = world.focusedMorph;
          world.showHaloFor(morph.getWindow() || morph, world.firstHand.pointerId);
          return true;
        }
      }, {
        name: "show morph",
        exec: function exec(world, _ref) {
          var morph = _ref.morph,
              _ref$loop = _ref.loop,
              loop = _ref$loop === void 0 ? false : _ref$loop;

          __varRecorder__$h.show(morph, loop);
        }
      }, {
        name: "show and snap to guides",
        exec: function exec(world, _ref2) {
          var target = _ref2.target,
              showGuides = _ref2.showGuides,
              snap = _ref2.snap;

          __varRecorder__$h.showAndSnapToGuides(target, showGuides, snap);
        }
      }, {
        name: "remove snap to guides",
        exec: function exec(world, target) {
          __varRecorder__$h.removeSnapToGuidesOf(target);
        }
      }, {
        name: "copy morph",
        exec: function exec(world) {
          var morph = world.focusedMorph;

          if (!morph || morph === world) {
            $world.setStatusMessage("no morph selected");
            return true;
          }

          var target = morph.getWindow() || morph;
          var copy = target.copy();
          copy.openInWorld(target.globalPosition.addXY(10, 10));
          if (copy.isWindow) copy.activate();
          return copy;
        }
      }, {
        name: "select morph",
        exec: function () {
          var _exec3 = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee3(world) {
            var opts,
                i,
                filterFn,
                selectionFn,
                _yield$import,
                ObjectPackage,
                items,
                actions,
                lastSelected,
                _yield$selectionFn,
                morphs,
                action,
                _args3 = arguments;

            return regeneratorRuntime.wrap(function _callee3$(_context3) {
              while (1) {
                switch (_context3.prev = _context3.next) {
                  case 0:
                    opts = _args3.length > 1 && _args3[1] !== undefined ? _args3[1] : {
                      root: world,
                      selectionFn: null,
                      justReturn: false,
                      requester: world,
                      filterFn: null,
                      prependItems: [],
                      prompt: null,
                      remote: false
                    };
                    i = 0;

                    filterFn = opts.filterFn || function () {
                      return true;
                    };

                    selectionFn = opts.selectionFn || function (title, items, opts) {
                      return world.filterableListPrompt(title, items, opts);
                    };

                    _context3.next = 6;
                    return module.import('./object-classes-cce74fc2.js');

                  case 6:
                    _yield$import = _context3.sent;
                    ObjectPackage = _yield$import["default"];
                    items = __varRecorder__$h.arr.compact(__varRecorder__$h.tree.map(opts.root || world, function (m, depth) {
                      if (!filterFn(m)) return null;
                      var isObjectPackage = !!ObjectPackage.lookupPackageForObject(m);
                      return {
                        isListItem: true,
                        label: ["".concat(String(++i)).concat("\u2003".repeat(depth)), {
                          fontSize: "80%",
                          textStyleClasses: ["v-center-text"],
                          paddingRight: "10px"
                        }, "".concat(m), {
                          fontWeight: isObjectPackage ? "bolder" : "normal",
                          fontStyle: isObjectPackage ? "normal" : "italic",
                          fontFamily: "Inconsolata",
                          fontSize: 16
                        }, isObjectPackage ? " [Object Class]" : "", {
                          opacity: 0.5
                        }],
                        value: m
                      };
                    }, function (m) {
                      return filterFn(m) ? m.submorphs : [];
                    }));
                    actions = ["show halo", "open object editor", "open object inspector"];
                    _context3.next = 12;
                    return selectionFn(opts.prompt || "Choose morph", (opts.prependItems || []).concat(items), {
                      historyId: "lively.morphic-select morph",
                      onSelection: function onSelection(sel) {
                        if (_this.lastSelectionHalo) _this.lastSelectionHalo.remove();

                        if (sel && sel.show && lastSelected !== sel) {
                          _this.lastSelectionHalo = sel.show();
                          lastSelected = sel;
                        }
                      },
                      selectedAction: "show halo",
                      actions: actions
                    });

                  case 12:
                    _yield$selectionFn = _context3.sent;
                    morphs = _yield$selectionFn.selected;
                    action = _yield$selectionFn.action;

                    if (!opts.justReturn) {
                      _context3.next = 17;
                      break;
                    }

                    return _context3.abrupt("return", morphs);

                  case 17:
                    morphs.forEach(function (m) {
                      if (action === actions[0]) world.showHaloFor(m);else if (action === actions[1]) world.execCommand("open object editor", {
                        target: m
                      });else if (action === actions[2]) world.execCommand("open object inspector", {
                        target: m
                      });
                    });
                    return _context3.abrupt("return", morphs);

                  case 19:
                  case "end":
                    return _context3.stop();
                }
              }
            }, _callee3);
          }));

          function exec(_x4) {
            return _exec3.apply(this, arguments);
          }

          return exec;
        }()
      }, {
        name: "print morph(s)",
        exec: function () {
          var _exec4 = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee4(world) {
            var finishedSelection, selectedMorphs, _yield$world$execComm, _yield$world$execComm2, _morph, li, _yield$import2, L2LClient, l2l, peers, printer, opts, msg, err;

            return regeneratorRuntime.wrap(function _callee4$(_context4) {
              while (1) {
                switch (_context4.prev = _context4.next) {
                  case 0:
                    finishedSelection = false;
                    selectedMorphs = [];

                  case 2:
                    if (finishedSelection) {
                      _context4.next = 14;
                      break;
                    }

                    _context4.next = 5;
                    return world.execCommand("select morph", {
                      justReturn: true
                    });

                  case 5:
                    _yield$world$execComm = _context4.sent;
                    _yield$world$execComm2 = _slicedToArray(_yield$world$execComm, 1);
                    _morph = _yield$world$execComm2[0];
                    selectedMorphs.push(_morph);
                    _context4.next = 11;
                    return world.confirm("Select additional morphs?", {
                      rejectLabel: "NO"
                    });

                  case 11:
                    finishedSelection = !_context4.sent;
                    _context4.next = 2;
                    break;

                  case 14:
                    li = __varRecorder__$h.LoadingIndicator.open("printing morph...");
                    _context4.next = 17;
                    return module.import('./__rootModule___commonjs-entry-2a340242.js').then(function (n) { return n.gb; });

                  case 17:
                    _yield$import2 = _context4.sent;
                    L2LClient = _yield$import2["default"];
                    l2l = L2LClient["default"]();
                    _context4.next = 22;
                    return l2l.listPeers(true);

                  case 22:
                    peers = _context4.sent;
                    printer = peers.find(function (ea) {
                      return ea.type === "pdf printer";
                    });
                    opts = {
                      ackTimeout: 30000
                    };
                    _context4.t0 = l2l;
                    _context4.t1 = printer.id;
                    _context4.next = 29;
                    return Promise.all(selectedMorphs.map(function (m) {
                      return __varRecorder__$h.createMorphSnapshot(m, {
                        addPreview: false,
                        testLoad: false
                      });
                    }));

                  case 29:
                    _context4.t2 = _context4.sent;
                    _context4.t3 = opts;
                    _context4.next = 33;
                    return _context4.t0.sendToAndWait.call(_context4.t0, _context4.t1, "[PDF printer] print", _context4.t2, _context4.t3);

                  case 33:
                    msg = _context4.sent;
                    err = msg.error || msg.data.error;

                    if (!err) {
                      _context4.next = 38;
                      break;
                    }

                    world.showError(err);
                    throw err;

                  case 38:
                    world.serveFileAsDownload(msg.data, {
                      fileName: selectedMorphs[0].name + (selectedMorphs.length > 1 ? ".etc" : "") + ".pdf",
                      type: "application/pdf"
                    });
                    li.remove();

                  case 40:
                  case "end":
                    return _context4.stop();
                }
              }
            }, _callee4);
          }));

          function exec(_x5) {
            return _exec4.apply(this, arguments);
          }

          return exec;
        }()
      }, {
        name: "escape",
        exec: function exec(world, _1, _2, evt) {
          var eventState = world.env.eventDispatcher.eventState;
          if (eventState.menu) eventState.menu.remove();
          var halos = world.halos();
          halos.forEach(function (h) {
            return h.remove();
          });
          world.hands.forEach(function (ea) {
            return ea.cancelGrab(true, evt);
          });
          var f = __varRecorder__$h.arr.last(halos) && __varRecorder__$h.arr.last(halos).target || world.focusedMorph || world;
          f.focus();

          if (f.isText) {
            f.selection.disableMultiSelect && f.selection.disableMultiSelect();
          }

          return false;
        }
      }, {
        name: "move or resize halo target",
        exec: function exec(world) {
          var opts = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {
            direction: "left",
            offset: 1,
            what: "move"
          };
          var halo = world.halos()[0];
          if (!halo || halo.changingName) return false;
          if (world.focusedMorph !== halo) return false;
          var direction = opts.direction,
              offset = opts.offset,
              what = opts.what;
          var t = halo.target;
          offset = offset || 1;
          t.withMetaDo({
            reconcileChanges: true
          }, function () {
            switch (direction) {
              case "left":
                t[what === "move" ? "left" : "width"] -= offset;
                break;

              case "right":
                t[what === "move" ? "left" : "width"] += offset;
                break;

              case "up":
                t[what === "move" ? "top" : "height"] -= offset;
                break;

              case "down":
                t[what === "move" ? "top" : "height"] += offset;
                break;
            }
          });
          halo.alignWithTarget();
          return true;
        }
      }, {
        name: "close halo target",
        exec: function exec(world) {
          var halo = world.halos()[0];
          var focusedMorph = $world.focusedMorph;

          if (!halo || halo.changingName || focusedMorph.isText || focusedMorph.isNumberWidget) {
            return false;
          }

          if (halo.target.selectedMorphs) {
            halo.target.selectedMorphs.forEach(function (m) {
              return m.abandon();
            });
            world.halos()[0].remove();
          } else halo.target.abandon();

          return true;
        }
      }, {
        name: "resize manually",
        exec: function () {
          var _exec5 = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee5(world) {
            var args,
                width,
                height,
                winBounds,
                bounds,
                _args5 = arguments;
            return regeneratorRuntime.wrap(function _callee5$(_context5) {
              while (1) {
                switch (_context5.prev = _context5.next) {
                  case 0:
                    args = _args5.length > 1 && _args5[1] !== undefined ? _args5[1] : {};
                    winBounds = world.windowBounds();
                    bounds = world.bounds();
                    _context5.t0 = Number;
                    _context5.t1 = args.width;

                    if (_context5.t1) {
                      _context5.next = 9;
                      break;
                    }

                    _context5.next = 8;
                    return world.prompt("Enter world width", {
                      input: Math.max(bounds.width, winBounds.width),
                      requester: world
                    });

                  case 8:
                    _context5.t1 = _context5.sent;

                  case 9:
                    _context5.t2 = _context5.t1;
                    width = (0, _context5.t0)(_context5.t2);

                    if (!(typeof width === "number")) {
                      _context5.next = 20;
                      break;
                    }

                    _context5.t3 = Number;
                    _context5.t4 = args.height;

                    if (_context5.t4) {
                      _context5.next = 18;
                      break;
                    }

                    _context5.next = 17;
                    return world.prompt("Enter world height", {
                      input: Math.max(bounds.height, winBounds.height),
                      requester: world
                    });

                  case 17:
                    _context5.t4 = _context5.sent;

                  case 18:
                    _context5.t5 = _context5.t4;
                    height = (0, _context5.t3)(_context5.t5);

                  case 20:
                    if (typeof width === "number" && !isNaN(width) && typeof height === "number" && !isNaN(height)) {
                      world.extent = __varRecorder__$h.pt(width, height);
                    }

                    return _context5.abrupt("return", true);

                  case 22:
                  case "end":
                    return _context5.stop();
                }
              }
            }, _callee5);
          }));

          function exec(_x6) {
            return _exec5.apply(this, arguments);
          }

          return exec;
        }()
      }, {
        name: "resize windows to fit visible world bounds",
        exec: function exec(world) {
          var windows = world.getWindows().filter(function (ea) {
            return !ea.minimized;
          });
          if (!windows.length) return true;
          var visibleBounds = world.visibleBoundsExcludingTopBar();
          var windowBoundsCombined = windows.reduce(function (bounds, win) {
            return win.bounds().union(bounds);
          }, new __varRecorder__$h.Rectangle(0, 0, 0, 0));
          var scaleX = visibleBounds.width / windowBoundsCombined.width;
          var scaleY = visibleBounds.height / windowBoundsCombined.height;
          windows.forEach(function (ea) {
            var _ea$bounds = ea.bounds(),
                x = _ea$bounds.x,
                y = _ea$bounds.y,
                width = _ea$bounds.width,
                height = _ea$bounds.height;

            ea.setBounds(new __varRecorder__$h.Rectangle(x * scaleX, y * scaleY, width * scaleX, height * scaleY));
          });
          return true;
        }
      }, {
        name: "window switcher",
        exec: function () {
          var _exec6 = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee6(world) {
            return regeneratorRuntime.wrap(function _callee6$(_context6) {
              while (1) {
                switch (_context6.prev = _context6.next) {
                  case 0:
                    if (!$world.get("window switcher")) {
                      _context6.next = 2;
                      break;
                    }

                    return _context6.abrupt("return");

                  case 2:
                    if (!($world.getWindows().length === 0)) {
                      _context6.next = 5;
                      break;
                    }

                    $world.setStatusMessage("No windows opened.");
                    return _context6.abrupt("return");

                  case 5:
                    $world.addMorph(__varRecorder__$h.part(__varRecorder__$h.WindowSwitcher));

                  case 6:
                  case "end":
                    return _context6.stop();
                }
              }
            }, _callee6);
          }));

          function exec(_x7) {
            return _exec6.apply(this, arguments);
          }

          return exec;
        }()
      }, {
        name: "close active window or morph",
        exec: function exec(world) {
          var focused = world.focusedMorph;
          if (!focused) return true;
          var win = focused.getWindow();
          world.undoStart("window close");
          if (win) win.close();else {
            __varRecorder__$h.arr.last(__varRecorder__$h.arr.without(focused.ownerChain(), world)).remove();

            win = world.activeWindow();
            win && win.activate();
          }
          world.undoStop("window close");
          return true;
        }
      }, {
        name: "toggle minimize active window",
        exec: function exec(world) {
          var win = world.activeWindow();
          win && win.toggleMinimize();
          return true;
        }
      }, {
        name: "toggle minimize all windows",
        exec: function exec(world) {
          var allWindows = world.getWindows();
          allWindows && allWindows.map(function (w) {
            return w.toggleMinimize();
          });
          return true;
        }
      }, {
        name: "toggle minimize all except active window",
        exec: function exec(world) {
          var allWindowsExceptActive = world.getWindows().filter(function (w) {
            return !w.isActive();
          });
          allWindowsExceptActive && allWindowsExceptActive.map(function (w) {
            return w.toggleMinimize();
          });
          return true;
        }
      }, {
        name: "close all except active window",
        exec: function exec(world) {
          var allWindowsExceptActive = world.getWindows().filter(function (w) {
            return !w.isActive();
          });
          allWindowsExceptActive && allWindowsExceptActive.map(function (w) {
            return w.close();
          });
          return true;
        }
      }, {
        name: "close all like this window",
        exec: function exec(world) {
          var activeWindow = world.getWindows().filter(function (w) {
            return w.isActive();
          })[0];
          var type = activeWindow.name.replace("window for", "");
          var allWindowsLikeThis = world.getWindows().filter(function (w) {
            return w.name.replace("window for", "") === type;
          });
          allWindowsLikeThis.map(function (w) {
            return w.close();
          });
          return true;
        }
      }, {
        name: "close all windows",
        exec: function exec(world) {
          var allWindows = world.getWindows();
          allWindows && allWindows.map(function (w) {
            return w.close();
          });
          return true;
        }
      }, {
        name: "open status message of focused morph",
        exec: function exec(world) {
          var focused = world.focusedMorph;

          var _ref3 = focused ? world.visibleStatusMessagesFor(focused) : [],
              _ref4 = _slicedToArray(_ref3, 1),
              msg = _ref4[0];

          if (msg) {
            msg.expand();
            msg.focus();
          }

          return msg || true;
        }
      }, {
        name: "resize active window",
        exec: function () {
          var _exec7 = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee8(world) {
            var opts,
                window,
                how,
                win,
                worldB,
                winB,
                thirdWMin,
                thirdW,
                thirdColBounds,
                askForHow,
                _askForHow,
                resizeBounds,
                _args8 = arguments;

            return regeneratorRuntime.wrap(function _callee8$(_context8) {
              while (1) {
                switch (_context8.prev = _context8.next) {
                  case 0:
                    resizeBounds = function _resizeBounds(how, bounds) {
                      switch (how) {
                        case "full":
                          return worldB;

                        case "col1":
                        case "left":
                          return thirdColBounds.withTopLeft(worldB.topLeft());

                        case "col2":
                        case "center":
                          return thirdColBounds.withCenter(worldB.center());

                        case "col3":
                        case "right":
                          return thirdColBounds.translatedBy(__varRecorder__$h.pt(worldB.width - thirdW, 0));

                        case "top":
                          return worldB.divide([__varRecorder__$h.rect(0, 0, 1, 0.5)])[0];

                        case "bottom":
                          return worldB.divide([__varRecorder__$h.rect(0, 0.5, 1, 0.5)])[0];

                        case "reset":
                          return win._normalBounds || __varRecorder__$h.pt(500, 400).extentAsRectangle().withCenter(bounds.center());

                        default:
                          return bounds;
                      }
                    };

                    _askForHow = function _askForHow3() {
                      _askForHow = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee7() {
                        var _yield$world$filterab3, _yield$world$filterab4, how;

                        return regeneratorRuntime.wrap(function _callee7$(_context7) {
                          while (1) {
                            switch (_context7.prev = _context7.next) {
                              case 0:
                                _context7.next = 2;
                                return world.filterableListPrompt("How to resize the window?", ["full", "center", "right", "left", "bottom", "top", "reset"], {
                                  requester: world
                                });

                              case 2:
                                _yield$world$filterab3 = _context7.sent;
                                _yield$world$filterab4 = _slicedToArray(_yield$world$filterab3.selected, 1);
                                how = _yield$world$filterab4[0];
                                return _context7.abrupt("return", how);

                              case 6:
                              case "end":
                                return _context7.stop();
                            }
                          }
                        }, _callee7);
                      }));
                      return _askForHow.apply(this, arguments);
                    };

                    askForHow = function _askForHow2() {
                      return _askForHow.apply(this, arguments);
                    };

                    opts = _args8.length > 1 && _args8[1] !== undefined ? _args8[1] : {
                      how: null,
                      window: null
                    };
                    window = opts.window, how = opts.how;
                    win = window || world.activeWindow();

                    if (win) {
                      _context8.next = 8;
                      break;
                    }

                    return _context8.abrupt("return");

                  case 8:
                    worldB = world.visibleBoundsExcludingStudioInterface().insetBy(40);
                    winB = win.bounds();
                    if (!win._normalBounds) win._normalBounds = winB;
                    thirdWMin = 700;
                    thirdW = Math.min(thirdWMin, Math.max(1000, worldB.width / 3));
                    thirdColBounds = worldB.withWidth(thirdW);

                    if (how) {
                      _context8.next = 18;
                      break;
                    }

                    _context8.next = 17;
                    return askForHow();

                  case 17:
                    how = _context8.sent;

                  case 18:
                    if (how) {
                      _context8.next = 20;
                      break;
                    }

                    return _context8.abrupt("return");

                  case 20:
                    win.setBounds(resizeBounds(how, worldB));
                    if (how === "reset") delete win._normalBounds;
                    return _context8.abrupt("return", true);

                  case 23:
                  case "end":
                    return _context8.stop();
                }
              }
            }, _callee8);
          }));

          function exec(_x8) {
            return _exec7.apply(this, arguments);
          }

          return exec;
        }()
      }, {
        name: "[recovery] show last object editor saves",
        exec: function exec(world, opts) {
          return world.execCommand("[recovery] show last doits", Object.assign({}, opts, {
            title: "logged ObjectEditor save",
            logAccessFn: function logAccessFn() {
              return JSON.parse(localStorage["oe helper"]).saves;
            }
          }));
        }
      }, {
        name: "[recovery] show last doits",
        description: "browse a list of your last doits",
        exec: function () {
          var _exec8 = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee9(world) {
            var opts,
                logAccessFn,
                log,
                normalizedLog,
                items,
                _yield$world$filterab5,
                coices,
                sources,
                _iterator,
                _step,
                coice,
                source,
                printedTime,
                _args9 = arguments;

            return regeneratorRuntime.wrap(function _callee9$(_context9) {
              while (1) {
                switch (_context9.prev = _context9.next) {
                  case 0:
                    opts = _args9.length > 1 && _args9[1] !== undefined ? _args9[1] : {};
                    logAccessFn = opts.logAccessFn;
                    if (!logAccessFn) logAccessFn = function logAccessFn() {
                      return JSON.parse(localStorage["lively.next-js-ide-doitlog"]);
                    };

                    try {
                      log = logAccessFn();
                    } catch (err) {}

                    if (log) {
                      _context9.next = 6;
                      break;
                    }

                    return _context9.abrupt("return", world.inform("no log yet"));

                  case 6:
                    normalizedLog = __varRecorder__$h.arr.sortBy(log.map(function (ea, i) {
                      var source = typeof ea === "string" ? ea : ea.source;
                      var time = typeof ea === "string" ? i : ea.time || i;

                      var printedTime = __varRecorder__$h.date.format(new Date(time), "yy-mm-dd HH:MM");

                      return {
                        time: time,
                        source: source,
                        printedTime: printedTime
                      };
                    }), function (ea) {
                      return -ea.time;
                    });
                    items = normalizedLog.map(function (ea, i) {
                      return {
                        isListItem: true,
                        string: "[".concat(ea.printedTime, "] ").concat(ea.source.slice(0, 100).replace(/\n/g, "").trim()),
                        value: ea
                      };
                    });
                    _context9.next = 10;
                    return world.filterableListPrompt("select doit code", items, {
                      multiSelect: true,
                      requester: world
                    });

                  case 10:
                    _yield$world$filterab5 = _context9.sent;
                    coices = _yield$world$filterab5.selected;

                    if (!coices.length) {
                      _context9.next = 17;
                      break;
                    }

                    sources = [];
                    _iterator = _createForOfIteratorHelper(coices);

                    try {
                      for (_iterator.s(); !(_step = _iterator.n()).done;) {
                        coice = _step.value;
                        source = coice.source, printedTime = coice.printedTime;
                        sources.push("// ".concat(printedTime, "\n").concat(source));
                      }
                    } catch (err) {
                      _iterator.e(err);
                    } finally {
                      _iterator.f();
                    }

                    return _context9.abrupt("return", world.execCommand("open workspace", Object.assign({
                      title: "logged doits",
                      mode: "js"
                    }, opts, {
                      content: sources.join("\n\n")
                    })));

                  case 17:
                    return _context9.abrupt("return", true);

                  case 18:
                  case "end":
                    return _context9.stop();
                }
              }
            }, _callee9);
          }));

          function exec(_x9) {
            return _exec8.apply(this, arguments);
          }

          return exec;
        }()
      }, {
        name: "open loading indicator",
        exec: function exec(world, message) {
          var props = {};

          if (_typeof(message) === "object") {
            props = message;
            message = props.label;
          }

          return __varRecorder__$h.LoadingIndicator.open(message, props);
        }
      }, {
        name: "show responsive halo for",
        exec: function exec(world, _ref5) {
          var _world$propertiesPane;

          var target = _ref5.target;
          var halo = world.halos().find(function (h) {
            return h.target === target;
          });
          if (!halo) throw Error("Cannot display responsive halo without preexisting morphic halo.");

          var responsiveHalo = __varRecorder__$h.part(__varRecorder__$h.ResponsiveLayoutHalo).openInWorld();

          responsiveHalo.focusOn(target);
          halo.activeItems = [];
          halo.alignWithTarget();

          __varRecorder__$h.once(responsiveHalo, "close", halo.responsiveHalo(), "stop");

          __varRecorder__$h.once(halo, "remove", responsiveHalo, "close");

          (_world$propertiesPane = world.propertiesPanel) === null || _world$propertiesPane === void 0 ? void 0 : _world$propertiesPane.get("responsive control").viewModel.activate();
          return responsiveHalo;
        }
      }, {
        name: "open workspace",
        exec: function () {
          var _exec9 = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee10(world) {
            var opts,
                evt,
                relayed,
                language,
                workspaceModules,
                alias,
                _varRecorder__$__int,
                _varRecorder__$__int2,
                workspaceLanguages,
                mod,
                _yield$System$import,
                Workspace,
                _args10 = arguments;

            return regeneratorRuntime.wrap(function _callee10$(_context10) {
              while (1) {
                switch (_context10.prev = _context10.next) {
                  case 0:
                    opts = _args10.length > 1 && _args10[1] !== undefined ? _args10[1] : {};
                    evt = _args10.length > 3 ? _args10[3] : undefined;
                    relayed = evt && world.relayCommandExecutionToFocusedMorph(evt);

                    if (!relayed) {
                      _context10.next = 6;
                      break;
                    }

                    return _context10.abrupt("return", relayed);

                  case 6:
                    language = opts.language || opts.mode || "javascript";
                    workspaceModules = {
                      javascript: "lively.ide/js/workspace.js",
                      shell: "lively.ide/shell/workspace.js",
                      html: "lively.ide/html/workspace.js",
                      py: "lively.ide/py/workspace.js",
                      md: "lively.ide/md/workspace.js",
                      sql: "lively.ide/sql/workspace.js",
                      css: "lively.ide/css/workspace.js",
                      less: "lively.ide/css/less/workspace.js",
                      text: null
                    };
                    alias = Object.keys(__varRecorder__$h.config.ide.modes.aliases).reduce(function (inverted, ea) {
                      return Object.assign(inverted, _defineProperty({}, __varRecorder__$h.config.ide.modes.aliases[ea], ea));
                    }, {});

                    if (!opts.askForMode) {
                      _context10.next = 17;
                      break;
                    }

                    workspaceLanguages = Object.keys(workspaceModules).concat("javascript console");
                    _context10.next = 13;
                    return world.filterableListPrompt("Open workspace for...", workspaceLanguages);

                  case 13:
                    __varRecorder__$h.__inter0__ = _context10.sent;
                    _varRecorder__$__int = __varRecorder__$h.__inter0__.selected, _varRecorder__$__int2 = _slicedToArray(_varRecorder__$__int, 1), language = _varRecorder__$__int2[0];

                    if (language) {
                      _context10.next = 17;
                      break;
                    }

                    return _context10.abrupt("return", true);

                  case 17:
                    if (!(language === "javascript console")) {
                      _context10.next = 19;
                      break;
                    }

                    return _context10.abrupt("return", world.execCommand("open console", opts));

                  case 19:
                    opts = Object.assign({
                      content: ""
                    }, opts, {
                      mode: language,
                      language: language
                    });
                    mod = workspaceModules[opts.language] || workspaceModules[alias[opts.language]];

                    if (!(language === "text" || !mod)) {
                      _context10.next = 23;
                      break;
                    }

                    return _context10.abrupt("return", world.execCommand("open text window", Object.assign({}, __varRecorder__$h.config.codeEditor.modes.text, {}, opts)));

                  case 23:
                    _context10.next = 25;
                    return System["import"](mod);

                  case 25:
                    _yield$System$import = _context10.sent;
                    Workspace = _yield$System$import["default"];
                    return _context10.abrupt("return", new Workspace({
                      title: opts.title || opts.language + " workspace",
                      center: world.center,
                      content: opts.content,
                      target: opts.target,
                      systemInterface: opts.systemInterface || opts.backend
                    }).activate());

                  case 28:
                  case "end":
                    return _context10.stop();
                }
              }
            }, _callee10);
          }));

          function exec(_x10) {
            return _exec9.apply(this, arguments);
          }

          return exec;
        }()
      }, {
        name: "open shell workspace",
        exec: function exec(world, opts) {
          return world.execCommand("open workspace", Object.assign({}, opts, {
            language: "shell"
          }));
        }
      }, {
        name: "open javascript workspace",
        exec: function exec(world, opts) {
          return world.execCommand("open workspace", Object.assign({}, opts, {
            language: "javascript"
          }));
        }
      }, {
        name: "open shell terminal",
        exec: function () {
          var _exec10 = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee11(world, opts) {
            var _yield$import3, Terminal, term;

            return regeneratorRuntime.wrap(function _callee11$(_context11) {
              while (1) {
                switch (_context11.prev = _context11.next) {
                  case 0:
                    _context11.next = 2;
                    return Promise.resolve().then(function () { return terminal; });

                  case 2:
                    _yield$import3 = _context11.sent;
                    Terminal = _yield$import3["default"];
                    term = Terminal.open(opts).openInWorldNearHand();
                    if (opts === null || opts === void 0 ? void 0 : opts.position) term.position = opts.position;
                    return _context11.abrupt("return", term);

                  case 7:
                  case "end":
                    return _context11.stop();
                }
              }
            }, _callee11);
          }));

          function exec(_x11, _x12) {
            return _exec10.apply(this, arguments);
          }

          return exec;
        }()
      }, {
        name: "open text window",
        exec: function exec(world) {
          var _Object$assign2;

          var opts = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};
          var title = opts.title,
              extent = opts.extent,
              content = opts.content,
              mode = opts.mode,
              name = opts.name,
              rangesAndStyles = opts.rangesAndStyles;
          title = title || "text window";
          content = content || "";
          extent = extent || __varRecorder__$h.pt(500, 400);
          name = name || "text workspace";
          var textAndAttributes = typeof content === "string" ? [content, null] : content;
          var text = new __varRecorder__$h.Text(Object.assign((_Object$assign2 = {
            fill: __varRecorder__$h.Color.white,
            readOnly: false
          }, _defineProperty(_Object$assign2, "readOnly", true), _defineProperty(_Object$assign2, "padding", __varRecorder__$h.Rectangle.inset(3)), _Object$assign2), __varRecorder__$h.obj.dissoc(opts, ["title", "content"]), {
            textAndAttributes: textAndAttributes,
            clipMode: "auto",
            name: name,
            extent: extent
          }));

          if (rangesAndStyles) {
            text.setTextAttributesWithSortedRanges(rangesAndStyles);
          }

          if (mode) text.changeEditorMode(mode);
          return world.openInWindow(text, {
            title: title
          }).activate();
        }
      }, {
        name: "diff and open in window",
        exec: function () {
          var _exec11 = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee13(world) {
            var opts,
                _opts$a,
                a,
                _opts$b,
                b,
                _opts$format,
                format,
                _opts$extent,
                extent,
                diff,
                diffed,
                findFormat,
                diffInWindow,
                _diffInWindow,
                _args13 = arguments;

            return regeneratorRuntime.wrap(function _callee13$(_context13) {
              while (1) {
                switch (_context13.prev = _context13.next) {
                  case 0:
                    _diffInWindow = function _diffInWindow3() {
                      _diffInWindow = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee12(a, b, opts) {
                        var format, plugin, content, headerA, headerB, filenameA, filenameB, context, _yield$import4, DiffEditorPlugin, win, textMorph;

                        return regeneratorRuntime.wrap(function _callee12$(_context12) {
                          while (1) {
                            switch (_context12.prev = _context12.next) {
                              case 0:
                                format = opts.format;
                                plugin = null;

                                if (!(format === "patch")) {
                                  _context12.next = 12;
                                  break;
                                }

                                headerA = opts.headerA, headerB = opts.headerB, filenameA = opts.filenameA, filenameB = opts.filenameB, context = opts.context;
                                content = [diff.createTwoFilesPatch(filenameA || "a", filenameB || "b", a, b, headerA, headerB, typeof context === "number" ? {
                                  context: context
                                } : undefined), {}];
                                _context12.next = 7;
                                return module.import('./editor-plugin-b7298219.js');

                              case 7:
                                _yield$import4 = _context12.sent;
                                DiffEditorPlugin = _yield$import4["default"];
                                plugin = new DiffEditorPlugin();
                                _context12.next = 14;
                                break;

                              case 12:
                                diffed = diff[format](a, b, opts);
                                content = diffed.flatMap(function (_ref6) {
                                  _ref6.count;
                                      var value = _ref6.value,
                                      added = _ref6.added,
                                      removed = _ref6.removed;
                                  var attribute = removed ? {
                                    fontWeight: "normal",
                                    textDecoration: "line-through",
                                    fontColor: __varRecorder__$h.Color.red
                                  } : added ? {
                                    fontWeight: "bold",
                                    textDecoration: "",
                                    fontColor: __varRecorder__$h.Color.green
                                  } : {
                                    fontWeight: "normal",
                                    textDecoration: "",
                                    fontColor: __varRecorder__$h.Color.darkGray
                                  };
                                  return [value, attribute];
                                });

                              case 14:
                                win = world.execCommand("open text window", opts);
                                textMorph = win.targetMorph;
                                win.extent = extent || __varRecorder__$h.pt(300, 200).maxPt(textMorph.textBounds().extent());
                                textMorph.textAndAttributes = content;
                                if (plugin) textMorph.addPlugin(plugin);
                                return _context12.abrupt("return", textMorph);

                              case 20:
                              case "end":
                                return _context12.stop();
                            }
                          }
                        }, _callee12);
                      }));
                      return _diffInWindow.apply(this, arguments);
                    };

                    diffInWindow = function _diffInWindow2(_x14, _x15, _x16) {
                      return _diffInWindow.apply(this, arguments);
                    };

                    findFormat = function _findFormat(a, b) {
                      if (__varRecorder__$h.obj.isPrimitive(a) || a instanceof RegExp || __varRecorder__$h.obj.isPrimitive(b) || b instanceof RegExp) {
                        a = String(a);
                        b = String(b);
                      }

                      if (typeof a !== "string" || typeof b !== "string") {
                        try {
                          JSON.stringify(a);
                          JSON.stringify(b);
                          return {
                            format: "diffJson",
                            a: a,
                            b: b
                          };
                        } catch (e) {
                          a = String(a);
                          b = String(b);
                        }
                      }

                      return {
                        format: "diffLines",
                        a: a,
                        b: b
                      };
                    };

                    opts = _args13.length > 1 && _args13[1] !== undefined ? _args13[1] : {};
                    _opts$a = opts.a, a = _opts$a === void 0 ? "" : _opts$a, _opts$b = opts.b, b = _opts$b === void 0 ? "" : _opts$b, _opts$format = opts.format, format = _opts$format === void 0 ? null : _opts$format, _opts$extent = opts.extent, extent = _opts$extent === void 0 ? pt(500, 600) : _opts$extent;

                    if (!format) {
                      __varRecorder__$h.__inter1__ = findFormat(a, b), a = __varRecorder__$h.__inter1__.a, b = __varRecorder__$h.__inter1__.b, format = __varRecorder__$h.__inter1__.format;
                    } else {
                      a = String(a);
                      b = String(b);
                    }

                    _context13.next = 8;
                    return module.import('./diff@5.0-976ac4cc.js');

                  case 8:
                    diff = _context13.sent;
                    _context13.next = 11;
                    return diffInWindow(a, b, Object.assign({
                      fontFamily: "IBM Plex Mono"
                    }, opts, {
                      format: format
                    }));

                  case 11:
                    diffed = _context13.sent;
                    return _context13.abrupt("return", diffed);

                  case 13:
                  case "end":
                    return _context13.stop();
                }
              }
            }, _callee13);
          }));

          function exec(_x13) {
            return _exec11.apply(this, arguments);
          }

          return exec;
        }()
      }, {
        name: "diff workspaces",
        exec: function () {
          var _exec12 = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee15(world) {
            var opts,
                editor1,
                editor2,
                editors,
                doDiff,
                selectMorph,
                _selectMorph,
                _args15 = arguments;

            return regeneratorRuntime.wrap(function _callee15$(_context15) {
              while (1) {
                switch (_context15.prev = _context15.next) {
                  case 0:
                    _selectMorph = function _selectMorph3() {
                      _selectMorph = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee14(morphs, thenDo) {
                        var candidates, _yield$world$filterab6, _yield$world$filterab7, choice;

                        return regeneratorRuntime.wrap(function _callee14$(_context14) {
                          while (1) {
                            switch (_context14.prev = _context14.next) {
                              case 0:
                                candidates = morphs.map(function (ea) {
                                  return {
                                    isListItem: true,
                                    value: ea,
                                    string: ea.name || String(ea)
                                  };
                                });
                                _context14.next = 3;
                                return world.filterableListPrompt("choose text: ", candidates, {
                                  onSelection: function onSelection(m) {
                                    m && m.show();
                                  }
                                });

                              case 3:
                                _yield$world$filterab6 = _context14.sent;
                                _yield$world$filterab7 = _slicedToArray(_yield$world$filterab6.selected, 1);
                                choice = _yield$world$filterab7[0];
                                return _context14.abrupt("return", choice);

                              case 7:
                              case "end":
                                return _context14.stop();
                            }
                          }
                        }, _callee14);
                      }));
                      return _selectMorph.apply(this, arguments);
                    };

                    selectMorph = function _selectMorph2(_x18, _x19) {
                      return _selectMorph.apply(this, arguments);
                    };

                    doDiff = function _doDiff(ed1, ed2) {
                      var p1 = ed1.pluginFind(function (ea) {
                        return ea.evalEnvironment;
                      });
                      var fn1 = p1 && p1.evalEnvironment.targetModule || "no file";
                      var p2 = ed2.pluginFind(function (ea) {
                        return ea.evalEnvironment;
                      });
                      var fn2 = p2 && p2.evalEnvironment.targetModule || "no file";
                      return world.execCommand("diff and open in window", {
                        a: ed1.textString,
                        b: ed2.textString,
                        filenameA: fn1,
                        filenameB: fn2
                      });
                    };

                    opts = _args15.length > 1 && _args15[1] !== undefined ? _args15[1] : {};
                    editor1 = opts.editor1, editor2 = opts.editor2;
                    editors = [];

                    if (!editor1 || !editor2) {
                      editors = world.withAllSubmorphsSelect(function (ea) {
                        return ea.isText && !ea.isInputLine && !ea.isUsedAsEpiMorph();
                      }).reverse();
                    }

                    if (editor1) {
                      _context15.next = 11;
                      break;
                    }

                    _context15.next = 10;
                    return selectMorph(editors);

                  case 10:
                    editor1 = _context15.sent;

                  case 11:
                    if (editor1) {
                      _context15.next = 13;
                      break;
                    }

                    return _context15.abrupt("return", world.setStatusMessage("Canceled"));

                  case 13:
                    if (editor2) {
                      _context15.next = 17;
                      break;
                    }

                    _context15.next = 16;
                    return selectMorph(__varRecorder__$h.arr.without(editors, editor1));

                  case 16:
                    editor2 = _context15.sent;

                  case 17:
                    if (editor2) {
                      _context15.next = 19;
                      break;
                    }

                    return _context15.abrupt("return", world.setStatusMessage("Canceled"));

                  case 19:
                    return _context15.abrupt("return", doDiff(editor1, editor2));

                  case 20:
                  case "end":
                    return _context15.stop();
                }
              }
            }, _callee15);
          }));

          function exec(_x17) {
            return _exec12.apply(this, arguments);
          }

          return exec;
        }()
      }, {
        name: "search workspaces",
        exec: function () {
          var _exec13 = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee16() {
            var _yield$$world$filtera, _yield$$world$filtera2, choice, _morph2, _win, row, morphsToCandidates, findWindowOrMorphWithStrings;

            return regeneratorRuntime.wrap(function _callee16$(_context16) {
              while (1) {
                switch (_context16.prev = _context16.next) {
                  case 0:
                    findWindowOrMorphWithStrings = function _findWindowOrMorphWit(strings) {
                      return $world.withAllSubmorphsDo(function (morph) {
                        if (morph.isWindow && morph.minimized && morph.targetMorph && morph.targetMorph.isText) morph = morph.targetMorph;
                        if (!morph.textString) return null;
                        if (!morph.isText) return null;
                        if (morph.isUsedAsEpiMorph()) return null;
                        var textString = morph.textString.toLowerCase();
                        if (!strings.every(function (string) {
                          return textString.includes(string);
                        })) return null;
                        return morph;
                      }).filter(Boolean);
                    };

                    morphsToCandidates = function _morphsToCandidates(morphs, tokens) {
                      return morphs.map(function (m) {
                        var win = m.world() ? m.getWindow() : $world.withAllSubmorphsDetect(function (m) {
                          return m.isWindow && m.targetMorph === morph;
                        });
                        var row = 0;

                        var preview = __varRecorder__$h.string.lines(m.textString).find(function (l, i) {
                          l = l.toLowerCase();
                          row = i;
                          return tokens.every(function (token) {
                            return l.includes(token);
                          });
                        });

                        var title = win ? win.title : m.toString();
                        return preview ? {
                          isListItem: true,
                          string: title + " | " + preview,
                          value: {
                            window: win,
                            morph: m,
                            row: row
                          }
                        } : null;
                      }).filter(Boolean);
                    };

                    _context16.next = 4;
                    return $world.filterableListPrompt("search workspaces", [], {
                      historyId: "lively.morphic-ide-search-workspaces-hist",
                      customize: function customize(listPrompt) {
                        listPrompt.getSubmorphNamed("list").updateFilter = function () {
                          var parsed = this.parseInput();
                          if (parsed.input.length < 3) return;
                          var morphs = findWindowOrMorphWithStrings(parsed.lowercasedTokens);
                          this.listMorph.items = morphsToCandidates(morphs, parsed.lowercasedTokens);
                        };
                      }
                    });

                  case 4:
                    _yield$$world$filtera = _context16.sent;
                    _yield$$world$filtera2 = _slicedToArray(_yield$$world$filtera.selected, 1);
                    choice = _yield$$world$filtera2[0];

                    if (!choice) {
                      _context16.next = 13;
                      break;
                    }

                    _morph2 = choice.morph, _win = choice.window, row = choice.row;

                    if (_win) {
                      if (_win.minimized) _win.toggleMinimize();

                      _win.activate();
                    }

                    (_win || _morph2).show();

                    this.cursorPosition = {
                      row: row,
                      column: 0
                    };
                    return _context16.abrupt("return", _morph2);

                  case 13:
                    return _context16.abrupt("return", null);

                  case 14:
                  case "end":
                    return _context16.stop();
                }
              }
            }, _callee16, this);
          }));

          function exec() {
            return _exec13.apply(this, arguments);
          }

          return exec;
        }()
      }, {
        name: "browse and load component",
        exec: function () {
          var _exec14 = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee17(world) {
            var li, p, _yield$import5, ComponentBrowser, componentBrowser, loadedComponent;

            return regeneratorRuntime.wrap(function _callee17$(_context17) {
              while (1) {
                switch (_context17.prev = _context17.next) {
                  case 0:
                    li = __varRecorder__$h.LoadingIndicator.open("loading component browser");
                    p = $world.openedProject;

                    if (!(p && (p.name !== "partsbin" || p.repoOwner !== "LivelyKernel") || !p)) {
                      _context17.next = 5;
                      break;
                    }

                    _context17.next = 5;
                    return __varRecorder__$h.Project.loadProject("partsbin", "LivelyKernel", true);

                  case 5:
                    _context17.next = 7;
                    return Promise.resolve().then(function () { return componentBrowser_cp; });

                  case 7:
                    _yield$import5 = _context17.sent;
                    ComponentBrowser = _yield$import5.ComponentBrowser;
                    componentBrowser = world._componentBrowser || (world._componentBrowser = __varRecorder__$h.part(ComponentBrowser, {
                      name: "lively component browser"
                    }));
                    li.remove();
                    componentBrowser.openInWindow({
                      minimizable: false,
                      title: "Browse Components"
                    });
                    _context17.next = 14;
                    return componentBrowser.activate();

                  case 14:
                    loadedComponent = _context17.sent;

                    if (loadedComponent && !loadedComponent.world()) {
                      loadedComponent.openInWorld();
                    }

                  case 16:
                  case "end":
                    return _context17.stop();
                }
              }
            }, _callee17);
          }));

          function exec(_x20) {
            return _exec14.apply(this, arguments);
          }

          return exec;
        }()
      }, {
        name: "open console",
        exec: function exec() {
          var consoleMorph = __varRecorder__$h.part(__varRecorder__$h.Console);

          consoleMorph.fixedWidth = true;
          consoleMorph.fixedHeight = true;
          consoleMorph.extent = __varRecorder__$h.pt(600, 400);
          consoleMorph.openInWindow();
        }
      }, {
        name: "open object editor",
        exec: function () {
          var _exec15 = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee18(world) {
            var args,
                li,
                ObjectEditor,
                ed,
                _args18 = arguments;
            return regeneratorRuntime.wrap(function _callee18$(_context18) {
              while (1) {
                switch (_context18.prev = _context18.next) {
                  case 0:
                    args = _args18.length > 1 && _args18[1] !== undefined ? _args18[1] : {
                      target: null,
                      selectedClass: null,
                      selectedMethod: null,
                      evalEnvironment: null
                    };

                    if (args.target) {
                      _context18.next = 4;
                      break;
                    }

                    world.setStatusMessage("No target for ObjectEditor");
                    return _context18.abrupt("return", null);

                  case 4:
                    li = args.loadingIndicator = __varRecorder__$h.LoadingIndicator.open("Open Object Editor...");
                    _context18.next = 7;
                    return module.import('./ui.cp-a0677399.js');

                  case 7:
                    ObjectEditor = _context18.sent;
                    _context18.next = 10;
                    return ObjectEditor.open(args);

                  case 10:
                    ed = _context18.sent;
                    li.remove();
                    return _context18.abrupt("return", ed);

                  case 13:
                  case "end":
                    return _context18.stop();
                }
              }
            }, _callee18);
          }));

          function exec(_x21) {
            return _exec15.apply(this, arguments);
          }

          return exec;
        }()
      }, {
        name: "open object inspector",
        exec: function () {
          var _exec16 = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee19(world) {
            var args,
                _args19 = arguments;
            return regeneratorRuntime.wrap(function _callee19$(_context19) {
              while (1) {
                switch (_context19.prev = _context19.next) {
                  case 0:
                    args = _args19.length > 1 && _args19[1] !== undefined ? _args19[1] : {
                      target: null
                    };

                    if (args.target) {
                      _context19.next = 4;
                      break;
                    }

                    world.setStatusMessage("no target for Inspector");
                    return _context19.abrupt("return", null);

                  case 4:
                    return _context19.abrupt("return", __varRecorder__$h.inspect(args.target));

                  case 5:
                  case "end":
                    return _context19.stop();
                }
              }
            }, _callee19);
          }));

          function exec(_x22) {
            return _exec16.apply(this, arguments);
          }

          return exec;
        }()
      }, {
        name: "inspect server",
        exec: function () {
          var _exec17 = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee20(world) {
            var Inspector, _yield$import6, serverInterfaceFor, remote, evalEnvironment;

            return regeneratorRuntime.wrap(function _callee20$(_context20) {
              while (1) {
                switch (_context20.prev = _context20.next) {
                  case 0:
                    _context20.next = 2;
                    return module.import('./ui.cp-46daffed.js').then(function (n) { return n.a4; });

                  case 2:
                    Inspector = _context20.sent;
                    _context20.next = 5;
                    return module.import('./ui.cp-46daffed.js').then(function (n) { return n.Y; });

                  case 5:
                    _yield$import6 = _context20.sent;
                    serverInterfaceFor = _yield$import6.serverInterfaceFor;
                    remote = serverInterfaceFor(System.baseURL + "eval");
                    evalEnvironment = {
                      format: "esm",
                      context: "global",
                      targetModule: "lively://lively.next-workspace/world",
                      sourceURL: "inspect-server_" + Date.now(),
                      systemInterface: remote
                    };
                    _context20.next = 11;
                    return remote.runEval("\n           import LivelyServer from \"lively.server/server.js\";\n           let server = LivelyServer.servers.values().next().value;\n        ", evalEnvironment);

                  case 11:
                    Inspector.openInWindow({
                      remoteTarget: {
                        code: "server",
                        evalEnvironment: evalEnvironment
                      }
                    });

                  case 12:
                  case "end":
                    return _context20.stop();
                }
              }
            }, _callee20);
          }));

          function exec(_x23) {
            return _exec17.apply(this, arguments);
          }

          return exec;
        }()
      }, {
        name: "open browser",
        progressIndicator: "opening browser...",
        exec: function () {
          var _exec18 = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee21(world) {
            var args,
                evt,
                relayed,
                Browser,
                loc,
                fileName,
                browser,
                _args21 = arguments;

            return regeneratorRuntime.wrap(function _callee21$(_context21) {
              while (1) {
                switch (_context21.prev = _context21.next) {
                  case 0:
                    args = _args21.length > 1 && _args21[1] !== undefined ? _args21[1] : {
                      packageName: "lively.morphic",
                      moduleName: "morph.js",
                      scroll: __varRecorder__$h.pt(0, 0),
                      reuse: false
                    };
                    evt = _args21.length > 3 ? _args21[3] : undefined;
                    relayed = evt && world.relayCommandExecutionToFocusedMorph(evt);

                    if (!relayed) {
                      _context21.next = 6;
                      break;
                    }

                    return _context21.abrupt("return", relayed);

                  case 6:
                    _context21.next = 8;
                    return module.import('./ui.cp-46daffed.js').then(function (n) { return n.a2; });

                  case 8:
                    Browser = _context21.sent;
                    loc = __varRecorder__$h.obj.select(args, ["packageName", "moduleName", "textPosition", "codeEntity", "systemInterface", "scroll", "range"]);
                    fileName = args.packageName ? args.packageName + args.moduleName : args.moduleName;

                    if (!args.reuse) {
                      _context21.next = 21;
                      break;
                    }

                    _context21.t0 = __varRecorder__$h.browserForFile(System.decanonicalize(fileName));

                    if (_context21.t0) {
                      _context21.next = 17;
                      break;
                    }

                    _context21.next = 16;
                    return Browser.open();

                  case 16:
                    _context21.t0 = _context21.sent;

                  case 17:
                    browser = _context21.t0;
                    browser.browse(loc);
                    _context21.next = 24;
                    break;

                  case 21:
                    _context21.next = 23;
                    return Browser.browse(loc, {
                      extent: __varRecorder__$h.pt(700, 600)
                    });

                  case 23:
                    browser = _context21.sent;

                  case 24:
                    browser.getWindow().activate();
                    return _context21.abrupt("return", browser);

                  case 26:
                  case "end":
                    return _context21.stop();
                }
              }
            }, _callee21);
          }));

          function exec(_x24) {
            return _exec18.apply(this, arguments);
          }

          return exec;
        }()
      }, {
        name: "choose and browse package resources",
        progressIndicator: "browsing resources...",
        exec: function () {
          var _exec19 = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee22(world) {
            var opts,
                evt,
                relayed,
                browser,
                _yield$import7,
                localInterface,
                systemInterface,
                items,
                _yield$world$filterab8,
                selected,
                _varRecorder__$arr$p,
                _varRecorder__$arr$p2,
                jsModules,
                nonJsModules,
                _yield$import8,
                Browser,
                _args22 = arguments;

            return regeneratorRuntime.wrap(function _callee22$(_context22) {
              while (1) {
                switch (_context22.prev = _context22.next) {
                  case 0:
                    opts = _args22.length > 1 && _args22[1] !== undefined ? _args22[1] : {
                      browser: null,
                      systemInterface: null
                    };
                    evt = _args22.length > 3 ? _args22[3] : undefined;
                    relayed = evt && world.relayCommandExecutionToFocusedMorph(evt);

                    if (!relayed) {
                      _context22.next = 6;
                      break;
                    }

                    return _context22.abrupt("return", relayed);

                  case 6:
                    browser = opts.browser || world.focusedMorph && world.focusedMorph.ownerChain().find(function (ea) {
                      return ea.isBrowser;
                    });

                    if (browser && browser.isBrowser) {
                      browser = browser.getWindow();
                    } else browser = null;

                    _context22.next = 10;
                    return module.import('./ui.cp-46daffed.js').then(function (n) { return n.Y; });

                  case 10:
                    _yield$import7 = _context22.sent;
                    localInterface = _yield$import7.localInterface;
                    systemInterface = opts && opts.systemInterface ? opts.systemInterface : browser ? browser.systemInterface : localInterface;
                    _context22.next = 15;
                    return systemInterface.coreInterface.getResourcesOfLoadedPackages(__varRecorder__$h.config.ide.js.ignoredPackages);

                  case 15:
                    _context22.t0 = function (_ref7) {
                      var p = _ref7["package"],
                          r = _ref7.resource;
                      var string = "[".concat(p.name, "] ").concat(r.nameInPackage).concat(r.isLoaded ? "" : " [not loaded]");
                      return {
                        isListItem: true,
                        string: string,
                        value: r
                      };
                    };

                    items = _context22.sent.map(_context22.t0);
                    _context22.next = 19;
                    return world.filterableListPrompt("Choose module to open", items, {
                      historyId: "lively.morphic-choose and browse package resources",
                      requester: browser,
                      width: 700,
                      multiSelect: true,
                      fuzzy: "value.shortName"
                    });

                  case 19:
                    _yield$world$filterab8 = _context22.sent;
                    selected = _yield$world$filterab8.selected;
                    _varRecorder__$arr$p = __varRecorder__$h.arr.partition(selected, function (ea) {
                      return ea.url.match(/\.js(on)?/);
                    }), _varRecorder__$arr$p2 = _slicedToArray(_varRecorder__$arr$p, 2), jsModules = _varRecorder__$arr$p2[0], nonJsModules = _varRecorder__$arr$p2[1];
                    _context22.next = 24;
                    return module.import('./ui.cp-46daffed.js').then(function (n) { return n.a1; });

                  case 24:
                    _yield$import8 = _context22.sent;
                    Browser = _yield$import8["default"];
                    _context22.next = 28;
                    return Promise.all(jsModules.map(function (ea) {
                      var loc = {
                        packageName: ea["package"],
                        moduleName: ea.url
                      };
                      return Browser.browse(loc, browser, systemInterface).then(function (browser) {
                        return browser.activate();
                      });
                    }));

                  case 28:
                    if (!nonJsModules.length) {
                      _context22.next = 31;
                      break;
                    }

                    _context22.next = 31;
                    return Promise.all(nonJsModules.map(function (_ref8) {
                      var url = _ref8.url;
                      return world.execCommand("open file", {
                        url: url
                      });
                    }));

                  case 31:
                    return _context22.abrupt("return", true);

                  case 32:
                  case "end":
                    return _context22.stop();
                }
              }
            }, _callee22);
          }));

          function exec(_x25) {
            return _exec19.apply(this, arguments);
          }

          return exec;
        }()
      }, {
        name: "choose and browse module",
        progressIndicator: "browsing module...",
        handlesCount: true,
        exec: function () {
          var _exec20 = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee24(world) {
            var opts,
                count,
                focused,
                _win2,
                browser,
                Browser,
                _yield$import9,
                localInterface,
                systemInterface,
                locationString,
                seenPackages,
                items,
                _args24 = arguments;

            return regeneratorRuntime.wrap(function _callee24$(_context24) {
              while (1) {
                switch (_context24.prev = _context24.next) {
                  case 0:
                    opts = _args24.length > 1 && _args24[1] !== undefined ? _args24[1] : {
                      browser: undefined,
                      systemInterface: undefined
                    };
                    count = _args24.length > 2 ? _args24[2] : undefined;

                    if (opts.browser) {
                      _context24.next = 7;
                      break;
                    }

                    focused = world.focusedMorph;
                    _win2 = focused && focused.getWindow();

                    if (!(_win2 && _win2.targetMorph && _win2.targetMorph.isFileBrowser)) {
                      _context24.next = 7;
                      break;
                    }

                    return _context24.abrupt("return", _win2.targetMorph.execCommand("find file and select", opts, count));

                  case 7:
                    browser = opts.browser || focused && focused.ownerChain().find(function (ea) {
                      return ea.isBrowser;
                    });
                    _context24.next = 10;
                    return module.import('./ui.cp-46daffed.js').then(function (n) { return n.a2; });

                  case 10:
                    Browser = _context24.sent;
                    _context24.next = 13;
                    return module.import('./ui.cp-46daffed.js').then(function (n) { return n.Y; });

                  case 13:
                    _yield$import9 = _context24.sent;
                    localInterface = _yield$import9.localInterface;
                    systemInterface = opts && opts.systemInterface ? opts.systemInterface : browser ? browser.systemInterface : localInterface;
                    locationString = systemInterface.name === "local" ? "" : " on [".concat(__varRecorder__$h.string.truncate(systemInterface.name, 35, "..."), "]");
                    seenPackages = new Map();
                    _context24.next = 20;
                    return systemInterface.coreInterface.getLoadedModules(__varRecorder__$h.config.ide.js.ignoredPackages);

                  case 20:
                    _context24.t0 = function (_ref9) {
                      var p = _ref9["package"],
                          m = _ref9.module;
                      var shortName = systemInterface.shortModuleName(m.name, p);
                      var packageName = seenPackages.get(p);

                      if (!packageName) {
                        if (p.name.includes("--") && !_toConsumableArray(seenPackages.values()).find(function (n) {
                          return p.name.endsWith("--" + n);
                        })) {
                          packageName = p.name.split("--")[1];
                        } else packageName = p.name;

                        seenPackages.set(p, packageName);
                      }

                      return {
                        isListItem: true,
                        string: "[".concat(packageName, "] ").concat(shortName),
                        value: {
                          "package": p,
                          module: m,
                          shortName: shortName
                        }
                      };
                    };

                    items = _context24.sent.map(_context24.t0);
                    items = __varRecorder__$h.arr.sortBy(items, function (ea) {
                      return ea.string;
                    });

                    _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee23() {
                      var requester, _yield$world$filterab9, selected, i, _selected$i, p, shortName, loc, b;

                      return regeneratorRuntime.wrap(function _callee23$(_context23) {
                        while (1) {
                          switch (_context23.prev = _context23.next) {
                            case 0:
                              requester = browser || focused;
                              _context23.next = 3;
                              return world.filterableListPrompt("Choose module to open".concat(locationString), items, {
                                historyId: "lively.morphic-choose and browse module",
                                requester: requester,
                                height: Math.min(requester.height, 700),
                                width: 500,
                                multiSelect: true,
                                listFontColor: "white",
                                fuzzy: "value.shortName"
                              });

                            case 3:
                              _yield$world$filterab9 = _context23.sent;
                              selected = _yield$world$filterab9.selected;
                              i = 0;

                            case 6:
                              if (!(i < selected.length)) {
                                _context23.next = 17;
                                break;
                              }

                              _selected$i = selected[i], p = _selected$i["package"], shortName = _selected$i.shortName;
                              loc = {
                                packageName: p.name,
                                moduleName: shortName
                              };
                              _context23.next = 11;
                              return Browser.browse(loc, i === 0 ? browser : undefined, systemInterface);

                            case 11:
                              b = _context23.sent;
                              b.moveBy(__varRecorder__$h.pt(i * 20, i * 20));
                              b.getWindow().activate();

                            case 14:
                              i++;
                              _context23.next = 6;
                              break;

                            case 17:
                            case "end":
                              return _context23.stop();
                          }
                        }
                      }, _callee23);
                    }))();

                    return _context24.abrupt("return", true);

                  case 25:
                  case "end":
                    return _context24.stop();
                }
              }
            }, _callee24);
          }));

          function exec(_x26) {
            return _exec20.apply(this, arguments);
          }

          return exec;
        }()
      }, {
        name: "open code search",
        progressIndicator: "opening code search...",
        exec: function () {
          var _exec21 = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee25(world) {
            var opts,
                activeMorphs,
                browser,
                li,
                _yield$import10,
                localInterface,
                systemInterface,
                ed,
                searcher,
                _args25 = arguments;

            return regeneratorRuntime.wrap(function _callee25$(_context25) {
              while (1) {
                switch (_context25.prev = _context25.next) {
                  case 0:
                    opts = _args25.length > 1 && _args25[1] !== undefined ? _args25[1] : {
                      browser: null,
                      systemInterface: null,
                      input: null
                    };
                    activeMorphs = world.focusedMorph ? world.focusedMorph.ownerChain() : [];
                    browser = opts.browser || activeMorphs.find(function (ea) {
                      return ea.isBrowser;
                    });
                    li = __varRecorder__$h.LoadingIndicator.open("loading code search");

                    if (!(browser && browser.isBrowser)) {
                      _context25.next = 11;
                      break;
                    }

                    if (!browser.associatedSearchPanel) {
                      _context25.next = 9;
                      break;
                    }

                    li.remove();
                    browser.associatedSearchPanel.browser = browser;
                    return _context25.abrupt("return", browser.associatedSearchPanel.getWindow().activate());

                  case 9:
                    _context25.next = 12;
                    break;

                  case 11:
                    browser = null;

                  case 12:
                    _context25.next = 14;
                    return module.import('./ui.cp-46daffed.js').then(function (n) { return n.Y; });

                  case 14:
                    _yield$import10 = _context25.sent;
                    localInterface = _yield$import10.localInterface;
                    systemInterface = opts.systemInterface || browser && browser.systemInterface;

                    if (!systemInterface) {
                      ed = activeMorphs.find(function (ea) {
                        return ea.isText && ea.editorPlugin && ea.editorPlugin.isJSEditorPlugin;
                      });
                      if (ed) systemInterface = ed.editorPlugin.systemInterface();else systemInterface = localInterface;
                    }

                    searcher = __varRecorder__$h.part(__varRecorder__$h.CodeSearch);
                    Object.assign(searcher, {
                      browser: browser,
                      input: opts.input,
                      systemInterface: systemInterface
                    });
                    searcher.openInWindow();
                    searcher.focus();
                    li.remove();
                    if (browser) browser.associatedSearchPanel = searcher;
                    return _context25.abrupt("return", searcher);

                  case 25:
                  case "end":
                    return _context25.stop();
                }
              }
            }, _callee25);
          }));

          function exec(_x27) {
            return _exec21.apply(this, arguments);
          }

          return exec;
        }()
      }, {
        name: "open test runner",
        progressIndicator: "opening test runner...",
        exec: function () {
          var _exec22 = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee26(world) {
            var _yield$import11, TestRunner;

            return regeneratorRuntime.wrap(function _callee26$(_context26) {
              while (1) {
                switch (_context26.prev = _context26.next) {
                  case 0:
                    _context26.next = 2;
                    return module.import('./ui.cp-46daffed.js').then(function (n) { return n.a0; });

                  case 2:
                    _yield$import11 = _context26.sent;
                    TestRunner = _yield$import11["default"];
                    _context26.next = 6;
                    return TestRunner.open();

                  case 6:
                    return _context26.abrupt("return", _context26.sent);

                  case 7:
                  case "end":
                    return _context26.stop();
                }
              }
            }, _callee26);
          }));

          function exec(_x28) {
            return _exec22.apply(this, arguments);
          }

          return exec;
        }()
      }, {
        name: "open file browser",
        progressIndicator: "opening file browser...",
        exec: function () {
          var _exec23 = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee27(world) {
            var opts,
                _yield$import12,
                HTTPFileBrowser,
                location,
                url,
                file,
                browser,
                _args27 = arguments;

            return regeneratorRuntime.wrap(function _callee27$(_context27) {
              while (1) {
                switch (_context27.prev = _context27.next) {
                  case 0:
                    opts = _args27.length > 1 && _args27[1] !== undefined ? _args27[1] : {};
                    _context27.next = 3;
                    return module.import('./http-file-browser-28ec4e64.js');

                  case 3:
                    _yield$import12 = _context27.sent;
                    HTTPFileBrowser = _yield$import12["default"];
                    location = opts.location, url = opts.url, file = opts.file;
                    browser = file ? HTTPFileBrowser.forFile(file, location) : HTTPFileBrowser.forLocation(url || location || document.location.origin);
                    return _context27.abrupt("return", world.openInWindow(browser).activate());

                  case 8:
                  case "end":
                    return _context27.stop();
                }
              }
            }, _callee27);
          }));

          function exec(_x29) {
            return _exec23.apply(this, arguments);
          }

          return exec;
        }()
      }, {
        name: "open file",
        progressIndicator: "opening file...",
        exec: function () {
          var _exec24 = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee28(world) {
            var opts,
                url,
                lineNumber,
                reuse,
                li,
                editor,
                _yield$import13,
                TextEditor,
                _args28 = arguments;

            return regeneratorRuntime.wrap(function _callee28$(_context28) {
              while (1) {
                switch (_context28.prev = _context28.next) {
                  case 0:
                    opts = _args28.length > 1 && _args28[1] !== undefined ? _args28[1] : {
                      url: null,
                      lineNumber: null,
                      reuse: false
                    };
                    url = opts.url, lineNumber = opts.lineNumber, reuse = opts.reuse;
                    li = world.commandHandler.progressIndicator;

                    if (url) {
                      _context28.next = 9;
                      break;
                    }

                    li.visible = false;
                    _context28.next = 7;
                    return world.prompt("Enter file location", {
                      historyId: "lively.morphic-text editor url",
                      useLastInput: true
                    });

                  case 7:
                    url = _context28.sent;
                    li.visible = true;

                  case 9:
                    if (!reuse) {
                      _context28.next = 14;
                      break;
                    }

                    editor = __varRecorder__$h.arr.findAndGet(world.getWindows(), function (ea) {
                      var t = ea.targetMorph;
                      return t && t.isTextEditor && t.location.split(":")[0] === url ? t : null;
                    });

                    if (!editor) {
                      _context28.next = 14;
                      break;
                    }

                    if (typeof lineNumber === "number") {
                      editor.lineNumber = lineNumber;
                    }

                    return _context28.abrupt("return", editor.getWindow().activate());

                  case 14:
                    if (lineNumber) url += ":" + lineNumber;
                    _context28.next = 17;
                    return module.import('./text-editor-c46e6e07.js');

                  case 17:
                    _yield$import13 = _context28.sent;
                    TextEditor = _yield$import13["default"];
                    return _context28.abrupt("return", url ? TextEditor.openURL(url, __varRecorder__$h.obj.dissoc(opts, ["url"])) : null);

                  case 20:
                  case "end":
                    return _context28.stop();
                }
              }
            }, _callee28);
          }));

          function exec(_x30) {
            return _exec24.apply(this, arguments);
          }

          return exec;
        }()
      }, {
        name: "open file for EDITOR",
        exec: function () {
          var _exec25 = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee29(world) {
            var opts,
                _yield$import14,
                TextEditor,
                url,
                _args29 = arguments;

            return regeneratorRuntime.wrap(function _callee29$(_context29) {
              while (1) {
                switch (_context29.prev = _context29.next) {
                  case 0:
                    opts = _args29.length > 1 && _args29[1] !== undefined ? _args29[1] : {
                      url: null,
                      lineNumber: null
                    };
                    _context29.next = 3;
                    return module.import('./text-editor-c46e6e07.js');

                  case 3:
                    _yield$import14 = _context29.sent;
                    TextEditor = _yield$import14["default"];
                    url = opts.url;
                    _context29.next = 8;
                    return TextEditor.openAsEDITOR(url, {});

                  case 8:
                    return _context29.abrupt("return", _context29.sent);

                  case 9:
                  case "end":
                    return _context29.stop();
                }
              }
            }, _callee29);
          }));

          function exec(_x31) {
            return _exec25.apply(this, arguments);
          }

          return exec;
        }()
      }, {
        name: "[lively.installer] publish new version of a package",
        exec: function () {
          var _exec26 = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee30(world) {
            var _yield$import15, publishPackage;

            return regeneratorRuntime.wrap(function _callee30$(_context30) {
              while (1) {
                switch (_context30.prev = _context30.next) {
                  case 0:
                    _context30.next = 2;
                    return lively.modules.registerPackage(document.location.origin + "/lively.installer");

                  case 2:
                    _context30.next = 4;
                    return module.import('./publish-new-package-version-40b9f95e.js');

                  case 4:
                    _yield$import15 = _context30.sent;
                    publishPackage = _yield$import15["default"];
                    _context30.next = 8;
                    return publishPackage();

                  case 8:
                    return _context30.abrupt("return", true);

                  case 9:
                  case "end":
                    return _context30.stop();
                }
              }
            }, _callee30);
          }));

          function exec(_x32) {
            return _exec26.apply(this, arguments);
          }

          return exec;
        }()
      }, {
        name: "report a bug",
        exec: function () {
          var _exec27 = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee31(world) {
            return regeneratorRuntime.wrap(function _callee31$(_context31) {
              while (1) {
                switch (_context31.prev = _context31.next) {
                  case 0:
                    window.open("https://github.com/LivelyKernel/lively.next/issues/new", "_blank");
                    return _context31.abrupt("return", true);

                  case 2:
                  case "end":
                    return _context31.stop();
                }
              }
            }, _callee31);
          }));

          function exec(_x33) {
            return _exec27.apply(this, arguments);
          }

          return exec;
        }()
      }, {
        name: "fix font metric",
        exec: function () {
          var _exec28 = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee32(world) {
            return regeneratorRuntime.wrap(function _callee32$(_context32) {
              while (1) {
                switch (_context32.prev = _context32.next) {
                  case 0:
                    world.env.fontMetric.reset();
                    world.withAllSubmorphsDo(function (ea) {
                      return ea.isText && ea.textLayout && ea.textLayout.reset();
                    });
                    return _context32.abrupt("return", true);

                  case 3:
                  case "end":
                    return _context32.stop();
                }
              }
            }, _callee32);
          }));

          function exec(_x34) {
            return _exec28.apply(this, arguments);
          }

          return exec;
        }()
      }, {
        name: "delete change history",
        exec: function exec(world) {
          var env = world.env;
          var status = env.printStatus();
          env.deleteHistory();
          world.setStatusMessage(status);

          if (world._componentsBrowser) {
            world._componentsBrowser.reset();
          }

          return true;
        }
      }, {
        name: "install global inspect and show",
        exec: function exec(world) {
          window.show = __varRecorder__$h.show;
          window.inspect = __varRecorder__$h.inspect;
          world.setStatusMessage("inspect() and show() are now globally available");
          return true;
        }
      }, {
        name: "save world or project",
        exec: function () {
          var _exec29 = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee33(world, args, _, evt) {
            var saved, relayed;
            return regeneratorRuntime.wrap(function _callee33$(_context33) {
              while (1) {
                switch (_context33.prev = _context33.next) {
                  case 0:
                    if (!$world.openedProject) {
                      _context33.next = 13;
                      break;
                    }

                    _context33.next = 3;
                    return $world.openedProject.saveConfigData();

                  case 3:
                    _context33.next = 5;
                    return $world.openedProject.hasUncommitedChanges();

                  case 5:
                    if (_context33.sent) {
                      _context33.next = 8;
                      break;
                    }

                    $world.setStatusMessage("All changes are saved. Nothing to do.", __varRecorder__$h.StatusMessageConfirm);
                    return _context33.abrupt("return");

                  case 8:
                    _context33.next = 10;
                    return $world.openPrompt(__varRecorder__$h.part(__varRecorder__$h.SaveProjectDialog, {
                      viewModel: {
                        project: $world.openedProject
                      }
                    }));

                  case 10:
                    saved = _context33.sent;
                    _context33.next = 20;
                    break;

                  case 13:
                    relayed = evt && world.relayCommandExecutionToFocusedMorph(evt);

                    if (!relayed) {
                      _context33.next = 16;
                      break;
                    }

                    return _context33.abrupt("return", relayed);

                  case 16:
                    args = Object.assign({
                      confirmOverwrite: true,
                      showSaveDialog: true,
                      moduleManager: __varRecorder__$h.modules
                    }, args);
                    _context33.next = 19;
                    return __varRecorder__$h.interactivelySaveWorld(world, args);

                  case 19:
                    saved = _context33.sent;

                  case 20:
                    return _context33.abrupt("return", saved);

                  case 21:
                  case "end":
                    return _context33.stop();
                }
              }
            }, _callee33);
          }));

          function exec(_x35, _x36, _x37, _x38) {
            return _exec29.apply(this, arguments);
          }

          return exec;
        }()
      }, {
        name: "save this world",
        exec: function exec(world, args, _, evt) {
          return world.execCommand("save world or project", Object.assign({
            confirmOverwrite: true
          }, args, {
            showSaveDialog: false
          }));
        }
      }, {
        name: "load world",
        exec: function () {
          var _exec30 = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee34(oldWorld) {
            var args,
                id,
                commit,
                name,
                ref,
                world,
                World,
                li,
                fader,
                worldList,
                _args34 = arguments;
            return regeneratorRuntime.wrap(function _callee34$(_context34) {
              while (1) {
                switch (_context34.prev = _context34.next) {
                  case 0:
                    args = _args34.length > 1 && _args34[1] !== undefined ? _args34[1] : {};
                    id = args.id, commit = args.commit, name = args.name, ref = args.ref, world = args.world;
                    World = oldWorld.constructor;

                    if (!world) {
                      _context34.next = 5;
                      break;
                    }

                    return _context34.abrupt("return", World.loadWorld(world, oldWorld, {
                      moduleManager: __varRecorder__$h.modules
                    }));

                  case 5:
                    if (!(id || commit)) {
                      _context34.next = 7;
                      break;
                    }

                    return _context34.abrupt("return", World.loadFromCommit(id || commit, oldWorld, {
                      moduleManager: __varRecorder__$h.modules
                    }));

                  case 7:
                    if (!name) {
                      _context34.next = 9;
                      break;
                    }

                    return _context34.abrupt("return", World.loadFromDB(name, ref, oldWorld, {
                      moduleManager: __varRecorder__$h.modules
                    }));

                  case 9:
                    li = __varRecorder__$h.LoadingIndicator.open("loading project browser...");
                    fader = __varRecorder__$h.morph({
                      fill: __varRecorder__$h.Color.black.withA(0.5),
                      extent: oldWorld.extent,
                      name: "dark overlay",
                      opacity: 0,
                      reactsToPointer: false,
                      renderOnGPU: true,
                      halosEnabled: false
                    });
                    fader.openInWorld(__varRecorder__$h.pt(0, 0));
                    fader.animate({
                      opacity: 1,
                      duration: 300
                    });
                    worldList = oldWorld.get("a project browser") || __varRecorder__$h.part(__varRecorder__$h.WorldBrowser, {
                      name: "a project browser",
                      viewModel: new __varRecorder__$h.WorldBrowserModel({
                        showCloseButton: true
                      })
                    });
                    worldList.name = "a project browser";
                    worldList.hasFixedPosition = true;
                    worldList.epiMorph = true;
                    worldList.bringToFront().alignInWorld(oldWorld);
                    worldList.focus();

                    __varRecorder__$h.once(worldList, "remove", function () {
                      return fader.animate({
                        opacity: 0
                      }).then(function () {
                        return fader.remove();
                      });
                    });

                    li.remove();
                    return _context34.abrupt("return", worldList);

                  case 22:
                  case "end":
                    return _context34.stop();
                }
              }
            }, _callee34);
          }));

          function exec(_x39) {
            return _exec30.apply(this, arguments);
          }

          return exec;
        }()
      }, {
        name: "add external package dependency to object",
        exec: function () {
          var _exec31 = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee35(world) {
            var opts,
                object,
                externalPackages,
                _yield$world$editList,
                list,
                _args35 = arguments;

            return regeneratorRuntime.wrap(function _callee35$(_context35) {
              while (1) {
                switch (_context35.prev = _context35.next) {
                  case 0:
                    opts = _args35.length > 1 && _args35[1] !== undefined ? _args35[1] : {};
                    object = opts.target || world;
                    externalPackages = object.metadata && object.metadata.externalPackages || [];
                    _context35.next = 5;
                    return world.editListPrompt("modify package dependencies of " + object, externalPackages);

                  case 5:
                    _yield$world$editList = _context35.sent;
                    list = _yield$world$editList.list;

                    if (list) {
                      _context35.next = 9;
                      break;
                    }

                    return _context35.abrupt("return");

                  case 9:
                    if (!list.length) {
                      if (object.metadata) {
                        delete object.metadata.externalPackages;
                      }
                    } else {
                      if (!object.metadata) object.metadata = {};
                      object.metadata.externalPackages = list;
                    }

                    return _context35.abrupt("return", true);

                  case 11:
                  case "end":
                    return _context35.stop();
                }
              }
            }, _callee35);
          }));

          function exec(_x40) {
            return _exec31.apply(this, arguments);
          }

          return exec;
        }()
      }];
      var commands = __varRecorder__$h.commands;
      __varRecorder__$h["default"] = commands;

      var __varRecorder__$g = lively.FreezerRuntime.recorderFor("lively.ide/world-mini-map.cp.js");
      __varRecorder__$g.ViewModel = ViewModel;
      __varRecorder__$g.config = config;
      __varRecorder__$g.Morph = Morph;
      __varRecorder__$g.component = component;
      __varRecorder__$g.Canvas = Canvas;
      __varRecorder__$g.pt = pt;
      __varRecorder__$g.Color = Color;
      __varRecorder__$g.max = max;
      __varRecorder__$g.min = min;
      __varRecorder__$g.delay = delay;

      (function (superclass) {
        var __lively_classholder__ = lively.FreezerRuntime.recorderFor("lively.ide/world-mini-map.cp.js");

        var __lively_class__ = __lively_classholder__.hasOwnProperty("MiniMapModel") && typeof __lively_classholder__.MiniMapModel === "function" ? __lively_classholder__.MiniMapModel : __lively_classholder__.MiniMapModel = function MiniMapModel(__first_arg__) {
          if (__first_arg__ && __first_arg__[Symbol["for"]("lively-instance-restorer")]) ; else {
            return this[Symbol["for"]("lively-instance-initialize")].apply(this, arguments);
          }
        };

        return initializeClass(__lively_class__, superclass, [{
          key: "context",
          get: function get() {
            return this.view.context;
          }
        }, {
          key: "isMiniMap",
          get: function get() {
            return true;
          }
        }, {
          key: "repositionViewPort",
          value: function MiniMapModel_repositionViewPort_(evt) {
            if (!__varRecorder__$g.config.ide.studio.canvasModeEnabled) return;
            var clickedPositionOnMap = this.view.localize(evt.position);

            var clickedPositionInCanvasSpace = __varRecorder__$g.pt(this.xFromMapSpaceToCanvasSpace(clickedPositionOnMap.x), this.yFromMapSpaceToCanvasSpace(clickedPositionOnMap.y));

            var currentViewportPosition = $world.screenToWorld(__varRecorder__$g.pt($world.windowBounds().width / 2, $world.windowBounds().height / 2));
            var offsetShift = clickedPositionInCanvasSpace.subPt(currentViewportPosition);
            $world.scrollWorld(offsetShift.x, offsetShift.y);
          }
        }, {
          key: "onMouseDown",
          value: function MiniMapModel_onMouseDown_(evt) {
            this.repositionViewPort(evt);
          }
        }, {
          key: "onDrag",
          value: function MiniMapModel_onDrag_(evt) {
            if (!this.view.bounds().containsPoint(evt.position)) return;
            this.repositionViewPort(evt);
          }
        }, {
          key: "relayout",
          value: function MiniMapModel_relayout_() {
            var view = this.view;
            if ($world.activeSideBars.includes("properties panel")) view.position = __varRecorder__$g.pt($world.get("properties panel").left - 10 - view.width, $world.extent.y - 10 - view.height);else view.position = __varRecorder__$g.pt($world.right - 10 - view.width, $world.extent.y - 10 - view.height);
          }
        }, {
          key: "viewDidLoad",
          value: function MiniMapModel_viewDidLoad_() {
            var worldBounds = $world.windowBounds();
            this.ratio = worldBounds.width / worldBounds.height;
            this.view.width = 300;
            this.view.height = this.view.width / this.ratio;
            this.view.env.forceUpdate();
            this.relayout();
          }
        }, {
          key: "updateMapSpace",
          value: function MiniMapModel_updateMapSpace_() {
            var defaultScreenCutoffs = {
              top: 0,
              left: 0,
              right: $world.windowBounds().width,
              bottom: $world.windowBounds().height
            };
            var xPositionsForMin = $world.morphsInWorld.map(function (m) {
              return m.positionOnCanvas.x;
            });
            var xPositionsForMax = $world.morphsInWorld.map(function (m) {
              return m.positionOnCanvas.x + m.width;
            });
            var maxX = __varRecorder__$g.max(xPositionsForMax) || 0;
            var minX = __varRecorder__$g.min(xPositionsForMin) || 0;
            var yPositionsForMin = $world.morphsInWorld.map(function (m) {
              return m.positionOnCanvas.y;
            });
            var yPositionsForMax = $world.morphsInWorld.map(function (m) {
              return m.positionOnCanvas.y + m.height;
            });
            var maxY = __varRecorder__$g.max(yPositionsForMax) || 0;
            var minY = __varRecorder__$g.min(yPositionsForMin) || 0;
            var mapSpace = {
              top: Math.min(minY, $world.screenToWorld(__varRecorder__$g.pt(0, 0)).y, defaultScreenCutoffs.top),
              left: Math.min(minX, $world.screenToWorld(__varRecorder__$g.pt(0, 0)).x, defaultScreenCutoffs.left),
              right: Math.max(maxX, $world.screenToWorld(__varRecorder__$g.pt(defaultScreenCutoffs.right, defaultScreenCutoffs.bottom)).x, defaultScreenCutoffs.right),
              bottom: Math.max(maxY, $world.screenToWorld(__varRecorder__$g.pt(defaultScreenCutoffs.right, defaultScreenCutoffs.bottom)).y, defaultScreenCutoffs.bottom)
            };
            this.virtualHeight = mapSpace.top * -1 + mapSpace.bottom;
            this.virtualWidth = mapSpace.left * -1 + mapSpace.right;
            this.balanceNegativeTop = 0;
            this.balanceNegativeLeft = 0;
            if (mapSpace.top < 0) this.balanceNegativeTop = -1 * mapSpace.top;
            if (mapSpace.left < 0) this.balanceNegativeLeft = -1 * mapSpace.left;
            this.widthCorrection = 0;
            this.heightCorrection = 0;

            if (this.virtualWidth > this.virtualHeight) {
              var goalHeight = this.virtualWidth / this.ratio;

              if (this.virtualHeight > goalHeight) {
                this.widthCorrection = this.virtualHeight * this.ratio - this.virtualWidth;
              } else {
                this.heightCorrection = goalHeight - this.virtualHeight;
              }
            } else {
              var goalWidth = this.virtualHeight * this.ratio;

              if (this.virtualWidth > goalWidth) {
                this.heightCorrection = this.virtualWidth / this.ratio - this.virtualHeight;
              } else {
                this.widthCorrection = goalWidth - this.virtualWidth;
              }
            }
          }
        }, {
          key: "heightFromCanvasSpaceToMapSpace",
          value: function MiniMapModel_heightFromCanvasSpaceToMapSpace_(number) {
            return number / (this.virtualHeight + this.heightCorrection) * this.view.height;
          }
        }, {
          key: "widthFromCanvasSpaceToMapSpace",
          value: function MiniMapModel_widthFromCanvasSpaceToMapSpace_(number) {
            return number / (this.virtualWidth + this.widthCorrection) * 300;
          }
        }, {
          key: "xFromMapSpaceToCanvasSpace",
          value: function MiniMapModel_xFromMapSpaceToCanvasSpace_(number) {
            return number / 300 * (this.virtualWidth + this.widthCorrection) - (this.balanceNegativeLeft + this.widthCorrection / 2);
          }
        }, {
          key: "yFromMapSpaceToCanvasSpace",
          value: function MiniMapModel_yFromMapSpaceToCanvasSpace_(number) {
            return number / this.view.height * (this.virtualHeight + this.heightCorrection) - (this.balanceNegativeTop + this.heightCorrection / 2);
          }
        }, {
          key: "createCurrentViewPortMorph",
          value: function MiniMapModel_createCurrentViewPortMorph_() {
            var height = $world.screenToWorld($world.bottomRight).y - $world.screenToWorld($world.topLeft).y;
            var width = $world.screenToWorld($world.bottomRight).x - $world.screenToWorld($world.topLeft).x;
            var viewPort = new __varRecorder__$g.Morph({
              name: "viewport",
              extent: __varRecorder__$g.pt(width, height),
              borderWidth: 15,
              borderColor: __varRecorder__$g.Color.lively,
              fill: __varRecorder__$g.Color.transparent
            });
            viewPort._positionOnCanvas = $world.screenToWorld(__varRecorder__$g.pt(0, 0));
            return viewPort;
          }
        }, {
          key: "drawMorphs",
          value: function () {
            var _MiniMapModel_drawMorphs_ = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee() {
              var _this = this;

              var context, itemsToDraw, _iterator, _step, currentItem, virtualWidthDivisor, virtualHeightDivisor, widthBalancing, topBalancing;

              return regeneratorRuntime.wrap(function _callee$(_context) {
                while (1) {
                  switch (_context.prev = _context.next) {
                    case 0:
                      context = this.context;
                      this.updateMapSpace();
                      itemsToDraw = [].concat(_toConsumableArray($world.morphsInWorldWithSubmorphs), [this.createCurrentViewPortMorph()]);
                      _iterator = _createForOfIteratorHelper(itemsToDraw);
                      _context.prev = 4;

                      _iterator.s();

                    case 6:
                      if ((_step = _iterator.n()).done) {
                        _context.next = 13;
                        break;
                      }

                      currentItem = _step.value;

                      if (!currentItem.isPath) {
                        _context.next = 11;
                        break;
                      }

                      _context.next = 11;
                      return this.prepareImageDataForPolygons(currentItem);

                    case 11:
                      _context.next = 6;
                      break;

                    case 13:
                      _context.next = 18;
                      break;

                    case 15:
                      _context.prev = 15;
                      _context.t0 = _context["catch"](4);

                      _iterator.e(_context.t0);

                    case 18:
                      _context.prev = 18;

                      _iterator.f();

                      return _context.finish(18);

                    case 21:
                      this.view.clear(null);
                      virtualWidthDivisor = this.virtualWidth + this.widthCorrection;
                      virtualHeightDivisor = this.virtualHeight + this.heightCorrection;
                      widthBalancing = this.balanceNegativeLeft + this.widthCorrection / 2;
                      topBalancing = this.balanceNegativeTop + this.heightCorrection / 2;
                      itemsToDraw.forEach(function (m) {
                        var xPos = (m.positionOnCanvas.x + widthBalancing) / virtualWidthDivisor;
                        xPos = 300 * xPos;
                        var yPos = (m.positionOnCanvas.y + topBalancing) / virtualHeightDivisor;
                        yPos = _this.view.height * yPos;

                        var width = _this.widthFromCanvasSpaceToMapSpace(m.width);

                        var height = _this.heightFromCanvasSpaceToMapSpace(m.height);

                        _this.renderMorphPreviewOnCanvas(m, xPos, yPos, width, height, context);
                      });

                    case 27:
                    case "end":
                      return _context.stop();
                  }
                }
              }, _callee, this, [[4, 15, 18, 21]]);
            }));

            function MiniMapModel_drawMorphs_() {
              return _MiniMapModel_drawMorphs_.apply(this, arguments);
            }

            return MiniMapModel_drawMorphs_;
          }()
        }, {
          key: "prepareImageDataForPolygons",
          value: function () {
            var _MiniMapModel_prepareImageDataForPolygons_ = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee2(polygon) {
              var svg, img, xml, svg64, b64Start, image64;
              return regeneratorRuntime.wrap(function _callee2$(_context2) {
                while (1) {
                  switch (_context2.prev = _context2.next) {
                    case 0:
                      svg = $world.env.renderer.getNodeForMorph(polygon).querySelector("svg");
                      img = $world.env.domEnv.document.createElement("img");
                      xml = new XMLSerializer().serializeToString(svg);
                      svg64 = btoa(xml);
                      b64Start = "data:image/svg+xml;base64,";
                      image64 = b64Start + svg64;
                      img.src = image64;
                      polygon.imgData = img;
                      _context2.next = 10;
                      return __varRecorder__$g.delay(1);

                    case 10:
                    case "end":
                      return _context2.stop();
                  }
                }
              }, _callee2);
            }));

            function MiniMapModel_prepareImageDataForPolygons_(_x) {
              return _MiniMapModel_prepareImageDataForPolygons_.apply(this, arguments);
            }

            return MiniMapModel_prepareImageDataForPolygons_;
          }()
        }, {
          key: "renderMorphPreviewOnCanvas",
          value: function MiniMapModel_renderMorphPreviewOnCanvas_(morph, xPos, yPos, width, height, context) {
            var m = morph;
            context.setTransform(1, 0, 0, 1, 0, 0);

            if (m.getGlobalTransform().getRotation()) {
              context.translate(xPos, yPos);
              context.rotate(m.getGlobalTransform().getRotation() * Math.PI / 180);
              xPos = 0;
              yPos = 0;
            }

            context.beginPath();

            if (m.isImage) {
              var img = $world.env.renderer.getNodeForMorph(m).querySelector("img");
              context.drawImage(img, xPos, yPos, width, height);
              return;
            }

            if (m.isPath) {
              context.drawImage(m.imgData, xPos, yPos, width, height);
              return;
            }

            context.lineWidth = m.borderWidth.top / 5;
            context.strokeStyle = m.borderColor.top;
            context.fillStyle = m.fill;

            if (m.fill.isGradient) {
              if (m.fill.type === "linearGradient") {
                var vec = m.fill.vector.toPoints();
                var grad = context.createLinearGradient(vec[0].x * width + xPos, vec[0].y * height + yPos, width * vec[1].x + xPos, height * vec[1].y + yPos);
                m.fill.stops.forEach(function (stop) {
                  return grad.addColorStop(stop.offset, stop.color);
                });
                context.fillStyle = grad;
              }

              if (m.fill.type === "radialGradient") {
                var _grad = context.createLinearGradient(xPos, yPos, width + xPos, height + yPos);

                m.fill.stops.forEach(function (stop) {
                  return _grad.addColorStop(stop.offset, stop.color);
                });
                context.fillStyle = _grad;
              }
            }

            if (m.isEllipse) {
              context.ellipse(xPos + width / 2, yPos + height / 2, width / 2, height / 2, 0, 0, 2 * Math.PI);
              context.fill();
              context.stroke();
              return;
            }

            var bR = m.borderRadius;
            context.roundRect(xPos, yPos, width, height, [bR.topLeft, bR.topRight, bR.bottomRight, bR.topRight]);
            context.fill();
            context.stroke();
          }
        }], [{
          key: Symbol["for"]("__LivelyClassName__"),
          get: function get() {
            return "MiniMapModel";
          }
        }, {
          key: "properties",
          get: function get() {
            return {
              expose: {
                get: function get() {
                  return ["isMiniMap", "drawMorphs", "relayout", "onDrag", "onMouseDown"];
                }
              }
            };
          }
        }], __lively_classholder__, {
          pathInPackage: function pathInPackage() {
            return "./world-mini-map.cp.js";
          },
          unsubscribeFromToplevelDefinitionChanges: function unsubscribeFromToplevelDefinitionChanges() {
            return function () {};
          },
          subscribeToToplevelDefinitionChanges: function subscribeToToplevelDefinitionChanges() {
            return function () {};
          },
          "package": function _package() {
            return {
              name: "lively.ide",
              version: "0.1.0"
            };
          }
        }, {
          start: 294,
          end: 11290
        });
      })(__varRecorder__$g.ViewModel);

      var WorldMiniMap = __varRecorder__$g.component["for"](function () {
        return __varRecorder__$g.component({
          type: __varRecorder__$g.Canvas,
          name: "world mini map",
          defaultViewModel: __varRecorder__$g.MiniMapModel,
          extent: __varRecorder__$g.pt(100, 100),
          fill: __varRecorder__$g.Color.rgb(30, 30, 30).withA(0.95),
          borderWidth: 0,
          borderRadius: 5,
          epiMorph: true,
          draggable: true,
          styleClasses: ["Popups"]
        });
      }, {
        module: "lively.ide/world-mini-map.cp.js",
        "export": "WorldMiniMap",
        range: {
          start: 11305,
          end: 11578
        }
      }, __varRecorder__$g.WorldMiniMap);
      __varRecorder__$g.WorldMiniMap = WorldMiniMap;
      __varRecorder__$g.WorldMiniMap = WorldMiniMap;

      var __varRecorder__$f = lively.FreezerRuntime.recorderFor("lively.ide/studio/top-bar-buttons.cp.js");
      __varRecorder__$f.component = component;
      __varRecorder__$f.ViewModel = ViewModel;
      __varRecorder__$f.Icon = Icon;
      __varRecorder__$f.part = part;
      __varRecorder__$f.TilingLayout = TilingLayout;
      __varRecorder__$f.ShadowObject = ShadowObject;
      __varRecorder__$f.Label = Label;
      __varRecorder__$f.Color = Color;
      __varRecorder__$f.pt = pt;
      __varRecorder__$f.rect = rect;

      (function (superclass) {
        var __lively_classholder__ = lively.FreezerRuntime.recorderFor("lively.ide/studio/top-bar-buttons.cp.js");

        var __lively_class__ = __lively_classholder__.hasOwnProperty("TopBarButtonModel") && typeof __lively_classholder__.TopBarButtonModel === "function" ? __lively_classholder__.TopBarButtonModel : __lively_classholder__.TopBarButtonModel = function TopBarButtonModel(__first_arg__) {
          if (__first_arg__ && __first_arg__[Symbol["for"]("lively-instance-restorer")]) ; else {
            return this[Symbol["for"]("lively-instance-initialize")].apply(this, arguments);
          }
        };

        return initializeClass(__lively_class__, superclass, [{
          key: "getIcon",
          value: function TopBarButtonModel_getIcon_() {
            return this.ui.symbol.textAndAttributes;
          }
        }, {
          key: "changeIcon",
          value: function TopBarButtonModel_changeIcon_(iconAttributes) {
            this.ui.symbol.textAndAttributes = iconAttributes;
          }
        }, {
          key: "activateButton",
          value: function TopBarButtonModel_activateButton_() {
            this.view.master = __varRecorder__$f.TopBarButtonSelected;
          }
        }, {
          key: "deactivateButton",
          value: function TopBarButtonModel_deactivateButton_() {
            this.view.master = null;
          }
        }], [{
          key: Symbol["for"]("__LivelyClassName__"),
          get: function get() {
            return "TopBarButtonModel";
          }
        }, {
          key: "properties",
          get: function get() {
            return {
              expose: {
                get: function get() {
                  return ["activateButton", "deactivateButton", "changeIcon", "getIcon"];
                }
              },
              opts: {}
            };
          }
        }], __lively_classholder__, {
          pathInPackage: function pathInPackage() {
            return "./studio/top-bar-buttons.cp.js";
          },
          unsubscribeFromToplevelDefinitionChanges: function unsubscribeFromToplevelDefinitionChanges() {
            return function () {};
          },
          subscribeToToplevelDefinitionChanges: function subscribeToToplevelDefinitionChanges() {
            return function () {};
          },
          "package": function _package() {
            return {
              name: "lively.ide",
              version: "0.1.0"
            };
          }
        }, {
          start: 154,
          end: 728
        });
      })(__varRecorder__$f.ViewModel);

      var TopBarButton = __varRecorder__$f.component["for"](function () {
        return __varRecorder__$f.component({
          type: __varRecorder__$f.Label,
          defaultViewModel: __varRecorder__$f.TopBarButtonModel,
          name: "top bar button",
          lineHeight: 1,
          fontColor: __varRecorder__$f.Color.rgb(102, 102, 102),
          fontSize: 23,
          nativeCursor: "pointer",
          padding: __varRecorder__$f.rect(0, 1, 0, -1)
        });
      }, {
        module: "lively.ide/studio/top-bar-buttons.cp.js",
        "export": "TopBarButton",
        range: {
          start: 743,
          end: 980
        }
      }, __varRecorder__$f.TopBarButton);
      __varRecorder__$f.TopBarButton = TopBarButton;
      __varRecorder__$f.TopBarButton = TopBarButton;
      var TopBarButtonSelected = __varRecorder__$f.component["for"](function () {
        return __varRecorder__$f.component(__varRecorder__$f.TopBarButton, {
          name: "top bar button selected",
          dropShadow: new __varRecorder__$f.ShadowObject({
            color: __varRecorder__$f.Color.rgba(64, 196, 255, 0.4),
            fast: false
          }),
          fontColor: __varRecorder__$f.Color.rgb(0, 176, 255)
        });
      }, {
        module: "lively.ide/studio/top-bar-buttons.cp.js",
        "export": "TopBarButtonSelected",
        range: {
          start: 995,
          end: 1214
        }
      }, __varRecorder__$f.TopBarButtonSelected);
      __varRecorder__$f.TopBarButtonSelected = TopBarButtonSelected;
      __varRecorder__$f.TopBarButtonSelected = TopBarButtonSelected;

      (function (superclass) {
        var __lively_classholder__ = lively.FreezerRuntime.recorderFor("lively.ide/studio/top-bar-buttons.cp.js");

        var __lively_class__ = __lively_classholder__.hasOwnProperty("TopBarButtonDropDownModel") && typeof __lively_classholder__.TopBarButtonDropDownModel === "function" ? __lively_classholder__.TopBarButtonDropDownModel : __lively_classholder__.TopBarButtonDropDownModel = function TopBarButtonDropDownModel(__first_arg__) {
          if (__first_arg__ && __first_arg__[Symbol["for"]("lively-instance-restorer")]) ; else {
            return this[Symbol["for"]("lively-instance-initialize")].apply(this, arguments);
          }
        };

        return initializeClass(__lively_class__, superclass, [{
          key: "expose",
          get: function get() {
            return [].concat(_toConsumableArray(initializeClass._get(Object.getPrototypeOf(__lively_class__.prototype), "expose", this)), ["removeDropdown"]);
          }
        }, {
          key: "activateButton",
          value: function TopBarButtonDropDownModel_activateButton_() {
            this.ui.symbol.master = __varRecorder__$f.TopBarButtonSelected;
          }
        }, {
          key: "deactivateButton",
          value: function TopBarButtonDropDownModel_deactivateButton_() {
            this.ui.symbol.master = null;
          }
        }, {
          key: "viewDidLoad",
          value: function TopBarButtonDropDownModel_viewDidLoad_() {
            var view = this.view,
                opts = this.opts;
            view.tooltip = opts.tooltip;
            var symbolButton = this.ui.symbol;
            symbolButton.tooltip = opts.symbol.tooltip;
            symbolButton.textAndAttributes = opts.symbol.textAndAttributes;
          }
        }, {
          key: "removeDropdown",
          value: function TopBarButtonDropDownModel_removeDropdown_() {
            this.ui.dropdown.remove();
          }
        }], [{
          key: Symbol["for"]("__LivelyClassName__"),
          get: function get() {
            return "TopBarButtonDropDownModel";
          }
        }, {
          key: "properties",
          get: function get() {
            return {
              opts: {}
            };
          }
        }], __lively_classholder__, {
          pathInPackage: function pathInPackage() {
            return "./studio/top-bar-buttons.cp.js";
          },
          unsubscribeFromToplevelDefinitionChanges: function unsubscribeFromToplevelDefinitionChanges() {
            return function () {};
          },
          subscribeToToplevelDefinitionChanges: function subscribeToToplevelDefinitionChanges() {
            return function () {};
          },
          "package": function _package() {
            return {
              name: "lively.ide",
              version: "0.1.0"
            };
          }
        }, {
          start: 1217,
          end: 2166
        });
      })(__varRecorder__$f.TopBarButtonModel);

      var TopBarButtonDropDown = __varRecorder__$f.component["for"](function () {
        return __varRecorder__$f.component({
          name: "outer button name",
          defaultViewModel: __varRecorder__$f.TopBarButtonDropDownModel,
          extent: __varRecorder__$f.pt(55.8, 24.7),
          fill: __varRecorder__$f.Color.rgba(46, 75, 223, 0),
          layout: new __varRecorder__$f.TilingLayout({
            axisAlign: "center",
            hugContentsHorizontally: true,
            align: "center",
            padding: {
              height: 0,
              width: 0,
              x: 5,
              y: 5
            },
            spacing: 5
          }),
          nativeCursor: "pointer",
          submorphs: [__varRecorder__$f.part(__varRecorder__$f.TopBarButton, {
            name: "symbol",
            reactsToPointer: false,
            textAndAttributes: __varRecorder__$f.Icon.textAttribute("square"),
            tooltip: "symbol tooltip"
          }), __varRecorder__$f.part(__varRecorder__$f.TopBarButton, {
            name: "dropdown",
            fontSize: 23,
            nativeCursor: "pointer",
            textAndAttributes: __varRecorder__$f.Icon.textAttribute("angle-down")
          })],
          tooltip: "dropdown tooltip"
        });
      }, {
        module: "lively.ide/studio/top-bar-buttons.cp.js",
        "export": "TopBarButtonDropDown",
        range: {
          start: 2181,
          end: 2947
        }
      }, __varRecorder__$f.TopBarButtonDropDown);
      __varRecorder__$f.TopBarButtonDropDown = TopBarButtonDropDown;
      __varRecorder__$f.TopBarButtonDropDown = TopBarButtonDropDown;

      var __varRecorder__$e = lively.FreezerRuntime.recorderFor("lively.ide/studio/top-bar.cp.js");
      __varRecorder__$e.Color = Color;
      __varRecorder__$e.Rectangle = Rectangle;
      __varRecorder__$e.LinearGradient = LinearGradient;
      __varRecorder__$e.rect = rect;
      __varRecorder__$e.pt = pt;
      __varRecorder__$e.config = config;
      __varRecorder__$e.TilingLayout = TilingLayout;
      __varRecorder__$e.morph = morph;
      __varRecorder__$e.Text = Text;
      __varRecorder__$e.Polygon = Polygon;
      __varRecorder__$e.Path = Path;
      __varRecorder__$e.HTMLMorph = HTMLMorph;
      __varRecorder__$e.Ellipse = Ellipse;
      __varRecorder__$e.Morph = Morph;
      __varRecorder__$e.Image = Image;
      __varRecorder__$e.ShadowObject = ShadowObject;
      __varRecorder__$e.Icon = Icon;
      __varRecorder__$e.component = component;
      __varRecorder__$e.ViewModel = ViewModel;
      __varRecorder__$e.part = part;
      __varRecorder__$e.Canvas = Canvas;
      __varRecorder__$e.Closure = Closure;
      __varRecorder__$e.obj = obj;
      __varRecorder__$e.CommentBrowser = CommentBrowser;
      __varRecorder__$e.once = once;
      __varRecorder__$e.connect = connect;
      __varRecorder__$e.disconnect = disconnect;
      __varRecorder__$e.signal = signal;
      __varRecorder__$e.getClassName = getClassName;
      __varRecorder__$e.SystemTooltip = SystemTooltip;
      __varRecorder__$e.RichTextPlugin = RichTextPlugin;
      __varRecorder__$e.WorldMiniMap = WorldMiniMap;
      __varRecorder__$e.UserFlap = UserFlap;
      __varRecorder__$e.TopBarButton = TopBarButton;
      __varRecorder__$e.TopBarButtonDropDown = TopBarButtonDropDown;
      __varRecorder__$e.TopBarButtonSelected = TopBarButtonSelected;
      __varRecorder__$e.notYetImplemented = notYetImplemented;
      __varRecorder__$e.defaultDirectory = defaultDirectory;
      __varRecorder__$e.ProjectSettingsPrompt = ProjectSettingsPrompt;
      __varRecorder__$e.RepoCreationPrompt = RepoCreationPrompt;
      __varRecorder__$e.isUserLoggedIn = isUserLoggedIn;

      (function (superclass) {
        var __lively_classholder__ = lively.FreezerRuntime.recorderFor("lively.ide/studio/top-bar.cp.js");

        var __lively_class__ = __lively_classholder__.hasOwnProperty("SelectionElement") && typeof __lively_classholder__.SelectionElement === "function" ? __lively_classholder__.SelectionElement : __lively_classholder__.SelectionElement = function SelectionElement(__first_arg__) {
          if (__first_arg__ && __first_arg__[Symbol["for"]("lively-instance-restorer")]) ; else {
            return this[Symbol["for"]("lively-instance-initialize")].apply(this, arguments);
          }
        };

        return initializeClass(__lively_class__, superclass, undefined, [{
          key: Symbol["for"]("__LivelyClassName__"),
          get: function get() {
            return "SelectionElement";
          }
        }, {
          key: "properties",
          get: function get() {
            return {
              borderColor: {
                defaultValue: __varRecorder__$e.Color.red
              },
              borderWidth: {
                defaultValue: 1
              },
              fill: {
                defaultValue: __varRecorder__$e.Color.transparent
              },
              epiMorph: {
                defaultValue: true
              },
              isSelectionElement: {
                readOnly: true,
                get: function get() {
                  return true;
                }
              }
            };
          }
        }], __lively_classholder__, {
          pathInPackage: function pathInPackage() {
            return "./studio/top-bar.cp.js";
          },
          unsubscribeFromToplevelDefinitionChanges: function unsubscribeFromToplevelDefinitionChanges() {
            return function () {};
          },
          subscribeToToplevelDefinitionChanges: function subscribeToToplevelDefinitionChanges() {
            return function () {};
          },
          "package": function _package() {
            return {
              name: "lively.ide",
              version: "0.1.0"
            };
          }
        }, {
          start: 1157,
          end: 1594
        });
      })(__varRecorder__$e.Morph);

      var Selection = function (superclass) {
        var __lively_classholder__ = lively.FreezerRuntime.recorderFor("lively.ide/studio/top-bar.cp.js");

        var __lively_class__ = __lively_classholder__.hasOwnProperty("Selection") && typeof __lively_classholder__.Selection === "function" ? __lively_classholder__.Selection : __lively_classholder__.Selection = function Selection(__first_arg__) {
          if (__first_arg__ && __first_arg__[Symbol["for"]("lively-instance-restorer")]) ; else {
            return this[Symbol["for"]("lively-instance-initialize")].apply(this, arguments);
          }
        };

        return initializeClass(__lively_class__, superclass, undefined, [{
          key: Symbol["for"]("__LivelyClassName__"),
          get: function get() {
            return "Selection";
          }
        }, {
          key: "properties",
          get: function get() {
            return {
              fill: {
                defaultValue: __varRecorder__$e.Color.gray.withA(0.2)
              },
              borderWidth: {
                defaultValue: 2
              },
              borderColor: {
                defaultValue: __varRecorder__$e.Color.gray
              },
              isSelectionElement: {
                readOnly: true,
                get: function get() {
                  return true;
                }
              }
            };
          }
        }], __lively_classholder__, {
          pathInPackage: function pathInPackage() {
            return "./studio/top-bar.cp.js";
          },
          unsubscribeFromToplevelDefinitionChanges: function unsubscribeFromToplevelDefinitionChanges() {
            return function () {};
          },
          subscribeToToplevelDefinitionChanges: function subscribeToToplevelDefinitionChanges() {
            return function () {};
          },
          "package": function _package() {
            return {
              name: "lively.ide",
              version: "0.1.0"
            };
          }
        }, {
          start: 1603,
          end: 1984
        });
      }(__varRecorder__$e.Morph);
      __varRecorder__$e.Selection = Selection;
      __varRecorder__$e.Selection = Selection;
      var TopBarModel = function (superclass) {
        var __lively_classholder__ = lively.FreezerRuntime.recorderFor("lively.ide/studio/top-bar.cp.js");

        var __lively_class__ = __lively_classholder__.hasOwnProperty("TopBarModel") && typeof __lively_classholder__.TopBarModel === "function" ? __lively_classholder__.TopBarModel : __lively_classholder__.TopBarModel = function TopBarModel(__first_arg__) {
          if (__first_arg__ && __first_arg__[Symbol["for"]("lively-instance-restorer")]) ; else {
            return this[Symbol["for"]("lively-instance-initialize")].apply(this, arguments);
          }
        };

        return initializeClass(__lively_class__, superclass, [{
          key: "mode",
          get: function get() {
            return this.editMode;
          }
        }, {
          key: "isTopBar",
          get: function get() {
            return true;
          }
        }, {
          key: "__additionally_serialize__",
          value: function TopBarModel___additionally_serialize___(snapshot, ref, pool, addFn) {
            addFn("haloFilterFn", this.getProperty("haloFilterFn"));
          }
        }, {
          key: "viewDidLoad",
          value: function TopBarModel_viewDidLoad_() {
            if (__varRecorder__$e.config.ide.studio.worldMenuInTopBar) {
              var worldMenuButton = __varRecorder__$e.part(__varRecorder__$e.TopBarButton, {
                name: "world menu button",
                textAndAttributes: __varRecorder__$e.Icon.textAttribute("burger"),
                tooltip: "Open World Menu"
              });

              this.ui.tilingLayout.addMorphAt(worldMenuButton, 0);

              __varRecorder__$e.connect(worldMenuButton, "onMouseDown", function () {
                $world.openMenu($world.menuItems());
              });
            }

            if ($world.playgroundsMode) {
              this.ui.saveButton.removeDropdown();
            }
          }
        }, {
          key: "onMouseDown",
          value: function () {
            var _TopBarModel_onMouseDown_ = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee(evt) {
              var shapeSelector, handHaloSelector, handOrHaloModeButton, shapeModeButton, canvasModeButton, canvasModeSelector, saveButton, saveMenu, target, menu, _menu, _menu2, currentlyShowingHaloIcon, _menu3;

              return regeneratorRuntime.wrap(function _callee$(_context) {
                while (1) {
                  switch (_context.prev = _context.next) {
                    case 0:
                      shapeSelector = this.ui.shapeModeButton.get("dropdown");
                      handHaloSelector = this.ui.handOrHaloModeButton.get("dropdown");
                      handOrHaloModeButton = this.ui.handOrHaloModeButton;
                      shapeModeButton = this.ui.shapeModeButton;
                      canvasModeButton = this.ui.canvasModeButton;
                      canvasModeSelector = this.ui.canvasModeButton.get("dropdown");
                      saveButton = this.ui.saveButton;
                      saveMenu = this.ui.saveButton.get("dropdown");
                      target = this.primaryTarget || this.world();
                      if (evt.targetMorph === saveButton) $world.execCommand("save world or project");

                      if (!(evt.targetMorph === saveMenu)) {
                        _context.next = 18;
                        break;
                      }

                      _context.t0 = $world;
                      _context.t1 = evt;
                      _context.next = 15;
                      return this.getSaveMenuItems();

                    case 15:
                      _context.t2 = _context.sent;
                      menu = _context.t0.openWorldMenu.call(_context.t0, _context.t1, _context.t2);
                      menu.position = saveButton.globalBounds().bottomLeft().subPt($world.scroll);

                    case 18:
                      if (evt.targetMorph === shapeSelector) {
                        _menu = $world.openWorldMenu(evt, this.getShapeMenuItems());
                        _menu.position = shapeModeButton.globalBounds().bottomLeft().subPt($world.scroll);
                      }

                      if (evt.targetMorph === handHaloSelector) {
                        _menu2 = $world.openWorldMenu(evt, this.getHandAndHaloModeItems());
                        _menu2.position = handOrHaloModeButton.globalBounds().bottomLeft().subPt($world.scroll);
                      }

                      if (evt.targetMorph.name === "undo button") {
                        target.execCommand("undo");
                      }

                      if (evt.targetMorph.name === "redo button") {
                        target.execCommand("redo");
                      }

                      if (evt.targetMorph === shapeModeButton) {
                        this.setEditMode("Shape");
                      }

                      if (evt.targetMorph === handOrHaloModeButton) {
                        currentlyShowingHaloIcon = this.ui.handOrHaloModeButton.getIcon()[0] === __varRecorder__$e.Icon.textAttribute("arrow-pointer")[0];
                        this.setEditMode(currentlyShowingHaloIcon ? "Halo" : "Hand");
                      }

                      if (evt.targetMorph.name === "text mode button") {
                        this.setEditMode("Text");
                      }

                      if (evt.targetMorph.name === "open component browser") {
                        this.interactivelyLoadComponent();
                      }

                      if (evt.targetMorph.name === "load world button") {
                        $world.execCommand("load world");
                      }

                      if (evt.targetMorph.name === "comment browser button") {
                        this.toggleCommentBrowser();
                      }

                      if (evt.targetMorph === canvasModeButton) {
                        this.toggleMiniMap(null);
                      }

                      if (evt.targetMorph === canvasModeSelector) {
                        _menu3 = this.world().openWorldMenu(evt, this.getCanvasModeItems());
                        _menu3.position = canvasModeButton.globalBounds().bottomLeft().subPt(this.world().scroll);
                      }

                    case 30:
                    case "end":
                      return _context.stop();
                  }
                }
              }, _callee, this);
            }));

            function TopBarModel_onMouseDown_(_x) {
              return _TopBarModel_onMouseDown_.apply(this, arguments);
            }

            return TopBarModel_onMouseDown_;
          }()
        }, {
          key: "onKeyUp",
          value: function TopBarModel_onKeyUp_() {
            if (this._tmpEditMode === "Hand") {
              this.setEditMode("Hand", true);
            }
          }
        }, {
          key: "onKeyDown",
          value: function TopBarModel_onKeyDown_(evt) {
            if (evt.isCommandKey()) {
              if (this.primaryTarget.isIDEWorld) return;

              if (this._tmpEditMode === "Hand") {
                this.setEditMode("Halo", true);
                return;
              }
            }

            if (evt.isAltDown()) {
              return;
            }

            var keyToShape = this.keyToShape;

            if (keyToShape[evt.key]) {
              this.currentShapeMode = keyToShape[evt.key];
              this.setEditMode("Shape");
              return;
            }

            switch (evt.key) {
              case "Escape":
                this.setEditMode("Halo");
                break;

              case "T":
                this.setEditMode("Text");
                break;
            }
          }
        }, {
          key: "registerCustomShape",
          value: function TopBarModel_registerCustomShape_(shapeName, klass, shapeKey, iconArgs) {
            this.shapeToClass[shapeName] = klass;
            this.keyToShape[shapeKey] = shapeName;
            this.shapeToIcon[shapeName] = {
              shortcut: shapeKey,
              args: iconArgs
            };
            this.shapesCreatedViaDrag.push(klass);
          }
        }, {
          key: "onUserChanged",
          value: function TopBarModel_onUserChanged_(evt) {
            try {
              this.ui.userFlap.onUserChanged(evt);
            } finally {}
          }
        }, {
          key: "relayout",
          value: function TopBarModel_relayout_() {
            this.ui.ipadStatusBar.width = this.view.width = $world.visibleBounds().width;
            this.view.position = __varRecorder__$e.pt(0, 0);
          }
        }, {
          key: "adjustElements",
          value: function TopBarModel_adjustElements_() {
            var statusBar = this.ui.ipadStatusBar;
            if (statusBar) statusBar.width = this.view.width;

            if (this.ui.userFlap.owner === this) {
              this.ui.userFlap.right = this.width - 10;
              this.ui.userFlap.visible = this.width > 750;
            }
          }
        }, {
          key: "getSaveMenuItems",
          value: function () {
            var _TopBarModel_getSaveMenuItems_ = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee4() {
              return regeneratorRuntime.wrap(function _callee4$(_context4) {
                while (1) {
                  switch (_context4.prev = _context4.next) {
                    case 0:
                      _context4.t0 = [["\uD83D\uDCBE", {
                        fontFamily: "Noto Emoji"
                      }, " Save this workspace", null], function () {
                        __varRecorder__$e.notYetImplemented("Saving workspaces");
                      }];
                      _context4.t1 = [["\uD83D\uDCBE", {
                        fontFamily: "Noto Emoji"
                      }, " Save this workspace under different name", null], function () {
                        __varRecorder__$e.notYetImplemented("Saving workspaces");
                      }];
                      _context4.next = 4;
                      return $world.openedProject.hasRemoteConfigured();

                    case 4:
                      if (!_context4.sent) {
                        _context4.next = 8;
                        break;
                      }

                      _context4.t2 = [["\u2699\uFE0F", {
                        fontFamily: "Noto Emoji"
                      }, " Change Project Settings", null], function () {
                        $world.openPrompt(__varRecorder__$e.part(__varRecorder__$e.ProjectSettingsPrompt, {
                          viewModel: {
                            project: $world.openedProject
                          },
                          hasFixedPosition: true
                        }));
                      }];
                      _context4.next = 9;
                      break;

                    case 8:
                      _context4.t2 = [["\uD83C\uDF0F", {
                        fontFamily: "Noto Emoji"
                      }, " Create Remote Repository", null], /*#__PURE__*/_asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee2() {
                        return regeneratorRuntime.wrap(function _callee2$(_context2) {
                          while (1) {
                            switch (_context2.prev = _context2.next) {
                              case 0:
                                if (__varRecorder__$e.isUserLoggedIn()) {
                                  _context2.next = 4;
                                  break;
                                }

                                $world.setStatusMessage("You need to log in using github.");
                                $world.get("user flap").show();
                                return _context2.abrupt("return");

                              case 4:
                                $world.openPrompt(__varRecorder__$e.part(__varRecorder__$e.RepoCreationPrompt, {
                                  viewModel: {
                                    project: $world.openedProject
                                  },
                                  hasFixedPosition: true
                                }));

                              case 5:
                              case "end":
                                return _context2.stop();
                            }
                          }
                        }, _callee2);
                      }))];

                    case 9:
                      _context4.t3 = _context4.t2;
                      _context4.t4 = [["\uD83E\uDDD1\u200D\uD83D\uDCBB", {
                        fontFamily: "Noto Emoji"
                      }, " Open a Terminal (advanced operation)", null], /*#__PURE__*/_asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee3() {
                        var serverDir, projectsDir, projectDir;
                        return regeneratorRuntime.wrap(function _callee3$(_context3) {
                          while (1) {
                            switch (_context3.prev = _context3.next) {
                              case 0:
                                _context3.next = 2;
                                return __varRecorder__$e.defaultDirectory();

                              case 2:
                                serverDir = _context3.sent;
                                projectsDir = serverDir.replace("lively.server", "") + "local_projects/";
                                projectDir = projectsDir + "".concat($world.openedProject.repoOwner, "--").concat($world.openedProject.name);
                                $world.execCommand("open shell terminal", {
                                  cwd: projectDir,
                                  position: $world.center.subXY(300, 150)
                                });

                              case 6:
                              case "end":
                                return _context3.stop();
                            }
                          }
                        }, _callee3);
                      }))];
                      return _context4.abrupt("return", [_context4.t0, _context4.t1, _context4.t3, _context4.t4]);

                    case 12:
                    case "end":
                      return _context4.stop();
                  }
                }
              }, _callee4);
            }));

            function TopBarModel_getSaveMenuItems_() {
              return _TopBarModel_getSaveMenuItems_.apply(this, arguments);
            }

            return TopBarModel_getSaveMenuItems_;
          }()
        }, {
          key: "getHandAndHaloModeItems",
          value: function TopBarModel_getHandAndHaloModeItems_() {
            var _this = this;

            return [[[].concat(_toConsumableArray(this.editMode === "Halo" ? [].concat(_toConsumableArray(__varRecorder__$e.Icon.textAttribute("check", {
              fontSize: 11,
              paddingTop: "2px"
            })), ["    ", {}]) : ["     ", {}]), _toConsumableArray(__varRecorder__$e.Icon.textAttribute("arrow-pointer", {
              paddingLeft: "6px",
              paddingRight: "2px"
            })), ["   Editing "]), function () {
              return _this.setEditMode("Halo");
            }], [[].concat(_toConsumableArray(this.editMode === "Hand" ? [].concat(_toConsumableArray(__varRecorder__$e.Icon.textAttribute("check", {
              fontSize: 11,
              paddingTop: "2px"
            })), ["   ", {}]) : ["       ", {}]), _toConsumableArray(__varRecorder__$e.Icon.textAttribute("hand")), ["   Interacting "]), function () {
              return _this.setEditMode("Hand");
            }]];
          }
        }, {
          key: "getShapeMenuItems",
          value: function TopBarModel_getShapeMenuItems_() {
            var _this2 = this;

            return Object.entries(this.shapeToIcon).map(function (_ref3) {
              var _varRecorder__$Icon;

              var _ref4 = _slicedToArray(_ref3, 2),
                  shapeName = _ref4[0],
                  _ref4$ = _ref4[1],
                  shortcut = _ref4$.shortcut,
                  args = _ref4$.args;

              return [[].concat(_toConsumableArray(_this2.currentShapeMode === shapeName ? [].concat(_toConsumableArray(__varRecorder__$e.Icon.textAttribute("check", {
                fontSize: 11,
                paddingTop: "2px"
              })), ["   ", {}]) : ["     ", {}]), _toConsumableArray((_varRecorder__$Icon = __varRecorder__$e.Icon).textAttribute.apply(_varRecorder__$Icon, _toConsumableArray(args))), ["   ".concat(shapeName, " "), {
                "float": "none"
              }, "      " + shortcut, {
                fontSize: 11,
                opacity: 0.5,
                fontFamily: "IBM Plex Mono",
                textStyleClasses: ["annotation"]
              }]), function () {
                _this2.currentShapeMode = shapeName;

                _this2.setEditMode("Shape");
              }];
            });
          }
        }, {
          key: "getCanvasModeItems",
          value: function TopBarModel_getCanvasModeItems_() {
            var _this3 = this;

            return [[[].concat(_toConsumableArray(__varRecorder__$e.config.ide.studio.canvasModeEnabled ? __varRecorder__$e.Icon.textAttribute("check-square", {
              fontSize: 18,
              paddingTop: "2px"
            }) : __varRecorder__$e.Icon.textAttribute("square", {
              fontSize: 18,
              paddingTop: "2px"
            })), ["  Enabled "]), /*#__PURE__*/_asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee5() {
              var currentMode, changeMode;
              return regeneratorRuntime.wrap(function _callee5$(_context5) {
                while (1) {
                  switch (_context5.prev = _context5.next) {
                    case 0:
                      currentMode = __varRecorder__$e.config.ide.studio.canvasModeEnabled;
                      changeMode = true;

                      if (currentMode) {
                        _context5.next = 6;
                        break;
                      }

                      _context5.next = 5;
                      return $world.confirm("Confirm to activate Canvas Mode. This will reset the scale of all open Morphs to 1!");

                    case 5:
                      changeMode = _context5.sent;

                    case 6:
                      if (changeMode) {
                        _context5.next = 8;
                        break;
                      }

                      return _context5.abrupt("return");

                    case 8:
                      __varRecorder__$e.config.ide.studio.canvasModeEnabled = !__varRecorder__$e.config.ide.studio.canvasModeEnabled;
                      if (__varRecorder__$e.config.ide.studio.canvasModeEnabled) document.body.style["overscroll-behavior-x"] = "none";else document.body.style["overscroll-behavior-x"] = "auto";
                      $world.resetScaleFactor();
                      !__varRecorder__$e.config.ide.studio.canvasModeEnabled ? _this3.toggleMiniMap(false) : _this3.toggleMiniMap();

                    case 12:
                    case "end":
                      return _context5.stop();
                  }
                }
              }, _callee5);
            }))]];
          }
        }, {
          key: "colorTopbarButton",
          value: function TopBarModel_colorTopbarButton_(button, active) {
            button.master = active ? __varRecorder__$e.TopBarButtonSelected : __varRecorder__$e.TopBarButton;
          }
        }, {
          key: "toggleCommentBrowser",
          value: function TopBarModel_toggleCommentBrowser_() {
            var _this4 = this;

            var commentBrowser = $world.getSubmorphNamed("Comment Browser");
            var commentBrowserButton = this.ui.commentBrowserButton;

            if (commentBrowser) {
              this.colorTopbarButton(commentBrowserButton, false);
              commentBrowser.getWindow().close();
            } else {
              this.colorTopbarButton(commentBrowserButton, true);

              var win = __varRecorder__$e.part(__varRecorder__$e.CommentBrowser).openInWindow();

              __varRecorder__$e.once(win, "remove", function () {
                _this4.colorTopbarButton(commentBrowserButton, false);
              });
            }
          }
        }, {
          key: "toggleMiniMap",
          value: function TopBarModel_toggleMiniMap_(forceState) {
            var miniMap = $world.getSubmorphNamed("world mini map");

            if (miniMap && forceState !== true && forceState !== undefined) {
              this.ui.canvasModeButton.deactivateButton();
              miniMap.remove();
              $world.getSubmorphNamed("world zoom indicator").relayout();
            } else if (!miniMap && forceState !== false && forceState !== undefined) {
              this.ui.canvasModeButton.activateButton();

              var _miniMap = __varRecorder__$e.part(__varRecorder__$e.WorldMiniMap).openInWorld();

              _miniMap.relayout();

              $world.getSubmorphNamed("world zoom indicator").relayout();
            }
          }
        }, {
          key: "interactivelyLoadComponent",
          value: function () {
            var _TopBarModel_interactivelyLoadComponent_ = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee6() {
              var currComponentBrowser;
              return regeneratorRuntime.wrap(function _callee6$(_context6) {
                while (1) {
                  switch (_context6.prev = _context6.next) {
                    case 0:
                      currComponentBrowser = this.world()._componentBrowser;

                      if (!(currComponentBrowser && !!currComponentBrowser.world())) {
                        _context6.next = 3;
                        break;
                      }

                      return _context6.abrupt("return", currComponentBrowser.getWindow().close(false));

                    case 3:
                      this.colorTopbarButton(this.ui.openComponentBrowser, true);
                      _context6.next = 6;
                      return this.world().execCommand("browse and load component");

                    case 6:
                      this.colorTopbarButton(this.ui.openComponentBrowser, false);

                    case 7:
                    case "end":
                      return _context6.stop();
                  }
                }
              }, _callee6, this);
            }));

            function TopBarModel_interactivelyLoadComponent_() {
              return _TopBarModel_interactivelyLoadComponent_.apply(this, arguments);
            }

            return TopBarModel_interactivelyLoadComponent_;
          }()
        }, {
          key: "setEditMode",
          value: function TopBarModel_setEditMode_(mode) {
            var _this5 = this;

            var shallow = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : false;
            var isTemporary = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : false;
            this.editMode = mode;
            var target = this.primaryTarget || $world;
            if (!target) return;
            if (!shallow) this._tmpEditMode = mode;
            if (!isTemporary && (mode === "Halo" || mode === "Hand")) this.view.recoverMode = mode;
            var _this$ui = this.ui,
                shapeModeButton = _this$ui.shapeModeButton,
                textModeButton = _this$ui.textModeButton,
                handOrHaloModeButton = _this$ui.handOrHaloModeButton;
            [["Shape", shapeModeButton], ["Text", textModeButton], ["Hand", handOrHaloModeButton], ["Halo", handOrHaloModeButton]].forEach(function (_ref6) {
              var _ref7 = _slicedToArray(_ref6, 2),
                  modeName = _ref7[0],
                  morphToUpdate = _ref7[1];

              if (mode === "Halo") {
                _this5.ui.handOrHaloModeButton.changeIcon(__varRecorder__$e.Icon.textAttribute("arrow-pointer", {
                  paddingLeft: "7px"
                }));
              }

              if (mode === "Hand") {
                _this5.ui.handOrHaloModeButton.changeIcon(__varRecorder__$e.Icon.textAttribute("hand"));
              }

              if (mode === "Shape") {
                _this5.toggleShapeMode(target, true, _this5.currentShapeMode);
              } else if (mode === "Text") {
                _this5.toggleShapeMode(target, true, "Text");
              } else {
                _this5.toggleShapeMode(target, false);
              }

              _this5.showHaloPreviews(mode === "Halo");

              if (!shallow && mode !== "Halo") $world.halos().forEach(function (h) {
                return h.remove();
              });

              if (modeName === mode) {
                morphToUpdate.activateButton();
              } else if (!((mode === "Hand" || mode === "Halo") && (modeName === "Hand" || modeName === "Halo"))) {
                morphToUpdate.deactivateButton();
              }
            });
          }
        }, {
          key: "canBeCreatedViaDrag",
          value: function TopBarModel_canBeCreatedViaDrag_(klass) {
            return this.shapesCreatedViaDrag.includes(klass);
          }
        }, {
          key: "toggleShapeMode",
          value: function TopBarModel_toggleShapeMode_(target, active, shapeName) {
            var shapeToClass = this.shapeToClass;

            if (active) {
              target.nativeCursor = "crosshair";
              target._yieldShapeOnClick = shapeToClass[shapeName];
            } else {
              target._yieldShapeOnClick = false;
              target.nativeCursor = "auto";
            }
          }
        }, {
          key: "handleShapeCreation",
          value: function TopBarModel_handleShapeCreation_(evt) {
            if (this._customDrag) {
              var _$world$halos$;

              this._customDrag = false;
              (_$world$halos$ = $world.halos()[0]) === null || _$world$halos$ === void 0 ? void 0 : _$world$halos$.onDragEnd();
            }

            var target = this.primaryTarget || $world;
            var type = target._yieldShapeOnClick;
            if (!type) return false;
            if (target._sizeTooltip) target._sizeTooltip.remove();
            if (evt.targetMorph !== target) return false;

            if (target._shapeRequest && type && !target._yieldedShape) {
              var position = target.localize($world.firstHand.position);

              switch (type) {
                case __varRecorder__$e.Image:
                  target.addMorph(__varRecorder__$e.morph({
                    type: type,
                    position: position,
                    extent: __varRecorder__$e.pt(150, 150),
                    fill: __varRecorder__$e.Color.transparent
                  }));
                  break;

                case __varRecorder__$e.Text:
                  if (evt.targetMorph.isText) return;

                  var textMorph = __varRecorder__$e.morph({
                    type: type,
                    position: position,
                    readOnly: true,
                    textString: "I am a text field!",
                    dynamicCursorColoring: true,
                    fill: __varRecorder__$e.Color.white
                  });

                  textMorph.addPlugin(new __varRecorder__$e.RichTextPlugin());
                  target.addMorph(textMorph);
                  break;
              }
            }

            if (target._yieldedShape && target._yieldedShape.owner) {
              this.showHaloFor(target._yieldedShape);

              if (type === __varRecorder__$e.Text && target._yieldedShape) {
                target._yieldedShape.execCommand("temporary edit text");
              }
            }

            target._yieldedShape = null;
            target._shapeRequest = false;
          }
        }, {
          key: "prepareShapeCreation",
          value: function TopBarModel_prepareShapeCreation_(evt) {
            var target = this.primaryTarget || $world;
            var type = target._yieldShapeOnClick;
            if (!type) return false;
            if (!this.canBeCreatedViaDrag(type)) return false;
            this._shapeCreationStartPos = evt.positionIn(target);
            target._yieldedShape = __varRecorder__$e.morph(Object.assign({
              type: type,
              scale: $world.scaleFactor,
              position: this._shapeCreationStartPos,
              extent: __varRecorder__$e.pt(1, 1),
              fill: __varRecorder__$e.Color.white,
              borderWidth: 1,
              borderColor: __varRecorder__$e.Color.rgb(23, 160, 251),
              fixedHeight: true,
              fixedWidth: true,
              lineWrapping: "by-words"
            }, type === __varRecorder__$e.Text ? this.getDefaultTextAttrs() : {}, {}, type === __varRecorder__$e.Image ? this.getImageDefaultAttrs() : {}, {}, type === __varRecorder__$e.Polygon ? this.getPolyDefaultAttrs() : {}, {}, type === __varRecorder__$e.Path ? this.getPathDefaultAttrs() : {}));
            if (target._yieldedShape.isText) target._yieldedShape.addPlugin(new __varRecorder__$e.RichTextPlugin());
            target._sizeTooltip = __varRecorder__$e.part(__varRecorder__$e.SystemTooltip, {
              opacity: 0
            });

            target._sizeTooltip.openInWorld();

            return true;
          }
        }, {
          key: "getPolyDefaultAttrs",
          value: function TopBarModel_getPolyDefaultAttrs_() {
            return {
              vertices: [__varRecorder__$e.pt(131.4, 86.3), __varRecorder__$e.pt(171, 139.6), __varRecorder__$e.pt(105.9, 119.9), __varRecorder__$e.pt(65.3, 172.5), __varRecorder__$e.pt(64.7, 107), __varRecorder__$e.pt(0, 86.3), __varRecorder__$e.pt(64.7, 65.5), __varRecorder__$e.pt(65.3, 0), __varRecorder__$e.pt(105.9, 52.6), __varRecorder__$e.pt(171, 32.9), __varRecorder__$e.pt(131.4, 86.3)],
              borderWidth: 1
            };
          }
        }, {
          key: "getPathDefaultAttrs",
          value: function TopBarModel_getPathDefaultAttrs_() {
            return {
              vertices: [__varRecorder__$e.pt(0, 0), __varRecorder__$e.pt(1, 1)],
              borderWidth: 1
            };
          }
        }, {
          key: "getImageDefaultAttrs",
          value: function TopBarModel_getImageDefaultAttrs_() {
            return {};
          }
        }, {
          key: "getDefaultTextAttrs",
          value: function TopBarModel_getDefaultTextAttrs_() {
            return {
              readOnly: true,
              padding: __varRecorder__$e.Rectangle.inset(1, 1, 1, 1),
              cursorWidth: 1.5,
              dynamicCursorColoring: true
            };
          }
        }, {
          key: "yieldShapeIfNeeded",
          value: function TopBarModel_yieldShapeIfNeeded_(evt) {
            var target = this.primaryTarget || $world;

            if (target._yieldedShape) {
              if (!target._yieldedShape.owner && evt.state.absDragDelta.r() > 10) target.addMorph(target._yieldedShape);

              target._yieldedShape.setBounds(__varRecorder__$e.Rectangle.fromAny(evt.position, this._shapeCreationStartPos).scaleBy(1 / $world.scaleFactor));

              Object.assign(target._sizeTooltip, {
                opacity: 1,
                description: "".concat(target._yieldShapeOnClick[Symbol["for"]("__LivelyClassName__")], ": ").concat(target._yieldedShape.width.toFixed(0), "x").concat(target._yieldedShape.height.toFixed(0)),
                topLeft: evt.positionIn(target.world()).addXY(15, 15)
              });
              return true;
            }

            return false;
          }
        }, {
          key: "handleHaloSelection",
          value: function TopBarModel_handleHaloSelection_(evt) {
            var world = $world;
            var target = this.primaryTarget || world;

            if (this._showHaloPreview && this._currentlyHighlighted && world.halos().length === 0) {
              evt.stop();
              world.getSubmorphsByStyleClassName("HaloPreview").forEach(function (m) {
                return m.remove();
              });
              this.showHaloFor(this._currentlyHighlighted);
            }

            if (evt.targetMorph !== target) return;
            target._shapeRequest = true;
          }
        }, {
          key: "showHaloFor",
          value: function TopBarModel_showHaloFor_(targets) {
            var _this6 = this;

            var halo;
            if (!targets) return;

            if (__varRecorder__$e.obj.isArray(targets)) {
              if (targets.length === 0) return;
              halo = $world.showHaloForSelection(targets);
            } else {
              halo = $world.showHaloFor(targets);
            }

            __varRecorder__$e.once(halo, "remove", function () {
              if (halo.target !== $world.focusedMorph) {
                __varRecorder__$e.signal(_this6.primaryTarget, "onHaloRemoved", targets);
              }
            });

            if (!this.activeHaloItems.includes("*")) {
              halo.activeItems = this.activeHaloItems;
            }

            halo.topBar = this;

            __varRecorder__$e.signal(this.primaryTarget, "onHaloOpened", targets);

            return halo;
          }
        }, {
          key: "handleHaloPreview",
          value: function TopBarModel_handleHaloPreview_(evt) {
            var _this7 = this;

            this.clearHaloPreviews();

            if (this._showHaloPreview) {
              var haloFilterFn = this.haloFilterFn;
              var target = this.primaryTarget || $world;
              var morphsContainingPoint = target.morphsContainingPoint(evt.positionIn(target.world()));

              if (evt.type === "hoverout") {
                morphsContainingPoint = [target];
              }

              var haloTarget = morphsContainingPoint.filter(function (m) {
                return haloFilterFn(m) && m.halosEnabled && [m].concat(_toConsumableArray(m.ownerChain())).every(function (m) {
                  return m.visible && m.opacity > 0 && !m.styleClasses.includes("HaloPreview");
                });
              })[0];

              if (morphsContainingPoint.find(function (m) {
                return m.isMenuItem || m === _this7.sideBar || m === _this7.propertiesPanel;
              }) || __varRecorder__$e.obj.equals([target], morphsContainingPoint)) {
                this._currentlyHighlighted = false;
                this.clearHaloPreviews();
                return;
              }

              this.showHaloPreviewFor(haloTarget);
            }

            if (evt.state.draggedMorph) return;

            var _$world$halos = $world.halos(),
                _$world$halos2 = _slicedToArray(_$world$halos, 1),
                halo = _$world$halos2[0];

            if (halo && this._customDrag && evt.leftMouseButtonPressed()) {
              halo.customDrag(evt);
            }

            if (evt.leftMouseButtonPressed() && !this._customDrag && !evt.state.draggedMorph && evt.startPosition && evt.startPosition.subPt(evt.position).r() > 25 && halo && halo.fullContainsPoint(evt.position)) {
              halo.onDragStart(evt);
              this._customDrag = true;
            }
          }
        }, {
          key: "showHaloPreviewFor",
          value: function TopBarModel_showHaloPreviewFor_(aMorph) {
            var target = this.primaryTarget || $world;
            if (!aMorph) return;
            if (![aMorph].concat(_toConsumableArray(aMorph.ownerChain())).find(function (m) {
              return m.isComponent;
            }) && aMorph.getWindow()) aMorph = null;else if ([aMorph].concat(_toConsumableArray(aMorph.ownerChain())).find(function (m) {
              return m.isEpiMorph;
            })) aMorph = null;else if (aMorph === target) aMorph = null;

            if (this._currentlyHighlighted !== aMorph) {
              this.clearHaloPreviews();
              this._currentlyHighlighted = aMorph;
            }

            if ($world.halos().length > 0) return;
            if (!aMorph) return;
            if (!this._previewCache) this._previewCache = new WeakMap();
            var type = __varRecorder__$e.Morph;

            switch (__varRecorder__$e.getClassName(aMorph)) {
              case "Ellipse":
                type = __varRecorder__$e.Ellipse;
                break;
            }

            var preview = this._previewCache.get(aMorph) || __varRecorder__$e.morph({
              type: type,
              styleClasses: ["HaloPreview"],
              epiMorph: true,
              fill: __varRecorder__$e.Color.transparent,
              reactsToPointer: false,
              halosEnabled: false,
              acceptsDrops: false,
              border: {
                color: __varRecorder__$e.Color.rgb(23, 160, 251),
                width: 1
              }
            });

            if (!preview.owner) $world.addMorph(preview);
            preview.setBounds(aMorph.globalBounds());
            preview.borderColor = __varRecorder__$e.Color.rgb(23, 160, 251);
            preview.borderStyle = "solid";
            if (aMorph.master) preview.borderColor = __varRecorder__$e.Color.purple;

            if (aMorph.ownerChain().find(function (m) {
              return m.master && m.master.managesMorph(aMorph);
            })) {
              preview.borderColor = __varRecorder__$e.Color.purple;
              preview.borderStyle = "dotted";
            }

            if (aMorph.isComponent) preview.borderColor = __varRecorder__$e.Color.magenta;

            this._previewCache.set(aMorph, preview);
          }
        }, {
          key: "showHaloPreviews",
          value: function TopBarModel_showHaloPreviews_(active) {
            if (!active) {
              this.clearHaloPreviews();
            }

            this._showHaloPreview = active;
          }
        }, {
          key: "clearHaloPreviews",
          value: function TopBarModel_clearHaloPreviews_() {
            this._currentlyHighlighted = null;
            $world.getSubmorphsByStyleClassName("HaloPreview").forEach(function (m) {
              return m.remove();
            });
          }
        }, {
          key: "prepareDragSelection",
          value: function TopBarModel_prepareDragSelection_(evt) {
            var target = this.primaryTarget || $world;
            var world = target.world();
            this._selectionStartPos = evt.positionIn(world);
            this._morphSelection = world.addMorph({
              type: __varRecorder__$e.Selection,
              epiMorph: true,
              reactsToPointer: false,
              position: this._selectionStartPos,
              extent: evt.state.dragDelta
            });
            this._selectedMorphs = {};
          }
        }, {
          key: "adjustDragSelection",
          value: function TopBarModel_adjustDragSelection_(evt) {
            var _this8 = this;

            var target = this.primaryTarget || $world;
            var world = target.world();

            var selectionBounds = __varRecorder__$e.Rectangle.fromAny(evt.position, this._selectionStartPos);

            this._morphSelection.setBounds(selectionBounds);

            target.submorphs.forEach(function (c) {
              if (c.isSelectionElement || c.isHand || c.isHalo || c.styleClasses.includes("HaloPreview") || c.isMorphSelection || !c.halosEnabled) return;
              var candidateBounds = c.globalBounds();
              var included = selectionBounds.containsRect(candidateBounds);

              if (!_this8._selectedMorphs[c.id] && included) {
                _this8._selectedMorphs[c.id] = world.addMorph({
                  type: __varRecorder__$e.SelectionElement,
                  bounds: candidateBounds
                }, _this8._morphSelection);
              }

              if (_this8._selectedMorphs[c.id] && !included) {
                _this8._selectedMorphs[c.id].remove();

                delete _this8._selectedMorphs[c.id];
              }
            });
          }
        }, {
          key: "finishDragSelectionIfNeeded",
          value: function TopBarModel_finishDragSelectionIfNeeded_() {
            if (this._morphSelection) {
              var world = $world;

              this._morphSelection.fadeOut(200);

              __varRecorder__$e.obj.values(this._selectedMorphs).map(function (m) {
                return m.remove();
              });

              this.showHaloFor(Object.keys(this._selectedMorphs).map(function (id) {
                return world.getMorphWithId(id);
              }));
              this._selectedMorphs = {};
              this._morphSelection = null;
            }
          }
        }, {
          key: "onTargetDragStart",
          value: function TopBarModel_onTargetDragStart_(evt) {
            if (!this.prepareShapeCreation(evt) && evt.leftMouseButtonPressed()) {
              this.prepareDragSelection(evt);
            }
          }
        }, {
          key: "onTargetDrag",
          value: function TopBarModel_onTargetDrag_(evt) {
            if (!this.yieldShapeIfNeeded(evt) && this._morphSelection) {
              this.adjustDragSelection(evt);
            }
          }
        }, {
          key: "showCurrentUser",
          value: function TopBarModel_showCurrentUser_() {
            var userFlap = this.models.userFlap;
            userFlap.showUser(userFlap.currentUser(), false);
          }
        }, {
          key: "detachFromTarget",
          value: function TopBarModel_detachFromTarget_(target) {
            __varRecorder__$e.disconnect(target, "onMouseMove", this, "handleHaloPreview");

            __varRecorder__$e.disconnect(target, "onMouseDown", this, "handleHaloSelection");

            __varRecorder__$e.disconnect(target, "onMouseUp", this, "handleShapeCreation");

            __varRecorder__$e.disconnect(target, "onDragStart", this, "onTargetDragStart");

            __varRecorder__$e.disconnect(target, "onDrag", this, "onTargetDrag");

            __varRecorder__$e.disconnect(target, "onDragEnd", this, "finishDragSelectionIfNeeded");
          }
        }, {
          key: "attachToTarget",
          value: function TopBarModel_attachToTarget_(target) {
            if (this.primaryTarget) this.detachFromTarget(this.primaryTarget);
            this.primaryTarget = target;
            this.setEditMode("Halo");

            __varRecorder__$e.connect(target, "onMouseMove", this, "handleHaloPreview", {
              garbageCollect: true
            });

            __varRecorder__$e.connect(target, "onHoverOut", this, "handleHaloPreview", {
              garbageCollect: true
            });

            __varRecorder__$e.connect(target, "onMouseDown", this, "handleHaloSelection", {
              garbageCollect: true
            });

            __varRecorder__$e.connect(target, "onMouseUp", this, "handleShapeCreation", {
              garbageCollect: true
            });

            __varRecorder__$e.connect(target, "onDragStart", this, "onTargetDragStart", {
              garbageCollect: true
            });

            __varRecorder__$e.connect(target, "onDrag", this, "onTargetDrag", {
              garbageCollect: true
            });

            __varRecorder__$e.connect(target, "onDragEnd", this, "finishDragSelectionIfNeeded", {
              garbageCollect: true
            });

            try {
              target.draggable = true;
            } catch (err) {}
          }
        }], [{
          key: Symbol["for"]("__LivelyClassName__"),
          get: function get() {
            return "TopBarModel";
          }
        }, {
          key: "properties",
          get: function get() {
            return {
              isTopBar: {
                readOnly: true,
                get: function get() {
                  return true;
                }
              },
              activeHaloItems: {
                initialize: function initialize(v) {
                  if (!v) this.activeHaloItems = ["*"];
                }
              },
              primaryTarget: {
                doc: "A reference to the morph that the top bar considers its primary target",
                defaultValue: null
              },
              haloFilterFn: {
                defaultValue: "() => true",
                derived: true,
                set: function set(fnSource) {
                  this.setProperty("haloFilterFn", fnSource);
                },
                get: function get() {
                  return __varRecorder__$e.Closure.fromSource(this.getProperty("haloFilterFn"), {
                    target: this.primaryTarget
                  }).asFunction();
                }
              },
              currentShapeMode: {
                defaultValue: "Rectangle",
                set: function set(shapeName) {
                  this.setProperty("currentShapeMode", shapeName);
                  this.ui.shapeModeButton.changeIcon(__varRecorder__$e.Icon.textAttribute(this.shapeToIcon[shapeName].args[0]));
                }
              },
              shapeToIcon: {
                initialize: function initialize(prevValue) {
                  this.shapeToIcon = prevValue || {
                    Rectangle: {
                      shortcut: "R",
                      args: ["square", {}]
                    },
                    Ellipse: {
                      shortcut: "E",
                      args: ["circle", {}]
                    },
                    Image: {
                      shortcut: "I",
                      args: ["image", {}]
                    },
                    Path: {
                      shortcut: "P",
                      args: ["bezier-curve", {
                        fontSize: 13,
                        paddingTop: "3px"
                      }]
                    },
                    Polygon: {
                      shortcut: "Q",
                      args: ["draw-polygon", {
                        fontSize: 17
                      }]
                    },
                    Canvas: {
                      shortcut: "C",
                      args: ["chess-board", {
                        paddingTop: "1px"
                      }]
                    },
                    HTML: {
                      shortcut: "H",
                      args: ["code", {
                        paddingTop: "1px"
                      }]
                    }
                  };
                }
              },
              keyToShape: {
                initialize: function initialize(prevValue) {
                  this.keyToShape = prevValue || {
                    R: "Rectangle",
                    E: "Ellipse",
                    I: "Image",
                    P: "Path",
                    Q: "Polygon",
                    C: "Canvas",
                    H: "HTML"
                  };
                }
              },
              shapeToClass: {
                serialize: false,
                defaultValue: {
                  Rectangle: __varRecorder__$e.Morph,
                  Ellipse: __varRecorder__$e.Ellipse,
                  HTML: __varRecorder__$e.HTMLMorph,
                  Canvas: __varRecorder__$e.Canvas,
                  Image: __varRecorder__$e.Image,
                  Path: __varRecorder__$e.Path,
                  Polygon: __varRecorder__$e.Polygon,
                  Text: __varRecorder__$e.Text
                }
              },
              shapesCreatedViaDrag: {
                serialize: false,
                initialize: function initialize() {
                  this.shapesCreatedViaDrag = [__varRecorder__$e.Morph, __varRecorder__$e.Ellipse, __varRecorder__$e.HTMLMorph, __varRecorder__$e.Canvas, __varRecorder__$e.Text, __varRecorder__$e.Polygon, __varRecorder__$e.Path, __varRecorder__$e.Image];
                }
              },
              expose: {
                get: function get() {
                  return ["relayout", "attachToTarget", "setEditMode", "showCurrentUser", "showHaloFor", "colorTopbarButton", "isTopBar", "mode"];
                }
              },
              bindings: {
                get: function get() {
                  return [{
                    signal: "onMouseDown",
                    handler: "onMouseDown"
                  }, {
                    signal: "onKeyDown",
                    handler: "onKeyDown"
                  }, {
                    signal: "onKeyUp",
                    handler: "onKeyUp"
                  }];
                }
              }
            };
          }
        }], __lively_classholder__, {
          pathInPackage: function pathInPackage() {
            return "./studio/top-bar.cp.js";
          },
          unsubscribeFromToplevelDefinitionChanges: function unsubscribeFromToplevelDefinitionChanges() {
            return function () {};
          },
          subscribeToToplevelDefinitionChanges: function subscribeToToplevelDefinitionChanges() {
            return function () {};
          },
          "package": function _package() {
            return {
              name: "lively.ide",
              version: "0.1.0"
            };
          }
        }, {
          start: 1992,
          end: 30072
        });
      }(__varRecorder__$e.ViewModel);
      __varRecorder__$e.TopBarModel = TopBarModel;
      __varRecorder__$e.TopBarModel = TopBarModel;
      __varRecorder__$e.TopBar = __varRecorder__$e.component["for"](function () {
        return __varRecorder__$e.component({
          name: "top bar",
          layout: new __varRecorder__$e.TilingLayout({
            justifySubmorphs: "spaced",
            orderByIndex: true,
            padding: __varRecorder__$e.Rectangle.inset(10, 0, 10, 0)
          }),
          defaultViewModel: __varRecorder__$e.TopBarModel,
          dropShadow: new __varRecorder__$e.ShadowObject({
            color: __varRecorder__$e.Color.rgba(0, 0, 0, 0.31),
            blur: 20
          }),
          extent: __varRecorder__$e.pt(929.1, 49.7),
          fill: new __varRecorder__$e.LinearGradient({
            stops: [{
              offset: 0,
              color: __varRecorder__$e.Color.white
            }, {
              offset: 1,
              color: __varRecorder__$e.Color.rgb(229, 231, 233)
            }],
            vector: __varRecorder__$e.rect(0, 0, 0, 1)
          }),
          submorphs: [{
            name: "tiling layout",
            extent: __varRecorder__$e.pt(476.8, 51.1),
            fill: __varRecorder__$e.Color.rgba(46, 75, 223, 0),
            layout: new __varRecorder__$e.TilingLayout({
              align: "bottom",
              padding: {
                height: 0,
                width: 0,
                x: 13,
                y: 13
              },
              reactToSubmorphAnimations: false,
              renderViaCSS: true,
              spacing: 13
            }),
            submorphs: [__varRecorder__$e.part(__varRecorder__$e.TopBarButton, {
              name: "undo button",
              textAndAttributes: __varRecorder__$e.Icon.textAttribute("reply"),
              tooltip: "Undo"
            }), __varRecorder__$e.part(__varRecorder__$e.TopBarButton, {
              name: "redo button",
              textAndAttributes: __varRecorder__$e.Icon.textAttribute("share"),
              tooltip: "Redo"
            }), __varRecorder__$e.part(__varRecorder__$e.TopBarButtonDropDown, {
              name: "save button",
              viewModel: {
                opts: {
                  tooltip: "Choose advanced saving options for Projects.",
                  symbol: {
                    textAndAttributes: __varRecorder__$e.Icon.textAttribute("save"),
                    tooltip: "Save Project or World"
                  }
                }
              }
            }), __varRecorder__$e.part(__varRecorder__$e.TopBarButtonDropDown, {
              name: "hand or halo mode button",
              viewModel: {
                opts: {
                  tooltip: "Choose between Hand and Halo mode",
                  symbol: {
                    textAndAttributes: __varRecorder__$e.Icon.textAttribute("arrow-pointer"),
                    tooltip: "Current mode of the cursor (Hand or Halo)"
                  }
                }
              }
            }), __varRecorder__$e.part(__varRecorder__$e.TopBarButton, {
              name: "text mode button",
              textAndAttributes: __varRecorder__$e.Icon.textAttribute("font"),
              tooltip: "Create textbox mode"
            }), __varRecorder__$e.part(__varRecorder__$e.TopBarButtonDropDown, {
              name: "shape mode button",
              viewModel: {
                opts: {
                  tooltip: "Select different shape",
                  symbol: {
                    textAndAttributes: __varRecorder__$e.Icon.textAttribute("square"),
                    tooltip: "Create basic shape mode"
                  }
                }
              }
            }), __varRecorder__$e.part(__varRecorder__$e.TopBarButton, {
              name: "open component browser",
              padding: __varRecorder__$e.rect(3, 0, -3, 0),
              textAndAttributes: __varRecorder__$e.Icon.textAttribute("cubes"),
              tooltip: "Browse master components"
            }), __varRecorder__$e.part(__varRecorder__$e.TopBarButton, {
              name: "load world button",
              padding: __varRecorder__$e.rect(3, 0, -3, 0),
              textAndAttributes: __varRecorder__$e.Icon.textAttribute("globe"),
              tooltip: "Load other project"
            }), __varRecorder__$e.part(__varRecorder__$e.TopBarButton, {
              name: "comment browser button",
              textAndAttributes: __varRecorder__$e.Icon.textAttribute("comment-alt"),
              tooltip: "Toggle Comment Browser"
            }), __varRecorder__$e.part(__varRecorder__$e.TopBarButtonDropDown, {
              name: "canvas mode button",
              viewModel: {
                opts: {
                  tooltip: "Enable/Disable Canvas mode",
                  symbol: {
                    textAndAttributes: __varRecorder__$e.Icon.textAttribute("map-location-dot"),
                    tooltip: "Open/Close the Minimap"
                  }
                }
              }
            })]
          }, {
            name: "ipad status bar",
            isLayoutable: false,
            borderColor: __varRecorder__$e.Color.rgba(0, 0, 0, 0),
            extent: __varRecorder__$e.pt(929.2, 26),
            fill: __varRecorder__$e.Color.rgb(0, 0, 0),
            position: __varRecorder__$e.pt(0, -26)
          }, __varRecorder__$e.part(__varRecorder__$e.UserFlap, {
            name: "user flap",
            fill: __varRecorder__$e.Color.transparent
          })]
        });
      }, {
        module: "lively.ide/studio/top-bar.cp.js",
        "export": "TopBar",
        range: {
          start: 30079,
          end: 33490
        }
      }, __varRecorder__$e.TopBar);
      var TopBar = __varRecorder__$e.TopBar;
      __varRecorder__$e.TopBar = TopBar;

      var __varRecorder__$d = lively.FreezerRuntime.recorderFor("lively.ide/studio/controls/shape.cp.js");
      __varRecorder__$d.Color = Color;
      __varRecorder__$d.Rectangle = Rectangle;
      __varRecorder__$d.pt = pt;
      __varRecorder__$d.rect = rect;
      __varRecorder__$d.TilingLayout = TilingLayout;
      __varRecorder__$d.Label = Label;
      __varRecorder__$d.ViewModel = ViewModel;
      __varRecorder__$d.add = add;
      __varRecorder__$d.without = without;
      __varRecorder__$d.part = part;
      __varRecorder__$d.component = component;
      __varRecorder__$d.string = string;
      __varRecorder__$d.num = num;
      __varRecorder__$d.DarkNumberIconWidget = DarkNumberIconWidget;
      __varRecorder__$d.PropertyLabel = PropertyLabel;
      __varRecorder__$d.PropertyLabelActive = PropertyLabelActive;
      __varRecorder__$d.DarkThemeList = DarkThemeList;
      __varRecorder__$d.EnumSelector = EnumSelector;
      __varRecorder__$d.PropertyLabelHovered = PropertyLabelHovered;
      __varRecorder__$d.AddButton = AddButton;
      __varRecorder__$d.disconnect = disconnect;
      __varRecorder__$d.epiConnect = epiConnect;
      __varRecorder__$d.FILL_ICON = "\uE5D7";
      __varRecorder__$d.HUG_ICON = "\uE5D6";
      __varRecorder__$d.FIXED_ICON = "\uEA16";
      var ShapeControlModel = function (superclass) {
        var __lively_classholder__ = lively.FreezerRuntime.recorderFor("lively.ide/studio/controls/shape.cp.js");

        var __lively_class__ = __lively_classholder__.hasOwnProperty("ShapeControlModel") && typeof __lively_classholder__.ShapeControlModel === "function" ? __lively_classholder__.ShapeControlModel : __lively_classholder__.ShapeControlModel = function ShapeControlModel(__first_arg__) {
          if (__first_arg__ && __first_arg__[Symbol["for"]("lively-instance-restorer")]) ; else {
            return this[Symbol["for"]("lively-instance-initialize")].apply(this, arguments);
          }
        };

        return initializeClass(__lively_class__, superclass, [{
          key: "attach",
          value: function ShapeControlModel_attach_(view) {
            initializeClass._get(Object.getPrototypeOf(__lively_class__.prototype), "attach", this).call(this, view);

            this.refreshFromTarget();
          }
        }, {
          key: "onRefresh",
          value: function ShapeControlModel_onRefresh_() {
            if (!this.view) return;
            this.ui.multiRadiusContainer.visible = this.multiBorderRadiusActive;
            this.ui.independentCornerToggle.master = this.multiBorderRadiusActive ? this.propertyLabelComponentActive : {
              auto: this.propertyLabelComponent,
              hover: this.propertyLabelComponentHover
            };
            this.ui.proportionalResizeToggle.master = this.proportionalResize ? this.propertyLabelComponentActive : {
              auto: this.propertyLabelComponent,
              hover: this.propertyLabelComponentHover
            };
          }
        }, {
          key: "adjustCornerIndicator",
          value: function ShapeControlModel_adjustCornerIndicator_(cornerSide) {
            var sideToRotation = {
              TopRight: 0,
              TopLeft: Math.PI / 2 * 3,
              BottomRight: Math.PI / 2,
              BottomLeft: Math.PI
            };
            var rotation = sideToRotation[cornerSide] || 0;
            this.ui.borderIndicator.rotation = rotation;
          }
        }, {
          key: "refreshFromTarget",
          value: function ShapeControlModel_refreshFromTarget_() {
            var _this = this;

            if (!this.targetMorph) return;
            var _this$ui = this.ui,
                xInput = _this$ui.xInput,
                yInput = _this$ui.yInput,
                widthInput = _this$ui.widthInput,
                heightInput = _this$ui.heightInput,
                rotationInput = _this$ui.rotationInput,
                radiusInput = _this$ui.radiusInput,
                clipModeSelector = _this$ui.clipModeSelector;
            var _this$targetMorph = this.targetMorph,
                top = _this$targetMorph.top,
                left = _this$targetMorph.left,
                width = _this$targetMorph.width,
                height = _this$targetMorph.height,
                rotation = _this$targetMorph.rotation,
                clipMode = _this$targetMorph.clipMode,
                borderRadius = _this$targetMorph.borderRadius;
            if (this._updating) return;
            this.withoutBindingsDo(function () {
              xInput.number = left;
              yInput.number = top;
              widthInput.number = width;
              heightInput.number = height;
              rotationInput.number = __varRecorder__$d.num.toDegrees(rotation) % 360;
              clipModeSelector.selection = clipMode;
              radiusInput.number = borderRadius.valueOf();

              _this.refreshExtentModes();

              _this.refreshBorderRadiusSides();
            });
          }
        }, {
          key: "refreshExtentModes",
          value: function ShapeControlModel_refreshExtentModes_() {
            var _target$layout, _parent$layout;

            var target = this.targetMorph;
            var parent = target.owner;
            var _this$ui2 = this.ui,
                widthModeSelector = _this$ui2.widthModeSelector,
                heightModeSelector = _this$ui2.heightModeSelector,
                widthInput = _this$ui2.widthInput,
                heightInput = _this$ui2.heightInput,
                xInput = _this$ui2.xInput,
                yInput = _this$ui2.yInput,
                bufferAfterPosition = _this$ui2.bufferAfterPosition;

            function extentModeListItems() {
              var direction = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : "width";
              var fixed = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : true;
              var fill = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : false;
              var hug = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : false;
              var text = arguments.length > 4 && arguments[4] !== undefined ? arguments[4] : false;
              var items = [];

              switch (direction) {
                case "width":
                  if (fixed || text) items.push({
                    string: "Fixed",
                    value: "fixed",
                    isListItem: true
                  });
                  if (fill) items.push({
                    string: "Fill",
                    value: "fill",
                    isListItem: true
                  });
                  if (hug || text) items.push({
                    string: "Hug",
                    value: "hug",
                    isListItem: true
                  });
                  break;

                case "height":
                  if (fixed || text) items.push({
                    string: "Fixed",
                    value: "fixed",
                    isListItem: true
                  });
                  if (fill) items.push({
                    string: "Fill",
                    value: "fill",
                    isListItem: true
                  });
                  if (hug || text) items.push({
                    string: "Hug",
                    value: "hug",
                    isListItem: true
                  });
              }

              return items;
            }

            var targetIsText = target.isText;
            var targetIsTiling = ((_target$layout = target.layout) === null || _target$layout === void 0 ? void 0 : _target$layout.name()) === "Tiling" && target.submorphs.length > 0;
            var parentIsTiling = parent && ((_parent$layout = parent.layout) === null || _parent$layout === void 0 ? void 0 : _parent$layout.name()) === "Tiling";
            widthModeSelector.enable();
            heightModeSelector.enable();
            xInput.visible = true;
            yInput.visible = true;
            bufferAfterPosition.visible = true;

            if (targetIsTiling && parentIsTiling) {
              xInput.visible = false;
              yInput.visible = false;
              bufferAfterPosition.visible = false;
              widthModeSelector.items = extentModeListItems("width", true, true, true, targetIsText);
              heightModeSelector.items = extentModeListItems("height", true, true, true, targetIsText);

              if (!target.layout.resizePolicies.some(function (_ref) {
                var _ref2 = _slicedToArray(_ref, 2);
                    _ref2[0];
                    var width = _ref2[1].width;

                return width === "fixed";
              })) {
                widthModeSelector.items = extentModeListItems("width", true, true, false, targetIsText);
              }

              if (!target.layout.resizePolicies.some(function (_ref3) {
                var _ref4 = _slicedToArray(_ref3, 2);
                    _ref4[0];
                    var height = _ref4[1].height;

                return height === "fixed";
              })) {
                heightModeSelector.items = extentModeListItems("height", true, true, false, targetIsText);
              }

              var heightMode = parent.layout.getResizeHeightPolicyFor(target);
              heightModeSelector.selection = heightMode;
              if (heightMode === "fill") heightInput.disable();else if (target.layout.hugContentsVertically) {
                heightModeSelector.selection = "hug";
                heightInput.disable();
              } else heightInput.enable();
              var widthMode = parent.layout.getResizeWidthPolicyFor(target);
              widthModeSelector.selection = widthMode;
              if (widthMode === "fill") widthInput.disable();else if (target.layout.hugContentsHorizontally) {
                widthModeSelector.selection = "hug";
                widthInput.disable();
              } else widthInput.enable();
            }

            if (targetIsTiling && !parentIsTiling) {
              widthModeSelector.items = extentModeListItems("width", true, false, true, targetIsText);
              heightModeSelector.items = extentModeListItems("height", true, false, true, targetIsText);

              if (!target.layout.resizePolicies.some(function (_ref5) {
                var _ref6 = _slicedToArray(_ref5, 2);
                    _ref6[0];
                    var width = _ref6[1].width;

                return width === "fixed";
              })) {
                widthModeSelector.items = extentModeListItems("width", true, false, false, targetIsText);
                widthModeSelector.disable();
                widthInput.enable();
                widthModeSelector.selection = "fixed";
                return;
              }

              if (!target.layout.resizePolicies.some(function (_ref7) {
                var _ref8 = _slicedToArray(_ref7, 2);
                    _ref8[0];
                    var height = _ref8[1].height;

                return height === "fixed";
              })) {
                heightModeSelector.items = extentModeListItems("height", true, false, false, targetIsText);
                heightModeSelector.disable();
                heightInput.enable();
                heightModeSelector.selection = "fixed";
                return;
              }

              if (target.layout.hugContentsVertically) {
                heightModeSelector.selection = "hug";
                heightInput.disable();
              } else {
                widthInput.enable();
                widthModeSelector.selection = "fixed";
              }

              if (target.layout.hugContentsHorizontally) {
                widthModeSelector.selection = "hug";
                widthInput.disable();
              } else {
                widthInput.enable();
                widthModeSelector.selection = "fixed";
              }
            }

            if (!targetIsTiling && parentIsTiling) {
              xInput.visible = false;
              yInput.visible = false;
              bufferAfterPosition.visible = false;
              widthModeSelector.items = extentModeListItems("width", true, true, false, targetIsText);
              heightModeSelector.items = extentModeListItems("height", true, true, false, targetIsText);

              var _heightMode = parent.layout.getResizeHeightPolicyFor(target);

              if (targetIsText && !target.fixedHeight) _heightMode = "hug";
              heightModeSelector.selection = _heightMode;
              if (_heightMode === "fill" || _heightMode === "hug") heightInput.disable();else heightInput.enable();

              var _widthMode = parent.layout.getResizeWidthPolicyFor(target);

              if (targetIsText && !target.fixedWidth) _widthMode = "hug";
              widthModeSelector.selection = _widthMode;
              if (_widthMode === "fill" || _widthMode === "hug") widthInput.disable();else widthInput.enable();
            }

            if (!targetIsTiling && !parentIsTiling) {
              widthModeSelector.items = extentModeListItems("width", false, false, false, targetIsText);
              heightModeSelector.items = extentModeListItems("height", false, false, false, targetIsText);

              if (!targetIsText) {
                widthModeSelector.disable();
                heightModeSelector.disable();
                widthModeSelector.selection = "fixed";
                heightModeSelector.selection = "fixed";
                heightInput.enable();
                widthInput.enable();
              } else {
                if (target.fixedWidth) {
                  widthModeSelector.selection = "fixed";
                  widthInput.enable();
                } else {
                  widthModeSelector.selection = "hug";
                  widthInput.disable();
                }

                if (target.fixedHeight) {
                  heightModeSelector.selection = "fixed";
                  heightInput.enable();
                } else {
                  heightModeSelector.selection = "hug";
                  heightInput.disable();
                }
              }
            }
          }
        }, {
          key: "refreshBorderRadiusSides",
          value: function ShapeControlModel_refreshBorderRadiusSides_() {
            var _this$ui3 = this.ui,
                radiusInputTopLeft = _this$ui3.radiusInputTopLeft,
                radiusInputTopRight = _this$ui3.radiusInputTopRight,
                radiusInputBottomLeft = _this$ui3.radiusInputBottomLeft,
                radiusInputBottomRight = _this$ui3.radiusInputBottomRight;
            var _this$targetMorph2 = this.targetMorph,
                borderRadiusTopLeft = _this$targetMorph2.borderRadiusTopLeft,
                borderRadiusTopRight = _this$targetMorph2.borderRadiusTopRight,
                borderRadiusBottomRight = _this$targetMorph2.borderRadiusBottomRight,
                borderRadiusBottomLeft = _this$targetMorph2.borderRadiusBottomLeft;
            radiusInputTopLeft.number = borderRadiusTopLeft;
            radiusInputTopRight.number = borderRadiusTopRight;
            radiusInputBottomRight.number = borderRadiusBottomRight;
            radiusInputBottomLeft.number = borderRadiusBottomLeft;
          }
        }, {
          key: "confirm",
          value: function ShapeControlModel_confirm_(propName, val) {
            var _this2 = this;

            this._updating = true;
            this.targetMorph.withMetaDo({
              reconcileChanges: true
            }, function () {
              _this2.targetMorph[propName] = val;
            });
            this._updating = false;
          }
        }, {
          key: "focusOn",
          value: function ShapeControlModel_focusOn_(targetMorph) {
            if (this.targetMorph) {
              __varRecorder__$d.disconnect(this.targetMorph, "position", this, "refreshFromTarget");

              __varRecorder__$d.disconnect(this.targetMorph, "extent", this, "refreshFromTarget");

              __varRecorder__$d.disconnect(this.targetMorph, "rotation", this, "refreshFromTarget");
            }

            this.targetMorph = targetMorph;

            __varRecorder__$d.epiConnect(this.targetMorph, "position", this, "refreshFromTarget");

            __varRecorder__$d.epiConnect(this.targetMorph, "extent", this, "refreshFromTarget");

            __varRecorder__$d.epiConnect(this.targetMorph, "rotation", this, "refreshFromTarget");

            if (this.targetMorph.isEllipse || this.targetMorph.isPolygon || this.targetMorph.isPath) {
              this.setBorderRadiusControlState(false);
            } else this.setBorderRadiusControlState(true);

            this.refreshFromTarget();
          }
        }, {
          key: "setBorderRadiusControlState",
          value: function ShapeControlModel_setBorderRadiusControlState_(state) {
            var _this3 = this;

            state ? null : this.multiBorderRadiusActive = state;
            ["independentCornerToggle", "radiusInput"].forEach(function (elem) {
              _this3.ui[elem].reactsToPointer = state;
              _this3.ui[elem].visible = state;
            });
          }
        }, {
          key: "changePosX",
          value: function ShapeControlModel_changePosX_(newX) {
            this.confirm("left", newX);
          }
        }, {
          key: "changePosY",
          value: function ShapeControlModel_changePosY_(newY) {
            this.confirm("top", newY);
          }
        }, {
          key: "changeWidth",
          value: function ShapeControlModel_changeWidth_(newWidth) {
            var _this4 = this;

            if (this.proportionalResize) {
              var scaledHeight = this.targetMorph.height * (newWidth / this.targetMorph.width);
              this.withoutBindingsDo(function () {
                return _this4.ui.heightInput.number = scaledHeight;
              });
              this.confirm("height", scaledHeight);
            }

            this.confirm("width", newWidth);
          }
        }, {
          key: "changeWidthMode",
          value: function ShapeControlModel_changeWidthMode_(newMode) {
            var _parent$layout2, _target$layout2, _parent$layout3;

            var symbol = this.ui.widthModeSelector.get("interactive label");
            var target = this.targetMorph;
            var parent = target.owner;
            var heightMode;

            switch (newMode) {
              case "fixed":
                symbol.textAndAttributes = [__varRecorder__$d.FIXED_ICON, {
                  fontFamily: "Material Icons",
                  fontSize: 18
                }];
                heightMode = (_parent$layout2 = parent.layout) === null || _parent$layout2 === void 0 ? void 0 : _parent$layout2.getResizeHeightPolicyFor(target);

                if (heightMode) {
                  parent.layout.setResizePolicyFor(target, {
                    width: "fixed",
                    height: heightMode
                  });
                }

                if ((_target$layout2 = target.layout) === null || _target$layout2 === void 0 ? void 0 : _target$layout2.hugContentsHorizontally) target.layout.hugContentsHorizontally = false;
                target.withMetaDo({
                  reconcileChanges: true
                }, function () {
                  if (target.isText) target.fixedWidth = true;
                });
                this.ui.widthInput.enable();
                break;

              case "fill":
                symbol.textAndAttributes = [__varRecorder__$d.FILL_ICON, {
                  fontFamily: "Material Icons",
                  fontSize: 18
                }];
                heightMode = parent.layout.getResizeHeightPolicyFor(target);
                parent.layout.wrapSubmorphs = false;
                parent.layout.setResizePolicyFor(target, {
                  width: "fill",
                  height: heightMode
                });
                this.ui.widthInput.disable();
                break;

              case "hug":
                symbol.textAndAttributes = [__varRecorder__$d.HUG_ICON, {
                  fontFamily: "Material Icons",
                  fontSize: 18
                }];

                if (parent && ((_parent$layout3 = parent.layout) === null || _parent$layout3 === void 0 ? void 0 : _parent$layout3.name()) === "Tiling") {
                  heightMode = parent.layout.getResizeHeightPolicyFor(target);
                  parent.layout.setResizePolicyFor(target, {
                    width: "fixed",
                    height: heightMode
                  });
                }

                if (target.isText) {
                  target.withMetaDo({
                    reconcileChanges: true
                  }, function () {
                    target.fixedWidth = false;
                  });
                } else {
                  target.layout.hugContentsHorizontally = true;
                  target.layout.wrapSubmorphs = false;
                }

                this.ui.widthInput.disable();
            }

            target.layout && target.withMetaDo({
              reconcileChanges: true
            }, function () {
              target.layout = target.layout;
            });
            parent.withMetaDo({
              reconcileChanges: true
            }, function () {
              parent.layout = parent.layout;
            });
          }
        }, {
          key: "changeHeight",
          value: function ShapeControlModel_changeHeight_(newHeight) {
            var _this5 = this;

            if (this.proportionalResize) {
              var scaledWidth = this.targetMorph.width * (newHeight / this.targetMorph.height);
              this.withoutBindingsDo(function () {
                return _this5.ui.widthInput.number = scaledWidth;
              });
              this.confirm("width", scaledWidth);
            }

            this.confirm("height", newHeight);
          }
        }, {
          key: "changeHeightMode",
          value: function ShapeControlModel_changeHeightMode_(newMode) {
            var _parent$layout4, _target$layout3, _parent$layout5;

            var symbol = this.ui.heightModeSelector.get("interactive label");
            var target = this.targetMorph;
            var parent = target.owner;
            var widthMode;

            switch (newMode) {
              case "fixed":
                symbol.textAndAttributes = [__varRecorder__$d.FIXED_ICON, {
                  fontFamily: "Material Icons",
                  fontSize: 18
                }];
                widthMode = (_parent$layout4 = parent.layout) === null || _parent$layout4 === void 0 ? void 0 : _parent$layout4.getResizeWidthPolicyFor(target);

                if (widthMode) {
                  parent.layout.setResizePolicyFor(target, {
                    width: widthMode,
                    height: "fixed"
                  });
                }

                if ((_target$layout3 = target.layout) === null || _target$layout3 === void 0 ? void 0 : _target$layout3.hugContentsVertically) target.layout.hugContentsVertically = false;
                target.withMetaDo({
                  reconcileChanges: true
                }, function () {
                  if (target.isText) target.fixedHeight = true;
                });
                this.ui.heightInput.enable();
                break;

              case "fill":
                symbol.textAndAttributes = [__varRecorder__$d.FILL_ICON, {
                  fontFamily: "Material Icons",
                  fontSize: 18
                }];
                widthMode = parent.layout.getResizeWidthPolicyFor(target);
                parent.layout.wrapSubmorphs = false;
                parent.layout.setResizePolicyFor(target, {
                  width: widthMode,
                  height: "fill"
                });
                this.ui.heightInput.disable();
                break;

              case "hug":
                symbol.textAndAttributes = [__varRecorder__$d.HUG_ICON, {
                  fontFamily: "Material Icons",
                  fontSize: 18
                }];

                if (parent && ((_parent$layout5 = parent.layout) === null || _parent$layout5 === void 0 ? void 0 : _parent$layout5.name()) === "Tiling") {
                  widthMode = parent.layout.getResizeWidthPolicyFor(target);
                  parent.layout.setResizePolicyFor(target, {
                    width: widthMode,
                    height: "fixed"
                  });
                }

                if (target.isText) {
                  target.withMetaDo({
                    reconcileChanges: true
                  }, function () {
                    target.fixedHeight = false;
                  });
                } else {
                  target.layout.hugContentsVertically = true;
                  target.layout.wrapSubmorphs = false;
                }

                this.ui.heightInput.disable();
            }

            target.layout && target.withMetaDo({
              reconcileChanges: true
            }, function () {
              target.layout = target.layout;
            });
            parent.layout && parent.withMetaDo({
              reconcileChanges: true
            }, function () {
              parent.layout = parent.layout;
            });
          }
        }, {
          key: "changeRotation",
          value: function ShapeControlModel_changeRotation_(newRot) {
            this.confirm("rotation", __varRecorder__$d.num.toRadians(newRot));
          }
        }, {
          key: "changeClipMode",
          value: function ShapeControlModel_changeClipMode_(newClipMode) {
            this.confirm("clipMode", newClipMode);
          }
        }, {
          key: "changeBorderRadius",
          value: function ShapeControlModel_changeBorderRadius_(rad) {
            var _this6 = this;

            this.confirm("borderRadius", rad);
            this.withoutBindingsDo(function () {
              return _this6.refreshBorderRadiusSides();
            });
          }
        }, {
          key: "changeBorderRadiusTopLeft",
          value: function ShapeControlModel_changeBorderRadiusTopLeft_(rad) {
            this.confirm("borderRadiusTopLeft", rad);
            this.toggleMixedRadius();
          }
        }, {
          key: "changeBorderRadiusTopRight",
          value: function ShapeControlModel_changeBorderRadiusTopRight_(rad) {
            this.confirm("borderRadiusTopRight", rad);
            this.toggleMixedRadius();
          }
        }, {
          key: "changeBorderRadiusBottomRight",
          value: function ShapeControlModel_changeBorderRadiusBottomRight_(rad) {
            this.confirm("borderRadiusBottomRight", rad);
            this.toggleMixedRadius();
          }
        }, {
          key: "changeBorderRadiusBottomLeft",
          value: function ShapeControlModel_changeBorderRadiusBottomLeft_(rad) {
            this.confirm("borderRadiusBottomLeft", rad);
            this.toggleMixedRadius();
          }
        }, {
          key: "toggleMixedRadius",
          value: function ShapeControlModel_toggleMixedRadius_() {
            this.ui.radiusInput.setMixed();
          }
        }, {
          key: "toggleBorderMultiVar",
          value: function ShapeControlModel_toggleBorderMultiVar_() {
            this.multiBorderRadiusActive = !this.multiBorderRadiusActive;
          }
        }, {
          key: "changeResizeMode",
          value: function ShapeControlModel_changeResizeMode_() {
            this.proportionalResize = !this.proportionalResize;
          }
        }], [{
          key: Symbol["for"]("__LivelyClassName__"),
          get: function get() {
            return "ShapeControlModel";
          }
        }, {
          key: "properties",
          get: function get() {
            return {
              targetMorph: {},
              proportionalResize: {
                defaultValue: false
              },
              multiBorderRadiusActive: {
                defaultValue: false
              },
              propertyLabelComponent: {
                isComponent: true,
                get: function get() {
                  return this.getProperty("propertyLabelComponent") || __varRecorder__$d.PropertyLabel;
                }
              },
              propertyLabelComponentActive: {
                isComponent: true,
                get: function get() {
                  return this.getProperty("propertyLabelComponentActive") || __varRecorder__$d.PropertyLabelActive;
                }
              },
              propertyLabelComponentHover: {
                isComponent: true,
                get: function get() {
                  return this.getProperty("propertyLabelComponentHover") || __varRecorder__$d.PropertyLabelHovered;
                }
              },
              expose: {
                get: function get() {
                  return ["refreshFromTarget"];
                }
              },
              bindings: {
                get: function get() {
                  return [{
                    target: "x input",
                    signal: "numberChanged",
                    handler: "changePosX"
                  }, {
                    target: "y input",
                    signal: "numberChanged",
                    handler: "changePosY"
                  }, {
                    target: "width input",
                    signal: "numberChanged",
                    handler: "changeWidth"
                  }, {
                    target: "height input",
                    signal: "numberChanged",
                    handler: "changeHeight"
                  }, {
                    target: "rotation input",
                    signal: "numberChanged",
                    handler: "changeRotation"
                  }].concat(_toConsumableArray(["", " top left", " top right", " bottom right", " bottom left"].map(function (d) {
                    return [{
                      target: "radius input" + d,
                      signal: "numberChanged",
                      handler: "change" + __varRecorder__$d.string.camelCaseString("border radius " + d),
                      override: false
                    }, {
                      target: "radius input" + d,
                      signal: "onMouseDown",
                      handler: "adjustCornerIndicator",
                      converter: "() => \"".concat(__varRecorder__$d.string.camelCaseString(d), "\"")
                    }];
                  }).flat()), [{
                    model: "clip mode selector",
                    signal: "selection",
                    handler: "changeClipMode"
                  }, {
                    model: "width mode selector",
                    signal: "selection",
                    handler: "changeWidthMode"
                  }, {
                    model: "height mode selector",
                    signal: "selection",
                    handler: "changeHeightMode"
                  }, {
                    target: "proportional resize toggle",
                    signal: "onMouseDown",
                    handler: "changeResizeMode"
                  }, {
                    target: "independent corner toggle",
                    signal: "onMouseDown",
                    handler: "toggleBorderMultiVar"
                  }]);
                }
              }
            };
          }
        }], __lively_classholder__, {
          pathInPackage: function pathInPackage() {
            return "./studio/controls/shape.cp.js";
          },
          unsubscribeFromToplevelDefinitionChanges: function unsubscribeFromToplevelDefinitionChanges() {
            return function () {};
          },
          subscribeToToplevelDefinitionChanges: function subscribeToToplevelDefinitionChanges() {
            return function () {};
          },
          "package": function _package() {
            return {
              name: "lively.ide",
              version: "0.1.0"
            };
          }
        }, {
          start: 573,
          end: 20116
        });
      }(__varRecorder__$d.ViewModel);
      __varRecorder__$d.ShapeControlModel = ShapeControlModel;
      __varRecorder__$d.ShapeControlModel = ShapeControlModel;
      __varRecorder__$d.ShapeControl = __varRecorder__$d.component["for"](function () {
        return __varRecorder__$d.component({
          name: "shape control",
          borderRadius: 0,
          defaultViewModel: __varRecorder__$d.ShapeControlModel,
          borderColor: __varRecorder__$d.Color.rgba(97, 106, 107, 1),
          borderWidth: {
            top: 0,
            left: 0,
            right: 0,
            bottom: 1
          },
          layout: new __varRecorder__$d.TilingLayout({
            axisAlign: "center",
            wrapSubmorphs: true,
            justifySubmorphs: "spaced",
            hugContentsVertically: true,
            orderByIndex: true,
            padding: __varRecorder__$d.rect(20, 20, 0, 0),
            spacing: 16
          }),
          fill: __varRecorder__$d.Color.transparent,
          extent: __varRecorder__$d.pt(250, 215.4),
          submorphs: [__varRecorder__$d.part(__varRecorder__$d.DarkNumberIconWidget, {
            name: "x input",
            tooltip: "X Position",
            viewModel: {
              min: -Infinity,
              max: Infinity,
              scaleFactor: 1,
              autofit: true
            },
            submorphs: [{
              name: "interactive label",
              fontSize: 13,
              fontFamily: "IBM Plex Mono",
              padding: __varRecorder__$d.rect(8, 0, -1, 0),
              textAndAttributes: ["X", {
                textStyleClasses: [""]
              }]
            }]
          }), __varRecorder__$d.part(__varRecorder__$d.DarkNumberIconWidget, {
            name: "y input",
            tooltip: "Y Position",
            viewModel: {
              min: -Infinity,
              max: Infinity,
              scaleFactor: 1,
              autofit: true
            },
            submorphs: [{
              name: "interactive label",
              padding: __varRecorder__$d.rect(7, 0, 0, 0),
              fontFamily: "IBM Plex Mono",
              fontSize: 13,
              textAndAttributes: ["Y", {
                textStyleClasses: [""]
              }]
            }]
          }), {
            opacity: 0,
            name: "buffer after position",
            width: 25
          }, __varRecorder__$d.part(__varRecorder__$d.DarkNumberIconWidget, {
            name: "width input",
            tooltip: "Width",
            viewModel: {
              min: -Infinity,
              max: Infinity,
              scaleFactor: 1,
              autofit: true
            },
            submorphs: [{
              name: "interactive label",
              lineHeight: 1,
              padding: __varRecorder__$d.rect(0, 4, 0, -4),
              rotation: -1.57,
              fontFamily: "Material Icons",
              textAndAttributes: ["\uEA16", {
                fontSize: 18
              }]
            }]
          }), __varRecorder__$d.part(__varRecorder__$d.DarkNumberIconWidget, {
            name: "height input",
            viewModel: {
              min: -Infinity,
              max: Infinity,
              scaleFactor: 1,
              autofit: true
            },
            tooltip: "Height",
            submorphs: [{
              name: "interactive label",
              padding: __varRecorder__$d.rect(3, 3, -3, -3),
              fontFamily: "Material Icons",
              textAndAttributes: [__varRecorder__$d.FIXED_ICON, {
                fontSize: 18
              }]
            }]
          }), __varRecorder__$d.part(__varRecorder__$d.AddButton, {
            master: {
              auto: __varRecorder__$d.AddButton,
              hover: __varRecorder__$d.PropertyLabelHovered
            },
            name: "proportional resize toggle",
            tooltip: "Proportional Resize",
            padding: __varRecorder__$d.rect(5, 5, 0, 0),
            textAndAttributes: ["\uF0C1", {
              fontFamily: "\"Font Awesome 6 Free\", \"Font Awesome 6 Brands\"",
              fontWeight: "900"
            }]
          }), __varRecorder__$d.part(__varRecorder__$d.EnumSelector, {
            name: "width mode selector",
            tooltip: "Horizontal Resizing",
            extent: __varRecorder__$d.pt(72, 22),
            layout: new __varRecorder__$d.TilingLayout({
              align: "center",
              axisAlign: "center",
              justifySubmorphs: "spaced",
              orderByIndex: true,
              padding: __varRecorder__$d.rect(0, 0, 10, 0),
              resizePolicies: [["label", {
                0: {
                  height: "fixed",
                  width: "fill"
                }
              }]]
            }),
            viewModel: {
              listMaster: __varRecorder__$d.DarkThemeList,
              openListInWorld: true,
              listAlign: "selection",
              items: [{
                string: "Fixed",
                value: "fixed",
                isListItem: true
              }, {
                string: "Fill",
                value: "fill",
                isListItem: true
              }, {
                string: "Hug",
                value: "hug",
                isListItem: true
              }]
            },
            submorphs: [__varRecorder__$d.add({
              type: __varRecorder__$d.Label,
              name: "interactive label",
              fill: __varRecorder__$d.Color.rgba(229, 231, 233, 0),
              fontColor: __varRecorder__$d.Color.rgba(178, 235, 242, 0.6),
              fontFamily: "Material Icons",
              nativeCursor: "pointer",
              rotation: -1.5707963267948966,
              reactsToPointer: false,
              textAndAttributes: [__varRecorder__$d.FIXED_ICON, {
                fontSize: 16
              }]
            }, "label"), {
              name: "label",
              fontSize: 12,
              fontColor: __varRecorder__$d.Color.rgb(178, 235, 242)
            }]
          }), __varRecorder__$d.part(__varRecorder__$d.EnumSelector, {
            name: "height mode selector",
            tooltip: "Vertical Resizing",
            extent: __varRecorder__$d.pt(72, 22),
            layout: new __varRecorder__$d.TilingLayout({
              align: "center",
              axisAlign: "center",
              justifySubmorphs: "spaced",
              orderByIndex: true,
              padding: __varRecorder__$d.rect(2, 0, 8, 0),
              resizePolicies: [["label", {
                0: {
                  height: "fixed",
                  width: "fill"
                }
              }]]
            }),
            viewModel: {
              listMaster: __varRecorder__$d.DarkThemeList,
              openListInWorld: true,
              listAlign: "selection",
              items: [{
                string: "Fixed",
                value: "fixed",
                isListItem: true
              }, {
                string: "Fill",
                value: "fill",
                isListItem: true
              }, {
                string: "Hug",
                value: "hug",
                isListItem: true
              }]
            },
            submorphs: [__varRecorder__$d.add({
              type: __varRecorder__$d.Label,
              name: "interactive label",
              fill: __varRecorder__$d.Color.rgba(229, 231, 233, 0),
              fontColor: __varRecorder__$d.Color.rgba(178, 235, 242, 0.6),
              fontFamily: "Material Icons",
              nativeCursor: "pointer",
              reactsToPointer: false,
              lineHeight: 1,
              textAndAttributes: [__varRecorder__$d.FIXED_ICON, {
                fontSize: 16
              }]
            }, "label"), {
              name: "label",
              fontSize: 12,
              fontColor: __varRecorder__$d.Color.rgb(178, 235, 242)
            }]
          }), {
            opacity: 0,
            name: "buffer",
            width: 25
          }, __varRecorder__$d.part(__varRecorder__$d.DarkNumberIconWidget, {
            name: "rotation input",
            tooltip: "Rotation",
            viewModel: {
              unit: "\xB0",
              min: 0,
              max: 359,
              autofit: true
            },
            submorphs: [{
              name: "interactive label",
              lineHeight: 1,
              padding: __varRecorder__$d.Rectangle.inset(6, 0, 0, 0)
            }, {
              name: "value",
              cursorColor: __varRecorder__$d.Color.rgba(178, 235, 242, 0.75),
              extent: __varRecorder__$d.pt(42.6, 21)
            }]
          }), __varRecorder__$d.part(__varRecorder__$d.DarkNumberIconWidget, {
            name: "radius input",
            tooltip: "Border Radius",
            viewModel: {
              min: 0,
              autofit: true
            },
            submorphs: [{
              name: "interactive label",
              fontFamily: "Material Icons",
              lineHeight: 1,
              textAndAttributes: ["\uE920", {
                fontSize: 16
              }]
            }]
          }), __varRecorder__$d.part(__varRecorder__$d.AddButton, {
            master: {
              auto: __varRecorder__$d.AddButton,
              hover: __varRecorder__$d.PropertyLabelHovered
            },
            name: "independent corner toggle",
            tooltip: "Independent Border Radius per Corner",
            padding: __varRecorder__$d.rect(3, 3, 0, 0),
            textAndAttributes: ["\uE5D0", {
              fontSize: 18,
              fontFamily: "Material Icons"
            }]
          }), {
            name: "multi radius container",
            layout: new __varRecorder__$d.TilingLayout({
              axisAlign: "center",
              orderByIndex: true,
              spacing: 1
            }),
            fill: __varRecorder__$d.Color.transparent,
            extent: __varRecorder__$d.pt(223.5, 25),
            clipMode: "hidden",
            submorphs: [{
              name: "centering wrapper",
              fill: __varRecorder__$d.Color.transparent,
              clipMode: "hidden",
              layout: new __varRecorder__$d.TilingLayout({
                align: "center",
                axisAlign: "center"
              }),
              extent: __varRecorder__$d.pt(21, 25),
              submorphs: [{
                type: __varRecorder__$d.Label,
                name: "border indicator",
                borderRadius: 3,
                fill: __varRecorder__$d.Color.rgba(229, 231, 233, 0),
                fontColor: __varRecorder__$d.Color.rgb(178, 235, 242),
                fontFamily: "Material Icons",
                padding: __varRecorder__$d.rect(2, 2, 0, -2),
                textAndAttributes: ["\uE920", {
                  fontSize: 16
                }]
              }]
            }, __varRecorder__$d.part(__varRecorder__$d.DarkNumberIconWidget, {
              name: "radius input top left",
              viewModel: {
                min: 0,
                autofit: true
              },
              extent: __varRecorder__$d.pt(35, 22),
              tooltip: "Border Radius Top Left",
              borderRadiusTopRight: 0,
              borderRadiusBottomRight: 0,
              submorphs: [__varRecorder__$d.without("interactive label")]
            }), __varRecorder__$d.part(__varRecorder__$d.DarkNumberIconWidget, {
              name: "radius input top right",
              viewModel: {
                min: 0,
                autofit: true
              },
              borderRadius: 0,
              extent: __varRecorder__$d.pt(35, 22),
              tooltip: "Border Radius Top Right",
              submorphs: [__varRecorder__$d.without("interactive label")]
            }), __varRecorder__$d.part(__varRecorder__$d.DarkNumberIconWidget, {
              name: "radius input bottom right",
              viewModel: {
                min: 0,
                autofit: true
              },
              borderRadius: 0,
              extent: __varRecorder__$d.pt(35, 22),
              tooltip: "Border Radius Bottom Right",
              submorphs: [__varRecorder__$d.without("interactive label")]
            }), __varRecorder__$d.part(__varRecorder__$d.DarkNumberIconWidget, {
              name: "radius input bottom left",
              viewModel: {
                min: 0,
                autofit: true
              },
              borderRadiusTopLeft: 0,
              borderRadiusBottomLeft: 0,
              extent: __varRecorder__$d.pt(35, 22),
              tooltip: "Border Radius Bottom Left",
              submorphs: [__varRecorder__$d.without("interactive label")]
            })]
          }, __varRecorder__$d.part(__varRecorder__$d.EnumSelector, {
            name: "clip mode selector",
            tooltip: "Clip Mode",
            extent: __varRecorder__$d.pt(165, 23.3),
            viewModel: {
              listMaster: __varRecorder__$d.DarkThemeList,
              openListInWorld: true,
              listAlign: "selection",
              items: [{
                string: "Visible",
                value: "visible",
                isListItem: true
              }, {
                string: "Hidden",
                value: "hidden",
                isListItem: true
              }, {
                string: "Scroll",
                value: "scroll",
                isListItem: true
              }, {
                string: "Auto",
                value: "auto",
                isListItem: true
              }]
            },
            submorphs: [__varRecorder__$d.add({
              type: __varRecorder__$d.Label,
              name: "interactive label",
              fill: __varRecorder__$d.Color.rgba(229, 231, 233, 0),
              fontColor: __varRecorder__$d.Color.rgba(178, 235, 242, 0.6),
              fontFamily: "Material Icons",
              nativeCursor: "pointer",
              lineHeight: 1,
              padding: __varRecorder__$d.rect(6, 0, -6, 0),
              reactsToPointer: false,
              textAndAttributes: ["\uE3BE", {
                fontSize: 16
              }]
            }, "label"), {
              name: "label",
              fontColor: __varRecorder__$d.Color.rgb(178, 235, 242)
            }]
          })]
        });
      }, {
        module: "lively.ide/studio/controls/shape.cp.js",
        "export": "ShapeControl",
        range: {
          start: 20123,
          end: 29435
        }
      }, __varRecorder__$d.ShapeControl);
      var ShapeControl = __varRecorder__$d.ShapeControl;
      __varRecorder__$d.ShapeControl = ShapeControl;

      var __varRecorder__$c = lively.FreezerRuntime.recorderFor("lively.ide/studio/controls/layout.cp.js");
      __varRecorder__$c.Morph = Morph;
      __varRecorder__$c.TilingLayout = TilingLayout;
      __varRecorder__$c.component = component;
      __varRecorder__$c.without = without;
      __varRecorder__$c.ViewModel = ViewModel;
      __varRecorder__$c.part = part;
      __varRecorder__$c.add = add;
      __varRecorder__$c.pt = pt;
      __varRecorder__$c.rect = rect;
      __varRecorder__$c.Rectangle = Rectangle;
      __varRecorder__$c.Color = Color;
      __varRecorder__$c.arr = arr;
      __varRecorder__$c.epiConnect = epiConnect;
      __varRecorder__$c.signal = signal;
      __varRecorder__$c.disconnect = disconnect;
      __varRecorder__$c.once = once;
      __varRecorder__$c.AddButton = AddButton;
      __varRecorder__$c.PropLabel = PropLabel;
      __varRecorder__$c.DarkFlap = DarkFlap;
      __varRecorder__$c.DarkThemeList = DarkThemeList;
      __varRecorder__$c.EnumSelector = EnumSelector;
      __varRecorder__$c.PropertyLabel = PropertyLabel;
      __varRecorder__$c.DarkNumberIconWidget = DarkNumberIconWidget;
      __varRecorder__$c.PropertyLabelHovered = PropertyLabelHovered;
      __varRecorder__$c.PropertySection = PropertySection;
      __varRecorder__$c.PropertySectionModel = PropertySectionModel;
      __varRecorder__$c.LabeledCheckbox = LabeledCheckbox;
      var LayoutPreview = function (superclass) {
        var __lively_classholder__ = lively.FreezerRuntime.recorderFor("lively.ide/studio/controls/layout.cp.js");

        var __lively_class__ = __lively_classholder__.hasOwnProperty("LayoutPreview") && typeof __lively_classholder__.LayoutPreview === "function" ? __lively_classholder__.LayoutPreview : __lively_classholder__.LayoutPreview = function LayoutPreview(__first_arg__) {
          if (__first_arg__ && __first_arg__[Symbol["for"]("lively-instance-restorer")]) ; else {
            return this[Symbol["for"]("lively-instance-initialize")].apply(this, arguments);
          }
        };

        return initializeClass(__lively_class__, superclass, [{
          key: "previewLayout",
          value: function LayoutPreview_previewLayout_(autoLayout) {
            var _this = this;

            (this.getSubmorphNamed("outer border") || this).layout = new __varRecorder__$c.TilingLayout({
              spacing: this.defaultSpacing,
              padding: this.defaultPadding,
              align: autoLayout.align,
              axisAlign: autoLayout.axisAlign,
              axis: autoLayout.axis,
              justifySubmorphs: autoLayout.justifySubmorphs
            });
            ["mini bar 1", "mini bar 2", "mini bar 3"].forEach(function (bar) {
              _this.getSubmorphNamed(bar).rotation = autoLayout.axis === "row" ? 0 : Math.PI / 2;
            });
          }
        }, {
          key: "setActive",
          value: function () {
            var _LayoutPreview_setActive_ = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee(active) {
              return regeneratorRuntime.wrap(function _callee$(_context) {
                while (1) {
                  switch (_context.prev = _context.next) {
                    case 0:
                      this.master = active ? this.activeComponent : this.inactiveComponent;

                    case 1:
                    case "end":
                      return _context.stop();
                  }
                }
              }, _callee, this);
            }));

            function LayoutPreview_setActive_(_x) {
              return _LayoutPreview_setActive_.apply(this, arguments);
            }

            return LayoutPreview_setActive_;
          }()
        }], [{
          key: Symbol["for"]("__LivelyClassName__"),
          get: function get() {
            return "LayoutPreview";
          }
        }, {
          key: "properties",
          get: function get() {
            return {
              defaultSpacing: {
                defaultValue: 2
              },
              defaultPadding: {
                defaultValue: __varRecorder__$c.rect(3, 3, 0, 0)
              },
              activeComponent: {
                isComponent: true,
                get: function get() {
                  return this.getProperty("activeComponent") || __varRecorder__$c.MiniLayoutPreviewActive;
                }
              },
              inactiveComponent: {
                isComponent: true,
                get: function get() {
                  return this.getProperty("inactiveComponent") || __varRecorder__$c.MiniLayoutPreview;
                }
              }
            };
          }
        }], __lively_classholder__, {
          pathInPackage: function pathInPackage() {
            return "./studio/controls/layout.cp.js";
          },
          unsubscribeFromToplevelDefinitionChanges: function unsubscribeFromToplevelDefinitionChanges() {
            return function () {};
          },
          subscribeToToplevelDefinitionChanges: function subscribeToToplevelDefinitionChanges() {
            return function () {};
          },
          "package": function _package() {
            return {
              name: "lively.ide",
              version: "0.1.0"
            };
          }
        }, {
          start: 552,
          end: 1849
        });
      }(__varRecorder__$c.Morph);
      __varRecorder__$c.LayoutPreview = LayoutPreview;
      __varRecorder__$c.LayoutPreview = LayoutPreview;
      var AutoLayoutControlModel = function (superclass) {
        var __lively_classholder__ = lively.FreezerRuntime.recorderFor("lively.ide/studio/controls/layout.cp.js");

        var __lively_class__ = __lively_classholder__.hasOwnProperty("AutoLayoutControlModel") && typeof __lively_classholder__.AutoLayoutControlModel === "function" ? __lively_classholder__.AutoLayoutControlModel : __lively_classholder__.AutoLayoutControlModel = function AutoLayoutControlModel(__first_arg__) {
          if (__first_arg__ && __first_arg__[Symbol["for"]("lively-instance-restorer")]) ; else {
            return this[Symbol["for"]("lively-instance-initialize")].apply(this, arguments);
          }
        };

        return initializeClass(__lively_class__, superclass, [{
          key: "focusOn",
          value: function AutoLayoutControlModel_focusOn_(aMorph) {
            this.targetMorph = null;

            if (!aMorph.layout || aMorph.layout.name() !== "Tiling") {
              this.deactivate();
              this.targetMorph = aMorph;
            } else {
              this.targetMorph = aMorph;
              this.activate();
            }
          }
        }, {
          key: "onRefresh",
          value: function AutoLayoutControlModel_onRefresh_(prop) {
            if (!prop || prop === "targetMorph") this.update();
          }
        }, {
          key: "update",
          value: function AutoLayoutControlModel_update_(prop) {
            var _this2 = this;

            this.withoutBindingsDo(function () {
              var _this2$ui = _this2.ui,
                  miniLayoutPreview = _this2$ui.miniLayoutPreview,
                  vertical = _this2$ui.vertical,
                  horizontal = _this2$ui.horizontal,
                  spacingInput = _this2$ui.spacingInput,
                  totalPaddingInput = _this2$ui.totalPaddingInput,
                  wrapSubmorphsCheckbox = _this2$ui.wrapSubmorphsCheckbox;
              miniLayoutPreview.setActive(!!_this2.popup);
              if (!_this2.targetMorph) return;
              var layout = _this2.targetMorph.layout;
              if (!layout) return;
              miniLayoutPreview.previewLayout(layout);
              vertical.master = layout.axis === "column" ? _this2.buttonActiveComponent : _this2.buttonInactiveComponent;
              horizontal.master = layout.axis === "row" ? _this2.buttonActiveComponent : _this2.buttonInactiveComponent;
              spacingInput.number = layout.spacing;

              if (_this2.hasMixedPadding()) {
                totalPaddingInput.setMixed();
              } else {
                totalPaddingInput.number = layout.padding.top();
              }

              if (prop === "wrapping") wrapSubmorphsCheckbox.checked = layout.wrapSubmorphs;
            });
          }
        }, {
          key: "confirm",
          value: function AutoLayoutControlModel_confirm_() {
            var _this3 = this;

            var layout = this.targetMorph.layout;
            var _this$ui = this.ui,
                spacingInput = _this$ui.spacingInput,
                totalPaddingInput = _this$ui.totalPaddingInput;
            this.targetMorph.withMetaDo({
              reconcileChanges: true
            }, function () {
              var changes = {
                spacing: spacingInput.number
              };

              if (!totalPaddingInput.isMixed) {
                changes.padding = __varRecorder__$c.Rectangle.inset(totalPaddingInput.number);
              }

              _this3.targetMorph.layout = layout["with"](changes);
            });
          }
        }, {
          key: "toggleWrapping",
          value: function AutoLayoutControlModel_toggleWrapping_() {
            var _this4 = this;

            var layout = this.targetMorph.layout;
            this.targetMorph.withMetaDo({
              reconcileChanges: true
            }, function () {
              _this4.targetMorph.layout = layout["with"]({
                wrapSubmorphs: !layout.wrapSubmorphs
              });
            });
            this.update("wrapping");
          }
        }, {
          key: "setVerticalFlow",
          value: function AutoLayoutControlModel_setVerticalFlow_() {
            var _this5 = this;

            this.targetMorph.withMetaDo({
              reconcileChanges: true
            }, function () {
              _this5.targetMorph.layout = _this5.targetMorph.layout["with"]({
                axis: "column"
              });
            });
            this.update();
          }
        }, {
          key: "setHorizontalFlow",
          value: function AutoLayoutControlModel_setHorizontalFlow_() {
            var _this6 = this;

            this.targetMorph.withMetaDo({
              reconcileChanges: true
            }, function () {
              _this6.targetMorph.layout = _this6.targetMorph.layout["with"]({
                axis: "row"
              });
            });
            this.update();
          }
        }, {
          key: "hasMixedPadding",
          value: function AutoLayoutControlModel_hasMixedPadding_() {
            var padding = this.targetMorph.layout.padding;
            return __varRecorder__$c.arr.uniq(["left", "top", "right", "bottom"].map(function (side) {
              return padding[side]();
            })).length > 1;
          }
        }, {
          key: "activate",
          value: function AutoLayoutControlModel_activate_() {
            var _this7 = this;

            var _this$ui2 = this.ui,
                controls = _this$ui2.controls,
                wrapCheckboxWrapper = _this$ui2.wrapCheckboxWrapper;

            initializeClass._get(Object.getPrototypeOf(__lively_class__.prototype), "activate", this).call(this);

            controls.visible = true;
            wrapCheckboxWrapper.visible = true;
            this.view.master.setState(null);
            var layout = this.targetMorph && this.targetMorph.layout;
            this.targetMorph.withMetaDo({
              reconcileChanges: true
            }, function () {
              if (!layout || layout.name() !== "Tiling") {
                _this7.targetMorph.layout = new __varRecorder__$c.TilingLayout();
              }
            });
            this.update();

            __varRecorder__$c.signal(this, "layout changed");
          }
        }, {
          key: "deactivate",
          value: function AutoLayoutControlModel_deactivate_() {
            var _this8 = this;

            var _this$ui3 = this.ui,
                controls = _this$ui3.controls,
                wrapCheckboxWrapper = _this$ui3.wrapCheckboxWrapper;

            initializeClass._get(Object.getPrototypeOf(__lively_class__.prototype), "deactivate", this).call(this);

            this.view.master.setState("inactive");
            controls.visible = false;
            wrapCheckboxWrapper.visible = false;

            if (this.targetMorph && this.targetMorph.layout) {
              var layoutableSubmorphs = this.targetMorph.layout.layoutableSubmorphs;
              this.targetMorph.withMetaDo({
                reconcileChanges: true
              }, function () {
                _this8.targetMorph.layout = undefined;
                layoutableSubmorphs.forEach(function (m) {
                  return m.position = m.position;
                });
              });
            }

            this.popup = false;

            __varRecorder__$c.signal(this, "layout changed");
          }
        }, {
          key: "openLayoutPopup",
          value: function () {
            var _AutoLayoutControlModel_openLayoutPopup_ = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee2() {
              var p;
              return regeneratorRuntime.wrap(function _callee2$(_context2) {
                while (1) {
                  switch (_context2.prev = _context2.next) {
                    case 0:
                      if (!this.popup) {
                        _context2.next = 2;
                        break;
                      }

                      return _context2.abrupt("return");

                    case 2:
                      p = this.popup = __varRecorder__$c.part(this.controlFlapComponent, {
                        viewModel: {
                          targetMorph: this.targetMorph
                        }
                      });

                      __varRecorder__$c.epiConnect(p.viewModel, "update", this, "update");

                      __varRecorder__$c.once(p.viewModel, "close", this, "closePopup");

                      p.openInWorld();
                      p.topRight = this.ui.miniLayoutPreview.globalBounds().bottomRight().addXY(0, 2);
                      p.topLeft = this.world().visibleBounds().translateForInclusion(p.globalBounds()).topLeft();
                      p.start();
                      p.viewModel.update();

                    case 10:
                    case "end":
                      return _context2.stop();
                  }
                }
              }, _callee2, this);
            }));

            function AutoLayoutControlModel_openLayoutPopup_() {
              return _AutoLayoutControlModel_openLayoutPopup_.apply(this, arguments);
            }

            return AutoLayoutControlModel_openLayoutPopup_;
          }()
        }, {
          key: "closePopup",
          value: function AutoLayoutControlModel_closePopup_() {
            this.popup.close();
            this.popup = null;
            this.update();
          }
        }], [{
          key: Symbol["for"]("__LivelyClassName__"),
          get: function get() {
            return "AutoLayoutControlModel";
          }
        }, {
          key: "properties",
          get: function get() {
            return {
              targetMorph: {},
              activeSectionComponent: {
                isComponent: true,
                get: function get() {
                  return this.getProperty("activeSectionComponent") || __varRecorder__$c.LayoutControl;
                }
              },
              buttonActiveComponent: {
                isComponent: true,
                get: function get() {
                  return this.getProperty("buttonActiveComponent") || __varRecorder__$c.PropertyLabelHovered;
                }
              },
              buttonInactiveComponent: {
                isComponent: true,
                get: function get() {
                  return this.getProperty("buttonInactiveComponent") || __varRecorder__$c.PropertyLabel;
                }
              },
              controlFlapComponent: {
                isComponent: true,
                get: function get() {
                  return this.getProperty("controlFlapComponent") || __varRecorder__$c.AutoLayoutAlignmentFlap;
                }
              },
              bindings: {
                get: function get() {
                  return [].concat(_toConsumableArray(initializeClass._get(Object.getPrototypeOf(__lively_class__), "prototype", this).bindings), [{
                    target: "mini layout preview",
                    signal: "onMouseDown",
                    handler: "openLayoutPopup"
                  }, {
                    target: "vertical",
                    signal: "onMouseDown",
                    handler: "setVerticalFlow"
                  }, {
                    target: "horizontal",
                    signal: "onMouseDown",
                    handler: "setHorizontalFlow"
                  }, {
                    target: "wrap submorphs checkbox",
                    signal: "checked",
                    handler: "toggleWrapping"
                  }, {
                    target: "spacing input",
                    signal: "number",
                    handler: "confirm"
                  }, {
                    target: "total padding input",
                    signal: "number",
                    handler: "confirm"
                  }]);
                }
              }
            };
          }
        }], __lively_classholder__, {
          pathInPackage: function pathInPackage() {
            return "./studio/controls/layout.cp.js";
          },
          unsubscribeFromToplevelDefinitionChanges: function unsubscribeFromToplevelDefinitionChanges() {
            return function () {};
          },
          subscribeToToplevelDefinitionChanges: function subscribeToToplevelDefinitionChanges() {
            return function () {};
          },
          "package": function _package() {
            return {
              name: "lively.ide",
              version: "0.1.0"
            };
          }
        }, {
          start: 1857,
          end: 8239
        });
      }(__varRecorder__$c.PropertySectionModel);
      __varRecorder__$c.AutoLayoutControlModel = AutoLayoutControlModel;
      __varRecorder__$c.AutoLayoutControlModel = AutoLayoutControlModel;
      var AutoLayoutAlignmentFlapModel = function (superclass) {
        var __lively_classholder__ = lively.FreezerRuntime.recorderFor("lively.ide/studio/controls/layout.cp.js");

        var __lively_class__ = __lively_classholder__.hasOwnProperty("AutoLayoutAlignmentFlapModel") && typeof __lively_classholder__.AutoLayoutAlignmentFlapModel === "function" ? __lively_classholder__.AutoLayoutAlignmentFlapModel : __lively_classholder__.AutoLayoutAlignmentFlapModel = function AutoLayoutAlignmentFlapModel(__first_arg__) {
          if (__first_arg__ && __first_arg__[Symbol["for"]("lively-instance-restorer")]) ; else {
            return this[Symbol["for"]("lively-instance-initialize")].apply(this, arguments);
          }
        };

        return initializeClass(__lively_class__, superclass, [{
          key: "confirm",
          value: function AutoLayoutAlignmentFlapModel_confirm_() {
            var _this9 = this;

            var _this$ui4 = this.ui,
                paddingTop = _this$ui4.paddingTop,
                paddingRight = _this$ui4.paddingRight,
                paddingBottom = _this$ui4.paddingBottom,
                paddingLeft = _this$ui4.paddingLeft,
                spacingSelector = _this$ui4.spacingSelector,
                spacingPreview = _this$ui4.spacingPreview;
            var layout = this.targetMorph.layout;
            this.targetMorph.withMetaDo({
              reconcileChanges: true
            }, function () {
              var _spacingPreview$layou, _spacingPreview$layou2;

              _this9.targetMorph.layout = layout["with"]({
                justifySubmorphs: spacingSelector.selection,
                align: ((_spacingPreview$layou = spacingPreview.layout) === null || _spacingPreview$layou === void 0 ? void 0 : _spacingPreview$layou.align) || layout.align,
                axisAlign: ((_spacingPreview$layou2 = spacingPreview.layout) === null || _spacingPreview$layou2 === void 0 ? void 0 : _spacingPreview$layou2.axisAlign) || layout.axisAlign,
                padding: __varRecorder__$c.Rectangle.inset(paddingLeft.number, paddingTop.number, paddingRight.number, paddingBottom.number)
              });
            });
            this.ui.containerPlaceholder.previewLayout(this.targetMorph.layout);
          }
        }, {
          key: "update",
          value: function AutoLayoutAlignmentFlapModel_update_() {
            var _this10 = this;

            this.withoutBindingsDo(function () {
              var _this10$ui = _this10.ui,
                  paddingTop = _this10$ui.paddingTop,
                  paddingRight = _this10$ui.paddingRight,
                  paddingBottom = _this10$ui.paddingBottom,
                  paddingLeft = _this10$ui.paddingLeft,
                  containerPlaceholder = _this10$ui.containerPlaceholder,
                  spacingSelector = _this10$ui.spacingSelector;
              var layout = _this10.targetMorph.layout;
              paddingTop.number = layout.padding.top();
              paddingRight.number = layout.padding.right();
              paddingBottom.number = layout.padding.bottom();
              paddingLeft.number = layout.padding.left();
              spacingSelector.selection = layout.justifySubmorphs;
              containerPlaceholder.previewLayout(layout);
            });
          }
        }, {
          key: "showLayoutPreview",
          value: function AutoLayoutAlignmentFlapModel_showLayoutPreview_(evt) {
            if (evt.state.draggedMorph) return;
            var spacingPreview = this.ui.spacingPreview;
            var layout = this.targetMorph.layout;
            spacingPreview.opacity = 0.3;
            var pos = evt.positionIn(spacingPreview);
            if (layout.axis === "row") pos = __varRecorder__$c.pt(pos.y, pos.x);
            var align = "left";
            if (pos.y > spacingPreview.height / 3) align = "center";
            if (pos.y > spacingPreview.height * 2 / 3) align = "right";
            var axisAlign = "left";
            if (pos.x > spacingPreview.width / 3) axisAlign = "center";
            if (pos.x > spacingPreview.width * 2 / 3) axisAlign = "right";
            spacingPreview.previewLayout(layout["with"]({
              align: align,
              axisAlign: axisAlign
            }));
          }
        }, {
          key: "clearLayoutPreview",
          value: function AutoLayoutAlignmentFlapModel_clearLayoutPreview_() {
            this.ui.spacingPreview.opacity = 0;
            this.ui.spacingPreview.layout = null;
          }
        }, {
          key: "start",
          value: function AutoLayoutAlignmentFlapModel_start_() {
            __varRecorder__$c.epiConnect($world, "onMouseDown", this, "closeIfClickedOutside");
          }
        }, {
          key: "closeIfClickedOutside",
          value: function AutoLayoutAlignmentFlapModel_closeIfClickedOutside_(evt) {
            var _this11 = this;

            if (![evt.targetMorph].concat(_toConsumableArray(evt.targetMorph.ownerChain())).find(function (m) {
              return m === _this11.view || m.isList;
            })) {
              this.close();
            }
          }
        }, {
          key: "close",
          value: function AutoLayoutAlignmentFlapModel_close_() {
            this.view.remove();

            __varRecorder__$c.disconnect($world, "onMouseDown", this, "closeIfClickedOutside");
          }
        }], [{
          key: Symbol["for"]("__LivelyClassName__"),
          get: function get() {
            return "AutoLayoutAlignmentFlapModel";
          }
        }, {
          key: "properties",
          get: function get() {
            return {
              targetMorph: {},
              isHaloItem: {
                defaultValue: true
              },
              expose: {
                get: function get() {
                  return ["start", "close", "update", "isHaloItem"];
                }
              },
              bindings: {
                get: function get() {
                  return [].concat(_toConsumableArray(["top", "right", "bottom", "left"].map(function (side) {
                    return {
                      target: "padding " + side,
                      signal: "number",
                      handler: "confirm"
                    };
                  })), [{
                    model: "spacing selector",
                    signal: "selection",
                    handler: "confirm"
                  }, {
                    target: "spacing preview",
                    signal: "onMouseMove",
                    handler: "showLayoutPreview"
                  }, {
                    target: "spacing preview",
                    signal: "onHoverOut",
                    handler: "clearLayoutPreview"
                  }, {
                    target: "spacing preview",
                    signal: "onMouseDown",
                    handler: "confirm"
                  }]);
                }
              }
            };
          }
        }], __lively_classholder__, {
          pathInPackage: function pathInPackage() {
            return "./studio/controls/layout.cp.js";
          },
          unsubscribeFromToplevelDefinitionChanges: function unsubscribeFromToplevelDefinitionChanges() {
            return function () {};
          },
          subscribeToToplevelDefinitionChanges: function subscribeToToplevelDefinitionChanges() {
            return function () {};
          },
          "package": function _package() {
            return {
              name: "lively.ide",
              version: "0.1.0"
            };
          }
        }, {
          start: 8247,
          end: 11778
        });
      }(__varRecorder__$c.ViewModel);
      __varRecorder__$c.AutoLayoutAlignmentFlapModel = AutoLayoutAlignmentFlapModel;
      __varRecorder__$c.AutoLayoutAlignmentFlapModel = AutoLayoutAlignmentFlapModel;
      __varRecorder__$c.PaddingInput = __varRecorder__$c.component["for"](function () {
        return __varRecorder__$c.component(__varRecorder__$c.DarkNumberIconWidget, {
          name: "padding input",
          layout: new __varRecorder__$c.TilingLayout({
            axisAlign: "center",
            align: "center"
          }),
          viewModel: {
            unit: "",
            min: 0,
            autofit: true
          },
          extent: __varRecorder__$c.pt(33.7, 22.7),
          position: __varRecorder__$c.pt(57.3, 1.9),
          submorphs: [__varRecorder__$c.without("button holder"), __varRecorder__$c.without("interactive label"), {
            name: "value",
            textAlign: "center",
            min: 0,
            padding: __varRecorder__$c.rect(0, 2, 0, -2)
          }]
        });
      }, {
        module: "lively.ide/studio/controls/layout.cp.js",
        "export": "PaddingInput",
        range: {
          start: 11816,
          end: 12253
        }
      }, __varRecorder__$c.PaddingInput);
      __varRecorder__$c.PaddingInputHovered = __varRecorder__$c.component["for"](function () {
        return __varRecorder__$c.component(__varRecorder__$c.PaddingInput, {
          name: "padding input hovered",
          borderWidth: 1
        });
      }, {
        module: "lively.ide/studio/controls/layout.cp.js",
        "export": "PaddingInputHovered",
        range: {
          start: 12261,
          end: 12361
        }
      }, __varRecorder__$c.PaddingInputHovered);
      __varRecorder__$c.LayoutSimulator = __varRecorder__$c.component["for"](function () {
        return __varRecorder__$c.component({
          type: __varRecorder__$c.LayoutPreview,
          defaultSpacing: 5,
          defaultPadding: __varRecorder__$c.rect(5, 5, 0, 0),
          name: "layout simulator",
          layout: new __varRecorder__$c.TilingLayout({
            align: "right",
            orderByIndex: true,
            padding: __varRecorder__$c.rect(5, 5, 0, 0),
            spacing: 5
          }),
          borderColor: __varRecorder__$c.Color.rgb(176, 190, 197),
          borderWidth: 1,
          extent: __varRecorder__$c.pt(65.1, 65.1),
          fill: __varRecorder__$c.Color.rgba(0, 0, 0, 0),
          position: __varRecorder__$c.pt(44.6, 34.9),
          submorphs: [{
            name: "mini bar 1",
            borderColor: __varRecorder__$c.Color.rgb(23, 160, 251),
            borderRadius: 5,
            extent: __varRecorder__$c.pt(5.1, 19.9),
            fill: __varRecorder__$c.Color.rgb(178, 235, 242),
            position: __varRecorder__$c.pt(5.1, 6.1)
          }, {
            name: "mini bar 2",
            borderColor: __varRecorder__$c.Color.rgb(23, 160, 251),
            borderRadius: 5,
            extent: __varRecorder__$c.pt(5.1, 24.9),
            fill: __varRecorder__$c.Color.rgb(178, 235, 242),
            position: __varRecorder__$c.pt(49.1, 16)
          }, {
            name: "mini bar 3",
            borderColor: __varRecorder__$c.Color.rgb(23, 160, 251),
            borderRadius: 5,
            extent: __varRecorder__$c.pt(5.1, 14.9),
            fill: __varRecorder__$c.Color.rgb(178, 235, 242),
            position: __varRecorder__$c.pt(34.5, 32.7)
          }]
        });
      }, {
        module: "lively.ide/studio/controls/layout.cp.js",
        "export": "LayoutSimulator",
        range: {
          start: 12369,
          end: 13347
        }
      }, __varRecorder__$c.LayoutSimulator);
      __varRecorder__$c.MiniLayoutPreview = __varRecorder__$c.component["for"](function () {
        return __varRecorder__$c.component({
          type: __varRecorder__$c.LayoutPreview,
          extent: __varRecorder__$c.pt(22, 22),
          name: "mini layout preview",
          tooltip: "Configure Layout",
          borderRadius: 2,
          fill: __varRecorder__$c.Color.transparent,
          nativeCursor: "pointer",
          submorphs: [{
            name: "outer border",
            layout: new __varRecorder__$c.TilingLayout({
              spacing: 4,
              padding: __varRecorder__$c.Rectangle.inset(3)
            }),
            reactsToPointer: false,
            borderColor: __varRecorder__$c.Color.rgb(176, 190, 197),
            borderRadius: 2,
            borderWidth: 1,
            extent: __varRecorder__$c.pt(18, 18),
            fill: __varRecorder__$c.Color.rgba(0, 0, 0, 0),
            position: __varRecorder__$c.pt(2, 2),
            submorphs: [{
              reactsToPointer: false,
              name: "mini bar 1",
              fill: __varRecorder__$c.Color.rgb(176, 190, 197),
              extent: __varRecorder__$c.pt(1, 5),
              position: __varRecorder__$c.pt(10, 10)
            }, {
              reactsToPointer: false,
              name: "mini bar 2",
              fill: __varRecorder__$c.Color.rgb(176, 190, 197),
              extent: __varRecorder__$c.pt(1, 10),
              position: __varRecorder__$c.pt(5.6, 7.7)
            }, {
              reactsToPointer: false,
              name: "mini bar 3",
              fill: __varRecorder__$c.Color.rgb(176, 190, 197),
              extent: __varRecorder__$c.pt(1, 7.5),
              position: __varRecorder__$c.pt(15.5, 8.7)
            }]
          }]
        });
      }, {
        module: "lively.ide/studio/controls/layout.cp.js",
        "export": "MiniLayoutPreview",
        range: {
          start: 13355,
          end: 14387
        }
      }, __varRecorder__$c.MiniLayoutPreview);
      __varRecorder__$c.MiniLayoutPreviewActive = __varRecorder__$c.component["for"](function () {
        return __varRecorder__$c.component(__varRecorder__$c.MiniLayoutPreview, {
          name: "mini layout preview active",
          fill: __varRecorder__$c.Color.rgb(178, 235, 242),
          submorphs: [{
            name: "outer border",
            borderColor: __varRecorder__$c.Color.rgb(66, 73, 73),
            submorphs: [{
              name: "mini bar 1",
              fill: __varRecorder__$c.Color.rgb(66, 73, 73)
            }, {
              name: "mini bar 2",
              fill: __varRecorder__$c.Color.rgb(66, 73, 73)
            }, {
              name: "mini bar 3",
              fill: __varRecorder__$c.Color.rgb(66, 73, 73)
            }]
          }]
        });
      }, {
        module: "lively.ide/studio/controls/layout.cp.js",
        "export": "MiniLayoutPreviewActive",
        range: {
          start: 14395,
          end: 14836
        }
      }, __varRecorder__$c.MiniLayoutPreviewActive);
      __varRecorder__$c.LayoutControl = __varRecorder__$c.component["for"](function () {
        return __varRecorder__$c.component(__varRecorder__$c.PropertySection, {
          defaultViewModel: __varRecorder__$c.AutoLayoutControlModel,
          name: "layout control",
          layout: new __varRecorder__$c.TilingLayout({
            axis: "column",
            hugContentsVertically: true,
            orderByIndex: true,
            padding: __varRecorder__$c.rect(0, 10, 0, 0),
            resizePolicies: [["h floater", {
              height: "fixed",
              width: "fill"
            }]],
            spacing: 3
          }),
          extent: __varRecorder__$c.pt(248.9, 131),
          submorphs: [{
            name: "h floater",
            submorphs: [{
              name: "section headline",
              textAndAttributes: ["Auto Layout", null]
            }]
          }, __varRecorder__$c.add({
            name: "controls",
            borderColor: __varRecorder__$c.Color.rgb(23, 160, 251),
            extent: __varRecorder__$c.pt(250.1, 31),
            fill: __varRecorder__$c.Color.rgba(0, 0, 0, 0),
            layout: new __varRecorder__$c.TilingLayout({
              axisAlign: "center",
              orderByIndex: true,
              spacing: 5,
              padding: __varRecorder__$c.Rectangle.inset(20, 0, 0, 0)
            }),
            submorphs: [__varRecorder__$c.part(__varRecorder__$c.AddButton, {
              master: {
                auto: __varRecorder__$c.AddButton,
                hover: __varRecorder__$c.PropertyLabelHovered
              },
              name: "vertical",
              tooltip: "Position Items Vertically",
              textAndAttributes: ["\uF1E3", null],
              fontSize: 14,
              padding: __varRecorder__$c.rect(4, 4, 0, 0)
            }), __varRecorder__$c.part(__varRecorder__$c.AddButton, {
              master: {
                auto: __varRecorder__$c.AddButton,
                hover: __varRecorder__$c.PropertyLabelHovered
              },
              name: "horizontal",
              tooltip: "Position Items Horizontally",
              fontSize: 14,
              textAndAttributes: ["\uF1DF", null],
              padding: __varRecorder__$c.rect(4, 4, 0, 0)
            }), __varRecorder__$c.part(__varRecorder__$c.DarkNumberIconWidget, {
              name: "spacing input",
              width: 60,
              min: 0,
              tooltip: "Spacing between Items",
              submorphs: [{
                name: "interactive label",
                fontSize: 14,
                tooltip: "Spacing between elements.",
                textAndAttributes: ["\uE076", null]
              }]
            }), __varRecorder__$c.part(__varRecorder__$c.DarkNumberIconWidget, {
              name: "total padding input",
              width: 60,
              min: 0,
              tooltip: "Padding between Container and Items",
              submorphs: [{
                name: "interactive label",
                fontSize: 14,
                tooltip: "Padding distance of elements to the container.",
                textAndAttributes: ["\uE22F", null]
              }]
            }), __varRecorder__$c.part(__varRecorder__$c.MiniLayoutPreview, {
              name: "mini layout preview",
              tooltip: "Alignment controls."
            })]
          }), __varRecorder__$c.add({
            name: "wrap checkbox wrapper",
            extent: __varRecorder__$c.pt(250, 20),
            fill: __varRecorder__$c.Color.transparent,
            layout: new __varRecorder__$c.TilingLayout({
              axisAlign: "center",
              orderByIndex: true
            }),
            submorphs: [{
              name: "spacer",
              fill: __varRecorder__$c.Color.rgba(255, 255, 255, 0),
              borderColor: __varRecorder__$c.Color.rgba(23, 160, 251, 0),
              borderWidth: 1,
              extent: __varRecorder__$c.pt(20, 30)
            }, __varRecorder__$c.part(__varRecorder__$c.LabeledCheckbox, {
              name: "wrap submorphs checkbox",
              viewModel: {
                label: "Wrap Items"
              },
              submorphs: [{
                name: "label",
                master: __varRecorder__$c.PropLabel
              }]
            })]
          })]
        });
      }, {
        module: "lively.ide/studio/controls/layout.cp.js",
        "export": "LayoutControl",
        range: {
          start: 14844,
          end: 17598
        }
      }, __varRecorder__$c.LayoutControl);
      __varRecorder__$c.AutoLayoutAlignmentFlap = __varRecorder__$c.component["for"](function () {
        return __varRecorder__$c.component(__varRecorder__$c.DarkFlap, {
          defaultViewModel: __varRecorder__$c.AutoLayoutAlignmentFlapModel,
          name: "auto layout alignment control",
          layout: new __varRecorder__$c.TilingLayout({
            wrapSubmorphs: true,
            orderByIndex: true,
            hugContentsVertically: true,
            resizeSubmorphs: true,
            padding: 10
          }),
          extent: __varRecorder__$c.pt(175.7, 201),
          submorphs: [__varRecorder__$c.add({
            name: "padding and spacing",
            epiMorph: true,
            reactsToPointer: false,
            fill: __varRecorder__$c.Color.rgba(255, 255, 255, 0),
            extent: __varRecorder__$c.pt(156, 136.5),
            submorphs: [__varRecorder__$c.part(__varRecorder__$c.LayoutSimulator, {
              name: "container placeholder"
            }), __varRecorder__$c.part(__varRecorder__$c.LayoutSimulator, {
              name: "spacing preview",
              borderColor: __varRecorder__$c.Color.transparent,
              opacity: 0
            }), __varRecorder__$c.part(__varRecorder__$c.PaddingInput, {
              master: {
                auto: __varRecorder__$c.PaddingInput,
                hover: __varRecorder__$c.PaddingInputHovered
              },
              name: "padding top",
              position: __varRecorder__$c.pt(61.1, 0),
              tooltip: "Padding Top",
              submorphs: [{
                name: "value",
                padding: __varRecorder__$c.rect(0, 2, 0, -2)
              }]
            }), __varRecorder__$c.part(__varRecorder__$c.PaddingInput, {
              name: "padding bottom",
              master: {
                auto: __varRecorder__$c.PaddingInput,
                hover: __varRecorder__$c.PaddingInputHovered
              },
              position: __varRecorder__$c.pt(61.2, 110.3),
              tooltip: "Padding Bottom",
              submorphs: [{
                name: "value",
                padding: __varRecorder__$c.rect(0, 2, 0, -2)
              }]
            }), __varRecorder__$c.part(__varRecorder__$c.PaddingInput, {
              name: "padding left",
              master: {
                auto: __varRecorder__$c.PaddingInput,
                hover: __varRecorder__$c.PaddingInputHovered
              },
              position: __varRecorder__$c.pt(0, 56.9),
              tooltip: "Padding Left",
              submorphs: [{
                name: "value",
                padding: __varRecorder__$c.rect(0, 2, 0, -2)
              }]
            }), __varRecorder__$c.part(__varRecorder__$c.PaddingInput, {
              name: "padding right",
              master: {
                auto: __varRecorder__$c.PaddingInput,
                hover: __varRecorder__$c.PaddingInputHovered
              },
              position: __varRecorder__$c.pt(122.3, 56.9),
              tooltip: "Padding Right",
              submorphs: [{
                name: "value",
                padding: __varRecorder__$c.rect(0, 2, 0, -2)
              }]
            })]
          }), __varRecorder__$c.add(__varRecorder__$c.part(__varRecorder__$c.EnumSelector, {
            name: "spacing selector",
            extent: __varRecorder__$c.pt(155, 23),
            tooltip: "Select Spacing of Items",
            viewModel: {
              openListInWorld: true,
              listMaster: __varRecorder__$c.DarkThemeList,
              items: [{
                string: "Packed",
                value: "packed",
                isListItem: true
              }, {
                string: "Space between",
                value: "spaced",
                isListItem: true
              }],
              listAlign: "selection"
            }
          }))]
        });
      }, {
        module: "lively.ide/studio/controls/layout.cp.js",
        "export": "AutoLayoutAlignmentFlap",
        range: {
          start: 17606,
          end: 19927
        }
      }, __varRecorder__$c.AutoLayoutAlignmentFlap);
      __varRecorder__$c.GridLayoutControl = __varRecorder__$c.component["for"](function () {
        return __varRecorder__$c.component(__varRecorder__$c.PropertySection, {
          name: "grid layout control",
          submorphs: [{
            name: "h floater",
            submorphs: [{
              name: "section headline",
              textAndAttributes: ["Grid Layout", null]
            }]
          }]
        });
      }, {
        module: "lively.ide/studio/controls/layout.cp.js",
        "export": "GridLayoutControl",
        range: {
          start: 19935,
          end: 20165
        }
      }, __varRecorder__$c.GridLayoutControl);
      var MiniLayoutPreviewActive = __varRecorder__$c.MiniLayoutPreviewActive;
      var MiniLayoutPreview = __varRecorder__$c.MiniLayoutPreview;
      var GridLayoutControl = __varRecorder__$c.GridLayoutControl;
      var LayoutControl = __varRecorder__$c.LayoutControl;
      var AutoLayoutAlignmentFlap = __varRecorder__$c.AutoLayoutAlignmentFlap;
      __varRecorder__$c.MiniLayoutPreviewActive = MiniLayoutPreviewActive;
      __varRecorder__$c.MiniLayoutPreview = MiniLayoutPreview;
      __varRecorder__$c.GridLayoutControl = GridLayoutControl;
      __varRecorder__$c.LayoutControl = LayoutControl;
      __varRecorder__$c.AutoLayoutAlignmentFlap = AutoLayoutAlignmentFlap;

      var __varRecorder__$b = lively.FreezerRuntime.recorderFor("lively.ide/studio/controls/border.cp.js");
      __varRecorder__$b.Color = Color;
      __varRecorder__$b.rect = rect;
      __varRecorder__$b.Rectangle = Rectangle;
      __varRecorder__$b.pt = pt;
      __varRecorder__$b.TilingLayout = TilingLayout;
      __varRecorder__$b.without = without;
      __varRecorder__$b.Morph = Morph;
      __varRecorder__$b.Label = Label;
      __varRecorder__$b.part = part;
      __varRecorder__$b.add = add;
      __varRecorder__$b.component = component;
      __varRecorder__$b.AddButton = AddButton;
      __varRecorder__$b.PropertyLabel = PropertyLabel;
      __varRecorder__$b.DarkPopupWindow = DarkPopupWindow;
      __varRecorder__$b.DarkThemeList = DarkThemeList;
      __varRecorder__$b.PropertyLabelActive = PropertyLabelActive;
      __varRecorder__$b.EnumSelector = EnumSelector;
      __varRecorder__$b.DarkNumberIconWidget = DarkNumberIconWidget;
      __varRecorder__$b.PropertyLabelHovered = PropertyLabelHovered;
      __varRecorder__$b.ColorInput = ColorInput;
      __varRecorder__$b.arr = arr;
      __varRecorder__$b.string = string;
      __varRecorder__$b.once = once;
      __varRecorder__$b.epiConnect = epiConnect;
      __varRecorder__$b.signal = signal;
      __varRecorder__$b.PropertySection = PropertySection;
      __varRecorder__$b.PropertySectionModel = PropertySectionModel;
      __varRecorder__$b.DarkColorPicker = DarkColorPicker;
      __varRecorder__$b.PopupModel = PopupModel;
      var BorderControlModel = function (superclass) {
        var __lively_classholder__ = lively.FreezerRuntime.recorderFor("lively.ide/studio/controls/border.cp.js");

        var __lively_class__ = __lively_classholder__.hasOwnProperty("BorderControlModel") && typeof __lively_classholder__.BorderControlModel === "function" ? __lively_classholder__.BorderControlModel : __lively_classholder__.BorderControlModel = function BorderControlModel(__first_arg__) {
          if (__first_arg__ && __first_arg__[Symbol["for"]("lively-instance-restorer")]) ; else {
            return this[Symbol["for"]("lively-instance-initialize")].apply(this, arguments);
          }
        };

        return initializeClass(__lively_class__, superclass, [{
          key: "onMouseDown",
          value: function BorderControlModel_onMouseDown_() {
            this.closePopup();
            this.models.borderColorInput.closeColorPicker();
          }
        }, {
          key: "onRefresh",
          value: function BorderControlModel_onRefresh_(prop) {
            if (prop === "popup") {
              this.ui.moreButton.master = this.popup ? this.propertyLabelComponentActive : {
                auto: this.propertyLabelComponent,
                hover: this.propertyLabelComponentHover,
                click: this.propertyLabelComponentActive
              };
            }
          }
        }, {
          key: "focusOn",
          value: function BorderControlModel_focusOn_(aMorph) {
            this.targetMorph = aMorph;

            if (__varRecorder__$b.Color.white.equals(this.targetMorph.borderColor.valueOf()) && this.targetMorph.borderWidth === 0 && this.targetMorph.borderStyle === "solid") {
              this.deactivate();
            } else {
              this.activate(false);
              this.update();
            }
          }
        }, {
          key: "update",
          value: function BorderControlModel_update_() {
            this.ui.borderStyleSelector.items = this.targetMorph.borderOptions.map(function (v) {
              return {
                string: __varRecorder__$b.string.capitalize(v),
                value: v,
                isListItem: true
              };
            });
            this.withBorder(this.targetMorph.border);
          }
        }, {
          key: "withBorder",
          value: function BorderControlModel_withBorder_(borderValue) {
            var _this = this;

            this.withoutBindingsDo(function () {
              var _this$ui = _this.ui,
                  borderColorInput = _this$ui.borderColorInput,
                  borderWidthInput = _this$ui.borderWidthInput,
                  borderStyleSelector = _this$ui.borderStyleSelector;
              var color = borderValue.color,
                  width = borderValue.width,
                  style = borderValue.style;

              if (_this.hasMixedColor) {
                borderColorInput.setMixed(Object.values(_this.targetMorph.borderColor).filter(function (c) {
                  return c.isColor;
                }));
              } else {
                borderColorInput.setColor(color.valueOf ? color.valueOf() : color);
              }

              if (_this.hasMixedWidth) {
                borderWidthInput.setMixed();
              } else {
                borderWidthInput.number = width.valueOf ? width.valueOf() : width;
              }

              if (_this.hasMixedStyle) {
                borderStyleSelector.setMixed();
              } else {
                borderStyleSelector.selection = style.valueOf ? style.valueOf() : style;
              }
            });
          }
        }, {
          key: "activate",
          value: function BorderControlModel_activate_() {
            var initBorder = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : true;

            initializeClass._get(Object.getPrototypeOf(__lively_class__.prototype), "activate", this).call(this);

            var elementsWrapper = this.ui.elementsWrapper;
            elementsWrapper.visible = true;
            this.view.layout = this.view.layout["with"]({
              padding: __varRecorder__$b.rect(0, 10, 0, 10)
            });

            if (initBorder) {
              this.targetMorph.border = {
                color: __varRecorder__$b.Color.white,
                width: 1,
                style: "solid"
              };
              this.update();
            }
          }
        }, {
          key: "deactivate",
          value: function BorderControlModel_deactivate_() {
            initializeClass._get(Object.getPrototypeOf(__lively_class__.prototype), "deactivate", this).call(this);

            this.closePopup();
            this.models.borderColorInput.closeColorPicker();
            if (!this.targetMorph) return;
            var elementsWrapper = this.ui.elementsWrapper;
            elementsWrapper.visible = false;
            this.view.layout = this.view.layout["with"]({
              padding: __varRecorder__$b.rect(0, 10, 0, 0)
            });
            this.targetMorph.borderWidth = 0;
            this.targetMorph.borderColor = __varRecorder__$b.Color.white;
            this.targetMorph.borderStyle = "solid";
          }
        }, {
          key: "openPopup",
          value: function BorderControlModel_openPopup_() {
            var p = this.popup = this.popup || __varRecorder__$b.part(this.borderPopupComponent);

            p.viewModel.targetMorph = this.targetMorph;
            p.openInWorld();
            p.alignAtButton(this.ui.moreButton);

            __varRecorder__$b.once(p.viewModel, "close", this, "closePopup");

            __varRecorder__$b.epiConnect(p.viewModel, "target updated", this, "update");
          }
        }, {
          key: "closePopup",
          value: function BorderControlModel_closePopup_() {
            if (!this.popup) return;
            this.popup.close();
            this.popup = null;
          }
        }, {
          key: "confirm",
          value: function BorderControlModel_confirm_() {
            var _this$targetMorph,
                _this2 = this;

            if (!this.targetMorph && this.updateDirectly) return;
            var _this$ui2 = this.ui,
                borderColorInput = _this$ui2.borderColorInput,
                borderWidthInput = _this$ui2.borderWidthInput,
                borderStyleSelector = _this$ui2.borderStyleSelector;
            var border = ((_this$targetMorph = this.targetMorph) === null || _this$targetMorph === void 0 ? void 0 : _this$targetMorph.border) || {};

            var updateBorder = function updateBorder() {
              if (!borderWidthInput.isMixed) border.width = borderWidthInput.number;
              if (!borderColorInput.isMixed) border.color = borderColorInput.colorValue;
              if (!borderStyleSelector.isMixed) border.style = borderStyleSelector.selection;
            };

            if (this.updateDirectly) {
              this.targetMorph.withMetaDo({
                reconcileChanges: true
              }, function () {
                updateBorder();
                _this2.targetMorph.border = border;
              });
            } else {
              updateBorder();

              __varRecorder__$b.signal(this, "value", border);
            }
          }
        }], [{
          key: Symbol["for"]("__LivelyClassName__"),
          get: function get() {
            return "BorderControlModel";
          }
        }, {
          key: "properties",
          get: function get() {
            return {
              targetMorph: {},
              popup: {},
              updateDirectly: {
                defaultValue: true
              },
              activeSectionComponent: {
                isComponent: true,
                get: function get() {
                  return this.getProperty("activeSectionComponent") || __varRecorder__$b.BorderControl;
                }
              },
              propertyLabelComponent: {
                isComponent: true,
                get: function get() {
                  return this.getProperty("propertyLabelComponent") || __varRecorder__$b.PropertyLabel;
                }
              },
              propertyLabelComponentActive: {
                isComponent: true,
                get: function get() {
                  return this.getProperty("propertyLabelComponentActive") || __varRecorder__$b.PropertyLabelActive;
                }
              },
              propertyLabelComponentHover: {
                isComponent: true,
                get: function get() {
                  return this.getProperty("propertyLabelComponentHover") || __varRecorder__$b.PropertyLabelHovered;
                }
              },
              borderPopupComponent: {
                isComponent: true,
                get: function get() {
                  return this.getProperty("borderPopupComponent") || __varRecorder__$b.BorderPopup;
                }
              },
              hasMixedColor: {
                derived: true,
                get: function get() {
                  if (!this.targetMorph) return false;
                  var _this$targetMorph$bor = this.targetMorph.borderColor,
                      top = _this$targetMorph$bor.top,
                      left = _this$targetMorph$bor.left,
                      bottom = _this$targetMorph$bor.bottom,
                      right = _this$targetMorph$bor.right;
                  return this.updateDirectly && __varRecorder__$b.arr.uniqBy([top, left, bottom, right], function (a, b) {
                    return a.equals(b);
                  }).length > 1;
                }
              },
              hasMixedStyle: {
                derived: true,
                get: function get() {
                  if (!this.targetMorph) return false;
                  var _this$targetMorph$bor2 = this.targetMorph.borderStyle,
                      top = _this$targetMorph$bor2.top,
                      left = _this$targetMorph$bor2.left,
                      bottom = _this$targetMorph$bor2.bottom,
                      right = _this$targetMorph$bor2.right;
                  return this.updateDirectly && __varRecorder__$b.arr.uniq([top, left, bottom, right]).length > 1;
                }
              },
              hasMixedWidth: {
                derived: true,
                get: function get() {
                  if (!this.targetMorph) return false;
                  var _this$targetMorph$bor3 = this.targetMorph.borderWidth,
                      top = _this$targetMorph$bor3.top,
                      left = _this$targetMorph$bor3.left,
                      bottom = _this$targetMorph$bor3.bottom,
                      right = _this$targetMorph$bor3.right;
                  return this.updateDirectly && __varRecorder__$b.arr.uniq([top, left, bottom, right]).length > 1;
                }
              },
              bindings: {
                get: function get() {
                  return [].concat(_toConsumableArray(initializeClass._get(Object.getPrototypeOf(__lively_class__), "prototype", this).bindings), [{
                    model: "border color input",
                    signal: "color",
                    handler: "confirm"
                  }, {
                    target: "border width input",
                    signal: "number",
                    handler: "confirm"
                  }, {
                    model: "border style selector",
                    signal: "selection",
                    handler: "confirm"
                  }, {
                    target: "more button",
                    signal: "onMouseDown",
                    handler: "openPopup"
                  }, {
                    signal: "onMouseDown",
                    handler: "onMouseDown"
                  }]);
                }
              }
            };
          }
        }], __lively_classholder__, {
          pathInPackage: function pathInPackage() {
            return "./studio/controls/border.cp.js";
          },
          unsubscribeFromToplevelDefinitionChanges: function unsubscribeFromToplevelDefinitionChanges() {
            return function () {};
          },
          subscribeToToplevelDefinitionChanges: function subscribeToToplevelDefinitionChanges() {
            return function () {};
          },
          "package": function _package() {
            return {
              name: "lively.ide",
              version: "0.1.0"
            };
          }
        }, {
          start: 963,
          end: 8869
        });
      }(__varRecorder__$b.PropertySectionModel);
      __varRecorder__$b.BorderControlModel = BorderControlModel;
      __varRecorder__$b.BorderControlModel = BorderControlModel;
      var BorderPopupWindow = function (superclass) {
        var __lively_classholder__ = lively.FreezerRuntime.recorderFor("lively.ide/studio/controls/border.cp.js");

        var __lively_class__ = __lively_classholder__.hasOwnProperty("BorderPopupWindow") && typeof __lively_classholder__.BorderPopupWindow === "function" ? __lively_classholder__.BorderPopupWindow : __lively_classholder__.BorderPopupWindow = function BorderPopupWindow(__first_arg__) {
          if (__first_arg__ && __first_arg__[Symbol["for"]("lively-instance-restorer")]) ; else {
            return this[Symbol["for"]("lively-instance-initialize")].apply(this, arguments);
          }
        };

        return initializeClass(__lively_class__, superclass, [{
          key: "isPropertiesPanelPopup",
          get: function get() {
            return true;
          }
        }, {
          key: "attach",
          value: function BorderPopupWindow_attach_(view) {
            initializeClass._get(Object.getPrototypeOf(__lively_class__.prototype), "attach", this).call(this, view);

            this.selectedBorder = "left";
          }
        }, {
          key: "onRefresh",
          value: function BorderPopupWindow_onRefresh_(prop) {
            var _this3 = this;

            if (prop === "selectedBorder") {
              var _this$ui3 = this.ui,
                  leftBorder = _this$ui3.leftBorder,
                  rightBorder = _this$ui3.rightBorder,
                  bottomBorder = _this$ui3.bottomBorder,
                  topBorder = _this$ui3.topBorder;
              var valToElem = {
                left: leftBorder,
                right: rightBorder,
                bottom: bottomBorder,
                top: topBorder
              };
              Object.values(valToElem).forEach(function (control) {
                return control.master = {
                  auto: _this3.propertyLabelComponent,
                  hover: _this3.propertyLabelComponentHover
                };
              });
              valToElem[this.selectedBorder].master = this.propertyLabelComponentActive;
            }

            if (prop === "targetMorph") {
              this.models.borderControl.withBorder(this.targetMorph.borderLeft);
            }
          }
        }, {
          key: "close",
          value: function BorderPopupWindow_close_() {
            this.view.remove();
          }
        }, {
          key: "selectBorderSide",
          value: function BorderPopupWindow_selectBorderSide_(evt) {
            var borderControl = this.models.borderControl;
            var elemToVal = {
              "left border": "left",
              "right border": "right",
              "top border": "top",
              "bottom border": "bottom"
            };

            if (elemToVal[evt.targetMorph.name]) {
              this.selectedBorder = elemToVal[evt.targetMorph.name];
              borderControl.withBorder(this.targetMorph["border" + __varRecorder__$b.string.capitalize(this.selectedBorder)]);
            }
          }
        }, {
          key: "updateBorder",
          value: function BorderPopupWindow_updateBorder_(borderStyle) {
            var _this4 = this;

            if (!this.targetMorph) return;
            var borderRadius = this.targetMorph.borderRadius;
            this.targetMorph.withMetaDo({
              reconcileChanges: true
            }, function () {
              _this4.targetMorph["border" + __varRecorder__$b.string.capitalize(_this4.selectedBorder)] = Object.assign({}, borderStyle, {
                borderRadius: borderRadius
              });
            });

            __varRecorder__$b.signal(this, "target updated");
          }
        }], [{
          key: Symbol["for"]("__LivelyClassName__"),
          get: function get() {
            return "BorderPopupWindow";
          }
        }, {
          key: "properties",
          get: function get() {
            return {
              targetMorph: {},
              selectedBorder: {
                defaultValue: "all"
              },
              isHaloItem: {
                defaultValue: true
              },
              propertyLabelComponent: {
                isComponent: true,
                get: function get() {
                  return this.getProperty("propertyLabelComponent") || __varRecorder__$b.PropertyLabel;
                }
              },
              propertyLabelComponentActive: {
                isComponent: true,
                get: function get() {
                  return this.getProperty("propertyLabelComponentActive") || __varRecorder__$b.PropertyLabelActive;
                }
              },
              propertyLabelComponentHover: {
                isComponent: true,
                get: function get() {
                  return this.getProperty("propertyLabelComponentHover") || __varRecorder__$b.PropertyLabelHovered;
                }
              },
              expose: {
                get: function get() {
                  return ["close", "isHaloItem", "isPropertiesPanelPopup", "alignAtButton"];
                }
              },
              bindings: {
                get: function get() {
                  return [{
                    target: "close button",
                    signal: "onMouseDown",
                    handler: "close"
                  }, {
                    target: "border selector wrapper",
                    signal: "onMouseDown",
                    handler: "selectBorderSide"
                  }, {
                    model: "border control",
                    signal: "value",
                    handler: "updateBorder"
                  }];
                }
              }
            };
          }
        }], __lively_classholder__, {
          pathInPackage: function pathInPackage() {
            return "./studio/controls/border.cp.js";
          },
          unsubscribeFromToplevelDefinitionChanges: function unsubscribeFromToplevelDefinitionChanges() {
            return function () {};
          },
          subscribeToToplevelDefinitionChanges: function subscribeToToplevelDefinitionChanges() {
            return function () {};
          },
          "package": function _package() {
            return {
              name: "lively.ide",
              version: "0.1.0"
            };
          }
        }, {
          start: 8971,
          end: 12383
        });
      }(__varRecorder__$b.PopupModel);
      __varRecorder__$b.BorderPopupWindow = BorderPopupWindow;
      __varRecorder__$b.BorderPopupWindow = BorderPopupWindow;
      __varRecorder__$b.BorderControlElements = __varRecorder__$b.component["for"](function () {
        return __varRecorder__$b.component({
          name: "border control elements",
          fill: __varRecorder__$b.Color.transparent,
          layout: new __varRecorder__$b.TilingLayout({
            spacing: 10,
            wrapSubmorphs: true,
            hugContentsVertically: true
          }),
          submorphs: [__varRecorder__$b.part(__varRecorder__$b.ColorInput, {
            name: "border color input",
            viewModel: {
              colorPickerComponent: __varRecorder__$b.DarkColorPicker
            }
          }), {
            name: "border width control",
            extent: __varRecorder__$b.pt(196.4, 25),
            fill: __varRecorder__$b.Color.rgba(255, 255, 255, 0),
            layout: new __varRecorder__$b.TilingLayout({
              axisAlign: "center",
              justifySubmorphs: "spaced",
              orderByIndex: true,
              padding: __varRecorder__$b.rect(15, 0, -10, 0),
              spacing: 10
            }),
            submorphs: [__varRecorder__$b.part(__varRecorder__$b.DarkNumberIconWidget, {
              tooltip: "Border Width",
              name: "border width input",
              extent: __varRecorder__$b.pt(90, 22),
              min: 0,
              submorphs: [{
                name: "interactive label",
                textAndAttributes: ["\uE91A", {
                  fontSize: 16,
                  fontFamily: "Material Icons"
                }]
              }, __varRecorder__$b.without("button holder")]
            }), __varRecorder__$b.part(__varRecorder__$b.EnumSelector, {
              name: "border style selector",
              tooltip: "Select Border Style",
              clipMode: "hidden",
              extent: __varRecorder__$b.pt(90, 22),
              viewModel: {
                listAlign: "selection",
                openListInWorld: true,
                listHeight: 500,
                listMaster: __varRecorder__$b.DarkThemeList,
                items: __varRecorder__$b.Morph.prototype.borderOptions
              },
              submorphs: [__varRecorder__$b.add({
                type: __varRecorder__$b.Label,
                name: "interactive label",
                fontColor: __varRecorder__$b.Color.rgb(255, 255, 255),
                padding: __varRecorder__$b.rect(0, 4, 7, -4),
                textAndAttributes: ["\uE919", {
                  fontSize: 18,
                  fontFamily: "Material Icons"
                }]
              }, "label"), {
                name: "label",
                fontSize: 12
              }]
            })]
          }]
        });
      }, {
        module: "lively.ide/studio/controls/border.cp.js",
        "export": "BorderControlElements",
        range: {
          start: 12390,
          end: 14078
        }
      }, __varRecorder__$b.BorderControlElements);
      __varRecorder__$b.BorderPopup = __varRecorder__$b.component["for"](function () {
        return __varRecorder__$b.component(__varRecorder__$b.DarkPopupWindow, {
          defaultViewModel: __varRecorder__$b.BorderPopupWindow,
          name: "border popup",
          submorphs: [{
            name: "header menu",
            submorphs: [{
              name: "title",
              textAndAttributes: ["Advanced Stroke", null]
            }]
          }, __varRecorder__$b.add({
            name: "multi border control",
            borderColor: __varRecorder__$b.Color.rgb(23, 160, 251),
            extent: __varRecorder__$b.pt(241, 115.1),
            fill: __varRecorder__$b.Color.rgba(0, 0, 0, 0),
            clipMode: "hidden",
            layout: new __varRecorder__$b.TilingLayout({
              spacing: 10,
              axis: "column",
              hugContentsVertically: true,
              padding: __varRecorder__$b.Rectangle.inset(0, 10, 0, 10)
            }),
            submorphs: [{
              fill: __varRecorder__$b.Color.transparent,
              name: "border selector wrapper",
              extent: __varRecorder__$b.pt(223, 28),
              position: __varRecorder__$b.pt(12.6, 12),
              layout: new __varRecorder__$b.TilingLayout({
                hugContentsVertically: true,
                justifySubmorphs: "spaced",
                orderByIndex: true,
                spacing: 10,
                padding: __varRecorder__$b.Rectangle.inset(20, 0, 0, 0)
              }),
              submorphs: [__varRecorder__$b.part(__varRecorder__$b.AddButton, {
                master: {
                  auto: __varRecorder__$b.AddButton,
                  hover: __varRecorder__$b.PropertyLabelHovered
                },
                name: "left border",
                tooltip: "Configure Left Border",
                padding: __varRecorder__$b.rect(4, 4, 0, 0),
                textAndAttributes: ["\uE22E", {
                  fontSize: 20,
                  fontFamily: "Material Icons"
                }]
              }), __varRecorder__$b.part(__varRecorder__$b.AddButton, {
                name: "top border",
                tooltip: "Configure Top Border",
                master: {
                  auto: __varRecorder__$b.AddButton,
                  hover: __varRecorder__$b.PropertyLabelHovered
                },
                padding: __varRecorder__$b.rect(4, 4, 0, 0),
                textAndAttributes: ["\uE232", {
                  fontSize: 20,
                  fontFamily: "Material Icons"
                }]
              }), __varRecorder__$b.part(__varRecorder__$b.AddButton, {
                master: {
                  auto: __varRecorder__$b.AddButton,
                  hover: __varRecorder__$b.PropertyLabelHovered
                },
                name: "right border",
                tooltip: "Configure Right Border",
                padding: __varRecorder__$b.rect(4, 4, 0, 0),
                textAndAttributes: ["\uE230", {
                  fontSize: 20,
                  fontFamily: "Material Icons"
                }]
              }), __varRecorder__$b.part(__varRecorder__$b.AddButton, {
                master: {
                  auto: __varRecorder__$b.AddButton,
                  hover: __varRecorder__$b.PropertyLabelHovered
                },
                name: "bottom border",
                tooltip: "Configure Bottom Border",
                padding: __varRecorder__$b.rect(4, 4, 0, 0),
                textAndAttributes: ["\uE229", {
                  fontSize: 20,
                  fontFamily: "Material Icons"
                }]
              })]
            }, __varRecorder__$b.part(__varRecorder__$b.BorderControlElements, {
              name: "border control",
              viewModelClass: __varRecorder__$b.BorderControlModel,
              viewModel: {
                updateDirectly: false
              }
            })]
          })]
        });
      }, {
        module: "lively.ide/studio/controls/border.cp.js",
        "export": "BorderPopup",
        range: {
          start: 14086,
          end: 16591
        }
      }, __varRecorder__$b.BorderPopup);
      __varRecorder__$b.BorderControl = __varRecorder__$b.component["for"](function () {
        return __varRecorder__$b.component(__varRecorder__$b.PropertySection, {
          name: "border control",
          defaultViewModel: __varRecorder__$b.BorderControlModel,
          height: 100,
          width: 250,
          submorphs: [{
            name: "h floater",
            submorphs: [{
              name: "section headline",
              textAndAttributes: ["Stroke", null]
            }]
          }, __varRecorder__$b.add(__varRecorder__$b.part(__varRecorder__$b.BorderControlElements, {
            name: "elements wrapper",
            extent: __varRecorder__$b.pt(250, 50),
            submorphs: [{
              name: "border color input",
              submorphs: [{
                name: "hex input",
                extent: __varRecorder__$b.pt(80, 23)
              }]
            }, {
              name: "border width control",
              extent: __varRecorder__$b.pt(175, 25),
              fill: __varRecorder__$b.Color.rgba(255, 255, 255, 0),
              layout: new __varRecorder__$b.TilingLayout({
                axisAlign: "center",
                justifySubmorphs: "spaced",
                orderByIndex: true,
                padding: __varRecorder__$b.rect(20, 0, -10, 0),
                spacing: 10
              }),
              submorphs: [{
                name: "border width input",
                extent: __varRecorder__$b.pt(59.9, 22),
                min: 0,
                tooltip: "Border Width",
                submorphs: [{
                  name: "value",
                  extent: __varRecorder__$b.pt(45.7, 21)
                }]
              }]
            }, __varRecorder__$b.add(__varRecorder__$b.part(__varRecorder__$b.AddButton, {
              master: {
                hover: __varRecorder__$b.PropertyLabelHovered,
                click: __varRecorder__$b.PropertyLabelActive
              },
              name: "more button",
              tooltip: "Open Advanced Settings",
              padding: __varRecorder__$b.rect(6, 4, 0, 0),
              textAndAttributes: ["\uE5D3", {
                fontSize: 18,
                fontFamily: "Material Icons"
              }]
            }))]
          }))]
        });
      }, {
        module: "lively.ide/studio/controls/border.cp.js",
        "export": "BorderControl",
        range: {
          start: 16599,
          end: 17993
        }
      }, __varRecorder__$b.BorderControl);
      var BorderControl = __varRecorder__$b.BorderControl;
      var BorderPopup = __varRecorder__$b.BorderPopup;
      var BorderControlElements = __varRecorder__$b.BorderControlElements;
      __varRecorder__$b.BorderControl = BorderControl;
      __varRecorder__$b.BorderPopup = BorderPopup;
      __varRecorder__$b.BorderControlElements = BorderControlElements;

      var __varRecorder__$a = lively.FreezerRuntime.recorderFor("lively.ide/studio/controls/fill.cp.js");
      __varRecorder__$a.ViewModel = ViewModel;
      __varRecorder__$a.part = part;
      __varRecorder__$a.add = add;
      __varRecorder__$a.without = without;
      __varRecorder__$a.component = component;
      __varRecorder__$a.pt = pt;
      __varRecorder__$a.rect = rect;
      __varRecorder__$a.Color = Color;
      __varRecorder__$a.ColorInput = ColorInput;
      __varRecorder__$a.TilingLayout = TilingLayout;
      __varRecorder__$a.Image = Image;
      __varRecorder__$a.PropLabel = PropLabel;
      __varRecorder__$a.PropertySection = PropertySection;
      __varRecorder__$a.DarkColorPicker = DarkColorPicker;
      __varRecorder__$a.obj = obj;
      __varRecorder__$a.noUpdate = noUpdate;
      __varRecorder__$a.placeholderImage = "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAwCAYAAABXAvmHAAAAAXNSR0IArs4c6QAAAfRJREFUaEPtmTFrFFEUhb+jIIKQgFZGi3QBU6SQCDaCXVJbqZCQpLW2E1OntRJCFEXxB2gdCxtFAxYh+QOJVYoU0c4THkxg3dmZnWXnTWbk3XLnzbvn3HPuXd4b0fFQx/GTCJy3gkmBVitg+wawAdwHrjcM9hewDTyVdFCUu9BCGfifwLWGgfenOwLmikiUEXgHPDpn8Gfp30t6PAhLGYEg21RLCBxKCnbORRkB966W1OjEsl0pfyIQy2JJgaoVSAoUVKBqAVMTJwslC41ZgWShMQuYptCoFrI9Kel42Hut/B+w/QBYB+5I+lNGonUEbM8A34AJYEvSWmsI2L4NXJQUAObC9hXgKzDb83BJ0tsiEo0pYPsq8AO4lFkjdwC3Peh4egLMS9orIB3/QGP7AvAJWMhAfAfu9frb9hPgRUGldzPSv/ufN6KA7dCQz/uSf5D0MPxm+y7wOVOnyC2vJK02TsD2IvARCCr0xzPgJbAD3Bw2MoFlSW9610VVwPZ05vvg/0HxF9gHblUAH5bk+iEaAduXgS9AmDx1xj/9EJPAJlA6w8dg9VrSStY/8afQGECHvhpNgaGZa1qQCFStQE0Fz21TNf9/fbnb+ev1cJ3d3Q8c2Szu7iemWM1Z976NfrSoG3zYLxGIUdVR9kwKjFKtGGtPAaQTYEDIYzesAAAAAElFTkSuQmCC";
      var FillControlModel = function (superclass) {
        var __lively_classholder__ = lively.FreezerRuntime.recorderFor("lively.ide/studio/controls/fill.cp.js");

        var __lively_class__ = __lively_classholder__.hasOwnProperty("FillControlModel") && typeof __lively_classholder__.FillControlModel === "function" ? __lively_classholder__.FillControlModel : __lively_classholder__.FillControlModel = function FillControlModel(__first_arg__) {
          if (__first_arg__ && __first_arg__[Symbol["for"]("lively-instance-restorer")]) ; else {
            return this[Symbol["for"]("lively-instance-initialize")].apply(this, arguments);
          }
        };

        return initializeClass(__lively_class__, superclass, [{
          key: "onMouseDown",
          value: function FillControlModel_onMouseDown_() {
            this.deactivate();
          }
        }, {
          key: "focusOn",
          value: function FillControlModel_focusOn_(target) {
            this.targetMorph = target;
            this.ui.imageControl.visible = !!target.isImage;
            this.models.fillColorInput.targetMorph = target;
          }
        }, {
          key: "onRefresh",
          value: function FillControlModel_onRefresh_(prop) {
            if (prop === "targetMorph") this.update();
          }
        }, {
          key: "ensureHalo",
          value: function FillControlModel_ensureHalo_() {
            var _this = this;

            __varRecorder__$a.noUpdate(function () {
              if (_this.targetMorph.world()) $world.showHaloFor(_this.targetMorph);
            });
          }
        }, {
          key: "confirm",
          value: function FillControlModel_confirm_() {
            var _this2 = this;

            if (!this.targetMorph) return;
            var color = this.ui.fillColorInput.colorValue;
            if (__varRecorder__$a.obj.equals(this.targetMorph.fill, color)) return;
            this.targetMorph.withMetaDo({
              reconcileChanges: true
            }, function () {
              _this2.targetMorph.fill = color;
            });
          }
        }, {
          key: "update",
          value: function () {
            var _FillControlModel_update_ = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee() {
              var _this$targetMorph, isImage, fill;

              return regeneratorRuntime.wrap(function _callee$(_context) {
                while (1) {
                  switch (_context.prev = _context.next) {
                    case 0:
                      _this$targetMorph = this.targetMorph, isImage = _this$targetMorph.isImage, fill = _this$targetMorph.fill;
                      this.ui.fillColorInput.setColor(fill);
                      this.ui.imageControl.visible = isImage;

                      if (isImage) {
                        this.ui.imageContainer.imageUrl = this.targetMorph.imageUrl || this.placeholderImage;
                      }

                    case 4:
                    case "end":
                      return _context.stop();
                  }
                }
              }, _callee, this);
            }));

            function FillControlModel_update_() {
              return _FillControlModel_update_.apply(this, arguments);
            }

            return FillControlModel_update_;
          }()
        }, {
          key: "deactivate",
          value: function FillControlModel_deactivate_() {
            this.models.fillColorInput.closeColorPicker();
          }
        }], [{
          key: Symbol["for"]("__LivelyClassName__"),
          get: function get() {
            return "FillControlModel";
          }
        }, {
          key: "properties",
          get: function get() {
            return {
              targetMorph: {},
              placeholderImage: {
                defaultValue: __varRecorder__$a.placeholderImage
              },
              bindings: {
                get: function get() {
                  return [{
                    model: "fill color input",
                    signal: "onPickerClosedWithClick",
                    handler: "ensureHalo"
                  }, {
                    model: "fill color input",
                    signal: "color",
                    handler: "confirm"
                  }, {
                    target: "image cell",
                    signal: "onMouseDown",
                    handler: "changeImageUrl"
                  }, {
                    signal: "onMouseDown",
                    handler: "onMouseDown"
                  }];
                }
              }
            };
          }
        }], __lively_classholder__, {
          pathInPackage: function pathInPackage() {
            return "./studio/controls/fill.cp.js";
          },
          unsubscribeFromToplevelDefinitionChanges: function unsubscribeFromToplevelDefinitionChanges() {
            return function () {};
          },
          subscribeToToplevelDefinitionChanges: function subscribeToToplevelDefinitionChanges() {
            return function () {};
          },
          "package": function _package() {
            return {
              name: "lively.ide",
              version: "0.1.0"
            };
          }
        }, {
          start: 1298,
          end: 3113
        });
      }(__varRecorder__$a.ViewModel);
      __varRecorder__$a.FillControlModel = FillControlModel;
      __varRecorder__$a.FillControlModel = FillControlModel;
      __varRecorder__$a.FillControl = __varRecorder__$a.component["for"](function () {
        return __varRecorder__$a.component(__varRecorder__$a.PropertySection, {
          defaultViewModel: __varRecorder__$a.FillControlModel,
          name: "fill control",
          extent: __varRecorder__$a.pt(250, 121),
          submorphs: [{
            name: "h floater",
            submorphs: [__varRecorder__$a.without("add button"), {
              name: "section headline",
              textAndAttributes: ["Fill", null]
            }]
          }, __varRecorder__$a.add(__varRecorder__$a.part(__varRecorder__$a.ColorInput, {
            name: "fill color input",
            viewModel: {
              gradientEnabled: true,
              colorPickerComponent: __varRecorder__$a.DarkColorPicker
            },
            extent: __varRecorder__$a.pt(250, 27)
          })), __varRecorder__$a.add({
            name: "image control",
            extent: __varRecorder__$a.pt(235.1, 25),
            fill: __varRecorder__$a.Color.rgba(255, 255, 255, 0),
            layout: new __varRecorder__$a.TilingLayout({
              axisAlign: "center",
              padding: __varRecorder__$a.rect(20, 1, -10, 1)
            }),
            height: 25,
            submorphs: [{
              name: "image cell",
              nativeCursor: "pointer",
              fill: __varRecorder__$a.Color.transparent,
              clipMode: "hidden",
              extent: __varRecorder__$a.pt(22, 22),
              submorphs: [{
                type: __varRecorder__$a.Image,
                name: "image container",
                reactsToPointer: false,
                extent: __varRecorder__$a.pt(20, 20),
                imageUrl: __varRecorder__$a.placeholderImage,
                naturalExtent: __varRecorder__$a.pt(48, 48),
                position: __varRecorder__$a.pt(1, 1)
              }]
            }, __varRecorder__$a.part(__varRecorder__$a.PropLabel, {
              name: "image marker",
              textString: "Image"
            })]
          })]
        });
      }, {
        module: "lively.ide/studio/controls/fill.cp.js",
        "export": "FillControl",
        range: {
          start: 3120,
          end: 4305
        }
      }, __varRecorder__$a.FillControl);
      var FillControl = exports('F', __varRecorder__$a.FillControl);
      __varRecorder__$a.FillControl = FillControl;

      var __varRecorder__$9 = lively.FreezerRuntime.recorderFor("lively.ide/studio/controls/constraints.cp.js");
      __varRecorder__$9.PropertySection = PropertySection;
      __varRecorder__$9.TilingLayout = TilingLayout;
      __varRecorder__$9.ConstraintLayout = ConstraintLayout;
      __varRecorder__$9.Label = Label;
      __varRecorder__$9.component = component;
      __varRecorder__$9.ViewModel = ViewModel;
      __varRecorder__$9.part = part;
      __varRecorder__$9.add = add;
      __varRecorder__$9.without = without;
      __varRecorder__$9.Rectangle = Rectangle;
      __varRecorder__$9.rect = rect;
      __varRecorder__$9.pt = pt;
      __varRecorder__$9.Color = Color;
      __varRecorder__$9.EnumSelector = EnumSelector;
      __varRecorder__$9.DarkThemeList = DarkThemeList;
      __varRecorder__$9.signal = signal;
      __varRecorder__$9.FIXED_ICON = "\uEA16";
      var ConstraintsManagerModel = function (superclass) {
        var __lively_classholder__ = lively.FreezerRuntime.recorderFor("lively.ide/studio/controls/constraints.cp.js");

        var __lively_class__ = __lively_classholder__.hasOwnProperty("ConstraintsManagerModel") && typeof __lively_classholder__.ConstraintsManagerModel === "function" ? __lively_classholder__.ConstraintsManagerModel : __lively_classholder__.ConstraintsManagerModel = function ConstraintsManagerModel(__first_arg__) {
          if (__first_arg__ && __first_arg__[Symbol["for"]("lively-instance-restorer")]) ; else {
            return this[Symbol["for"]("lively-instance-initialize")].apply(this, arguments);
          }
        };

        return initializeClass(__lively_class__, superclass, [{
          key: "focusOn",
          value: function ConstraintsManagerModel_focusOn_(aMorph) {
            this.targetMorph = aMorph;
            this.update();
          }
        }, {
          key: "ensureLayout",
          value: function ConstraintsManagerModel_ensureLayout_(x, y) {
            if (!this.targetMorph) return;
            var owner = this.targetMorph.owner;
            if (owner.isWorld) return;
            owner.withMetaDo({
              reconcileChanges: true
            }, function () {
              if (!owner.layout && (x !== "fixed" || y !== "fixed")) {
                owner.layout = new __varRecorder__$9.ConstraintLayout({
                  submorphSettings: owner.submorphs.map(function (m) {
                    return [m.name, {
                      x: "fixed",
                      y: "fixed"
                    }];
                  })
                });
              }
            });
            return owner.layout;
          }
        }, {
          key: "update",
          value: function ConstraintsManagerModel_update_() {
            var target = this.targetMorph;
            var owner = target.owner;
            this.view.visible = false;

            if (owner && !owner.isWorld && !owner.isHand && (!owner.layout || owner.layout.name() === "Constraint")) {
              this.view.visible = true;
            }

            if (this.view.visible) this.refreshConstraints();
          }
        }, {
          key: "refreshConstraints",
          value: function ConstraintsManagerModel_refreshConstraints_() {
            var constraints = this.models.constraints;
            var layout = this.targetMorph.owner.layout;

            if (!layout) {
              constraints.verticalConstraint = "fixed";
              constraints.horizontalConstraint = "fixed";
              return;
            }

            if (layout.name() === "Constraint") {
              var policy = layout.settingsFor(this.targetMorph);
              constraints.verticalConstraint = policy.y;
              constraints.horizontalConstraint = policy.x;
            }
          }
        }, {
          key: "confirmConstraintPolicies",
          value: function ConstraintsManagerModel_confirmConstraintPolicies_() {
            var _this = this;

            var constraints = this.models.constraints;
            var horizontalConstraint = constraints.horizontalConstraint,
                verticalConstraint = constraints.verticalConstraint;
            var layout = this.ensureLayout(horizontalConstraint, verticalConstraint);
            if (!layout) return;
            layout.changeSettingsFor(this.targetMorph, {
              x: horizontalConstraint,
              y: verticalConstraint
            });
            this.targetMorph.withMetaDo({
              reconcileChanges: true
            }, function () {
              _this.targetMorph.owner.layout = layout.getSpec().submorphSettings.length > 0 ? layout : undefined;
            });
          }
        }], [{
          key: Symbol["for"]("__LivelyClassName__"),
          get: function get() {
            return "ConstraintsManagerModel";
          }
        }, {
          key: "properties",
          get: function get() {
            return {
              targetMorph: {},
              bindings: {
                get: function get() {
                  return [{
                    model: "constraints",
                    signal: "changed",
                    handler: "confirmConstraintPolicies"
                  }];
                }
              },
              expose: {
                get: function get() {
                  return ["focusOn"];
                }
              }
            };
          }
        }], __lively_classholder__, {
          pathInPackage: function pathInPackage() {
            return "./studio/controls/constraints.cp.js";
          },
          unsubscribeFromToplevelDefinitionChanges: function unsubscribeFromToplevelDefinitionChanges() {
            return function () {};
          },
          subscribeToToplevelDefinitionChanges: function subscribeToToplevelDefinitionChanges() {
            return function () {};
          },
          "package": function _package() {
            return {
              name: "lively.ide",
              version: "0.1.0"
            };
          }
        }, {
          start: 573,
          end: 3486
        });
      }(__varRecorder__$9.ViewModel);
      __varRecorder__$9.ConstraintsManagerModel = ConstraintsManagerModel;
      __varRecorder__$9.ConstraintsManagerModel = ConstraintsManagerModel;
      var ConstraintsControlModel = function (superclass) {
        var __lively_classholder__ = lively.FreezerRuntime.recorderFor("lively.ide/studio/controls/constraints.cp.js");

        var __lively_class__ = __lively_classholder__.hasOwnProperty("ConstraintsControlModel") && typeof __lively_classholder__.ConstraintsControlModel === "function" ? __lively_classholder__.ConstraintsControlModel : __lively_classholder__.ConstraintsControlModel = function ConstraintsControlModel(__first_arg__) {
          if (__first_arg__ && __first_arg__[Symbol["for"]("lively-instance-restorer")]) ; else {
            return this[Symbol["for"]("lively-instance-initialize")].apply(this, arguments);
          }
        };

        return initializeClass(__lively_class__, superclass, [{
          key: "onRefresh",
          value: function ConstraintsControlModel_onRefresh_(prop) {
            this.clearAllMarkers();
            var _this$ui = this.ui,
                topMarker = _this$ui.topMarker,
                bottomMarker = _this$ui.bottomMarker,
                verticalMarker = _this$ui.verticalMarker,
                verticalAlignmentSelector = _this$ui.verticalAlignmentSelector;
            var ActiveMarker = this.activeMarkerComponent;
            verticalAlignmentSelector.selection = this.verticalConstraint;

            switch (this.verticalConstraint) {
              case "scale":
                break;

              case "move":
                bottomMarker.master = ActiveMarker;
                break;

              case "fixed":
                topMarker.master = ActiveMarker;
                break;

              case "resize":
                topMarker.master = ActiveMarker;
                bottomMarker.master = ActiveMarker;
                break;

              case "center":
                verticalMarker.master = ActiveMarker;
                break;
            }

            var _this$ui2 = this.ui,
                leftMarker = _this$ui2.leftMarker,
                rightMarker = _this$ui2.rightMarker,
                horizontalMarker = _this$ui2.horizontalMarker,
                horizontalAlignmentSelector = _this$ui2.horizontalAlignmentSelector;
            horizontalAlignmentSelector.selection = this.horizontalConstraint;

            switch (this.horizontalConstraint) {
              case "scale":
                break;

              case "move":
                rightMarker.master = ActiveMarker;
                break;

              case "fixed":
                leftMarker.master = ActiveMarker;
                break;

              case "resize":
                leftMarker.master = ActiveMarker;
                rightMarker.master = ActiveMarker;
                break;

              case "center":
                horizontalMarker.master = ActiveMarker;
                break;
            }
          }
        }, {
          key: "clearAllMarkers",
          value: function ConstraintsControlModel_clearAllMarkers_() {
            var MarkerDefault = this.defaultMarkerComponent;
            this.view.getAllNamed(/marker/).forEach(function (m) {
              m.master = MarkerDefault;
            });
          }
        }, {
          key: "selectVerticalConstraint",
          value: function ConstraintsControlModel_selectVerticalConstraint_(behavior) {
            if (behavior) this.verticalConstraint = behavior;

            __varRecorder__$9.signal(this, "changed");
          }
        }, {
          key: "selectHorizontalConstraint",
          value: function ConstraintsControlModel_selectHorizontalConstraint_(behavior) {
            if (behavior) this.horizontalConstraint = behavior;

            __varRecorder__$9.signal(this, "changed");
          }
        }, {
          key: "onMarkerClicked",
          value: function ConstraintsControlModel_onMarkerClicked_(evt) {
            var markerName = evt.targetMorph.name;

            if (markerName.endsWith("marker")) {
              this.selectVerticalConstraint({
                "top marker": "fixed",
                "bottom marker": "move",
                "vertical marker": "center"
              }[markerName]);
              this.selectHorizontalConstraint({
                "left marker": "fixed",
                "right marker": "move",
                "horizontal marker": "center"
              }[markerName]);
            }
          }
        }], [{
          key: Symbol["for"]("__LivelyClassName__"),
          get: function get() {
            return "ConstraintsControlModel";
          }
        }, {
          key: "properties",
          get: function get() {
            return {
              verticalConstraint: {
                defaultValue: "fixed"
              },
              horizontalConstraint: {
                defaultValue: "fixed"
              },
              activeMarkerComponent: {
                isComponent: true,
                get: function get() {
                  return this.getProperty("activeMarkerComponent") || __varRecorder__$9.ConstraintMarkerActive;
                }
              },
              defaultMarkerComponent: {
                isComponent: true,
                get: function get() {
                  return this.getProperty("defaultMarkerComponent") || __varRecorder__$9.ConstraintMarker;
                }
              },
              bindings: {
                get: function get() {
                  return [{
                    model: "horizontal alignment selector",
                    signal: "selection",
                    handler: "selectHorizontalConstraint"
                  }, {
                    model: "vertical alignment selector",
                    signal: "selection",
                    handler: "selectVerticalConstraint"
                  }, {
                    target: "constraints simulator",
                    signal: "onMouseDown",
                    handler: "onMarkerClicked"
                  }];
                }
              }
            };
          }
        }], __lively_classholder__, {
          pathInPackage: function pathInPackage() {
            return "./studio/controls/constraints.cp.js";
          },
          unsubscribeFromToplevelDefinitionChanges: function unsubscribeFromToplevelDefinitionChanges() {
            return function () {};
          },
          subscribeToToplevelDefinitionChanges: function subscribeToToplevelDefinitionChanges() {
            return function () {};
          },
          "package": function _package() {
            return {
              name: "lively.ide",
              version: "0.1.0"
            };
          }
        }, {
          start: 3838,
          end: 8708
        });
      }(__varRecorder__$9.ViewModel);
      __varRecorder__$9.ConstraintsControlModel = ConstraintsControlModel;
      __varRecorder__$9.ConstraintsControlModel = ConstraintsControlModel;
      __varRecorder__$9.Plain = __varRecorder__$9.component["for"](function () {
        return __varRecorder__$9.component({
          name: "plain",
          extent: __varRecorder__$9.pt(10, 14),
          fill: __varRecorder__$9.Color.transparent,
          nativeCursor: "pointer"
        });
      }, {
        module: "lively.ide/studio/controls/constraints.cp.js",
        "export": "Plain",
        range: {
          start: 8715,
          end: 8829
        }
      }, __varRecorder__$9.Plain);
      __varRecorder__$9.Hovered = __varRecorder__$9.component["for"](function () {
        return __varRecorder__$9.component({
          name: "marked",
          extent: __varRecorder__$9.pt(10, 14),
          fill: __varRecorder__$9.Color.rgba(128, 216, 255, 0.5),
          nativeCursor: "pointer"
        });
      }, {
        module: "lively.ide/studio/controls/constraints.cp.js",
        "export": "Hovered",
        range: {
          start: 8837,
          end: 8967
        }
      }, __varRecorder__$9.Hovered);
      __varRecorder__$9.ConstraintMarker = __varRecorder__$9.component["for"](function () {
        return __varRecorder__$9.component({
          name: "constraint marker",
          master: {
            auto: __varRecorder__$9.Plain,
            hover: __varRecorder__$9.Hovered
          },
          nativeCursor: "pointer",
          extent: __varRecorder__$9.pt(10, 14),
          fill: __varRecorder__$9.Color.transparent,
          submorphs: [{
            name: "accent",
            reactsToPointer: false,
            position: __varRecorder__$9.pt(4, 2),
            extent: __varRecorder__$9.pt(2, 10),
            borderColor: __varRecorder__$9.Color.rgb(178, 235, 242),
            fill: __varRecorder__$9.Color.rgb(176, 190, 197)
          }]
        });
      }, {
        module: "lively.ide/studio/controls/constraints.cp.js",
        "export": "ConstraintMarker",
        range: {
          start: 8975,
          end: 9360
        }
      }, __varRecorder__$9.ConstraintMarker);
      __varRecorder__$9.ConstraintMarkerActive = __varRecorder__$9.component["for"](function () {
        return __varRecorder__$9.component(__varRecorder__$9.ConstraintMarker, {
          name: "constraint marker active",
          submorphs: [{
            name: "accent",
            position: __varRecorder__$9.pt(2.5, 2),
            fill: __varRecorder__$9.Color.rgb(178, 235, 242),
            borderWidth: 1.5
          }]
        });
      }, {
        module: "lively.ide/studio/controls/constraints.cp.js",
        "export": "ConstraintMarkerActive",
        range: {
          start: 9368,
          end: 9585
        }
      }, __varRecorder__$9.ConstraintMarkerActive);
      __varRecorder__$9.ConstraintsSimulator = __varRecorder__$9.component["for"](function () {
        return __varRecorder__$9.component({
          name: "constraints simulator",
          borderColor: __varRecorder__$9.Color.darkGray,
          borderWidth: 1,
          extent: __varRecorder__$9.pt(75, 75),
          fill: __varRecorder__$9.Color.rgba(0, 0, 0, 0),
          position: __varRecorder__$9.pt(1.3, 12.1),
          submorphs: [__varRecorder__$9.part(__varRecorder__$9.ConstraintMarker, {
            name: "top marker",
            tooltip: "Resize with Top Border",
            position: __varRecorder__$9.pt(32.9, 4.4)
          }), __varRecorder__$9.part(__varRecorder__$9.ConstraintMarker, {
            name: "right marker",
            tooltip: "Resize with Right Border",
            rotation: Math.PI / 2,
            position: __varRecorder__$9.pt(71.6, 33.4)
          }), __varRecorder__$9.part(__varRecorder__$9.ConstraintMarker, {
            name: "bottom marker",
            tooltip: "Resize with Bottom Border",
            position: __varRecorder__$9.pt(31.7, 57.5)
          }), __varRecorder__$9.part(__varRecorder__$9.ConstraintMarker, {
            name: "left marker",
            rotation: Math.PI / 2,
            position: __varRecorder__$9.pt(17, 32.8)
          }), {
            name: "inner constraints",
            borderWidth: 1,
            borderColor: __varRecorder__$9.Color.rgb(176, 190, 197),
            extent: __varRecorder__$9.pt(35, 35),
            fill: __varRecorder__$9.Color.transparent,
            position: __varRecorder__$9.pt(20, 20),
            submorphs: [__varRecorder__$9.part(__varRecorder__$9.ConstraintMarker, {
              name: "vertical marker",
              tooltip: "Proportionally Fix Center Vertically",
              height: 19,
              position: __varRecorder__$9.pt(13.3, 9.1),
              submorphs: [{
                name: "accent",
                height: 15
              }]
            }), __varRecorder__$9.part(__varRecorder__$9.ConstraintMarker, {
              name: "horizontal marker",
              tooltip: "Proportionally Fix Center Horizontally",
              rotation: -1.5707963267948966,
              height: 19,
              position: __varRecorder__$9.pt(7.9, 22.7),
              submorphs: [{
                name: "accent",
                height: 15
              }]
            })]
          }]
        });
      }, {
        module: "lively.ide/studio/controls/constraints.cp.js",
        "export": "ConstraintsSimulator",
        range: {
          start: 9673,
          end: 11119
        }
      }, __varRecorder__$9.ConstraintsSimulator);
      __varRecorder__$9.ConstraintsControl = __varRecorder__$9.component["for"](function () {
        return __varRecorder__$9.component({
          defaultViewModel: __varRecorder__$9.ConstraintsControlModel,
          name: "constraint controller",
          layout: new __varRecorder__$9.TilingLayout({
            align: "center",
            axis: "column",
            orderByIndex: true,
            wrapSubmorphs: true,
            padding: __varRecorder__$9.Rectangle.inset(20, 0, 0, 10),
            spacing: 10
          }),
          borderColor: __varRecorder__$9.Color.rgb(23, 160, 251),
          borderWidth: 0,
          extent: __varRecorder__$9.pt(229, 84.9),
          fill: __varRecorder__$9.Color.rgba(0, 0, 0, 0),
          submorphs: [__varRecorder__$9.part(__varRecorder__$9.ConstraintsSimulator, {
            name: "constraints simulator"
          }), __varRecorder__$9.part(__varRecorder__$9.EnumSelector, {
            name: "horizontal alignment selector",
            tooltip: "Choose Horizontal Alignment",
            viewModel: {
              listMaster: __varRecorder__$9.DarkThemeList,
              listAlign: "selection",
              openListInWorld: true,
              listHeight: 500,
              items: [{
                string: "Left and Right",
                value: "resize",
                isListItem: true
              }, {
                string: "Center",
                value: "center",
                isListItem: true
              }, {
                string: "Left",
                value: "fixed",
                isListItem: true
              }, {
                string: "Right",
                value: "move",
                isListItem: true
              }, {
                string: "Scale",
                value: "scale",
                isListItem: true
              }]
            },
            clipMode: "hidden",
            extent: __varRecorder__$9.pt(128.8, 23.3),
            submorphs: [__varRecorder__$9.add({
              type: __varRecorder__$9.Label,
              name: "interactive label",
              padding: __varRecorder__$9.rect(0, 0, 0, 0),
              rotation: -1.5707963267948966,
              fontColor: __varRecorder__$9.Color.white,
              textAndAttributes: [__varRecorder__$9.FIXED_ICON, {
                fontFamily: "Material Icons",
                fontSize: 18
              }]
            }, "label"), {
              name: "label",
              fontSize: 12
            }]
          }), __varRecorder__$9.part(__varRecorder__$9.EnumSelector, {
            name: "vertical alignment selector",
            tooltip: "Choose Vertical Alignment",
            viewModel: {
              listMaster: __varRecorder__$9.DarkThemeList,
              listAlign: "selection",
              openListInWorld: true,
              listHeight: 500,
              items: [{
                string: "Top and Bottom",
                value: "resize",
                isListItem: true
              }, {
                string: "Center",
                value: "center",
                isListItem: true
              }, {
                string: "Top",
                value: "fixed",
                isListItem: true
              }, {
                string: "Bottom",
                value: "move",
                isListItem: true
              }, {
                string: "Scale",
                value: "scale",
                isListItem: true
              }]
            },
            extent: __varRecorder__$9.pt(128.5, 23.3),
            clipMode: "hidden",
            submorphs: [__varRecorder__$9.add({
              type: __varRecorder__$9.Label,
              name: "interactive label",
              padding: __varRecorder__$9.rect(0, 0, 0, 0),
              fontColor: __varRecorder__$9.Color.white,
              textAndAttributes: [__varRecorder__$9.FIXED_ICON, {
                fontFamily: "Material Icons",
                fontSize: 18
              }]
            }, "label"), {
              name: "label",
              fontSize: 12
            }]
          })]
        });
      }, {
        module: "lively.ide/studio/controls/constraints.cp.js",
        "export": "ConstraintsControl",
        range: {
          start: 11127,
          end: 13874
        }
      }, __varRecorder__$9.ConstraintsControl);
      __varRecorder__$9.ConstraintSizeSelectorDefault = __varRecorder__$9.component["for"](function () {
        return __varRecorder__$9.component({
          name: "constraint size selector default",
          extent: __varRecorder__$9.pt(38.6, 10),
          clipMode: "hidden",
          nativeCursor: "pointer",
          fill: __varRecorder__$9.Color.transparent,
          layout: new __varRecorder__$9.TilingLayout({
            axis: "row",
            align: "center",
            axisAlign: "center"
          }),
          submorphs: [{
            type: __varRecorder__$9.Label,
            name: "caret",
            reactsToPointer: false,
            fontColor: __varRecorder__$9.Color.rgb(176, 190, 197),
            padding: __varRecorder__$9.rect(3, 0, 0, 0),
            extent: __varRecorder__$9.pt(17, 17),
            position: __varRecorder__$9.pt(9.8, -2),
            borderRadius: 2,
            fontFamily: "Material Icons",
            textAndAttributes: ["\uE5CE", {
              fontSize: 14
            }]
          }]
        });
      }, {
        module: "lively.ide/studio/controls/constraints.cp.js",
        "export": "ConstraintSizeSelectorDefault",
        range: {
          start: 13882,
          end: 14494
        }
      }, __varRecorder__$9.ConstraintSizeSelectorDefault);
      __varRecorder__$9.ConstraintsManager = __varRecorder__$9.component["for"](function () {
        return __varRecorder__$9.component(__varRecorder__$9.PropertySection, {
          defaultViewModel: __varRecorder__$9.ConstraintsManagerModel,
          name: "constraints control",
          extent: __varRecorder__$9.pt(250.6, 145),
          submorphs: [{
            name: "h floater",
            submorphs: [{
              name: "section headline",
              textAndAttributes: ["Constraints", null]
            }, __varRecorder__$9.without("add button")]
          }, __varRecorder__$9.add(__varRecorder__$9.part(__varRecorder__$9.ConstraintsControl, {
            name: "constraints"
          }))]
        });
      }, {
        module: "lively.ide/studio/controls/constraints.cp.js",
        "export": "ConstraintsManager",
        range: {
          start: 14502,
          end: 14889
        }
      }, __varRecorder__$9.ConstraintsManager);
      var ConstraintsManager = __varRecorder__$9.ConstraintsManager;
      var ConstraintsControl = __varRecorder__$9.ConstraintsControl;
      var ConstraintsSimulator = __varRecorder__$9.ConstraintsSimulator;
      var ConstraintSizeSelectorDefault = __varRecorder__$9.ConstraintSizeSelectorDefault;
      var ConstraintMarker = __varRecorder__$9.ConstraintMarker;
      var ConstraintMarkerActive = __varRecorder__$9.ConstraintMarkerActive;
      __varRecorder__$9.ConstraintsManager = ConstraintsManager;
      __varRecorder__$9.ConstraintsControl = ConstraintsControl;
      __varRecorder__$9.ConstraintsSimulator = ConstraintsSimulator;
      __varRecorder__$9.ConstraintSizeSelectorDefault = ConstraintSizeSelectorDefault;
      __varRecorder__$9.ConstraintMarker = ConstraintMarker;
      __varRecorder__$9.ConstraintMarkerActive = ConstraintMarkerActive;

      var __varRecorder__$8 = lively.FreezerRuntime.recorderFor("lively.ide/studio/controls/body.cp.js");
      __varRecorder__$8.TilingLayout = TilingLayout;
      __varRecorder__$8.ShadowObject = ShadowObject;
      __varRecorder__$8.component = component;
      __varRecorder__$8.ViewModel = ViewModel;
      __varRecorder__$8.part = part;
      __varRecorder__$8.Color = Color;
      __varRecorder__$8.rect = rect;
      __varRecorder__$8.pt = pt;
      __varRecorder__$8.obj = obj;
      __varRecorder__$8.arr = arr;
      __varRecorder__$8.once = once;
      __varRecorder__$8.noUpdate = noUpdate;
      __varRecorder__$8.epiConnect = epiConnect;
      __varRecorder__$8.ShadowPopup = ShadowPopup;
      __varRecorder__$8.OpacityPopup = OpacityPopup;
      __varRecorder__$8.FlipPopup = FlipPopup;
      __varRecorder__$8.TiltPopup = TiltPopup;
      __varRecorder__$8.CursorPopup = CursorPopup;
      __varRecorder__$8.BlurPopup = BlurPopup;
      __varRecorder__$8.InsetShadowPopup = InsetShadowPopup;
      __varRecorder__$8.PropertySection = PropertySection;
      __varRecorder__$8.PropertySectionModel = PropertySectionModel;
      __varRecorder__$8.PropertyLabel = PropertyLabel;
      __varRecorder__$8.RemoveButton = RemoveButton;
      __varRecorder__$8.DarkThemeList = DarkThemeList;
      __varRecorder__$8.EnumSelector = EnumSelector;
      __varRecorder__$8.PropertyLabelActive = PropertyLabelActive;
      __varRecorder__$8.PropertyLabelHovered = PropertyLabelHovered;
      var BodyControlModel = function (superclass) {
        var __lively_classholder__ = lively.FreezerRuntime.recorderFor("lively.ide/studio/controls/body.cp.js");

        var __lively_class__ = __lively_classholder__.hasOwnProperty("BodyControlModel") && typeof __lively_classholder__.BodyControlModel === "function" ? __lively_classholder__.BodyControlModel : __lively_classholder__.BodyControlModel = function BodyControlModel(__first_arg__) {
          if (__first_arg__ && __first_arg__[Symbol["for"]("lively-instance-restorer")]) ; else {
            return this[Symbol["for"]("lively-instance-initialize")].apply(this, arguments);
          }
        };

        return initializeClass(__lively_class__, superclass, [{
          key: "addEffectButton",
          get: function get() {
            return this.ui.addButton;
          }
        }, {
          key: "disableAddEffectButton",
          value: function BodyControlModel_disableAddEffectButton_() {
            this.addEffectButton.reactsToPointer = false;
            this.addEffectButton.visible = false;
          }
        }, {
          key: "enableAddEffectButton",
          value: function BodyControlModel_enableAddEffectButton_() {
            this.addEffectButton.reactsToPointer = true;
            this.addEffectButton.visible = true;
          }
        }, {
          key: "focusOn",
          value: function BodyControlModel_focusOn_(aMorph) {
            this.targetMorph = aMorph;
            this.ensureDynamicControls();
            if (this.availableItems.length === 0) this.disableAddEffectButton();else this.enableAddEffectButton();
          }
        }, {
          key: "ensureDynamicControls",
          value: function BodyControlModel_ensureDynamicControls_() {
            this.dynamicControls.forEach(function (m) {
              return m.remove();
            });
            this.view.layout = this.view.layout;

            for (var prop in this.propConfig) {
              var _this$propConfig$prop = this.propConfig[prop],
                  resetValue = _this$propConfig$prop.resetValue,
                  accessor = _this$propConfig$prop.accessor;

              if (!__varRecorder__$8.obj.equals(resetValue, this.targetMorph[accessor])) {
                if (prop === "Inner shadow" && !this.targetMorph[accessor].inset) continue;
                if (prop === "Drop shadow" && this.targetMorph[accessor].inset) continue;
                this.addDynamicProperty(prop, false, false);
              }
            }

            this.refreshItemLists();
            this.deactivate();
          }
        }, {
          key: "refreshItemLists",
          value: function BodyControlModel_refreshItemLists_() {
            var _this = this;

            if (this._refreshing) return;
            this._refreshing = true;
            this.dynamicControls.forEach(function (ctrl) {
              return ctrl.refreshItems(_this.availableItems);
            });
            this._refreshing = false;

            if (this.availableItems.length < 1) {
              this.disableAddEffectButton();
            } else {
              this.enableAddEffectButton();
            }
          }
        }, {
          key: "addDynamicProperty",
          value: function BodyControlModel_addDynamicProperty_(selectedProp) {
            var reset = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : true;
            var applyDefault = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : true;
            var targetMorph = this.targetMorph,
                propConfig = this.propConfig;
            if (!selectedProp) selectedProp = this.availableItems[0];
            var control = this.view.addMorph(__varRecorder__$8.part(this.dynamicPropertyComponent, {
              viewModel: {
                targetMorph: targetMorph,
                propConfig: propConfig
              }
            }));
            this.view.layout.setResizePolicyFor(control, {
              height: "fixed",
              width: "fill"
            });
            control.choose(selectedProp, reset, applyDefault);

            __varRecorder__$8.once(control.viewModel, "remove", this, "deactivate");

            __varRecorder__$8.epiConnect(control.viewModel, "selectedProp", this, "refreshItemLists");

            this.refreshItemLists();
          }
        }, {
          key: "activate",
          value: function BodyControlModel_activate_() {
            this.view.layout = this.view.layout["with"]({
              padding: __varRecorder__$8.rect(0, 10, 0, 10)
            });
            this.view.master.setState(null);
            this.addDynamicProperty(null, false);
          }
        }, {
          key: "deactivate",
          value: function BodyControlModel_deactivate_() {
            this.refreshItemLists();
            this.dynamicControls.forEach(function (ctr) {
              return ctr.closePopup();
            });

            if (this.dynamicControls.length > 0) {
              this.view.master = this.activeSectionComponent;
              return;
            }

            this.view.layout = this.view.layout["with"]({
              padding: __varRecorder__$8.rect(0, 10, 0, 0)
            });
            this.view.master.setState("inactive");
          }
        }], [{
          key: Symbol["for"]("__LivelyClassName__"),
          get: function get() {
            return "BodyControlModel";
          }
        }, {
          key: "properties",
          get: function get() {
            return {
              targetMorph: {},
              dynamicPropertyComponent: {
                isComponent: true,
                get: function get() {
                  return this.getProperty("dynamicPropertyComponent") || __varRecorder__$8.DynamicProperty;
                }
              },
              activeSectionComponent: {
                isComponent: true,
                get: function get() {
                  return this.getProperty("activeSectionComponent") || __varRecorder__$8.PropertySection;
                }
              },
              propConfig: {
                get: function get() {
                  return this.getProperty("propConfig") || __varRecorder__$8.PROP_CONFIG;
                }
              },
              availableItems: {
                derived: true,
                get: function get() {
                  var res = __varRecorder__$8.arr.withoutAll(Object.keys(this.propConfig), this.dynamicControls.map(function (m) {
                    return m.selectedProp;
                  }));

                  if (!res.includes("Drop shadow") || !res.includes("Inner shadow")) {
                    return __varRecorder__$8.arr.withoutAll(res, ["Drop shadow", "Inner shadow"]);
                  }

                  return res;
                }
              },
              dynamicControls: {
                derived: true,
                get: function get() {
                  var _this$view;

                  return ((_this$view = this.view) === null || _this$view === void 0 ? void 0 : _this$view.submorphs.filter(function (m) {
                    return m.isControl;
                  })) || [];
                }
              }
            };
          }
        }], __lively_classholder__, {
          pathInPackage: function pathInPackage() {
            return "./studio/controls/body.cp.js";
          },
          unsubscribeFromToplevelDefinitionChanges: function unsubscribeFromToplevelDefinitionChanges() {
            return function () {};
          },
          subscribeToToplevelDefinitionChanges: function subscribeToToplevelDefinitionChanges() {
            return function () {};
          },
          "package": function _package() {
            return {
              name: "lively.ide",
              version: "0.1.0"
            };
          }
        }, {
          start: 673,
          end: 6500
        });
      }(__varRecorder__$8.PropertySectionModel);
      __varRecorder__$8.BodyControlModel = BodyControlModel;
      __varRecorder__$8.BodyControlModel = BodyControlModel;
      var DynamicPropertyModel = function (superclass) {
        var __lively_classholder__ = lively.FreezerRuntime.recorderFor("lively.ide/studio/controls/body.cp.js");

        var __lively_class__ = __lively_classholder__.hasOwnProperty("DynamicPropertyModel") && typeof __lively_classholder__.DynamicPropertyModel === "function" ? __lively_classholder__.DynamicPropertyModel : __lively_classholder__.DynamicPropertyModel = function DynamicPropertyModel(__first_arg__) {
          if (__first_arg__ && __first_arg__[Symbol["for"]("lively-instance-restorer")]) ; else {
            return this[Symbol["for"]("lively-instance-initialize")].apply(this, arguments);
          }
        };

        return initializeClass(__lively_class__, superclass, [{
          key: "choose",
          value: function DynamicPropertyModel_choose_(prop) {
            var _this2 = this;

            var resetValue = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : true;
            var applyDefault = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : false;

            __varRecorder__$8.noUpdate(function () {
              _this2.ui.effectSelector.selection = prop;
            });

            this.selectProperty(resetValue, applyDefault);
          }
        }, {
          key: "chooseDefault",
          value: function DynamicPropertyModel_chooseDefault_() {
            this.choose(this.ui.effectSelector.items[0].value);
          }
        }, {
          key: "selectProperty",
          value: function DynamicPropertyModel_selectProperty_() {
            var resetValue = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : false;
            var applyDefault = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : false;
            var effectSelector = this.ui.effectSelector;

            if (resetValue && this.selectedProp && this.selectedProp !== effectSelector.selection) {
              this.resetProperty();
            }

            this.selectedProp = effectSelector.selection;
            if (applyDefault) this.applyDefault();
          }
        }, {
          key: "applyDefault",
          value: function DynamicPropertyModel_applyDefault_() {
            this.targetMorph[this.accessor] = __varRecorder__$8.PROP_CONFIG[this.selectedProp].defaultValue;
          }
        }, {
          key: "refreshItems",
          value: function DynamicPropertyModel_refreshItems_(openItems) {
            var _this3 = this;

            var effectSelector = this.ui.effectSelector;
            var availableItems = [this.selectedProp].concat(_toConsumableArray(openItems));

            if (["Drop shadow", "Inner shadow"].includes(this.selectedProp)) {
              availableItems = __varRecorder__$8.arr.uniq(["Drop shadow", "Inner shadow"].concat(availableItems));
            }

            effectSelector.items = __varRecorder__$8.arr.compact(availableItems);

            __varRecorder__$8.noUpdate(function () {
              effectSelector.selection = _this3.selectedProp;
            });
          }
        }, {
          key: "resetProperty",
          value: function DynamicPropertyModel_resetProperty_() {
            var _this4 = this;

            this.targetMorph.withMetaDo({
              reconcileChanges: true
            }, function () {
              _this4.targetMorph[_this4.accessor] = __varRecorder__$8.PROP_CONFIG[_this4.selectedProp].resetValue;
            });
          }
        }, {
          key: "remove",
          value: function DynamicPropertyModel_remove_() {
            this.view.remove();
            this.resetProperty();
          }
        }, {
          key: "togglePopup",
          value: function DynamicPropertyModel_togglePopup_() {
            this.popup ? this.closePopup() : this.openPopup();
          }
        }, {
          key: "getInitPopupProps",
          value: function DynamicPropertyModel_getInitPopupProps_() {
            return __varRecorder__$8.PROP_CONFIG[this.selectedProp].defaultModelProps(this.targetMorph);
          }
        }, {
          key: "confirm",
          value: function DynamicPropertyModel_confirm_(v) {
            var _this5 = this;

            this.view.withMetaDo({
              reconcileChanges: true
            }, function () {
              _this5.targetMorph[_this5.accessor] = v;
            });
          }
        }, {
          key: "openPopup",
          value: function DynamicPropertyModel_openPopup_() {
            this.view.fill = __varRecorder__$8.Color.gray.withA(0.3);

            var p = this.popup = __varRecorder__$8.part(this.popupComponent, {
              viewModel: this.getInitPopupProps()
            }).openInWorld();

            p.env.forceUpdate(p);
            p.topRight = this.view.globalBounds().topLeft();
            p.topLeft = this.world().visibleBounds().translateForInclusion(p.globalBounds()).topLeft();

            __varRecorder__$8.once(p, "remove", this, "closePopup");

            __varRecorder__$8.epiConnect(p.viewModel, "value", this, "confirm");
          }
        }, {
          key: "closePopup",
          value: function DynamicPropertyModel_closePopup_() {
            this.view.fill = __varRecorder__$8.Color.transparent;
            if (!this.popup) return;
            this.popup.remove();
            this.popup = null;
          }
        }], [{
          key: Symbol["for"]("__LivelyClassName__"),
          get: function get() {
            return "DynamicPropertyModel";
          }
        }, {
          key: "properties",
          get: function get() {
            return {
              targetMorph: {},
              selectedProp: {
                defaultValue: "Opacity"
              },
              accessor: {
                get: function get() {
                  return this.propConfig[this.selectedProp].accessor;
                }
              },
              propConfig: {
                serialize: false,
                get: function get() {
                  return this.getProperty("propConfig") || __varRecorder__$8.PROP_CONFIG;
                }
              },
              popupComponent: {
                readOnly: true,
                serialize: false,
                get: function get() {
                  return this.propConfig[this.selectedProp].popupComponent;
                }
              },
              isControl: {
                get: function get() {
                  return true;
                }
              },
              expose: {
                get: function get() {
                  return ["refreshItems", "chooseDefault", "isControl", "selectedProp", "choose", "closePopup", "applyDefault"];
                }
              },
              bindings: {
                get: function get() {
                  return [{
                    model: "effect selector",
                    signal: "selection",
                    handler: "selectProperty",
                    updated: function updated($upd) {
                      return $upd(true, true);
                    }
                  }, {
                    target: "open popup",
                    signal: "onMouseDown",
                    handler: "togglePopup"
                  }, {
                    target: "remove",
                    signal: "onMouseDown",
                    handler: "remove"
                  }];
                }
              }
            };
          }
        }], __lively_classholder__, {
          pathInPackage: function pathInPackage() {
            return "./studio/controls/body.cp.js";
          },
          unsubscribeFromToplevelDefinitionChanges: function unsubscribeFromToplevelDefinitionChanges() {
            return function () {};
          },
          subscribeToToplevelDefinitionChanges: function subscribeToToplevelDefinitionChanges() {
            return function () {};
          },
          "package": function _package() {
            return {
              name: "lively.ide",
              version: "0.1.0"
            };
          }
        }, {
          start: 6687,
          end: 12953
        });
      }(__varRecorder__$8.ViewModel);
      __varRecorder__$8.DynamicPropertyModel = DynamicPropertyModel;
      __varRecorder__$8.DynamicPropertyModel = DynamicPropertyModel;
      __varRecorder__$8.BodyControl = __varRecorder__$8.component["for"](function () {
        return __varRecorder__$8.component(__varRecorder__$8.PropertySection, {
          name: "body control",
          defaultViewModel: __varRecorder__$8.BodyControlModel,
          submorphs: [{
            name: "h floater",
            submorphs: [{
              name: "section headline",
              textAndAttributes: ["Effects", null]
            }]
          }]
        });
      }, {
        module: "lively.ide/studio/controls/body.cp.js",
        "export": "BodyControl",
        range: {
          start: 13037,
          end: 13288
        }
      }, __varRecorder__$8.BodyControl);
      __varRecorder__$8.PROP_CONFIG = {
        "Drop shadow": {
          accessor: "dropShadow",
          defaultModelProps: function defaultModelProps(target) {
            var v = target.dropShadow;
            var opts = {
              fastShadow: v && v.fast,
              insetShadow: false
            };
            if (v) opts.shadowValue = v;
            return opts;
          },
          popupComponent: __varRecorder__$8.ShadowPopup,
          resetValue: null,
          defaultValue: new __varRecorder__$8.ShadowObject({
            color: __varRecorder__$8.Color.black,
            blur: 15
          })
        },
        "Inner shadow": {
          accessor: "dropShadow",
          defaultModelProps: function defaultModelProps(target) {
            var v = target.dropShadow;
            var opts = {
              fastShadow: v && v.fast,
              insetShadow: true
            };
            if (v) opts.shadowValue = v;
            return opts;
          },
          popupComponent: __varRecorder__$8.InsetShadowPopup,
          resetValue: null,
          defaultValue: new __varRecorder__$8.ShadowObject({
            color: __varRecorder__$8.Color.black,
            inset: true,
            blur: 15
          })
        },
        Opacity: {
          accessor: "opacity",
          defaultModelProps: function defaultModelProps(target) {
            return {
              value: target.opacity
            };
          },
          popupComponent: __varRecorder__$8.OpacityPopup,
          resetValue: 1,
          defaultValue: 1
        },
        Blur: {
          accessor: "blur",
          defaultModelProps: function defaultModelProps(target) {
            return {
              value: target.blur
            };
          },
          popupComponent: __varRecorder__$8.BlurPopup,
          resetValue: 0,
          defaultValue: 1
        },
        Cursor: {
          accessor: "nativeCursor",
          popupComponent: __varRecorder__$8.CursorPopup,
          resetValue: "auto",
          defaultModelProps: function defaultModelProps(target) {
            return {
              selection: target.nativeCursor
            };
          },
          defaultValue: "pointer"
        },
        Tilted: {
          accessor: "tilted",
          popupComponent: __varRecorder__$8.TiltPopup,
          resetValue: 0,
          defaultModelProps: function defaultModelProps(target) {
            return {
              value: target.tilted
            };
          },
          defaultValue: 0.5
        },
        Flipped: {
          accessor: "flipped",
          popupComponent: __varRecorder__$8.FlipPopup,
          resetValue: 0,
          defaultModelProps: function defaultModelProps(target) {
            return {
              value: target.flipped
            };
          },
          defaultValue: 0.5
        }
      };
      __varRecorder__$8.DynamicProperty = __varRecorder__$8.component["for"](function () {
        return __varRecorder__$8.component({
          defaultViewModel: __varRecorder__$8.DynamicPropertyModel,
          name: "dynamic property",
          layout: new __varRecorder__$8.TilingLayout({
            axisAlign: "center",
            justifySubmorphs: "spaced",
            padding: __varRecorder__$8.rect(10, 0, 0, 0),
            resizePolicies: [["effect selector", {
              height: "fixed",
              width: "fill"
            }]],
            spacing: 5
          }),
          fill: __varRecorder__$8.Color.rgba(255, 255, 255, 0),
          extent: __varRecorder__$8.pt(183.2, 30),
          submorphs: [__varRecorder__$8.part(__varRecorder__$8.PropertyLabel, {
            name: "open popup",
            tooltip: "Open Property Popup",
            padding: __varRecorder__$8.rect(4, 0, 0, 0),
            master: {
              auto: __varRecorder__$8.PropertyLabel,
              hover: __varRecorder__$8.PropertyLabelHovered,
              click: __varRecorder__$8.PropertyLabelActive
            }
          }), __varRecorder__$8.part(__varRecorder__$8.EnumSelector, {
            name: "effect selector",
            clipMode: "hidden",
            viewModel: {
              listAlign: "selection",
              openListInWorld: true,
              listMaster: __varRecorder__$8.DarkThemeList,
              listHeight: 1000,
              items: Object.keys(__varRecorder__$8.PROP_CONFIG)
            }
          }), __varRecorder__$8.part(__varRecorder__$8.RemoveButton, {
            master: {
              auto: __varRecorder__$8.RemoveButton,
              hover: __varRecorder__$8.PropertyLabelHovered
            },
            name: "remove",
            tooltip: "Remove Property/Effect",
            padding: __varRecorder__$8.rect(4, 4, 0, 0)
          })]
        });
      }, {
        module: "lively.ide/studio/controls/body.cp.js",
        "export": "DynamicProperty",
        range: {
          start: 15238,
          end: 16381
        }
      }, __varRecorder__$8.DynamicProperty);
      var BodyControl = __varRecorder__$8.BodyControl;
      var DynamicProperty = __varRecorder__$8.DynamicProperty;
      __varRecorder__$8.BodyControl = BodyControl;
      __varRecorder__$8.DynamicProperty = DynamicProperty;

      var __varRecorder__$7 = lively.FreezerRuntime.recorderFor("lively.ide/studio/controls/embedding.cp.js");
      __varRecorder__$7.ViewModel = ViewModel;
      __varRecorder__$7.TilingLayout = TilingLayout;
      __varRecorder__$7.add = add;
      __varRecorder__$7.without = without;
      __varRecorder__$7.Icon = Icon;
      __varRecorder__$7.part = part;
      __varRecorder__$7.component = component;
      __varRecorder__$7.pt = pt;
      __varRecorder__$7.Color = Color;
      __varRecorder__$7.EnumSelector = EnumSelector;
      __varRecorder__$7.DarkThemeList = DarkThemeList;
      __varRecorder__$7.PropertySection = PropertySection;
      var EmbeddingControlModel = function (superclass) {
        var __lively_classholder__ = lively.FreezerRuntime.recorderFor("lively.ide/studio/controls/embedding.cp.js");

        var __lively_class__ = __lively_classholder__.hasOwnProperty("EmbeddingControlModel") && typeof __lively_classholder__.EmbeddingControlModel === "function" ? __lively_classholder__.EmbeddingControlModel : __lively_classholder__.EmbeddingControlModel = function EmbeddingControlModel(__first_arg__) {
          if (__first_arg__ && __first_arg__[Symbol["for"]("lively-instance-restorer")]) ; else {
            return this[Symbol["for"]("lively-instance-initialize")].apply(this, arguments);
          }
        };

        return initializeClass(__lively_class__, superclass, [{
          key: "changeMorphEmbedding",
          value: function EmbeddingControlModel_changeMorphEmbedding_(embedding) {
            var targetMorph = this.targetMorph;
            var textMorph = targetMorph.owner;

            if (embedding === "plain") {
              var charPos = targetMorph.position;
              textMorph.removeMorph(targetMorph);
              textMorph.addMorph(targetMorph);
              targetMorph.position = charPos;
            }

            if (embedding === "no-wrap") {
              var textPos = textMorph.textPositionFromPoint(targetMorph.position);
              textMorph.insertText([targetMorph, null], textPos);
            }
          }
        }, {
          key: "attach",
          value: function EmbeddingControlModel_attach_(view) {
            initializeClass._get(Object.getPrototypeOf(__lively_class__.prototype), "attach", this).call(this, view);
          }
        }, {
          key: "focusOn",
          value: function EmbeddingControlModel_focusOn_(targetMorph) {
            var _this = this;

            var selector = this.ui.morphEmbeddingSelector;
            this.targetMorph = targetMorph;
            if (!this.targetMorph || !this.targetMorph.owner.isText) return;
            this.withoutBindingsDo(function () {
              if (_this.targetMorph.owner.embeddedMorphs.includes(targetMorph)) selector.selection = "no-wrap";else if (_this.targetMorph.owner.displacingMorphs.includes(targetMorph)) selector.selection = "wrap";else selector.selection = "plain";
            });
          }
        }], [{
          key: Symbol["for"]("__LivelyClassName__"),
          get: function get() {
            return "EmbeddingControlModel";
          }
        }, {
          key: "properties",
          get: function get() {
            return {
              targetMorph: {},
              bindings: {
                get: function get() {
                  return [{
                    model: "morph embedding selector",
                    signal: "selection",
                    handler: "changeMorphEmbedding"
                  }];
                }
              }
            };
          }
        }], __lively_classholder__, {
          pathInPackage: function pathInPackage() {
            return "./studio/controls/embedding.cp.js";
          },
          unsubscribeFromToplevelDefinitionChanges: function unsubscribeFromToplevelDefinitionChanges() {
            return function () {};
          },
          subscribeToToplevelDefinitionChanges: function subscribeToToplevelDefinitionChanges() {
            return function () {};
          },
          "package": function _package() {
            return {
              name: "lively.ide",
              version: "0.1.0"
            };
          }
        }, {
          start: 261,
          end: 1617
        });
      }(__varRecorder__$7.ViewModel);
      __varRecorder__$7.EmbeddingControlModel = EmbeddingControlModel;
      __varRecorder__$7.EmbeddingControlModel = EmbeddingControlModel;
      __varRecorder__$7.EmbeddingControl = __varRecorder__$7.component["for"](function () {
        return __varRecorder__$7.component(__varRecorder__$7.PropertySection, {
          defaultViewModel: __varRecorder__$7.EmbeddingControlModel,
          name: "embedding control",
          extent: __varRecorder__$7.pt(250, 121),
          submorphs: [{
            name: "h floater",
            submorphs: [__varRecorder__$7.without("add button"), {
              name: "section headline",
              textAndAttributes: ["Content Embeddings", null]
            }]
          }, __varRecorder__$7.add({
            name: "elements wrapper",
            extent: __varRecorder__$7.pt(250, 30),
            fill: __varRecorder__$7.Color.transparent,
            layout: new __varRecorder__$7.TilingLayout({
              axisAlign: "center",
              padding: 20
            }),
            submorphs: [__varRecorder__$7.part(__varRecorder__$7.EnumSelector, {
              name: "morph embedding selector",
              extent: __varRecorder__$7.pt(202.2, 23.3),
              tooltip: "Choose Embedding of Contents",
              viewModel: {
                listAlign: "selection",
                openListInWorld: true,
                listMaster: __varRecorder__$7.DarkThemeList,
                items: [{
                  isListItem: true,
                  label: __varRecorder__$7.Icon.textAttribute("ghost", {
                    lineHeight: 1.4,
                    paddingRight: "3px"
                  }).concat([" Floating Above Text", null]),
                  value: "plain"
                }, {
                  isListItem: true,
                  label: __varRecorder__$7.Icon.textAttribute("envelope", {
                    lineHeight: 1.4
                  }).concat([" Treated as Character", null]),
                  value: "no-wrap"
                }]
              },
              submorphs: [{
                name: "label",
                fontSize: 12,
                padding: 7
              }]
            })]
          })]
        });
      }, {
        module: "lively.ide/studio/controls/embedding.cp.js",
        "export": "EmbeddingControl",
        range: {
          start: 1624,
          end: 3223
        }
      }, __varRecorder__$7.EmbeddingControl);
      var EmbeddingControl = __varRecorder__$7.EmbeddingControl;
      __varRecorder__$7.EmbeddingControl = EmbeddingControl;

      var __varRecorder__$6 = lively.FreezerRuntime.recorderFor("lively.ide/studio/component-browser.cp.js");
      __varRecorder__$6.commonjsHelpers = commonjsHelpers;
      __varRecorder__$6.pt = pt;
      __varRecorder__$6.Color = Color;
      __varRecorder__$6.rect = rect;
      __varRecorder__$6.TilingLayout = TilingLayout;
      __varRecorder__$6.morph = morph;
      __varRecorder__$6.config = config;
      __varRecorder__$6.easings = easings;
      __varRecorder__$6.MorphicDB = MorphicDB;
      __varRecorder__$6.Icon = Icon;
      __varRecorder__$6.Morph = Morph;
      __varRecorder__$6.Label = Label;
      __varRecorder__$6.ShadowObject = ShadowObject;
      __varRecorder__$6.ViewModel = ViewModel;
      __varRecorder__$6.add = add;
      __varRecorder__$6.part = part;
      __varRecorder__$6.component = component;
      __varRecorder__$6.Project = Project;
      __varRecorder__$6.isModuleLoaded = isModuleLoaded;
      __varRecorder__$6.module = module$1;
      __varRecorder__$6.InputLineDefault = InputLineDefault;
      __varRecorder__$6.MullerColumnView = MullerColumnView;
      __varRecorder__$6.ColumnListDark = ColumnListDark;
      __varRecorder__$6.ColumnListDefault = ColumnListDefault;
      __varRecorder__$6.TreeData = TreeData;
      __varRecorder__$6.LabeledCheckbox = LabeledCheckbox;
      __varRecorder__$6.LabeledCheckboxLight = LabeledCheckboxLight;
      __varRecorder__$6.arr = arr;
      __varRecorder__$6.promise = promise;
      __varRecorder__$6.num = num;
      __varRecorder__$6.date = date;
      __varRecorder__$6.string = string;
      __varRecorder__$6.fun = fun;
      __varRecorder__$6.resource = resource;
      __varRecorder__$6.renderMorphToDataURI = renderMorphToDataURI;
      __varRecorder__$6.localInterface = localInterface;
      __varRecorder__$6.once = once;
      __varRecorder__$6.noUpdate = noUpdate;
      __varRecorder__$6.adoptObject = adoptObject;
      __varRecorder__$6.DropDownList = DropDownList;
      __varRecorder__$6.DarkDropDownList = DarkDropDownList;
      __varRecorder__$6.withAllViewModelsDo = withAllViewModelsDo;
      __varRecorder__$6.ButtonDarkDefault = ButtonDarkDefault;
      __varRecorder__$6.SystemButton = SystemButton;
      __varRecorder__$6.Text = Text;
      __varRecorder__$6.COLORS = COLORS;
      __varRecorder__$6.Spinner = Spinner;
      __varRecorder__$6.DarkPopupWindow = DarkPopupWindow;
      __varRecorder__$6.InteractiveComponentDescriptor = InteractiveComponentDescriptor;
      __varRecorder__$6.PopupWindow = PopupWindow;
      __varRecorder__$6.SystemList = SystemList;
      __varRecorder__$6.joinPath = joinPath;
      __varRecorder__$6.runCommand = runCommand$1;
      __varRecorder__$6.ShellClientResource = ShellClientResource;
      __varRecorder__$6.StatusMessageError = StatusMessageError;
      __varRecorder__$6.StatusMessageConfirm = StatusMessageConfirm;

      (function (superclass) {
        var __lively_classholder__ = lively.FreezerRuntime.recorderFor("lively.ide/studio/component-browser.cp.js");

        var __lively_class__ = __lively_classholder__.hasOwnProperty("MasterComponentTreeData") && typeof __lively_classholder__.MasterComponentTreeData === "function" ? __lively_classholder__.MasterComponentTreeData : __lively_classholder__.MasterComponentTreeData = function MasterComponentTreeData(__first_arg__) {
          if (__first_arg__ && __first_arg__[Symbol["for"]("lively-instance-restorer")]) ; else {
            return this[Symbol["for"]("lively-instance-initialize")].apply(this, arguments);
          }
        };

        return initializeClass(__lively_class__, superclass, [{
          key: Symbol["for"]("lively-instance-initialize"),
          value: function MasterComponentTreeData_initialize_(props) {
            var _this;

            _this = initializeClass._get(Object.getPrototypeOf(__lively_class__.prototype), Symbol["for"]("lively-instance-initialize"), this).call(this, props);
            this.ensurePopularComponentsCollection();
            return _this;
          }
        }, {
          key: "isCollapsed",
          value: function MasterComponentTreeData_isCollapsed_(_ref) {
            var isCollapsed = _ref.isCollapsed;
            return isCollapsed;
          }
        }, {
          key: "collapse",
          value: function () {
            var _MasterComponentTreeData_collapse_ = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee(node, bool) {
              return regeneratorRuntime.wrap(function _callee$(_context) {
                while (1) {
                  switch (_context.prev = _context.next) {
                    case 0:
                      if (!(node === this.root)) {
                        _context.next = 5;
                        break;
                      }

                      bool = false;
                      _context.next = 4;
                      return this.listAllComponentCollections();

                    case 4:
                      node.subNodes = _context.sent;

                    case 5:
                      if (!(!bool && node.type === "package loader")) {
                        _context.next = 9;
                        break;
                      }

                      this.columnView.reset();
                      this.interactivelyImportProject();
                      return _context.abrupt("return");

                    case 9:
                      node.isCollapsed = bool;
                      node.isDirty = true;

                      if (bool) {
                        _context.next = 25;
                        break;
                      }

                      if (!(node.type === "package")) {
                        _context.next = 16;
                        break;
                      }

                      _context.next = 15;
                      return this.listComponentFilesInPackage(node.url);

                    case 15:
                      node.subNodes = _context.sent;

                    case 16:
                      if (node.children) {
                        node.children.forEach(function (child) {
                          child.isDeclaration = true;
                          child.isCollapsed = true;
                          child.parent = node;
                        });
                        node.subNodes = node.children;
                      }

                      if (!(node.type === "directory")) {
                        _context.next = 21;
                        break;
                      }

                      _context.next = 20;
                      return this.listComponentFilesInDir(node.url);

                    case 20:
                      node.subNodes = _context.sent;

                    case 21:
                      if (!(node.type === "cp.js")) {
                        _context.next = 25;
                        break;
                      }

                      _context.next = 24;
                      return this.listModuleScope(node.url);

                    case 24:
                      node.subNodes = _context.sent;

                    case 25:
                    case "end":
                      return _context.stop();
                  }
                }
              }, _callee, this);
            }));

            function MasterComponentTreeData_collapse_(_x, _x2) {
              return _MasterComponentTreeData_collapse_.apply(this, arguments);
            }

            return MasterComponentTreeData_collapse_;
          }()
        }, {
          key: "getChildren",
          value: function MasterComponentTreeData_getChildren_(parent) {
            var _this2 = this;

            var subNodes = parent.subNodes;
            var result = subNodes || [];
            result && result.forEach(function (n) {
              return _this2.parentMap.set(n, parent);
            });
            return result;
          }
        }, {
          key: "isLeaf",
          value: function MasterComponentTreeData_isLeaf_(_ref2) {
            var type = _ref2.type,
                isDeclaration = _ref2.isDeclaration,
                children = _ref2.children;
            if (isDeclaration) return !children;
            return !["package", "directory", "cp.js"].includes(type);
          }
        }, {
          key: "display",
          value: function MasterComponentTreeData_display_(node) {
            var type = node.type,
                pkg = node.pkg,
                isCollapsed = node.isCollapsed,
                componentObject = node.componentObject,
                lastModified = node.lastModified,
                size = node.size,
                name = node.name,
                url = node.url;
            var isSelected = this.columnView.isSelected(node);

            if (type === "package") {
              return this.displayPackage(pkg, isSelected);
            } else if (type === "package loader") {
              return this.renderPackageLoader();
            } else if (componentObject) {
              return this.displayComponent(componentObject, isSelected);
            } else {
              var col1Size = 19;
              var datePrinted = lastModified ? __varRecorder__$6.date.format(lastModified, "yyyy-mm-dd HH:MM:ss") : " ".repeat(col1Size);
              var sizePrinted = size ? __varRecorder__$6.num.humanReadableByteSize(size) : "";
              var displayedName;

              switch (type) {
                case "cp.js":
                  if (!node.isLoaded && isSelected) node.isLoaded = true;
                  displayedName = this.displayComponentFile(name, isSelected, node.isLoaded, url);
                  break;

                case "directory":
                  displayedName = this.displayDirectory(name, !isCollapsed);
                  break;
              }

              return [].concat(_toConsumableArray(displayedName), ["\t".concat(sizePrinted, " ").concat(datePrinted), {
                paddingTop: "3px",
                opacity: 0.5,
                fontSize: "70%",
                textStyleClasses: ["annotation"]
              }]);
            }
          }
        }, {
          key: "renderPackageLoader",
          value: function MasterComponentTreeData_renderPackageLoader_() {
            return [].concat(_toConsumableArray(__varRecorder__$6.Icon.textAttribute("ti-square-rounded-arrow-right", {
              fontColor: __varRecorder__$6.Color.darkGray
            })), [" Import project...", {
              fontColor: __varRecorder__$6.Color.darkGray,
              fontWeight: "bold",
              fontStyle: "italic",
              nativeCursor: "pointer"
            }]);
          }
        }, {
          key: "columnView",
          get: function get() {
            return this.root.browser.models.componentFilesView;
          }
        }, {
          key: "systemInterface",
          get: function get() {
            return __varRecorder__$6.localInterface;
          }
        }, {
          key: "displayComponent",
          value: function MasterComponentTreeData_displayComponent_(componentObj, isSelected) {
            if (isSelected && !this.root.browser._pauseUpdates) {
              this.root.browser.selectComponent(componentObj, true);
            }

            return [].concat(_toConsumableArray(__varRecorder__$6.Icon.textAttribute("cube")), [" " + __varRecorder__$6.string.truncate(componentObj.componentName || "[PARSE_ERROR]", 18, "\u2026"), null]);
          }
        }, {
          key: "displayPackage",
          value: function MasterComponentTreeData_displayPackage_(pkg, isSelected) {
            var _$world$openedProject;

            if (isSelected && !this.root.browser._pauseUpdates) {
              this.root.browser.reset();
            }

            var isOpenedProject = pkg.url === ((_$world$openedProject = $world.openedProject) === null || _$world$openedProject === void 0 ? void 0 : _$world$openedProject["package"].url);
            return [].concat(_toConsumableArray(__varRecorder__$6.Icon.textAttribute("cubes")), [" " + __varRecorder__$6.string.truncate(pkg.name, 26, "\u2026"), {
              fontWeight: isOpenedProject ? "bold" : "normal",
              fontStyle: pkg.kind === "git" && !isOpenedProject ? "italic" : "normal"
            }, "\t".concat(pkg.kind), {
              paddingTop: "3px",
              opacity: 0.5,
              fontSize: "70%",
              textStyleClasses: ["annotation"]
            }]);
          }
        }, {
          key: "displayDirectory",
          value: function MasterComponentTreeData_displayDirectory_(dir, isOpen) {
            if (isOpen && !this.root.browser._pauseUpdates) {
              this.root.browser.reset();
            }

            return [].concat(_toConsumableArray(__varRecorder__$6.Icon.textAttribute(isOpen ? "folder-open" : "folder", {
              textStyleClasses: ["far"]
            })), [" " + dir, null]);
          }
        }, {
          key: "displayComponentFile",
          value: function MasterComponentTreeData_displayComponentFile_(modUrl, isSelected, isLoaded, url) {
            var _this3 = this;

            if (isSelected && !this.root.browser._pauseUpdates) {
              var _$world$openedProject2;

              var mod = __varRecorder__$6.module(url);

              var pkg = mod["package"]();
              var isOpenedProject = pkg.url === ((_$world$openedProject2 = $world.openedProject) === null || _$world$openedProject2 === void 0 ? void 0 : _$world$openedProject2["package"].url);
              modUrl = __varRecorder__$6.arr.last(modUrl.split("--"));
              this.getComponentsInModule(url).then(function (components) {
                _this3.root.browser.showComponentsInFile(modUrl, components, isOpenedProject);
              });
            }

            return [].concat(_toConsumableArray(__varRecorder__$6.Icon.textAttribute("shapes", {
              fontColor: isSelected ? __varRecorder__$6.Color.white : __varRecorder__$6.COLORS.cp,
              opacity: isLoaded ? 1 : 0.5
            })), [" " + __varRecorder__$6.string.truncate(modUrl.replace(".cp.js", ""), 24, "\u2026"), null]);
          }
        }, {
          key: "getComponentsInModule",
          value: function () {
            var _MasterComponentTreeData_getComponentsInModule_ = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee2(moduleName) {
              return regeneratorRuntime.wrap(function _callee2$(_context2) {
                while (1) {
                  switch (_context2.prev = _context2.next) {
                    case 0:
                      _context2.next = 2;
                      return this.root.browser.getComponentsInModule(moduleName);

                    case 2:
                      return _context2.abrupt("return", _context2.sent);

                    case 3:
                    case "end":
                      return _context2.stop();
                  }
                }
              }, _callee2, this);
            }));

            function MasterComponentTreeData_getComponentsInModule_(_x3) {
              return _MasterComponentTreeData_getComponentsInModule_.apply(this, arguments);
            }

            return MasterComponentTreeData_getComponentsInModule_;
          }()
        }, {
          key: "listModuleScope",
          value: function () {
            var _MasterComponentTreeData_listModuleScope_ = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee3(moduleName) {
              var exportedComponents;
              return regeneratorRuntime.wrap(function _callee3$(_context3) {
                while (1) {
                  switch (_context3.prev = _context3.next) {
                    case 0:
                      _context3.next = 2;
                      return this.getComponentsInModule(moduleName);

                    case 2:
                      exportedComponents = _context3.sent;
                      return _context3.abrupt("return", exportedComponents.map(function (componentObject) {
                        return {
                          isCollapsed: true,
                          isDeclaration: true,
                          componentObject: componentObject
                        };
                      }));

                    case 4:
                    case "end":
                      return _context3.stop();
                  }
                }
              }, _callee3, this);
            }));

            function MasterComponentTreeData_listModuleScope_(_x4) {
              return _MasterComponentTreeData_listModuleScope_.apply(this, arguments);
            }

            return MasterComponentTreeData_listModuleScope_;
          }()
        }, {
          key: "interactivelyImportProject",
          value: function () {
            var _MasterComponentTreeData_interactivelyImportProject_ = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee5() {
              var _this4 = this;

              var availableProjects, notLoaded, win, _yield$$world$filtera, _yield$$world$filtera2, projectToLoad;

              return regeneratorRuntime.wrap(function _callee5$(_context5) {
                while (1) {
                  switch (_context5.prev = _context5.next) {
                    case 0:
                      _context5.next = 2;
                      return __varRecorder__$6.Project.listAvailableProjects();

                    case 2:
                      availableProjects = _context5.sent;
                      notLoaded = availableProjects.filter(function (proj) {
                        return !__varRecorder__$6.isModuleLoaded(__varRecorder__$6.joinPath(proj.url, proj.main || "index.js"));
                      }).map(function (proj) {
                        return {
                          isListItem: true,
                          value: proj,
                          tooltip: "".concat(proj.name, " by ").concat(proj.projectRepoOwner, " at version ").concat(proj.version),
                          label: [proj.name, {}, proj.version, {
                            paddingLeft: "5px",
                            fontSize: "70%",
                            textStyleClasses: ["truncated-text", "annotation"]
                          }]
                        };
                      });
                      win = this.root.browser.view.getWindow();
                      _context5.next = 7;
                      return $world.filterableListPrompt("Select project to import", notLoaded, {
                        requester: win,
                        multiSelect: false
                      });

                    case 7:
                      _yield$$world$filtera = _context5.sent;
                      _yield$$world$filtera2 = _slicedToArray(_yield$$world$filtera.selected, 1);
                      projectToLoad = _yield$$world$filtera2[0];

                      if (!projectToLoad) {
                        _context5.next = 13;
                        break;
                      }

                      _context5.next = 13;
                      return $world.withLoadingIndicatorDo( /*#__PURE__*/_asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee4() {
                        return regeneratorRuntime.wrap(function _callee4$(_context4) {
                          while (1) {
                            switch (_context4.prev = _context4.next) {
                              case 0:
                                _context4.next = 2;
                                return __varRecorder__$6.Project.loadProject(projectToLoad.name, projectToLoad.projectRepoOwner, true);

                              case 2:
                                _context4.next = 4;
                                return _this4.listAllComponentCollections();

                              case 4:
                                _this4.root.subNodes = _context4.sent;

                                _this4.columnView.refresh();

                              case 6:
                              case "end":
                                return _context4.stop();
                            }
                          }
                        }, _callee4);
                      })), win, "Importing project...");

                    case 13:
                    case "end":
                      return _context5.stop();
                  }
                }
              }, _callee5, this);
            }));

            function MasterComponentTreeData_interactivelyImportProject_() {
              return _MasterComponentTreeData_interactivelyImportProject_.apply(this, arguments);
            }

            return MasterComponentTreeData_interactivelyImportProject_;
          }()
        }, {
          key: "getCustomLocalProjects",
          value: function () {
            var _MasterComponentTreeData_getCustomLocalProjects_ = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee6() {
              return regeneratorRuntime.wrap(function _callee6$(_context6) {
                while (1) {
                  switch (_context6.prev = _context6.next) {
                    case 0:
                      _context6.next = 2;
                      return __varRecorder__$6.Project.listAvailableProjects();

                    case 2:
                      _context6.t0 = function (_ref4) {
                        var _ref4$main = _ref4.main,
                            main = _ref4$main === void 0 ? "index.js" : _ref4$main,
                            url = _ref4.url;
                        return __varRecorder__$6.isModuleLoaded(__varRecorder__$6.joinPath(url, main));
                      };

                      return _context6.abrupt("return", _context6.sent.filter(_context6.t0));

                    case 4:
                    case "end":
                      return _context6.stop();
                  }
                }
              }, _callee6);
            }));

            function MasterComponentTreeData_getCustomLocalProjects_() {
              return _MasterComponentTreeData_getCustomLocalProjects_.apply(this, arguments);
            }

            return MasterComponentTreeData_getCustomLocalProjects_;
          }()
        }, {
          key: "ensurePopularComponentsCollection",
          value: function () {
            var _MasterComponentTreeData_ensurePopularComponentsCollection_ = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee9() {
              var res;
              return regeneratorRuntime.wrap(function _callee9$(_context9) {
                while (1) {
                  switch (_context9.prev = _context9.next) {
                    case 0:
                      res = __varRecorder__$6.resource("local://VeryPopularComponents");
                      ["buttons", "list", "inputs"].map( /*#__PURE__*/function () {
                        var _ref5 = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee7(name) {
                          return regeneratorRuntime.wrap(function _callee7$(_context7) {
                            while (1) {
                              switch (_context7.prev = _context7.next) {
                                case 0:
                                  _context7.t0 = res.join(name + ".cp.js");
                                  _context7.next = 3;
                                  return System.decanonicalize("lively.components/".concat(name, ".cp.js"));

                                case 3:
                                  _context7.t1 = _context7.sent;
                                  _context7.t2 = "redirect -> " + _context7.t1;

                                  _context7.t0.write.call(_context7.t0, _context7.t2);

                                case 6:
                                case "end":
                                  return _context7.stop();
                              }
                            }
                          }, _callee7);
                        }));

                        return function (_x5) {
                          return _ref5.apply(this, arguments);
                        };
                      }());
                      ["value-widgets", "styling/color-picker"].map( /*#__PURE__*/function () {
                        var _ref6 = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee8(name) {
                          return regeneratorRuntime.wrap(function _callee8$(_context8) {
                            while (1) {
                              switch (_context8.prev = _context8.next) {
                                case 0:
                                  _context8.t0 = res.join(name + ".cp.js");
                                  _context8.next = 3;
                                  return System.decanonicalize("lively.ide/".concat(name, ".cp.js"));

                                case 3:
                                  _context8.t1 = _context8.sent;
                                  _context8.t2 = "redirect -> " + _context8.t1;

                                  _context8.t0.write.call(_context8.t0, _context8.t2);

                                case 6:
                                case "end":
                                  return _context8.stop();
                              }
                            }
                          }, _callee8);
                        }));

                        return function (_x6) {
                          return _ref6.apply(this, arguments);
                        };
                      }());

                    case 3:
                    case "end":
                      return _context9.stop();
                  }
                }
              }, _callee9);
            }));

            function MasterComponentTreeData_ensurePopularComponentsCollection_() {
              return _MasterComponentTreeData_ensurePopularComponentsCollection_.apply(this, arguments);
            }

            return MasterComponentTreeData_ensurePopularComponentsCollection_;
          }()
        }, {
          key: "getComponentCollections",
          value: function () {
            var _MasterComponentTreeData_getComponentCollections_ = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee10() {
              var _this5 = this;

              return regeneratorRuntime.wrap(function _callee10$(_context10) {
                while (1) {
                  switch (_context10.prev = _context10.next) {
                    case 0:
                      _context10.t0 = [];
                      _context10.t1 = _toConsumableArray;
                      _context10.next = 4;
                      return Promise.all(["lively.ide", "lively.components"].map(function (pkgName) {
                        return _this5.systemInterface.getPackage(pkgName);
                      }));

                    case 4:
                      _context10.t2 = _context10.sent;
                      _context10.t3 = (0, _context10.t1)(_context10.t2);
                      _context10.t4 = _toConsumableArray;
                      _context10.next = 9;
                      return this.getCustomLocalProjects();

                    case 9:
                      _context10.t5 = _context10.sent;
                      _context10.t6 = (0, _context10.t4)(_context10.t5);
                      _context10.t7 = [{
                        name: "Popular",
                        url: "local://VeryPopularComponents"
                      }];
                      return _context10.abrupt("return", _context10.t0.concat.call(_context10.t0, _context10.t3, _context10.t6, _context10.t7));

                    case 13:
                    case "end":
                      return _context10.stop();
                  }
                }
              }, _callee10, this);
            }));

            function MasterComponentTreeData_getComponentCollections_() {
              return _MasterComponentTreeData_getComponentCollections_.apply(this, arguments);
            }

            return MasterComponentTreeData_getComponentCollections_;
          }()
        }, {
          key: "listAllComponentCollections",
          value: function () {
            var _MasterComponentTreeData_listAllComponentCollections_ = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee11() {
              var coll;
              return regeneratorRuntime.wrap(function _callee11$(_context11) {
                while (1) {
                  switch (_context11.prev = _context11.next) {
                    case 0:
                      _context11.next = 2;
                      return this.getComponentCollections();

                    case 2:
                      coll = _context11.sent;
                      coll = __varRecorder__$6.arr.sortBy(coll.map(function (pkg) {
                        var _pkg$url;

                        var kind = "git";
                        if ((_pkg$url = pkg.url) === null || _pkg$url === void 0 ? void 0 : _pkg$url.startsWith("local")) kind = "local";
                        if (pkg.name.startsWith("lively")) kind = "core";
                        pkg.kind = kind;
                        return {
                          url: pkg.url + (pkg.url.endsWith("/") ? "" : "/"),
                          isCollapsed: true,
                          type: "package",
                          name: pkg.name,
                          tooltip: pkg.name,
                          pkg: pkg
                        };
                      }), function (_ref7) {
                        var pkg = _ref7.pkg;
                        return {
                          core: 2,
                          local: 1,
                          git: 3
                        }[pkg.kind];
                      });

                      if (!this.root.browser.selectionMode) {
                        coll.push({
                          type: "package loader",
                          isCollapsed: true,
                          tooltip: "Import additional project"
                        });
                      }

                      return _context11.abrupt("return", coll);

                    case 6:
                    case "end":
                      return _context11.stop();
                  }
                }
              }, _callee11, this);
            }));

            function MasterComponentTreeData_listAllComponentCollections_() {
              return _MasterComponentTreeData_listAllComponentCollections_.apply(this, arguments);
            }

            return MasterComponentTreeData_listAllComponentCollections_;
          }()
        }, {
          key: "listComponentFilesInPackage",
          value: function () {
            var _MasterComponentTreeData_listComponentFilesInPackage_ = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee12(pkg) {
              return regeneratorRuntime.wrap(function _callee12$(_context12) {
                while (1) {
                  switch (_context12.prev = _context12.next) {
                    case 0:
                      _context12.next = 2;
                      return this.listComponentFilesInDir(pkg);

                    case 2:
                      return _context12.abrupt("return", _context12.sent);

                    case 3:
                    case "end":
                      return _context12.stop();
                  }
                }
              }, _callee12, this);
            }));

            function MasterComponentTreeData_listComponentFilesInPackage_(_x7) {
              return _MasterComponentTreeData_listComponentFilesInPackage_.apply(this, arguments);
            }

            return MasterComponentTreeData_listComponentFilesInPackage_;
          }()
        }, {
          key: "getLoadedComponentFileUrls",
          value: function () {
            var _MasterComponentTreeData_getLoadedComponentFileUrls_ = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee13() {
              var selectedPkg, files, loadedModules;
              return regeneratorRuntime.wrap(function _callee13$(_context13) {
                while (1) {
                  switch (_context13.prev = _context13.next) {
                    case 0:
                      selectedPkg = this.root.subNodes.find(function (pkg) {
                        return !pkg.isCollapsed;
                      });

                      if (selectedPkg) {
                        _context13.next = 3;
                        break;
                      }

                      return _context13.abrupt("return", {});

                    case 3:
                      _context13.next = 5;
                      return __varRecorder__$6.resource(selectedPkg.url).dirList(1, {
                        exclude: function exclude(res) {
                          return !(res.url.endsWith(".cp.js") || res.isDirectory());
                        }
                      });

                    case 5:
                      files = _context13.sent;

                      if (!(selectedPkg.name !== "Popular")) {
                        _context13.next = 9;
                        break;
                      }

                      _context13.next = 9;
                      return this.systemInterface.getPackage(selectedPkg.url);

                    case 9:
                      loadedModules = {};
                      files.forEach(function (file) {
                        loadedModules[file.url] = file;
                      });
                      return _context13.abrupt("return", loadedModules);

                    case 12:
                    case "end":
                      return _context13.stop();
                  }
                }
              }, _callee13, this);
            }));

            function MasterComponentTreeData_getLoadedComponentFileUrls_() {
              return _MasterComponentTreeData_getLoadedComponentFileUrls_.apply(this, arguments);
            }

            return MasterComponentTreeData_getLoadedComponentFileUrls_;
          }()
        }, {
          key: "listComponentFilesInDir",
          value: function () {
            var _MasterComponentTreeData_listComponentFilesInDir_ = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee15(folderLocation) {
              var _this6 = this;

              var resources, files, loadedFiles;
              return regeneratorRuntime.wrap(function _callee15$(_context15) {
                while (1) {
                  switch (_context15.prev = _context15.next) {
                    case 0:
                      _context15.next = 2;
                      return __varRecorder__$6.resource(folderLocation).dirList();

                    case 2:
                      _context15.t0 = function (res) {
                        return (res.isDirectory() || res.url.endsWith(".cp.js")) && !res.name().startsWith(".");
                      };

                      resources = _context15.sent.filter(_context15.t0);
                      _context15.t1 = __varRecorder__$6.arr;
                      _context15.next = 7;
                      return Promise.all(resources.map( /*#__PURE__*/function () {
                        var _ref8 = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee14(res) {
                          var type;
                          return regeneratorRuntime.wrap(function _callee14$(_context14) {
                            while (1) {
                              switch (_context14.prev = _context14.next) {
                                case 0:
                                  if (!res.isDirectory()) {
                                    _context14.next = 9;
                                    break;
                                  }

                                  type = "directory";
                                  _context14.next = 4;
                                  return _this6.listComponentFilesInDir(res.url);

                                case 4:
                                  _context14.t0 = _context14.sent.length;

                                  if (!(_context14.t0 === 0)) {
                                    _context14.next = 7;
                                    break;
                                  }

                                  return _context14.abrupt("return");

                                case 7:
                                  _context14.next = 14;
                                  break;

                                case 9:
                                  type = "cp.js";
                                  _context14.next = 12;
                                  return res.read();

                                case 12:
                                  if (!_context14.sent.match(/['"]skip listing['"];/)) {
                                    _context14.next = 14;
                                    break;
                                  }

                                  return _context14.abrupt("return");

                                case 14:
                                  return _context14.abrupt("return", {
                                    isCollapsed: true,
                                    name: res.name(),
                                    size: res.size,
                                    lastModified: res.lastModified,
                                    url: res.url,
                                    type: type
                                  });

                                case 15:
                                case "end":
                                  return _context14.stop();
                              }
                            }
                          }, _callee14);
                        }));

                        return function (_x9) {
                          return _ref8.apply(this, arguments);
                        };
                      }()));

                    case 7:
                      _context15.t2 = _context15.sent;
                      files = _context15.t1.compact.call(_context15.t1, _context15.t2);
                      _context15.next = 11;
                      return this.getLoadedComponentFileUrls();

                    case 11:
                      loadedFiles = _context15.sent;
                      return _context15.abrupt("return", files.map(function (file) {
                        file.isLoaded = !!loadedFiles[file.url];
                        return file;
                      }));

                    case 13:
                    case "end":
                      return _context15.stop();
                  }
                }
              }, _callee15, this);
            }));

            function MasterComponentTreeData_listComponentFilesInDir_(_x8) {
              return _MasterComponentTreeData_listComponentFilesInDir_.apply(this, arguments);
            }

            return MasterComponentTreeData_listComponentFilesInDir_;
          }()
        }], [{
          key: Symbol["for"]("__LivelyClassName__"),
          get: function get() {
            return "MasterComponentTreeData";
          }
        }], __lively_classholder__, {
          pathInPackage: function pathInPackage() {
            return "./studio/component-browser.cp.js";
          },
          unsubscribeFromToplevelDefinitionChanges: function unsubscribeFromToplevelDefinitionChanges() {
            return function () {};
          },
          subscribeToToplevelDefinitionChanges: function subscribeToToplevelDefinitionChanges() {
            return function () {};
          },
          "package": function _package() {
            return {
              name: "lively.ide",
              version: "0.1.0"
            };
          }
        }, {
          start: 1801,
          end: 13549
        });
      })(__varRecorder__$6.TreeData);

      var ExportedComponent = function (superclass) {
        var __lively_classholder__ = lively.FreezerRuntime.recorderFor("lively.ide/studio/component-browser.cp.js");

        var __lively_class__ = __lively_classholder__.hasOwnProperty("ExportedComponent") && typeof __lively_classholder__.ExportedComponent === "function" ? __lively_classholder__.ExportedComponent : __lively_classholder__.ExportedComponent = function ExportedComponent(__first_arg__) {
          if (__first_arg__ && __first_arg__[Symbol["for"]("lively-instance-restorer")]) ; else {
            return this[Symbol["for"]("lively-instance-initialize")].apply(this, arguments);
          }
        };

        return initializeClass(__lively_class__, superclass, [{
          key: "generatePreview",
          value: function ExportedComponent_generatePreview_() {
            try {
              var preview = __varRecorder__$6.part(this.component, {
                defaultViewModel: null,
                name: this.component.componentName
              });

              var container = this.get("preview container");

              var maxExtent = __varRecorder__$6.pt(100, 70);

              container.clipMode = "hidden";
              preview.scale = 1;

              var previewBoundsWrapper = __varRecorder__$6.morph({
                fill: __varRecorder__$6.Color.transparent,
                reactsToPointer: false,
                extent: preview.bounds().extent(),
                submorphs: [preview]
              });

              preview.topLeft = __varRecorder__$6.pt(0, 0);
              previewBoundsWrapper.scale = Math.min(maxExtent.x / previewBoundsWrapper.bounds().width, maxExtent.y / previewBoundsWrapper.bounds().height);
              container.submorphs = [previewBoundsWrapper];
              preview.withAllSubmorphsDo(function (m) {
                return m.reactsToPointer = false;
              });
            } catch (err) {
              this.displayError(err);
            }

            this.get("component name").textString = __varRecorder__$6.string.decamelize(this.component.componentName);
          }
        }, {
          key: "displayError",
          value: function ExportedComponent_displayError_(err) {
            this.get("preview container").submorphs = [__varRecorder__$6.part(__varRecorder__$6.ComponentError, {
              submorphs: [{
                name: "error message",
                textString: err.message
              }]
            })];
          }
        }, {
          key: "initExportIndicatorIfNeeded",
          value: function () {
            var _ExportedComponent_initExportIndicatorIfNeeded_ = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee16() {
              var exportIndicator;
              return regeneratorRuntime.wrap(function _callee16$(_context16) {
                while (1) {
                  switch (_context16.prev = _context16.next) {
                    case 0:
                      if (!this.fetchUrl.startsWith("part://$world/")) {
                        _context16.next = 13;
                        break;
                      }

                      _context16.t0 = this;
                      _context16.t1 = this.getSubmorphNamed("export indicator");

                      if (_context16.t1) {
                        _context16.next = 7;
                        break;
                      }

                      _context16.next = 6;
                      return __varRecorder__$6.resource("part://SystemDialogs/export indicator").read();

                    case 6:
                      _context16.t1 = _context16.sent;

                    case 7:
                      _context16.t2 = _context16.t1;
                      exportIndicator = _context16.t0.addMorph.call(_context16.t0, _context16.t2);
                      exportIndicator.name = "export indicator";
                      exportIndicator.fetchUrl = this.fetchUrl;
                      exportIndicator.isLayoutable = false;
                      return _context16.abrupt("return", exportIndicator);

                    case 13:
                    case "end":
                      return _context16.stop();
                  }
                }
              }, _callee16, this);
            }));

            function ExportedComponent_initExportIndicatorIfNeeded_() {
              return _ExportedComponent_initExportIndicatorIfNeeded_.apply(this, arguments);
            }

            return ExportedComponent_initExportIndicatorIfNeeded_;
          }()
        }, {
          key: "fitPreview",
          value: function () {
            var _ExportedComponent_fitPreview_ = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee17() {
              var img, naturalExtent, maxWidth, maxHeight, scaleFactor, exportIndicator;
              return regeneratorRuntime.wrap(function _callee17$(_context17) {
                while (1) {
                  switch (_context17.prev = _context17.next) {
                    case 0:
                      img = this.getSubmorphNamed("preview holder");
                      if (!this.world()) img.opacity = 0;
                      _context17.next = 4;
                      return this.master.whenApplied();

                    case 4:
                      _context17.next = 6;
                      return img.determineNaturalExtent();

                    case 6:
                      naturalExtent = _context17.sent;
                      maxWidth = 130;
                      maxHeight = 130;
                      scaleFactor = Math.min(maxWidth / naturalExtent.x, maxHeight / naturalExtent.y);
                      img.extent = naturalExtent.scaleBy(scaleFactor);
                      img.opacity = 1;
                      _context17.t0 = this.getSubmorphNamed("export indicator");

                      if (_context17.t0) {
                        _context17.next = 17;
                        break;
                      }

                      _context17.next = 16;
                      return this.initExportIndicatorIfNeeded();

                    case 16:
                      _context17.t0 = _context17.sent;

                    case 17:
                      exportIndicator = _context17.t0;

                      if (exportIndicator) {
                        _context17.next = 20;
                        break;
                      }

                      return _context17.abrupt("return");

                    case 20:
                      exportIndicator.topRight = this.innerBounds().insetBy(2).topRight();

                    case 21:
                    case "end":
                      return _context17.stop();
                  }
                }
              }, _callee17, this);
            }));

            function ExportedComponent_fitPreview_() {
              return _ExportedComponent_fitPreview_.apply(this, arguments);
            }

            return ExportedComponent_fitPreview_;
          }()
        }, {
          key: "updateLabel",
          value: function ExportedComponent_updateLabel_() {
            var nameLabel = this.getSubmorphNamed("component name");
            nameLabel.value = __varRecorder__$6.resource(this.fetchUrl).url.replace(/part:\/\/[^\/]*\//, "");
            this.tooltip = this.fetchUrl;
          }
        }, {
          key: "onMouseDown",
          value: function ExportedComponent_onMouseDown_(evt) {
            initializeClass._get(Object.getPrototypeOf(__lively_class__.prototype), "onMouseDown", this).call(this, evt);

            if (this.project) {
              this.project.selectComponent(this);
            }
          }
        }, {
          key: "onDrag",
          value: function ExportedComponent_onDrag_(evt) {
            var _this7 = this;

            if (!this.component) return;

            var _this$getSubmorphName = _slicedToArray(this.getSubmorphNamed("preview container").submorphs, 1),
                scale = _this$getSubmorphName[0].scale;

            var instance = __varRecorder__$6.part(this.component, {
              scale: scale
            });

            if (!this.componentBrowser.importAlive) {
              __varRecorder__$6.withAllViewModelsDo(instance, function (m) {
                return m.viewModel.detach();
              });
            }

            instance.openInHand();
            var grabShadow = new __varRecorder__$6.ShadowObject({
              fast: false,
              color: __varRecorder__$6.Color.rgba(0, 0, 0, 0.6),
              blur: 40
            });
            instance.animate({
              scale: 1,
              center: instance.center,
              dropShadow: grabShadow,
              duration: 300
            });

            __varRecorder__$6.once(instance, "onBeingDroppedOn", /*#__PURE__*/function () {
              var _ref9 = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee18(hand) {
                return regeneratorRuntime.wrap(function _callee18$(_context18) {
                  while (1) {
                    switch (_context18.prev = _context18.next) {
                      case 0:
                        if (!_this7.componentBrowser.globalBounds().containsPoint(hand.position)) {
                          _context18.next = 5;
                          break;
                        }

                        instance.openInWorld(hand.position);
                        _context18.next = 4;
                        return instance.animate({
                          center: _this7.globalBounds().center(),
                          opacity: 0,
                          duration: 300
                        });

                      case 4:
                        instance.remove();

                      case 5:
                      case "end":
                        return _context18.stop();
                    }
                  }
                }, _callee18);
              }));

              return function (_x10) {
                return _ref9.apply(this, arguments);
              };
            }());
          }
        }, {
          key: "select",
          value: function ExportedComponent_select_(active) {
            this.isSelected = active;

            if (active) {
              this.master = {
                auto: this.selectedMaster
              };
            } else {
              this.master = {
                auto: this.defaultMaster
              };
            }
          }
        }], [{
          key: Symbol["for"]("__LivelyClassName__"),
          get: function get() {
            return "ExportedComponent";
          }
        }, {
          key: "properties",
          get: function get() {
            return {
              project: {},
              componentBrowser: {
                derived: true,
                get: function get() {
                  return this.ownerChain().find(function (m) {
                    return m.isComponentBrowser;
                  });
                }
              },
              dragTriggerDistance: {
                get: function get() {
                  return 30;
                }
              },
              fetchUrl: {
                after: ["submorphs"],
                set: function set(url) {
                  this.setProperty("fetchUrl", url);
                  this.updateLabel();
                }
              },
              isSelected: {},
              isInOpenedProject: {
                derived: true,
                readOnly: true,
                get: function get() {
                  var _$world$openedProject3;

                  return ((_$world$openedProject3 = $world.openedProject) === null || _$world$openedProject3 === void 0 ? void 0 : _$world$openedProject3["package"].url) === this["package"].url;
                }
              },
              "package": {
                get: function get() {
                  return __varRecorder__$6.module(this.component[Symbol["for"]("lively-module-meta")].moduleId)["package"]();
                }
              },
              preview: {
                derived: true,
                set: function set(url) {
                  this.getSubmorphNamed("preview holder").imageUrl = url;
                  this.fitPreview();
                }
              },
              defaultMaster: {
                isComponent: true,
                initialize: function initialize() {
                  this.defaultMaster = __varRecorder__$6.ComponentPreview;
                }
              },
              selectedMaster: {
                isComponent: true,
                initialize: function initialize() {
                  this.selectedMaster = __varRecorder__$6.ComponentPreviewSelected;
                }
              },
              component: {
                set: function set(cp) {
                  this.setProperty("component", cp);
                  this.generatePreview();
                }
              }
            };
          }
        }], __lively_classholder__, {
          pathInPackage: function pathInPackage() {
            return "./studio/component-browser.cp.js";
          },
          unsubscribeFromToplevelDefinitionChanges: function unsubscribeFromToplevelDefinitionChanges() {
            return function () {};
          },
          subscribeToToplevelDefinitionChanges: function subscribeToToplevelDefinitionChanges() {
            return function () {};
          },
          "package": function _package() {
            return {
              name: "lively.ide",
              version: "0.1.0"
            };
          }
        }, {
          start: 13558,
          end: 19349
        });
      }(__varRecorder__$6.Morph);
      __varRecorder__$6.ExportedComponent = ExportedComponent;
      __varRecorder__$6.ExportedComponent = ExportedComponent;
      var ProjectEntry = function (superclass) {
        var __lively_classholder__ = lively.FreezerRuntime.recorderFor("lively.ide/studio/component-browser.cp.js");

        var __lively_class__ = __lively_classholder__.hasOwnProperty("ProjectEntry") && typeof __lively_classholder__.ProjectEntry === "function" ? __lively_classholder__.ProjectEntry : __lively_classholder__.ProjectEntry = function ProjectEntry(__first_arg__) {
          if (__first_arg__ && __first_arg__[Symbol["for"]("lively-instance-restorer")]) ; else {
            return this[Symbol["for"]("lively-instance-initialize")].apply(this, arguments);
          }
        };

        return initializeClass(__lively_class__, superclass, [{
          key: "onMouseUp",
          value: function ProjectEntry_onMouseUp_(evt) {
            initializeClass._get(Object.getPrototypeOf(__lively_class__.prototype), "onMouseUp", this).call(this, evt);

            if (this._navigationDisabled) return;
            var projectTitle = this.getSubmorphNamed("project title");

            if (projectTitle.textBounds().containsPoint(evt.positionIn(projectTitle))) {
              this.openComponentWorld();
            }
          }
        }, {
          key: "openComponentWorld",
          value: function () {
            var _ProjectEntry_openComponentWorld_ = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee19() {
              var selectedComponent, _selectedComponent$Sy, moduleName, name;

              return regeneratorRuntime.wrap(function _callee19$(_context19) {
                while (1) {
                  switch (_context19.prev = _context19.next) {
                    case 0:
                      selectedComponent = this.selectedComponent || this.exportedComponents[0];
                      _selectedComponent$Sy = selectedComponent[Symbol["for"]("lively-module-meta")], moduleName = _selectedComponent$Sy.moduleId, name = _selectedComponent$Sy.exportedName;
                      _context19.next = 4;
                      return $world.execCommand("open browser", {
                        moduleName: moduleName,
                        codeEntity: [{
                          name: name
                        }]
                      });

                    case 4:
                    case "end":
                      return _context19.stop();
                  }
                }
              }, _callee19, this);
            }));

            function ProjectEntry_openComponentWorld_() {
              return _ProjectEntry_openComponentWorld_.apply(this, arguments);
            }

            return ProjectEntry_openComponentWorld_;
          }()
        }, {
          key: "renderComponents",
          value: function ProjectEntry_renderComponents_(components) {
            var _this8 = this;

            var previewContainer = this.getSubmorphNamed("component previews");
            previewContainer.submorphs = components.map(function (cp) {
              var preview = previewContainer.submorphs.find(function (p) {
                return p.component === cp;
              });

              if (!preview) {
                preview = __varRecorder__$6.part(_this8.previewMaster, {
                  defaultMaster: _this8.previewMaster,
                  selectedMaster: _this8.selectedPreviewMaster
                });
                preview.project = _this8;
                preview.component = cp;
              }

              return preview;
            });
            return this;
          }
        }, {
          key: "selectComponent",
          value: function ProjectEntry_selectComponent_(component) {
            this.owner.getSubmorphsByStyleClassName("ExportedComponent").forEach(function (m) {
              return m.select(false);
            });
            component.select(true);
          }
        }, {
          key: "disableNavigation",
          value: function ProjectEntry_disableNavigation_() {
            this._navigationDisabled = true;
            this.getSubmorphNamed("project title").nativeCursor = "auto";
            this.getSubmorphNamed("project title").value = [this.worldName, {}];
          }
        }], [{
          key: Symbol["for"]("__LivelyClassName__"),
          get: function get() {
            return "ProjectEntry";
          }
        }, {
          key: "properties",
          get: function get() {
            return {
              exportedComponents: {
                derived: true,
                get: function get() {
                  return this.getSubmorphNamed("component previews").submorphs.map(function (m) {
                    return m.component;
                  });
                }
              },
              selectedComponent: {
                derived: true,
                get: function get() {
                  var selectedPreview = this.getSubmorphNamed("component previews").submorphs.find(function (m) {
                    return m.isSelected;
                  });
                  return selectedPreview && selectedPreview.component;
                }
              },
              previewMaster: {
                isComponent: true,
                initialize: function initialize() {
                  this.previewMaster = __varRecorder__$6.ComponentPreview;
                }
              },
              selectedPreviewMaster: {
                isComponent: true,
                initialize: function initialize() {
                  this.selectedPreviewMaster = __varRecorder__$6.ComponentPreviewSelected;
                }
              },
              worldName: {
                derived: true,
                set: function set(name) {
                  this.getSubmorphNamed("project title").value = [name, {}, "  ", {}].concat(name === "This Project" ? [] : __varRecorder__$6.Icon.textAttribute("external-link-square-alt", {
                    paddingTop: "3px"
                  }));
                },
                get: function get() {
                  return this.getSubmorphNamed("project title").value[0];
                }
              }
            };
          }
        }], __lively_classholder__, {
          pathInPackage: function pathInPackage() {
            return "./studio/component-browser.cp.js";
          },
          unsubscribeFromToplevelDefinitionChanges: function unsubscribeFromToplevelDefinitionChanges() {
            return function () {};
          },
          subscribeToToplevelDefinitionChanges: function subscribeToToplevelDefinitionChanges() {
            return function () {};
          },
          "package": function _package() {
            return {
              name: "lively.ide",
              version: "0.1.0"
            };
          }
        }, {
          start: 19357,
          end: 22250
        });
      }(__varRecorder__$6.Morph);
      __varRecorder__$6.ProjectEntry = ProjectEntry;
      __varRecorder__$6.ProjectEntry = ProjectEntry;
      var NameSection = function (superclass) {
        var __lively_classholder__ = lively.FreezerRuntime.recorderFor("lively.ide/studio/component-browser.cp.js");

        var __lively_class__ = __lively_classholder__.hasOwnProperty("NameSection") && typeof __lively_classholder__.NameSection === "function" ? __lively_classholder__.NameSection : __lively_classholder__.NameSection = function NameSection(__first_arg__) {
          if (__first_arg__ && __first_arg__[Symbol["for"]("lively-instance-restorer")]) ; else {
            return this[Symbol["for"]("lively-instance-initialize")].apply(this, arguments);
          }
        };

        return initializeClass(__lively_class__, superclass, undefined, [{
          key: Symbol["for"]("__LivelyClassName__"),
          get: function get() {
            return "NameSection";
          }
        }, {
          key: "properties",
          get: function get() {
            return {
              "char": {
                derived: true,
                set: function set(name) {
                  this.getSubmorphNamed("project title").value = [name, null];
                },
                get: function get() {
                  return this.getSubmorphNamed("project title").value[0];
                }
              }
            };
          }
        }], __lively_classholder__, {
          pathInPackage: function pathInPackage() {
            return "./studio/component-browser.cp.js";
          },
          unsubscribeFromToplevelDefinitionChanges: function unsubscribeFromToplevelDefinitionChanges() {
            return function () {};
          },
          subscribeToToplevelDefinitionChanges: function subscribeToToplevelDefinitionChanges() {
            return function () {};
          },
          "package": function _package() {
            return {
              name: "lively.ide",
              version: "0.1.0"
            };
          }
        }, {
          start: 22258,
          end: 22595
        });
      }(__varRecorder__$6.ProjectEntry);
      __varRecorder__$6.NameSection = NameSection;
      __varRecorder__$6.NameSection = NameSection;
      var ExportIndicator = function (superclass) {
        var __lively_classholder__ = lively.FreezerRuntime.recorderFor("lively.ide/studio/component-browser.cp.js");

        var __lively_class__ = __lively_classholder__.hasOwnProperty("ExportIndicator") && typeof __lively_classholder__.ExportIndicator === "function" ? __lively_classholder__.ExportIndicator : __lively_classholder__.ExportIndicator = function ExportIndicator(__first_arg__) {
          if (__first_arg__ && __first_arg__[Symbol["for"]("lively-instance-restorer")]) ; else {
            return this[Symbol["for"]("lively-instance-initialize")].apply(this, arguments);
          }
        };

        return initializeClass(__lively_class__, superclass, [{
          key: "updateStyle",
          value: function ExportIndicator_updateStyle_() {
            var _this$ui = this.ui,
                publicIndicator = _this$ui.publicIndicator,
                privateIndicator = _this$ui.privateIndicator;
            publicIndicator.isLayoutable = publicIndicator.visible = this.exported;
            privateIndicator.isLayoutable = privateIndicator.visible = !this.exported;
          }
        }, {
          key: "onMouseDown",
          value: function ExportIndicator_onMouseDown_(evt) {
            initializeClass._get(Object.getPrototypeOf(__lively_class__.prototype), "onMouseDown", this).call(this, evt);

            this.toggleExport();
          }
        }, {
          key: "isExported",
          value: function ExportIndicator_isExported_(url) {
            return !$world.hiddenComponents.includes(url);
          }
        }, {
          key: "toggleExport",
          value: function ExportIndicator_toggleExport_() {
            this.exported = !this.exported;

            if (this.exported) {
              this.exportComponent();
            } else {
              this.hideComponent();
            }
          }
        }, {
          key: "exportComponent",
          value: function ExportIndicator_exportComponent_() {
            $world.hiddenComponents = __varRecorder__$6.arr.without($world.hiddenComponents, this.fetchUrl);
          }
        }, {
          key: "hideComponent",
          value: function ExportIndicator_hideComponent_() {
            $world.hiddenComponents = [this.fetchUrl].concat(_toConsumableArray($world.hiddenComponents));
          }
        }], [{
          key: Symbol["for"]("__LivelyClassName__"),
          get: function get() {
            return "ExportIndicator";
          }
        }, {
          key: "properties",
          get: function get() {
            return {
              fetchUrl: {
                set: function set(url) {
                  this.setProperty("fetchUrl", url.replace("part://$world/", ""));
                  this.exported = this.isExported(this.fetchUrl);
                }
              },
              exported: {
                after: ["submorphs"],
                set: function set(isExported) {
                  this.setProperty("exported", isExported);
                  this.updateStyle();
                }
              },
              ui: {
                get: function get() {
                  return {
                    publicIndicator: this.getSubmorphNamed("public indicator"),
                    privateIndicator: this.getSubmorphNamed("private indicator")
                  };
                }
              }
            };
          }
        }], __lively_classholder__, {
          pathInPackage: function pathInPackage() {
            return "./studio/component-browser.cp.js";
          },
          unsubscribeFromToplevelDefinitionChanges: function unsubscribeFromToplevelDefinitionChanges() {
            return function () {};
          },
          subscribeToToplevelDefinitionChanges: function subscribeToToplevelDefinitionChanges() {
            return function () {};
          },
          "package": function _package() {
            return {
              name: "lively.ide",
              version: "0.1.0"
            };
          }
        }, {
          start: 22603,
          end: 24067
        });
      }(__varRecorder__$6.Morph);
      __varRecorder__$6.ExportIndicator = ExportIndicator;
      __varRecorder__$6.ExportIndicator = ExportIndicator;
      var ComponentBrowserModel = function (superclass) {
        var __lively_classholder__ = lively.FreezerRuntime.recorderFor("lively.ide/studio/component-browser.cp.js");

        var __lively_class__ = __lively_classholder__.hasOwnProperty("ComponentBrowserModel") && typeof __lively_classholder__.ComponentBrowserModel === "function" ? __lively_classholder__.ComponentBrowserModel : __lively_classholder__.ComponentBrowserModel = function ComponentBrowserModel(__first_arg__) {
          if (__first_arg__ && __first_arg__[Symbol["for"]("lively-instance-restorer")]) ; else {
            return this[Symbol["for"]("lively-instance-initialize")].apply(this, arguments);
          }
        };

        return initializeClass(__lively_class__, superclass, [{
          key: "menuItems",
          value: function ComponentBrowserModel_menuItems_() {
            var _this9 = this;

            var checked = __varRecorder__$6.Icon.textAttribute("check-square", {
              paddingRight: "3px"
            });

            var unchecked = __varRecorder__$6.Icon.textAttribute("square", {
              paddingRight: "3px"
            });

            return [["Import project...", function () {
              _this9.ui.componentFilesView.treeData.interactivelyImportProject();
            }], [[].concat(_toConsumableArray(this.importAlive ? checked : unchecked), [" Enable behavior"]), function () {
              return _this9.importAlive = !_this9.importAlive;
            }], ["Group Components by ", [[[].concat(_toConsumableArray(this.groupBy === "module" ? checked : unchecked), [" Modules"]), function () {
              _this9.groupBy = "module";
            }], [[].concat(_toConsumableArray(this.groupBy === "name" ? checked : unchecked), [" Names"]), function () {
              _this9.groupBy = "name";
            }]]]];
          }
        }, {
          key: "bindings",
          get: function get() {
            return [{
              signal: "onWindowClose",
              handler: "close"
            }, {
              target: "import button",
              signal: "fire",
              handler: "importSelectedComponent"
            }, {
              target: "selection button",
              signal: "fire",
              handler: "chooseComponent"
            }, {
              target: "edit button",
              signal: "fire",
              handler: "editSelectedComponent"
            }, {
              target: "search input",
              signal: "inputChanged",
              handler: "filterAllComponents"
            }, {
              signal: "onKeyDown",
              handler: "close",
              updater: function updater($reject, evt) {
                if (evt.key === "Escape") $reject();
              }
            }, {
              signal: "onMouseDown",
              handler: "focus"
            }, {
              target: /component files view|master component list/,
              signal: "onMouseUp",
              handler: "ensureButtonControls"
            }, {
              signal: "onHoverIn",
              handler: "refresh"
            }, {
              signal: "onMouseUp",
              handler: "ensureComponentEntitySelected"
            }, {
              target: "behavior toggle",
              signal: "checked",
              handler: "toggleBehaviorImport"
            }, {
              model: "sorting selector",
              signal: "selection",
              handler: "changeComponentGrouping"
            }, {
              target: "search clear button",
              signal: "onMouseDown",
              handler: "resetSearchInput"
            }];
          }
        }, {
          key: "focus",
          value: function ComponentBrowserModel_focus_() {
            this.view.bringToFront();
          }
        }, {
          key: "ensureButtonControls",
          value: function ComponentBrowserModel_ensureButtonControls_() {
            var selectedComponent = this.getSelectedComponent();
            this.models.importButton.deactivated = !selectedComponent;
            this.models.editButton.deactivated = !selectedComponent || !selectedComponent.isInOpenedProject;
            if (this.models.editButton.deactivated) this.ui.editButton.tooltip = "You can not edit this component, since it is outside of your current project.";else {
              this.ui.editButton.tooltip = "Click to start editing this component.\nNote that changes to this component will\npropagate throughout your project.";
              this.models.selectionButton.deactivated = !selectedComponent;
            }
          }
        }, {
          key: "viewDidLoad",
          value: function () {
            var _ComponentBrowserModel_viewDidLoad_ = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee20() {
              var _this10 = this;

              var openedProject, li, cmd;
              return regeneratorRuntime.wrap(function _callee20$(_context20) {
                while (1) {
                  switch (_context20.prev = _context20.next) {
                    case 0:
                      if (!this.view.isComponent) {
                        this.view.withMetaDo({
                          metaInteraction: true
                        }, function () {
                          _this10.ui.componentFilesView.setTreeData(new __varRecorder__$6.MasterComponentTreeData({
                            browser: _this10
                          }));
                        });
                      }

                      openedProject = $world.openedProject;

                      if (!(!(openedProject.owner === "LivelyKernel" && openedProject.name === "partsbin") && !$world._partsbinUpdated)) {
                        _context20.next = 13;
                        break;
                      }

                      li = $world.showLoadingIndicatorFor(null, "Updating `partsbin`");
                      cmd = __varRecorder__$6.runCommand("cd ../local_projects/LivelyKernel--partsbin && git stash && git checkout main && git pull", {
                        l2lClient: __varRecorder__$6.ShellClientResource.defaultL2lClient
                      });
                      _context20.next = 7;
                      return cmd.whenDone();

                    case 7:
                      if (!(cmd.exitCode !== 0)) {
                        _context20.next = 10;
                        break;
                      }

                      $world.setStatusMessage("`partsbin` could not be updated.", __varRecorder__$6.StatusMessageError);
                      return _context20.abrupt("return");

                    case 10:
                      $world.setStatusMessage("`partsbin` updated!", __varRecorder__$6.StatusMessageConfirm);
                      $world._partsbinUpdated = true;
                      li.remove();

                    case 13:
                    case "end":
                      return _context20.stop();
                  }
                }
              }, _callee20, this);
            }));

            function ComponentBrowserModel_viewDidLoad_() {
              return _ComponentBrowserModel_viewDidLoad_.apply(this, arguments);
            }

            return ComponentBrowserModel_viewDidLoad_;
          }()
        }, {
          key: "refresh",
          value: function () {
            var _ComponentBrowserModel_refresh_ = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee21() {
              var selectedModule, _this$ui2, componentFilesView, searchInput;

              return regeneratorRuntime.wrap(function _callee21$(_context21) {
                while (1) {
                  switch (_context21.prev = _context21.next) {
                    case 0:
                      selectedModule = this.getSelectedModule();
                      _this$ui2 = this.ui, componentFilesView = _this$ui2.componentFilesView, searchInput = _this$ui2.searchInput;

                      if (!(!selectedModule && searchInput.input)) {
                        _context21.next = 7;
                        break;
                      }

                      _context21.next = 5;
                      return componentFilesView.setTreeData(new __varRecorder__$6.MasterComponentTreeData({
                        browser: this
                      }));

                    case 5:
                      this.filterAllComponents();
                      return _context21.abrupt("return");

                    case 7:
                      if (selectedModule) {
                        delete selectedModule.subNodes;
                        componentFilesView.treeData.collapse(selectedModule, false);
                        componentFilesView.treeData.display(selectedModule);
                      }

                    case 8:
                    case "end":
                      return _context21.stop();
                  }
                }
              }, _callee21, this);
            }));

            function ComponentBrowserModel_refresh_() {
              return _ComponentBrowserModel_refresh_.apply(this, arguments);
            }

            return ComponentBrowserModel_refresh_;
          }()
        }, {
          key: "onRefresh",
          value: function ComponentBrowserModel_onRefresh_(change) {
            var _this11 = this;

            initializeClass._get(Object.getPrototypeOf(__lively_class__.prototype), "onRefresh", this).call(this, change);

            this.ui.behaviorToggle.checked = this.importAlive;
            this.handleColumnViewVisibility();
            this.ui.editButton.visible = !this.selectionMode;
            this.ui.behaviorToggle.visible = !this.selectionMode;
            this.ui.importButton.visible = !this.selectionMode;
            this.ui.selectionButton.visible = this.selectionMode;

            __varRecorder__$6.noUpdate(function () {
              return _this11.ui.sortingSelector.selection = _this11.groupBy;
            });
          }
        }, {
          key: "handleColumnViewVisibility",
          value: function ComponentBrowserModel_handleColumnViewVisibility_() {
            var _this$ui3 = this.ui,
                componentFilesView = _this$ui3.componentFilesView,
                searchInput = _this$ui3.searchInput;
            componentFilesView.visible = false;

            if (this.groupBy === "name") ; else if (!searchInput.input) componentFilesView.visible = true;
          }
        }, {
          key: "systemInterface",
          get: function get() {
            return __varRecorder__$6.localInterface;
          }
        }, {
          key: "reset",
          value: function ComponentBrowserModel_reset_() {
            this.ui.masterComponentList.submorphs = [];
            this.ui.componentFilesView.scroll = __varRecorder__$6.pt(0, 0);
          }
        }, {
          key: "activate",
          value: function () {
            var _ComponentBrowserModel_activate_ = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee22() {
              return regeneratorRuntime.wrap(function _callee22$(_context22) {
                while (1) {
                  switch (_context22.prev = _context22.next) {
                    case 0:
                      this.ui.editButton.visible = __varRecorder__$6.config.ide.studio.componentEditViaComponentBrowser;
                      this._promise = __varRecorder__$6.promise.deferred();
                      this.ui.searchInput.focus();
                      this.ensureButtonControls();
                      return _context22.abrupt("return", this._promise.promise);

                    case 6:
                    case "end":
                      return _context22.stop();
                  }
                }
              }, _callee22, this);
            }));

            function ComponentBrowserModel_activate_() {
              return _ComponentBrowserModel_activate_.apply(this, arguments);
            }

            return ComponentBrowserModel_activate_;
          }()
        }, {
          key: "onWindowClose",
          value: function ComponentBrowserModel_onWindowClose_() {
            this.close();
          }
        }, {
          key: "close",
          value: function ComponentBrowserModel_close_() {
            if (this._promise) this._promise.resolve(null);
          }
        }, {
          key: "importSelectedComponent",
          value: function () {
            var _ComponentBrowserModel_importSelectedComponent_ = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee23() {
              var selectedComponent, importedComponent;
              return regeneratorRuntime.wrap(function _callee23$(_context23) {
                while (1) {
                  switch (_context23.prev = _context23.next) {
                    case 0:
                      selectedComponent = this.getSelectedComponent();
                      importedComponent = __varRecorder__$6.part(selectedComponent.component);

                      if (!this.importAlive) {
                        __varRecorder__$6.withAllViewModelsDo(importedComponent, function (m) {
                          return m.viewModel.detach();
                        });
                      }

                      importedComponent.openInWorld();

                    case 4:
                    case "end":
                      return _context23.stop();
                  }
                }
              }, _callee23, this);
            }));

            function ComponentBrowserModel_importSelectedComponent_() {
              return _ComponentBrowserModel_importSelectedComponent_.apply(this, arguments);
            }

            return ComponentBrowserModel_importSelectedComponent_;
          }()
        }, {
          key: "chooseComponent",
          value: function ComponentBrowserModel_chooseComponent_() {
            this._promise.resolve(this.getSelectedComponent().component);

            this.close();
          }
        }, {
          key: "editSelectedComponent",
          value: function () {
            var _ComponentBrowserModel_editSelectedComponent_ = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee24() {
              var selectedComponent, editableComponent;
              return regeneratorRuntime.wrap(function _callee24$(_context24) {
                while (1) {
                  switch (_context24.prev = _context24.next) {
                    case 0:
                      selectedComponent = this.getSelectedComponent();
                      _context24.next = 3;
                      return selectedComponent.component.edit();

                    case 3:
                      editableComponent = _context24.sent;
                      if (editableComponent) editableComponent.openInWorld();

                    case 5:
                    case "end":
                      return _context24.stop();
                  }
                }
              }, _callee24, this);
            }));

            function ComponentBrowserModel_editSelectedComponent_() {
              return _ComponentBrowserModel_editSelectedComponent_.apply(this, arguments);
            }

            return ComponentBrowserModel_editSelectedComponent_;
          }()
        }, {
          key: "toggleBusyState",
          value: function ComponentBrowserModel_toggleBusyState_(active) {
            this.ui.spinner.visible = active;
          }
        }, {
          key: "toggleComponentList",
          value: function ComponentBrowserModel_toggleComponentList_(active) {
            var masterComponentList = this.ui.masterComponentList;
            if (masterComponentList.isLayoutable === active) return;
            var center = this.world().visibleBounds().center();
            this.withAnimationDo(function () {
              masterComponentList.height = active ? 300 : 0;
              masterComponentList.isLayoutable = active;
            }, {
              duration: 300,
              easing: __varRecorder__$6.easings.inOutExpo
            });
            this.layout.forceLayout();
            this.animate({
              center: center,
              duration: 300,
              easing: __varRecorder__$6.easings.inOutExpo
            });
          }
        }, {
          key: "getComponentsInModule",
          value: function () {
            var _ComponentBrowserModel_getComponentsInModule_ = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee25(moduleName) {
              var source, mod, exports, componentDescriptors;
              return regeneratorRuntime.wrap(function _callee25$(_context25) {
                while (1) {
                  switch (_context25.prev = _context25.next) {
                    case 0:
                      _context25.next = 2;
                      return this.systemInterface.moduleRead(moduleName);

                    case 2:
                      source = _context25.sent;

                      if (source.startsWith("redirect -> ")) {
                        moduleName = source.replace("redirect -> ", "");
                      }

                      if (!source.includes("component-browser skip")) {
                        _context25.next = 6;
                        break;
                      }

                      return _context25.abrupt("return", []);

                    case 6:
                      mod = __varRecorder__$6.localInterface.getModule(moduleName);

                      if (mod.isLoaded()) {
                        _context25.next = 10;
                        break;
                      }

                      _context25.next = 10;
                      return mod.load();

                    case 10:
                      _context25.next = 12;
                      return mod.exports();

                    case 12:
                      exports = _context25.sent;
                      componentDescriptors = exports.map(function (m) {
                        return mod.recorder[m.exported];
                      }).filter(function (c) {
                        return c && c.isComponentDescriptor;
                      });
                      componentDescriptors.forEach(function (descr) {
                        return __varRecorder__$6.adoptObject(descr, __varRecorder__$6.InteractiveComponentDescriptor);
                      });
                      return _context25.abrupt("return", componentDescriptors);

                    case 16:
                    case "end":
                      return _context25.stop();
                  }
                }
              }, _callee25, this);
            }));

            function ComponentBrowserModel_getComponentsInModule_(_x11) {
              return _ComponentBrowserModel_getComponentsInModule_.apply(this, arguments);
            }

            return ComponentBrowserModel_getComponentsInModule_;
          }()
        }, {
          key: "withoutUpdates",
          value: function () {
            var _ComponentBrowserModel_withoutUpdates_ = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee26(cb) {
              return regeneratorRuntime.wrap(function _callee26$(_context26) {
                while (1) {
                  switch (_context26.prev = _context26.next) {
                    case 0:
                      this._pauseUpdates = true;
                      _context26.next = 3;
                      return cb();

                    case 3:
                      this._pauseUpdates = false;

                    case 4:
                    case "end":
                      return _context26.stop();
                  }
                }
              }, _callee26, this);
            }));

            function ComponentBrowserModel_withoutUpdates_(_x12) {
              return _ComponentBrowserModel_withoutUpdates_.apply(this, arguments);
            }

            return ComponentBrowserModel_withoutUpdates_;
          }()
        }, {
          key: "ensureComponentEntitySelected",
          value: function () {
            var _ComponentBrowserModel_ensureComponentEntitySelected_ = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee27(evt) {
              var _this12 = this;

              var selectedComponent, _this$models$componen, n, td, url;

              return regeneratorRuntime.wrap(function _callee27$(_context27) {
                while (1) {
                  switch (_context27.prev = _context27.next) {
                    case 0:
                      if (!(!evt.isClickTarget(this.ui.masterComponentList) || !this.ui.componentFilesView.visible)) {
                        _context27.next = 2;
                        break;
                      }

                      return _context27.abrupt("return");

                    case 2:
                      selectedComponent = this.getSelectedComponent();

                      if (!selectedComponent) {
                        _context27.next = 10;
                        break;
                      }

                      _this$models$componen = this.models.componentFilesView, n = _this$models$componen._selectedNode, td = _this$models$componen.treeData;

                      if (!(n && n.componentObject === selectedComponent.component)) {
                        _context27.next = 7;
                        break;
                      }

                      return _context27.abrupt("return");

                    case 7:
                      url = System.decanonicalize(selectedComponent.component[Symbol["for"]("lively-module-meta")].moduleId);
                      _context27.next = 10;
                      return this.withoutUpdates(function () {
                        return _this12.models.componentFilesView.setExpandedPath(function (node) {
                          if (node === td.root) return true;
                          if (node.url) return url.startsWith(node.url);

                          if (node.componentObject === selectedComponent.component) {
                            _this12.models.componentFilesView._selectedNode = node;
                            return true;
                          }
                        }, td.root, false);
                      });

                    case 10:
                    case "end":
                      return _context27.stop();
                  }
                }
              }, _callee27, this);
            }));

            function ComponentBrowserModel_ensureComponentEntitySelected_(_x13) {
              return _ComponentBrowserModel_ensureComponentEntitySelected_.apply(this, arguments);
            }

            return ComponentBrowserModel_ensureComponentEntitySelected_;
          }()
        }, {
          key: "getSelectedComponent",
          value: function ComponentBrowserModel_getSelectedComponent_() {
            return this.view.getSubmorphsByStyleClassName("ExportedComponent").find(function (component) {
              return component.isSelected;
            });
          }
        }, {
          key: "getSelectedModule",
          value: function ComponentBrowserModel_getSelectedModule_() {
            if (!this.ui.componentFilesView.visible) return false;
            var fileView = this.models.componentFilesView;
            return fileView.getExpandedPath().find(function (m) {
              return m.type === "cp.js";
            });
          }
        }, {
          key: "toggleBehaviorImport",
          value: function ComponentBrowserModel_toggleBehaviorImport_() {
            this.importAlive = !this.importAlive;
          }
        }, {
          key: "parseInput",
          value: function ComponentBrowserModel_parseInput_() {
            var filterText = this.ui.searchInput.textString;
            var parsed = Array.from(filterText).reduce(function (state, _char) {
              if (_char === "\\" && !state.escaped) {
                state.escaped = true;
                return state;
              }

              if (_char === " " && !state.escaped) {
                if (!state.spaceSeen && state.current) {
                  state.tokens.push(state.current);
                  state.current = "";
                }

                state.spaceSeen = true;
              } else {
                state.spaceSeen = false;
                state.current += _char;
              }

              state.escaped = false;
              return state;
            }, {
              tokens: [],
              current: "",
              escaped: false,
              spaceSeen: false
            });
            parsed.current && parsed.tokens.push(parsed.current);
            var lowercasedTokens = parsed.tokens.map(function (ea) {
              return ea.toLowerCase();
            });
            return {
              tokens: parsed.tokens,
              lowercasedTokens: lowercasedTokens
            };
          }
        }, {
          key: "fuzzyMatch",
          value: function ComponentBrowserModel_fuzzyMatch_(parsedInput, term) {
            var tokens = parsedInput.lowercasedTokens;
            if (tokens.every(function (token) {
              return term.toLowerCase().includes(token);
            })) return true;
            var fuzzyValue = String(term).toLowerCase();
            return __varRecorder__$6.arr.sum(parsedInput.lowercasedTokens.map(function (token) {
              return __varRecorder__$6.string.levenshtein(fuzzyValue, token);
            })) <= 3;
          }
        }, {
          key: "filteredIndex",
          value: function () {
            var _ComponentBrowserModel_filteredIndex_ = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee29(term) {
              var _this13 = this;

              var previewWidth, filteredIndex, parsedInput, localComponents, _i, _Object$keys, worldName, matches;

              return regeneratorRuntime.wrap(function _callee29$(_context29) {
                while (1) {
                  switch (_context29.prev = _context29.next) {
                    case 0:
                      previewWidth = 120 * window.devicePixelRatio;
                      filteredIndex = {};
                      parsedInput = this.parseInput();
                      _context29.next = 5;
                      return Promise.all($world.localComponents.map( /*#__PURE__*/function () {
                        var _ref10 = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee28(c) {
                          var renderedWidth, renderedHeight, preview;
                          return regeneratorRuntime.wrap(function _callee28$(_context28) {
                            while (1) {
                              switch (_context28.prev = _context28.next) {
                                case 0:
                                  renderedWidth = c.width;
                                  renderedHeight = c.height;
                                  renderedHeight *= previewWidth / renderedWidth;
                                  renderedWidth = previewWidth;
                                  _context28.t0 = c._preview;

                                  if (_context28.t0) {
                                    _context28.next = 9;
                                    break;
                                  }

                                  _context28.next = 8;
                                  return __varRecorder__$6.renderMorphToDataURI(c, {
                                    width: renderedWidth,
                                    height: renderedHeight,
                                    type: "png"
                                  });

                                case 8:
                                  _context28.t0 = c._preview = _context28.sent;

                                case 9:
                                  preview = _context28.t0;
                                  return _context28.abrupt("return", {
                                    identifier: "part://$world/" + c.name,
                                    preview: preview,
                                    worldName: $world.name
                                  });

                                case 11:
                                case "end":
                                  return _context28.stop();
                              }
                            }
                          }, _callee28);
                        }));

                        return function (_x15) {
                          return _ref10.apply(this, arguments);
                        };
                      }()));

                    case 5:
                      localComponents = _context29.sent;
                      localComponents = localComponents.filter(function (component) {
                        return _this13.fuzzyMatch(parsedInput, component.identifier);
                      });

                      if (localComponents.length > 0) {
                        filteredIndex["This Project"] = localComponents;
                      }

                      _i = 0, _Object$keys = Object.keys(this._componentIndex);

                    case 9:
                      if (!(_i < _Object$keys.length)) {
                        _context29.next = 18;
                        break;
                      }

                      worldName = _Object$keys[_i];

                      if (!(worldName === this.world().name)) {
                        _context29.next = 13;
                        break;
                      }

                      return _context29.abrupt("continue", 15);

                    case 13:
                      matches = this._componentIndex[worldName].filter(function (component) {
                        return _this13.fuzzyMatch(parsedInput, component.identifier);
                      });
                      if (matches.length > 0) filteredIndex[worldName] = matches;

                    case 15:
                      _i++;
                      _context29.next = 9;
                      break;

                    case 18:
                      return _context29.abrupt("return", filteredIndex);

                    case 19:
                    case "end":
                      return _context29.stop();
                  }
                }
              }, _callee29, this);
            }));

            function ComponentBrowserModel_filteredIndex_(_x14) {
              return _ComponentBrowserModel_filteredIndex_.apply(this, arguments);
            }

            return ComponentBrowserModel_filteredIndex_;
          }()
        }, {
          key: "resetSearchInput",
          value: function ComponentBrowserModel_resetSearchInput_() {
            this.ui.searchInput.clear();
            this.reset();

            if (this.groupBy === "module") {
              var fileView = this.models.componentFilesView;
              var lastSelectedModule = fileView.getExpandedPath().find(function (m) {
                return m.type === "cp.js";
              });

              if (lastSelectedModule) {
                fileView.treeData.display(lastSelectedModule);
              } else this.ui.masterComponentList.submorphs = [];
            }

            if (this.groupBy === "name") {
              this.showSearchComponensNotice();
            }
          }
        }, {
          key: "filterAllComponents",
          value: function () {
            var _ComponentBrowserModel_filterAllComponents_ = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee32() {
              var _this14 = this;

              return regeneratorRuntime.wrap(function _callee32$(_context32) {
                while (1) {
                  switch (_context32.prev = _context32.next) {
                    case 0:
                      __varRecorder__$6.fun.debounceNamed("filterAllComponents", 200, /*#__PURE__*/_asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee31() {
                        var _componentFilesView$t;

                        var _this14$ui, importButton, componentFilesView, searchInput, searchClearButton, term, parsedInput, rootUrls, componentModules, filteredIndex, flattenedComponents;

                        return regeneratorRuntime.wrap(function _callee31$(_context31) {
                          while (1) {
                            switch (_context31.prev = _context31.next) {
                              case 0:
                                _this14.toggleBusyState(true);

                                _this14$ui = _this14.ui, importButton = _this14$ui.importButton, componentFilesView = _this14$ui.componentFilesView, searchInput = _this14$ui.searchInput, searchClearButton = _this14$ui.searchClearButton;
                                term = searchInput.input;
                                parsedInput = _this14.parseInput();
                                rootUrls = __varRecorder__$6.arr.compact((_componentFilesView$t = componentFilesView.treeData.root.subNodes) === null || _componentFilesView$t === void 0 ? void 0 : _componentFilesView$t.map(function (m) {
                                  return m.url;
                                }).slice(1));

                                if (rootUrls) {
                                  _context31.next = 7;
                                  break;
                                }

                                return _context31.abrupt("return", setTimeout(function () {
                                  return _this14.filterAllComponents();
                                }, 200));

                              case 7:
                                _context31.t0 = Array;
                                _context31.next = 10;
                                return Promise.all(rootUrls.map(function (url) {
                                  return __varRecorder__$6.resource(url).dirList(10, {
                                    exclude: function exclude(file) {
                                      return file.isFile() && !file.url.endsWith("cp.js");
                                    }
                                  });
                                }));

                              case 10:
                                _context31.t1 = _context31.sent;

                                _context31.t2 = function (file) {
                                  return file.url.endsWith("cp.js");
                                };

                                _context31.t3 = function (file) {
                                  return file.url;
                                };

                                componentModules = _context31.t0.from.call(_context31.t0, _context31.t1).flat().filter(_context31.t2).map(_context31.t3);

                                _this14.handleColumnViewVisibility();

                                if (!(term === "")) {
                                  _context31.next = 19;
                                  break;
                                }

                                searchClearButton.visible = false;

                                _this14.toggleBusyState(false);

                                return _context31.abrupt("return");

                              case 19:
                                searchClearButton.visible = true;
                                filteredIndex = {};
                                _context31.next = 23;
                                return Promise.all(componentModules.map( /*#__PURE__*/function () {
                                  var _ref12 = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee30(modUrl) {
                                    var components;
                                    return regeneratorRuntime.wrap(function _callee30$(_context30) {
                                      while (1) {
                                        switch (_context30.prev = _context30.next) {
                                          case 0:
                                            _context30.prev = 0;
                                            _context30.next = 3;
                                            return _this14.getComponentsInModule(modUrl);

                                          case 3:
                                            components = _context30.sent;
                                            _context30.next = 9;
                                            break;

                                          case 6:
                                            _context30.prev = 6;
                                            _context30.t0 = _context30["catch"](0);
                                            return _context30.abrupt("return");

                                          case 9:
                                            components = components.filter(function (c) {
                                              return _this14.fuzzyMatch(parsedInput, c.componentName);
                                            });
                                            if (components.length > 0) filteredIndex[modUrl.replace(System.baseURL, "")] = components;

                                          case 11:
                                          case "end":
                                            return _context30.stop();
                                        }
                                      }
                                    }, _callee30, null, [[0, 6]]);
                                  }));

                                  return function (_x16) {
                                    return _ref12.apply(this, arguments);
                                  };
                                }()));

                              case 23:
                                if (_this14.groupBy === "name") {
                                  flattenedComponents = __varRecorder__$6.arr.flat(Object.values(filteredIndex));
                                  filteredIndex = __varRecorder__$6.arr.groupBy(flattenedComponents, function (c) {
                                    return c.componentName[0];
                                  });
                                }

                                _this14.updateList(filteredIndex, _this14.groupBy === "name");

                                importButton.viewModel.deactivated = !_this14.getSelectedComponent();

                                _this14.toggleBusyState(false);

                              case 27:
                              case "end":
                                return _context31.stop();
                            }
                          }
                        }, _callee31);
                      })))();

                    case 1:
                    case "end":
                      return _context32.stop();
                  }
                }
              }, _callee32);
            }));

            function ComponentBrowserModel_filterAllComponents_() {
              return _ComponentBrowserModel_filterAllComponents_.apply(this, arguments);
            }

            return ComponentBrowserModel_filterAllComponents_;
          }()
        }, {
          key: "updateList",
          value: function () {
            var _ComponentBrowserModel_updateList_ = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee33(componentsByWorlds, organizeByName) {
              var masterComponentList, newList, orderedWorlds, _iterator, _step, worldName, mod, _i2, _newList, section;

              return regeneratorRuntime.wrap(function _callee33$(_context33) {
                while (1) {
                  switch (_context33.prev = _context33.next) {
                    case 0:
                      masterComponentList = this.ui.masterComponentList;
                      newList = [];
                      orderedWorlds = __varRecorder__$6.arr.sortBy((componentsByWorlds["This Project"] ? ["This Project"] : []).concat(__varRecorder__$6.arr.without(Object.keys(componentsByWorlds), "This Project")), function (m) {
                        return m;
                      });
                      _iterator = _createForOfIteratorHelper(orderedWorlds);

                      try {
                        for (_iterator.s(); !(_step = _iterator.n()).done;) {
                          worldName = _step.value;
                          mod = __varRecorder__$6.module(worldName);
                          newList.push(organizeByName ? this.renderComponentsByChar(worldName, componentsByWorlds[worldName]) : this.renderComponentsInFile(__varRecorder__$6.joinPath(mod["package"]().name, mod.pathInPackage()), componentsByWorlds[worldName]));
                        }
                      } catch (err) {
                        _iterator.e(err);
                      } finally {
                        _iterator.f();
                      }

                      masterComponentList.clipMode = "auto";
                      masterComponentList.submorphs = newList;

                      for (_i2 = 0, _newList = newList; _i2 < _newList.length; _i2++) {
                        section = _newList[_i2];
                        masterComponentList.layout.setResizePolicyFor(section, {
                          width: "fill",
                          height: "fixed"
                        });
                      }

                      this.view.doNotAcceptDropsForThisAndSubmorphs();

                    case 9:
                    case "end":
                      return _context33.stop();
                  }
                }
              }, _callee33, this);
            }));

            function ComponentBrowserModel_updateList_(_x17, _x18) {
              return _ComponentBrowserModel_updateList_.apply(this, arguments);
            }

            return ComponentBrowserModel_updateList_;
          }()
        }, {
          key: "selectComponent",
          value: function ComponentBrowserModel_selectComponent_(component) {
            var scrollIntoView = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : false;
            var previewToSelect = this.view.getSubmorphsByStyleClassName("ExportedComponent").find(function (preview) {
              return preview.component === component;
            });

            if (previewToSelect && !previewToSelect.isSelected) {
              previewToSelect.project.selectComponent(previewToSelect);
            }

            var masterComponentList = this.ui.masterComponentList;

            if (previewToSelect && scrollIntoView) {
              var scrollY = masterComponentList.localizePointFrom(__varRecorder__$6.pt(0, 0), previewToSelect).y;
              masterComponentList.animate({
                scroll: __varRecorder__$6.pt(0, scrollY - 50),
                duration: 200
              });
            }
          }
        }, {
          key: "renderComponentsByChar",
          value: function ComponentBrowserModel_renderComponentsByChar_(_char2, componentsByChar) {
            var masterComponentList = this.ui.masterComponentList;
            var currentList = masterComponentList.submorphs;

            var charGroup = currentList.find(function (item) {
              return item["char"] === _char2;
            }) || __varRecorder__$6.part(this.sectionMaster, {
              type: __varRecorder__$6.NameSection
            });

            charGroup["char"] = _char2;
            charGroup.renderComponents(componentsByChar);
            return charGroup;
          }
        }, {
          key: "renderComponentsInFile",
          value: function ComponentBrowserModel_renderComponentsInFile_(fileName, componentsInFile) {
            var masterComponentList = this.ui.masterComponentList;
            var currentList = masterComponentList.submorphs;

            var projectEntry = currentList.find(function (item) {
              return item.worldName === fileName;
            }) || __varRecorder__$6.part(this.sectionMaster);

            projectEntry.worldName = __varRecorder__$6.arr.last(fileName.split("--"));
            projectEntry.renderComponents(componentsInFile);
            return projectEntry;
          }
        }, {
          key: "showSearchComponensNotice",
          value: function ComponentBrowserModel_showSearchComponensNotice_() {
            var masterComponentList = this.ui.masterComponentList;
            var SearchComponentsNotice = this.SearchComponentsNotice;

            var notice = __varRecorder__$6.part(SearchComponentsNotice);

            masterComponentList.clipMode = "hidden";
            masterComponentList.submorphs = [notice];
            masterComponentList.layout.setResizePolicyFor(notice, {
              width: "fill",
              height: "fill"
            });
          }
        }, {
          key: "showComponentsInFile",
          value: function ComponentBrowserModel_showComponentsInFile_(fileName, componentsInFile, activeNavigation) {
            var masterComponentList = this.ui.masterComponentList;
            var projectEntry = this.renderComponentsInFile(fileName, componentsInFile);
            if (!activeNavigation) projectEntry.disableNavigation();
            masterComponentList.submorphs = [projectEntry];
            masterComponentList.layout.setResizePolicyFor(projectEntry, {
              width: "fill",
              height: "fixed"
            });
          }
        }, {
          key: "changeComponentGrouping",
          value: function ComponentBrowserModel_changeComponentGrouping_(groupBy) {
            this.groupBy = groupBy;
            this.resetSearchInput();
          }
        }], [{
          key: Symbol["for"]("__LivelyClassName__"),
          get: function get() {
            return "ComponentBrowserModel";
          }
        }, {
          key: "properties",
          get: function get() {
            return {
              isComponentBrowser: {
                get: function get() {
                  return true;
                }
              },
              sectionMaster: {
                initialize: function initialize() {
                  this.sectionMaster = __varRecorder__$6.ProjectSection;
                }
              },
              SearchComponentsNotice: {
                initialize: function initialize() {
                  this.SearchComponentsNotice = __varRecorder__$6.SearchComponentsNotice;
                }
              },
              isPrompt: {
                get: function get() {
                  return true;
                }
              },
              isEpiMorph: {
                get: function get() {
                  return true;
                }
              },
              isHaloItem: {
                get: function get() {
                  return true;
                }
              },
              importAlive: {
                defaultValue: false
              },
              selectionMode: {
                defaultValue: false
              },
              groupBy: {
                type: "Enum",
                values: ["name", "module"],
                defaultValue: "module"
              },
              db: {
                serialize: false,
                readOnly: true,
                get: function get() {
                  return __varRecorder__$6.MorphicDB["default"];
                }
              },
              expose: {
                get: function get() {
                  return ["activate", "isComponentBrowser", "reset", "isEpiMorph", "close", "isPrompt", "isHaloItem", "onWindowClose", "menuItems", "importAlive"];
                }
              }
            };
          }
        }], __lively_classholder__, {
          pathInPackage: function pathInPackage() {
            return "./studio/component-browser.cp.js";
          },
          unsubscribeFromToplevelDefinitionChanges: function unsubscribeFromToplevelDefinitionChanges() {
            return function () {};
          },
          subscribeToToplevelDefinitionChanges: function subscribeToToplevelDefinitionChanges() {
            return function () {};
          },
          "package": function _package() {
            return {
              name: "lively.ide",
              version: "0.1.0"
            };
          }
        }, {
          start: 24075,
          end: 43548
        });
      }(__varRecorder__$6.ViewModel);
      __varRecorder__$6.ComponentBrowserModel = ComponentBrowserModel;
      __varRecorder__$6.ComponentBrowserModel = ComponentBrowserModel;

      (function (superclass) {
        var __lively_classholder__ = lively.FreezerRuntime.recorderFor("lively.ide/studio/component-browser.cp.js");

        var __lively_class__ = __lively_classholder__.hasOwnProperty("ComponentBrowserPopupModel") && typeof __lively_classholder__.ComponentBrowserPopupModel === "function" ? __lively_classholder__.ComponentBrowserPopupModel : __lively_classholder__.ComponentBrowserPopupModel = function ComponentBrowserPopupModel(__first_arg__) {
          if (__first_arg__ && __first_arg__[Symbol["for"]("lively-instance-restorer")]) ; else {
            return this[Symbol["for"]("lively-instance-initialize")].apply(this, arguments);
          }
        };

        return initializeClass(__lively_class__, superclass, [{
          key: "bindings",
          get: function get() {
            return [].concat(_toConsumableArray(initializeClass._get(Object.getPrototypeOf(__lively_class__.prototype), "bindings", this)), [{
              target: "close button",
              signal: "onMouseUp",
              handler: "close"
            }]);
          }
        }, {
          key: "activate",
          value: function () {
            var _ComponentBrowserPopupModel_activate_ = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee34(pos) {
              var view;
              return regeneratorRuntime.wrap(function _callee34$(_context34) {
                while (1) {
                  switch (_context34.prev = _context34.next) {
                    case 0:
                      view = this.view;
                      view.doNotAcceptDropsForThisAndSubmorphs();
                      view.openInWorld();
                      view.clipMode = "hidden";
                      if (!pos) view.center = $world.visibleBounds().center();else view.position = pos;
                      _context34.next = 7;
                      return initializeClass._get(Object.getPrototypeOf(__lively_class__.prototype), "activate", this).call(this);

                    case 7:
                      return _context34.abrupt("return", _context34.sent);

                    case 8:
                    case "end":
                      return _context34.stop();
                  }
                }
              }, _callee34, this);
            }));

            function ComponentBrowserPopupModel_activate_(_x19) {
              return _ComponentBrowserPopupModel_activate_.apply(this, arguments);
            }

            return ComponentBrowserPopupModel_activate_;
          }()
        }, {
          key: "close",
          value: function ComponentBrowserPopupModel_close_() {
            initializeClass._get(Object.getPrototypeOf(__lively_class__.prototype), "close", this).call(this);

            this.view.remove();
          }
        }], [{
          key: Symbol["for"]("__LivelyClassName__"),
          get: function get() {
            return "ComponentBrowserPopupModel";
          }
        }], __lively_classholder__, {
          pathInPackage: function pathInPackage() {
            return "./studio/component-browser.cp.js";
          },
          unsubscribeFromToplevelDefinitionChanges: function unsubscribeFromToplevelDefinitionChanges() {
            return function () {};
          },
          subscribeToToplevelDefinitionChanges: function subscribeToToplevelDefinitionChanges() {
            return function () {};
          },
          "package": function _package() {
            return {
              name: "lively.ide",
              version: "0.1.0"
            };
          }
        }, {
          start: 43550,
          end: 44132
        });
      })(__varRecorder__$6.ComponentBrowserModel);

      __varRecorder__$6.ComponentPreview = __varRecorder__$6.component["for"](function () {
        return __varRecorder__$6.component({
          type: __varRecorder__$6.ExportedComponent,
          name: "component preview",
          layout: new __varRecorder__$6.TilingLayout({
            axis: "column",
            axisAlign: "center",
            hugContentsVertically: true,
            orderByIndex: true,
            padding: __varRecorder__$6.rect(5, 5, 0, 0),
            resizePolicies: [["component name", {
              height: "fixed",
              width: "fill"
            }]],
            spacing: 5
          }),
          borderColor: __varRecorder__$6.Color.transparent,
          borderRadius: 5,
          borderWidth: 2,
          extent: __varRecorder__$6.pt(129.5, 128.4),
          fill: __varRecorder__$6.Color.transparent,
          draggable: true,
          nativeCursor: "grab",
          submorphs: [{
            name: "preview container",
            layout: new __varRecorder__$6.TilingLayout({
              align: "center",
              axisAlign: "center",
              orderByIndex: true
            }),
            borderColor: __varRecorder__$6.Color.rgb(23, 160, 251),
            extent: __varRecorder__$6.pt(120, 100),
            fill: __varRecorder__$6.Color.rgba(0, 0, 0, 0),
            reactsToPointer: false,
            submorphs: [{
              name: "preview holder",
              borderColor: __varRecorder__$6.Color.rgb(23, 160, 251),
              dropShadow: new __varRecorder__$6.ShadowObject({
                distance: 5,
                rotation: 75,
                color: __varRecorder__$6.Color.rgba(0, 0, 0, 0.2),
                blur: 20,
                fast: false
              }),
              extent: __varRecorder__$6.pt(105, 45),
              naturalExtent: __varRecorder__$6.pt(105, 45),
              reactsToPointer: false
            }]
          }, {
            type: "text",
            name: "component name",
            textAlign: "center",
            fontColor: __varRecorder__$6.Color.darkGray,
            fixedWidth: true,
            fixedHeight: false,
            lineWrapping: true,
            fontSize: 14,
            fontWeight: "bold",
            clipMode: "hidden",
            reactsToPointer: false,
            textAndAttributes: ["Button", null]
          }]
        });
      }, {
        module: "lively.ide/studio/component-browser.cp.js",
        "export": "ComponentPreview",
        range: {
          start: 44140,
          end: 45642
        }
      }, __varRecorder__$6.ComponentPreview);
      __varRecorder__$6.ComponentPreviewDark = __varRecorder__$6.component["for"](function () {
        return __varRecorder__$6.component(__varRecorder__$6.ComponentPreview, {
          submorphs: [{
            name: "component name",
            fontColor: __varRecorder__$6.Color.rgb(204, 204, 204)
          }]
        });
      }, {
        module: "lively.ide/studio/component-browser.cp.js",
        "export": "ComponentPreviewDark",
        range: {
          start: 45650,
          end: 45794
        }
      }, __varRecorder__$6.ComponentPreviewDark);
      __varRecorder__$6.ComponentPreviewSelected = __varRecorder__$6.component["for"](function () {
        return __varRecorder__$6.component(__varRecorder__$6.ComponentPreview, {
          name: "component preview selected",
          borderColor: __varRecorder__$6.Color.rgb(33, 150, 243),
          borderWidth: 2,
          fill: __varRecorder__$6.Color.rgba(3, 169, 244, 0.75),
          submorphs: [{
            name: "component name",
            fontColor: __varRecorder__$6.Color.white
          }]
        });
      }, {
        module: "lively.ide/studio/component-browser.cp.js",
        "export": "ComponentPreviewSelected",
        range: {
          start: 45802,
          end: 46072
        }
      }, __varRecorder__$6.ComponentPreviewSelected);
      __varRecorder__$6.ComponentPreviewSelectedDark = __varRecorder__$6.component["for"](function () {
        return __varRecorder__$6.component(__varRecorder__$6.ComponentPreview, {
          borderColor: __varRecorder__$6.Color.rgb(52, 138, 117),
          borderWidth: 2,
          fill: __varRecorder__$6.Color.rgba(100, 255, 218, 0.6),
          submorphs: [{
            name: "component name",
            fontColor: __varRecorder__$6.Color.rgb(255, 255, 255)
          }]
        });
      }, {
        module: "lively.ide/studio/component-browser.cp.js",
        "export": "ComponentPreviewSelectedDark",
        range: {
          start: 46080,
          end: 46330
        }
      }, __varRecorder__$6.ComponentPreviewSelectedDark);
      __varRecorder__$6.ProjectSection = __varRecorder__$6.component["for"](function () {
        return __varRecorder__$6.component({
          type: __varRecorder__$6.ProjectEntry,
          name: "project section",
          layout: new __varRecorder__$6.TilingLayout({
            axis: "column",
            hugContentsVertically: true,
            orderByIndex: true,
            resizePolicies: [["project title", {
              height: "fixed",
              width: "fill"
            }], ["component previews", {
              height: "fixed",
              width: "fill"
            }]],
            wrapSubmorphs: false
          }),
          borderColor: __varRecorder__$6.Color.rgb(23, 160, 251),
          extent: __varRecorder__$6.pt(488.6, 154.2),
          fill: __varRecorder__$6.Color.rgba(0, 0, 0, 0),
          position: __varRecorder__$6.pt(647.1, 628.5),
          renderOnGPU: true,
          submorphs: [{
            type: __varRecorder__$6.Label,
            name: "project title",
            borderColor: __varRecorder__$6.Color.rgb(215, 219, 221),
            fontColor: __varRecorder__$6.Color.rgb(66, 73, 73),
            borderWidthBottom: 2,
            fontSize: 20,
            fontWeight: "bold",
            nativeCursor: "pointer",
            padding: __varRecorder__$6.rect(10, 8, -2, 0),
            textAndAttributes: ["Project Name", {}, "  ", {}, "\uF360", {
              fontFamily: "\"Font Awesome 5 Free\", \"Font Awesome 5 Brands\"",
              fontWeight: "900",
              nativeCursor: "pointer",
              paddingTop: "3px"
            }]
          }, {
            name: "component previews",
            borderColor: __varRecorder__$6.Color.rgb(23, 160, 251),
            extent: __varRecorder__$6.pt(489, 101.2),
            fill: __varRecorder__$6.Color.rgba(0, 0, 0, 0),
            layout: new __varRecorder__$6.TilingLayout({
              hugContentsVertically: true,
              orderByIndex: true,
              padding: __varRecorder__$6.rect(10, 10, 0, 0),
              spacing: 30,
              wrapSubmorphs: true
            })
          }]
        });
      }, {
        module: "lively.ide/studio/component-browser.cp.js",
        "export": "ProjectSection",
        range: {
          start: 46338,
          end: 47689
        }
      }, __varRecorder__$6.ProjectSection);
      __varRecorder__$6.ProjectSectionDark = __varRecorder__$6.component["for"](function () {
        return __varRecorder__$6.component(__varRecorder__$6.ProjectSection, {
          previewMaster: __varRecorder__$6.ComponentPreviewDark,
          selectedPreviewMaster: __varRecorder__$6.ComponentPreviewSelectedDark,
          submorphs: [{
            name: "project title",
            fontColor: __varRecorder__$6.Color.rgb(204, 204, 204),
            borderColor: __varRecorder__$6.Color.rgb(130, 130, 130)
          }]
        });
      }, {
        module: "lively.ide/studio/component-browser.cp.js",
        "export": "ProjectSectionDark",
        range: {
          start: 47697,
          end: 47973
        }
      }, __varRecorder__$6.ProjectSectionDark);
      __varRecorder__$6.SearchComponentsNotice = __varRecorder__$6.component["for"](function () {
        return __varRecorder__$6.component({
          extent: __varRecorder__$6.pt(663.7, 592.1),
          layout: new __varRecorder__$6.TilingLayout({
            axis: "column",
            axisAlign: "center",
            orderByIndex: true
          }),
          fill: __varRecorder__$6.Color.rgba(255, 255, 255, 0),
          submorphs: [{
            type: __varRecorder__$6.Text,
            name: "component box",
            extent: __varRecorder__$6.pt(164, 231),
            dropShadow: new __varRecorder__$6.ShadowObject({
              color: __varRecorder__$6.Color.rgba(0, 0, 0, 0.16),
              blur: 15,
              fast: false
            }),
            fontColor: __varRecorder__$6.Color.rgba(0, 0, 0, 0.25),
            fontSize: 164,
            fontWeight: 700,
            position: __varRecorder__$6.pt(-5, 26),
            textAndAttributes: ["\uF2A2", {
              fontFamily: "Tabler Icons",
              fontWeight: "900"
            }]
          }, {
            type: "text",
            name: "notice",
            textAlign: "center",
            fixedWidth: true,
            fontColor: __varRecorder__$6.Color.rgba(0, 0, 0, 0.25),
            dropShadow: new __varRecorder__$6.ShadowObject({
              color: __varRecorder__$6.Color.rgba(0, 0, 0, 0.16),
              blur: 15,
              fast: false
            }),
            fontSize: 34,
            fontWeight: 700,
            lineWrapping: true,
            textAndAttributes: ["Begin searching to display components...", null],
            extent: __varRecorder__$6.pt(354.6, 191)
          }]
        });
      }, {
        module: "lively.ide/studio/component-browser.cp.js",
        "export": "SearchComponentsNotice",
        range: {
          start: 47981,
          end: 49016
        }
      }, __varRecorder__$6.SearchComponentsNotice);
      __varRecorder__$6.SearchComponentsNoticeDark = __varRecorder__$6.component["for"](function () {
        return __varRecorder__$6.component(__varRecorder__$6.SearchComponentsNotice, {
          submorphs: [{
            name: "component box",
            fontColor: __varRecorder__$6.Color.rgba(255, 255, 255, 0.25)
          }, {
            name: "notice",
            fontColor: __varRecorder__$6.Color.rgba(255, 255, 255, 0.25)
          }]
        });
      }, {
        module: "lively.ide/studio/component-browser.cp.js",
        "export": "SearchComponentsNoticeDark",
        range: {
          start: 49024,
          end: 49260
        }
      }, __varRecorder__$6.SearchComponentsNoticeDark);
      __varRecorder__$6.ComponentBrowser = __varRecorder__$6.component["for"](function () {
        return __varRecorder__$6.component({
          defaultViewModel: __varRecorder__$6.ComponentBrowserModel,
          reactsToPointer: false,
          fill: __varRecorder__$6.Color.rgba(255, 255, 255, 0),
          extent: __varRecorder__$6.pt(515.1, 599.9),
          layout: new __varRecorder__$6.TilingLayout({
            axis: "column",
            axisAlign: "center",
            orderByIndex: true,
            padding: __varRecorder__$6.rect(16, 16, 0, 0),
            resizePolicies: [["search input wrapper", {
              height: "fixed",
              width: "fill"
            }], ["component files view", {
              height: "fixed",
              width: "fill"
            }], ["master component list", {
              height: "fill",
              width: "fill"
            }], ["button wrapper", {
              height: "fixed",
              width: "fill"
            }]],
            spacing: 16
          }),
          submorphs: [{
            name: "search input wrapper",
            layout: new __varRecorder__$6.TilingLayout({
              axisAlign: "center",
              orderByIndex: true,
              padding: __varRecorder__$6.rect(8, 0, -8, 0),
              resizePolicies: [["search input", {
                height: "fixed",
                width: "fill"
              }]]
            }),
            borderRadius: 3,
            borderColor: __varRecorder__$6.Color.rgb(23, 160, 251),
            extent: __varRecorder__$6.pt(388.4, 42.6),
            position: __varRecorder__$6.pt(120, 541),
            submorphs: [{
              type: __varRecorder__$6.Text,
              name: "search icon",
              extent: __varRecorder__$6.pt(17.5, 18),
              fontSize: 18,
              fontColor: __varRecorder__$6.Color.rgba(0, 0, 0, 0.5),
              cursorWidth: 1.5,
              fixedWidth: true,
              padding: __varRecorder__$6.rect(1, 1, 0, 0),
              textAndAttributes: ["\uF002", {
                fontFamily: "\"Font Awesome 5 Free\", \"Font Awesome 5 Brands\"",
                fontWeight: "900",
                lineHeight: 1.2
              }]
            }, __varRecorder__$6.part(__varRecorder__$6.InputLineDefault, {
              name: "search input",
              dropShadow: null,
              highlightWhenFocused: false,
              borderColor: __varRecorder__$6.Color.rgb(224, 224, 224),
              borderRadius: 2,
              extent: __varRecorder__$6.pt(445.3, 34.3),
              fill: __varRecorder__$6.Color.rgba(255, 255, 255, 0),
              padding: __varRecorder__$6.rect(6, 4, -4, 2),
              position: __varRecorder__$6.pt(11.9, 3.8),
              placeholder: "Search for components..."
            }), __varRecorder__$6.part(__varRecorder__$6.Spinner, {
              name: "spinner",
              opacity: 0.7,
              viewModel: {
                color: "black"
              },
              visible: false
            }), {
              type: __varRecorder__$6.Text,
              name: "search clear button",
              nativeCursor: "pointer",
              visible: false,
              fontColor: __varRecorder__$6.Color.rgba(0, 0, 0, 0.5),
              fontSize: 25,
              lineHeight: 2,
              padding: __varRecorder__$6.rect(1, 1, 9, 0),
              textAndAttributes: ["\uF00D", {
                fontFamily: "\"Font Awesome 5 Free\", \"Font Awesome 5 Brands\"",
                fontWeight: "900",
                lineHeight: 1
              }]
            }]
          }, __varRecorder__$6.part(__varRecorder__$6.MullerColumnView, {
            name: "component files view",
            viewModel: {
              listMaster: __varRecorder__$6.ColumnListDefault
            },
            borderColor: __varRecorder__$6.Color.rgb(149, 165, 166),
            borderWidth: 1,
            extent: __varRecorder__$6.pt(483, 150),
            borderRadius: 2
          }), {
            name: "master component list",
            borderColor: __varRecorder__$6.Color.rgb(149, 165, 166),
            borderWidth: 1,
            borderRadius: 2,
            fill: __varRecorder__$6.Color.rgb(238, 238, 238),
            clipMode: "auto",
            extent: __varRecorder__$6.pt(640, 304),
            layout: new __varRecorder__$6.TilingLayout({
              wrapSubmorphs: false,
              axis: "column"
            })
          }, {
            name: "button wrapper",
            height: 33.92421875,
            clipMode: "visible",
            fill: __varRecorder__$6.Color.transparent,
            layout: new __varRecorder__$6.TilingLayout({
              align: "right",
              axisAlign: "center",
              justifySubmorphs: "spaced",
              orderByIndex: true,
              resizePolicies: [["behavior toggle", {
                height: "fixed",
                width: "fill"
              }]],
              spacing: 15
            }),
            submorphs: [__varRecorder__$6.part(__varRecorder__$6.DropDownList, {
              name: "sorting selector",
              extent: __varRecorder__$6.pt(149.6, 25),
              viewModel: {
                openListInWorld: true,
                listMaster: __varRecorder__$6.SystemList,
                items: [{
                  isListItem: true,
                  label: [].concat(_toConsumableArray(__varRecorder__$6.Icon.textAttribute("boxes")), ["  By module", null]),
                  tooltip: "Group the components by the modules they are defined in.",
                  value: "module"
                }, {
                  isListItem: true,
                  label: [].concat(_toConsumableArray(__varRecorder__$6.Icon.textAttribute("tag", {
                    paddingLeft: "2px",
                    paddingTop: "2px"
                  })), ["  By name", null]),
                  tooltip: "Group the components by their names",
                  value: "name"
                }]
              },
              submorphs: [{
                name: "label",
                textAndAttributes: ["Arrange by name", null]
              }]
            }), __varRecorder__$6.part(__varRecorder__$6.LabeledCheckboxLight, {
              name: "behavior toggle",
              viewModel: {
                label: "Enable behavior"
              }
            }), __varRecorder__$6.part(__varRecorder__$6.SystemButton, {
              name: "edit button",
              extent: __varRecorder__$6.pt(80, 23.8),
              submorphs: [{
                name: "label",
                textAndAttributes: [].concat(_toConsumableArray(__varRecorder__$6.Icon.textAttribute("edit", {
                  fontColor: __varRecorder__$6.Color.rgbHex("D32F2F")
                })), [" Edit", {
                  fontFamily: "IBM Plex Sans"
                }])
              }]
            }), __varRecorder__$6.part(__varRecorder__$6.SystemButton, {
              name: "import button",
              extent: __varRecorder__$6.pt(80, 23.8),
              submorphs: [{
                name: "label",
                textAndAttributes: ["\uF56F", {
                  fontColor: __varRecorder__$6.Color.rgb(74, 174, 79),
                  fontFamily: "\"Font Awesome 5 Free\", \"Font Awesome 5 Brands\"",
                  fontWeight: "900",
                  lineHeight: 1
                }, " Open", {
                  fontFamily: "IBM Plex Sans"
                }]
              }]
            }), __varRecorder__$6.add(__varRecorder__$6.part(__varRecorder__$6.SystemButton, {
              name: "selection button",
              visible: false,
              extent: __varRecorder__$6.pt(80, 23.8),
              layout: new __varRecorder__$6.TilingLayout({
                align: "center",
                axisAlign: "center"
              }),
              submorphs: [{
                name: "label",
                textAndAttributes: ["Select", null]
              }]
            }))]
          }]
        });
      }, {
        module: "lively.ide/studio/component-browser.cp.js",
        "export": "ComponentBrowser",
        range: {
          start: 49268,
          end: 54505
        }
      }, __varRecorder__$6.ComponentBrowser);
      __varRecorder__$6.ComponentBrowserPopup = __varRecorder__$6.component["for"](function () {
        return __varRecorder__$6.component(__varRecorder__$6.PopupWindow, {
          defaultViewModel: __varRecorder__$6.ComponentBrowserPopupModel,
          hasFixedPosition: false,
          extent: __varRecorder__$6.pt(515, 658),
          layout: new __varRecorder__$6.TilingLayout({
            axis: "column",
            axisAlign: "center",
            hugContentsHorizontally: true,
            hugContentsVertically: true,
            orderByIndex: true,
            resizePolicies: [["header menu", {
              height: "fixed",
              width: "fill"
            }]]
          }),
          submorphs: [__varRecorder__$6.add(__varRecorder__$6.part(__varRecorder__$6.ComponentBrowser, {
            defaultViewModel: null,
            name: "controls",
            submorphs: [{
              name: "search input wrapper",
              fill: __varRecorder__$6.Color.rgb(238, 238, 238)
            }]
          })), {
            name: "header menu",
            submorphs: [{
              name: "title",
              fontSize: 18,
              reactsToPointer: false,
              textAndAttributes: ["Browse Components", null]
            }]
          }]
        });
      }, {
        module: "lively.ide/studio/component-browser.cp.js",
        "export": "ComponentBrowserPopup",
        range: {
          start: 54513,
          end: 55304
        }
      }, __varRecorder__$6.ComponentBrowserPopup);
      __varRecorder__$6.ComponentBrowserPopupDark = __varRecorder__$6.component["for"](function () {
        return __varRecorder__$6.component(__varRecorder__$6.ComponentBrowserPopup, {
          master: __varRecorder__$6.DarkPopupWindow,
          viewModel: {
            sectionMaster: __varRecorder__$6.ProjectSectionDark,
            SearchComponentsNotice: __varRecorder__$6.SearchComponentsNoticeDark
          },
          layout: new __varRecorder__$6.TilingLayout({
            axis: "column",
            axisAlign: "center",
            hugContentsHorizontally: true,
            hugContentsVertically: true,
            resizePolicies: [["header menu", {
              height: "fixed",
              width: "fill"
            }]]
          }),
          submorphs: [{
            name: "controls",
            submorphs: [{
              name: "search input wrapper",
              fill: __varRecorder__$6.Color.rgb(122, 122, 122),
              submorphs: [{
                name: "search icon",
                fontColor: __varRecorder__$6.Color.rgba(255, 255, 255, 0.5)
              }, {
                name: "search input",
                fontColor: __varRecorder__$6.Color.rgbHex("B2EBF2")
              }, {
                name: "spinner",
                viewModel: {
                  color: "white"
                },
                visible: false,
                position: __varRecorder__$6.pt(456.6, 4.4),
                scale: 0.35
              }, {
                name: "search clear button",
                fontColor: __varRecorder__$6.Color.rgba(255, 255, 255, 0.69)
              }]
            }, {
              name: "component files view",
              fill: __varRecorder__$6.Color.rgba(255, 255, 255, 0.1),
              borderColor: __varRecorder__$6.Color.rgb(112, 123, 124),
              borderWidth: 1,
              viewModel: {
                listMaster: __varRecorder__$6.ColumnListDark
              }
            }, {
              name: "master component list",
              fill: __varRecorder__$6.Color.rgba(238, 238, 238, 0.1),
              borderColor: __varRecorder__$6.Color.rgb(112, 123, 124),
              borderWidth: 1
            }, {
              name: "button wrapper",
              submorphs: [{
                name: "sorting selector",
                master: __varRecorder__$6.DarkDropDownList
              }, {
                name: "behavior toggle",
                master: __varRecorder__$6.LabeledCheckbox,
                submorphs: [{
                  name: "label",
                  textAndAttributes: ["Enable behavior", null],
                  fontColor: __varRecorder__$6.Color.white
                }]
              }, {
                name: "edit button",
                master: __varRecorder__$6.ButtonDarkDefault,
                submorphs: [{
                  name: "label",
                  fontColor: __varRecorder__$6.Color.rgb(255, 255, 255),
                  textAndAttributes: ["\uF044", {
                    fontColor: __varRecorder__$6.Color.rgbHex("B2EBF2"),
                    fontFamily: "\"Font Awesome 5 Free\", \"Font Awesome 5 Brands\"",
                    fontWeight: "900",
                    lineHeight: 1
                  }, " Edit", {
                    fontFamily: "IBM Plex Sans"
                  }]
                }]
              }, {
                name: "import button",
                master: __varRecorder__$6.ButtonDarkDefault,
                submorphs: [{
                  name: "label",
                  textAndAttributes: ["\uF56F", {
                    fontColor: __varRecorder__$6.Color.rgbHex("B2EBF2"),
                    fontFamily: "\"Font Awesome 5 Free\", \"Font Awesome 5 Brands\"",
                    fontWeight: "900",
                    lineHeight: 1
                  }, " Import", {
                    fontFamily: "IBM Plex Sans"
                  }]
                }]
              }, {
                name: "selection button",
                master: __varRecorder__$6.ButtonDarkDefault
              }]
            }]
          }]
        });
      }, {
        module: "lively.ide/studio/component-browser.cp.js",
        "export": "ComponentBrowserPopupDark",
        range: {
          start: 55312,
          end: 58072
        }
      }, __varRecorder__$6.ComponentBrowserPopupDark);
      __varRecorder__$6.ComponentError = __varRecorder__$6.component["for"](function () {
        return __varRecorder__$6.component({
          name: "component error",
          nativeCursor: "not-allowed",
          borderStyle: "none",
          borderColor: __varRecorder__$6.Color.rgb(189, 189, 189),
          dropShadow: new __varRecorder__$6.ShadowObject({
            color: __varRecorder__$6.Color.rgba(0, 0, 0, 0.52),
            blur: 15
          }),
          borderWidth: 2,
          borderRadius: 10,
          extent: __varRecorder__$6.pt(159.8, 159),
          fill: __varRecorder__$6.Color.rgba(0, 0, 0, 0.6719),
          layout: new __varRecorder__$6.TilingLayout({
            align: "center",
            axis: "column",
            axisAlign: "center",
            orderByIndex: true,
            padding: __varRecorder__$6.rect(10, 10, 0, 0),
            resizePolicies: [["error message", {
              height: "fixed",
              width: "fill"
            }]],
            spacing: 10
          }),
          position: __varRecorder__$6.pt(693.4, 588.2),
          submorphs: [{
            name: "backdrop",
            borderColor: __varRecorder__$6.Color.rgb(23, 160, 251),
            borderWidth: 1,
            extent: __varRecorder__$6.pt(10.6, 31.4),
            position: __varRecorder__$6.pt(7, 43),
            reactsToPointer: false,
            submorphs: [{
              type: __varRecorder__$6.Text,
              name: "warning sign",
              cursorWidth: 1.5,
              fill: __varRecorder__$6.Color.rgba(255, 255, 255, 0),
              fontColor: __varRecorder__$6.Color.rgb(255, 171, 64),
              fontSize: 48,
              reactsToPointer: false,
              lineWrapping: true,
              padding: __varRecorder__$6.rect(1, 1, 0, 0),
              position: __varRecorder__$6.pt(-19.7, -13.6),
              textAndAttributes: ["\uF071", {
                fontFamily: "\"Font Awesome 5 Free\", \"Font Awesome 5 Brands\"",
                fontWeight: "900",
                lineHeight: 1
              }]
            }]
          }, {
            type: __varRecorder__$6.Text,
            name: "error message",
            height: 70.91015625,
            fontWeight: 700,
            cursorWidth: 1.5,
            fill: __varRecorder__$6.Color.rgba(255, 255, 255, 0),
            fixedHeight: true,
            fixedWidth: true,
            fontColor: __varRecorder__$6.Color.rgb(255, 255, 255),
            lineWrapping: true,
            reactsToPointer: false,
            padding: __varRecorder__$6.rect(1, 1, 0, 0),
            position: __varRecorder__$6.pt(10, 81),
            textAlign: "center",
            textString: "This is not an error I would display explaining what went wrong."
          }]
        });
      }, {
        module: "lively.ide/studio/component-browser.cp.js",
        "export": "ComponentError",
        range: {
          start: 58080,
          end: 59851
        }
      }, __varRecorder__$6.ComponentError);
      var ComponentBrowser = __varRecorder__$6.ComponentBrowser;
      var ComponentBrowserPopup = __varRecorder__$6.ComponentBrowserPopup;
      var ComponentBrowserPopupDark = __varRecorder__$6.ComponentBrowserPopupDark;
      var ComponentPreview = __varRecorder__$6.ComponentPreview;
      var ComponentPreviewSelected = __varRecorder__$6.ComponentPreviewSelected;
      var ProjectSection = __varRecorder__$6.ProjectSection;
      var ComponentError = __varRecorder__$6.ComponentError;
      __varRecorder__$6.ComponentBrowser = ComponentBrowser;
      __varRecorder__$6.ComponentBrowserPopup = ComponentBrowserPopup;
      __varRecorder__$6.ComponentBrowserPopupDark = ComponentBrowserPopupDark;
      __varRecorder__$6.ComponentPreview = ComponentPreview;
      __varRecorder__$6.ComponentPreviewSelected = ComponentPreviewSelected;
      __varRecorder__$6.ProjectSection = ProjectSection;
      __varRecorder__$6.ComponentError = ComponentError;

      var componentBrowser_cp = /*#__PURE__*/Object.freeze({
        __proto__: null,
        ExportedComponent: ExportedComponent,
        ProjectEntry: ProjectEntry,
        NameSection: NameSection,
        ExportIndicator: ExportIndicator,
        ComponentBrowserModel: ComponentBrowserModel,
        ComponentBrowser: ComponentBrowser,
        ComponentBrowserPopup: ComponentBrowserPopup,
        ComponentBrowserPopupDark: ComponentBrowserPopupDark,
        ComponentPreview: ComponentPreview,
        ComponentPreviewSelected: ComponentPreviewSelected,
        ProjectSection: ProjectSection,
        ComponentError: ComponentError
      });

      var __varRecorder__$5 = lively.FreezerRuntime.recorderFor("lively.ide/studio/controls/component.cp.js");
      __varRecorder__$5.component = component;
      __varRecorder__$5.PropertySection = PropertySection;
      __varRecorder__$5.PropertySectionModel = PropertySectionModel;
      __varRecorder__$5.TilingLayout = TilingLayout;
      __varRecorder__$5.ViewModel = ViewModel;
      __varRecorder__$5.part = part;
      __varRecorder__$5.add = add;
      __varRecorder__$5.rect = rect;
      __varRecorder__$5.Color = Color;
      __varRecorder__$5.TextInput = TextInput;
      __varRecorder__$5.AddButton = AddButton;
      __varRecorder__$5.pt = pt;
      __varRecorder__$5.Text = Text;
      __varRecorder__$5.ComponentBrowserPopupDark = ComponentBrowserPopupDark;
      __varRecorder__$5.signal = signal;
      __varRecorder__$5.string = string;
      __varRecorder__$5.obj = obj;
      __varRecorder__$5.arr = arr;
      var ComponentSelectionControl = function (superclass) {
        var __lively_classholder__ = lively.FreezerRuntime.recorderFor("lively.ide/studio/controls/component.cp.js");

        var __lively_class__ = __lively_classholder__.hasOwnProperty("ComponentSelectionControl") && typeof __lively_classholder__.ComponentSelectionControl === "function" ? __lively_classholder__.ComponentSelectionControl : __lively_classholder__.ComponentSelectionControl = function ComponentSelectionControl(__first_arg__) {
          if (__first_arg__ && __first_arg__[Symbol["for"]("lively-instance-restorer")]) ; else {
            return this[Symbol["for"]("lively-instance-initialize")].apply(this, arguments);
          }
        };

        return initializeClass(__lively_class__, superclass, [{
          key: "viewDidLoad",
          value: function ComponentSelectionControl_viewDidLoad_() {
            this.onRefresh("component");
          }
        }, {
          key: "onRefresh",
          value: function () {
            var _ComponentSelectionControl_onRefresh_ = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee(prop) {
              return regeneratorRuntime.wrap(function _callee$(_context) {
                while (1) {
                  switch (_context.prev = _context.next) {
                    case 0:
                      this.ui.policyTypePin.textString = this.stateName;

                      if (!(prop !== "editable")) {
                        _context.next = 7;
                        break;
                      }

                      _context.next = 4;
                      return this.ui.policyTypePin.whenFontLoaded();

                    case 4:
                      this.ui.policyTypePin.fit();
                      this.ui.policyTypePin.readOnly = !this.editable;
                      this.ui.policyTypePin.nativeCursor = this.editable ? "text" : "auto";

                    case 7:
                      if (prop === "component") {
                        this.component ? this.activate() : this.deactivate();
                      }

                    case 8:
                    case "end":
                      return _context.stop();
                  }
                }
              }, _callee, this);
            }));

            function ComponentSelectionControl_onRefresh_(_x) {
              return _ComponentSelectionControl_onRefresh_.apply(this, arguments);
            }

            return ComponentSelectionControl_onRefresh_;
          }()
        }, {
          key: "clearComponent",
          value: function ComponentSelectionControl_clearComponent_() {
            this.component = null;

            __varRecorder__$5.signal(this.view, "componentChanged");
          }
        }, {
          key: "onInputStateName",
          value: function ComponentSelectionControl_onInputStateName_(evt) {
            var policyTypePin = this.ui.policyTypePin;

            if (evt.key == "Enter") {
              policyTypePin.textString = policyTypePin.textString.replace("\n", "");
              this.view.focus();
            }
          }
        }, {
          key: "startEditingStateName",
          value: function ComponentSelectionControl_startEditingStateName_() {
            if (!this.editable) return;
            this.ui.policyTypePin.master.setState("focused");
          }
        }, {
          key: "confirmStateName",
          value: function ComponentSelectionControl_confirmStateName_() {
            if (!this.editable) return;
            this.ui.policyTypePin.master.setState(null);
            this.stateName = this.ui.policyTypePin.textString;
            if (this.component) __varRecorder__$5.signal(this.view, "componentChanged");
          }
        }, {
          key: "selectComponent",
          value: function () {
            var _ComponentSelectionControl_selectComponent_ = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee2() {
              var selectedComponent;
              return regeneratorRuntime.wrap(function _callee2$(_context2) {
                while (1) {
                  switch (_context2.prev = _context2.next) {
                    case 0:
                      _context2.next = 2;
                      return __varRecorder__$5.part(__varRecorder__$5.ComponentBrowserPopupDark, {
                        hasFixedPosition: true,
                        viewModel: {
                          selectionMode: true
                        }
                      }).activate();

                    case 2:
                      selectedComponent = _context2.sent;

                      if (selectedComponent) {
                        this.component = selectedComponent;

                        __varRecorder__$5.signal(this.view, "componentChanged");
                      }

                    case 4:
                    case "end":
                      return _context2.stop();
                  }
                }
              }, _callee2, this);
            }));

            function ComponentSelectionControl_selectComponent_() {
              return _ComponentSelectionControl_selectComponent_.apply(this, arguments);
            }

            return ComponentSelectionControl_selectComponent_;
          }()
        }, {
          key: "deactivate",
          value: function ComponentSelectionControl_deactivate_() {
            this.ui.componentNameRef.input = "";
            this.view.master.setState("disabled");
          }
        }, {
          key: "activate",
          value: function ComponentSelectionControl_activate_() {
            if (this.component) {
              this.ui.componentNameRef.input = this.component[Symbol["for"]("lively-module-meta")].exportedName;
            }

            this.view.master.setState(null);
          }
        }], [{
          key: Symbol["for"]("__LivelyClassName__"),
          get: function get() {
            return "ComponentSelectionControl";
          }
        }, {
          key: "properties",
          get: function get() {
            return {
              component: {},
              editable: {
                defaultValue: false
              },
              stateName: {
                defaultValue: "AUTO"
              },
              expose: {
                get: function get() {
                  return ["component", "stateName"];
                }
              },
              bindings: {
                get: function get() {
                  return [{
                    target: "select component button",
                    signal: "onMouseDown",
                    handler: "selectComponent"
                  }, {
                    target: "no component button",
                    signal: "onMouseDown",
                    handler: "clearComponent"
                  }, {
                    target: "policy type pin",
                    signal: "onKeyDown",
                    handler: "onInputStateName"
                  }, {
                    target: "policy type pin",
                    signal: "onBlur",
                    handler: "confirmStateName"
                  }, {
                    target: "policy type pin",
                    signal: "onFocus",
                    handler: "startEditingStateName"
                  }];
                }
              }
            };
          }
        }], __lively_classholder__, {
          pathInPackage: function pathInPackage() {
            return "./studio/controls/component.cp.js";
          },
          unsubscribeFromToplevelDefinitionChanges: function unsubscribeFromToplevelDefinitionChanges() {
            return function () {};
          },
          subscribeToToplevelDefinitionChanges: function subscribeToToplevelDefinitionChanges() {
            return function () {};
          },
          "package": function _package() {
            return {
              name: "lively.ide",
              version: "0.1.0"
            };
          }
        }, {
          start: 583,
          end: 3425
        });
      }(__varRecorder__$5.ViewModel);
      __varRecorder__$5.ComponentSelectionControl = ComponentSelectionControl;
      __varRecorder__$5.ComponentSelectionControl = ComponentSelectionControl;
      __varRecorder__$5.PolicyPin = __varRecorder__$5.component["for"](function () {
        return __varRecorder__$5.component({
          type: __varRecorder__$5.Text,
          fontColor: __varRecorder__$5.Color.rgb(66, 73, 73),
          borderRadius: 17,
          fontFamily: "\"IBM Plex Mono\"",
          fontWeight: 700,
          textAlign: "left",
          textAndAttributes: ["AUTO", null],
          borderColor: __varRecorder__$5.Color.rgb(23, 160, 251),
          cursorWidth: 1.5,
          dynamicCursorColoring: true,
          extent: __varRecorder__$5.pt(53.5, 19.8),
          fill: __varRecorder__$5.Color.rgb(178, 235, 242),
          lineWrapping: true,
          padding: __varRecorder__$5.rect(5, 1, 0, 0),
          position: __varRecorder__$5.pt(-55, 30)
        });
      }, {
        module: "lively.ide/studio/controls/component.cp.js",
        "export": "PolicyPin",
        range: {
          start: 3432,
          end: 3864
        }
      }, __varRecorder__$5.PolicyPin);
      __varRecorder__$5.PolicyPinFocused = __varRecorder__$5.component["for"](function () {
        return __varRecorder__$5.component(__varRecorder__$5.PolicyPin, {
          borderWidth: 1,
          borderColor: __varRecorder__$5.Color.rgb(206, 147, 216),
          fill: __varRecorder__$5.Color.rgba(178, 235, 242, 0),
          fontColor: __varRecorder__$5.Color.rgb(206, 147, 216),
          padding: __varRecorder__$5.rect(4, 0, 0, 0)
        });
      }, {
        module: "lively.ide/studio/controls/component.cp.js",
        "export": "PolicyPinFocused",
        range: {
          start: 3872,
          end: 4080
        }
      }, __varRecorder__$5.PolicyPinFocused);
      var ComponentSelection = __varRecorder__$5.component["for"](function () {
        return __varRecorder__$5.component({
          defaultViewModel: __varRecorder__$5.ComponentSelectionControl,
          name: "selection controls",
          extent: __varRecorder__$5.pt(242.9, 45.7),
          layout: new __varRecorder__$5.TilingLayout({
            align: "right",
            padding: __varRecorder__$5.rect(17, 10, -7, 0),
            resizePolicies: [["component name ref", {
              height: "fixed",
              width: "fill"
            }]],
            spacing: 5
          }),
          fill: __varRecorder__$5.Color.rgba(255, 255, 255, 0),
          borderColor: __varRecorder__$5.Color.rgb(23, 160, 251),
          submorphs: [__varRecorder__$5.part(__varRecorder__$5.PolicyPin, {
            name: "policy type pin"
          }), __varRecorder__$5.part(__varRecorder__$5.TextInput, {
            name: "component name ref",
            placeholder: "no component",
            padding: __varRecorder__$5.rect(4, 2, -2, 2),
            readOnly: true,
            textAndAttributes: ["sfhgs", null]
          }), __varRecorder__$5.part(__varRecorder__$5.AddButton, {
            name: "select component button",
            tooltip: "Select Component",
            padding: __varRecorder__$5.rect(4, 4, 0, 0),
            textAndAttributes: ["\uF0C1", {
              fontFamily: "\"Font Awesome 6 Free\", \"Font Awesome 6 Brands\"",
              fontWeight: "900"
            }]
          }), __varRecorder__$5.part(__varRecorder__$5.AddButton, {
            name: "no component button",
            tooltip: "Clear Component",
            fontSize: 15,
            padding: __varRecorder__$5.rect(4, 4, 0, 0),
            textAndAttributes: ["\uE14C", {
              fontFamily: "Material Icons",
              fontWeight: "900"
            }]
          })]
        });
      }, {
        module: "lively.ide/studio/controls/component.cp.js",
        "export": "ComponentSelection",
        range: {
          start: 4095,
          end: 5251
        }
      }, __varRecorder__$5.ComponentSelection);
      __varRecorder__$5.ComponentSelection = ComponentSelection;
      __varRecorder__$5.ComponentSelection = ComponentSelection;
      var CustomStateComponentSelection = __varRecorder__$5.component["for"](function () {
        return __varRecorder__$5.component(__varRecorder__$5.ComponentSelection, {
          submorphs: [{
            name: "policy type pin",
            fill: __varRecorder__$5.Color.rgb(206, 147, 216)
          }, {
            name: "no component button",
            padding: __varRecorder__$5.rect(4, 2, 0, 2),
            tooltip: "Remove this custom component state.",
            textAndAttributes: ["\uF068", {
              fontFamily: "\"Font Awesome 6 Free\", \"Font Awesome 6 Brands\"",
              fontWeight: "900"
            }]
          }]
        });
      }, {
        module: "lively.ide/studio/controls/component.cp.js",
        "export": "CustomStateComponentSelection",
        range: {
          start: 5266,
          end: 5670
        }
      }, __varRecorder__$5.CustomStateComponentSelection);
      __varRecorder__$5.CustomStateComponentSelection = CustomStateComponentSelection;
      __varRecorder__$5.CustomStateComponentSelection = CustomStateComponentSelection;
      var ComponentSelectionDisabled = __varRecorder__$5.component["for"](function () {
        return __varRecorder__$5.component(__varRecorder__$5.ComponentSelection, {
          submorphs: [{
            name: "policy type pin",
            opacity: 0.3
          }, {
            name: "component name ref",
            opacity: 0.3,
            textAndAttributes: []
          }, {
            name: "no component button",
            visible: false
          }]
        });
      }, {
        module: "lively.ide/studio/controls/component.cp.js",
        "export": "ComponentSelectionDisabled",
        range: {
          start: 5685,
          end: 5957
        }
      }, __varRecorder__$5.ComponentSelectionDisabled);
      __varRecorder__$5.ComponentSelectionDisabled = ComponentSelectionDisabled;
      __varRecorder__$5.ComponentSelectionDisabled = ComponentSelectionDisabled;
      var ComponentControlModel = function (superclass) {
        var __lively_classholder__ = lively.FreezerRuntime.recorderFor("lively.ide/studio/controls/component.cp.js");

        var __lively_class__ = __lively_classholder__.hasOwnProperty("ComponentControlModel") && typeof __lively_classholder__.ComponentControlModel === "function" ? __lively_classholder__.ComponentControlModel : __lively_classholder__.ComponentControlModel = function ComponentControlModel(__first_arg__) {
          if (__first_arg__ && __first_arg__[Symbol["for"]("lively-instance-restorer")]) ; else {
            return this[Symbol["for"]("lively-instance-initialize")].apply(this, arguments);
          }
        };

        return initializeClass(__lively_class__, superclass, [{
          key: "bindings",
          get: function get() {
            return [].concat(_toConsumableArray(initializeClass._get(Object.getPrototypeOf(__lively_class__.prototype), "bindings", this)), [{
              target: /component selection/,
              signal: "componentChanged",
              handler: "confirm"
            }]);
          }
        }, {
          key: "confirm",
          value: function ComponentControlModel_confirm_() {
            var _this$targetMorph$mas,
                _this = this;

            var _this$ui = this.ui,
                autoComponentSelection = _this$ui.autoComponentSelection,
                hoverComponentSelection = _this$ui.hoverComponentSelection,
                clickComponentSelection = _this$ui.clickComponentSelection;
            var pos = this.targetMorph.position;
            var previousMaster = ((_this$targetMorph$mas = this.targetMorph.master) === null || _this$targetMorph$mas === void 0 ? void 0 : _this$targetMorph$mas.getConfig()) || {};
            this.targetMorph.withMetaDo({
              reconcileChanges: true
            }, function () {
              _this.targetMorph.master = Object.assign({}, previousMaster, {
                auto: autoComponentSelection.component,
                hover: hoverComponentSelection.component,
                click: clickComponentSelection.component
              });

              if (!_this.targetMorph.master.overriddenMaster) {
                _this.targetMorph.master._isOverridden = true;
              }
            });
            this.targetMorph.position = pos;

            __varRecorder__$5.signal(this.view, "component changed");
          }
        }, {
          key: "update",
          value: function ComponentControlModel_update_() {
            var stylePolicy = this.targetMorph.master;
            if (stylePolicy.overriddenMaster) stylePolicy = stylePolicy.overriddenMaster;
            var _this$ui2 = this.ui,
                autoComponentSelection = _this$ui2.autoComponentSelection,
                hoverComponentSelection = _this$ui2.hoverComponentSelection,
                clickComponentSelection = _this$ui2.clickComponentSelection;
            this.withoutBindingsDo(function () {
              var _stylePolicy, _stylePolicy2, _stylePolicy3;

              autoComponentSelection.component = (_stylePolicy = stylePolicy) === null || _stylePolicy === void 0 ? void 0 : _stylePolicy._parent;
              hoverComponentSelection.component = (_stylePolicy2 = stylePolicy) === null || _stylePolicy2 === void 0 ? void 0 : _stylePolicy2._hoverMaster;
              clickComponentSelection.component = (_stylePolicy3 = stylePolicy) === null || _stylePolicy3 === void 0 ? void 0 : _stylePolicy3._clickMaster;
            });
          }
        }, {
          key: "focusOn",
          value: function ComponentControlModel_focusOn_(aMorph) {
            this.targetMorph = aMorph;
            if (!aMorph.master) this.deactivate();else this.activate();
          }
        }, {
          key: "deactivate",
          value: function ComponentControlModel_deactivate_() {
            var _this2 = this;

            var _this$ui3 = this.ui,
                autoComponentSelection = _this$ui3.autoComponentSelection,
                hoverComponentSelection = _this$ui3.hoverComponentSelection,
                clickComponentSelection = _this$ui3.clickComponentSelection;

            initializeClass._get(Object.getPrototypeOf(__lively_class__.prototype), "deactivate", this).call(this);

            autoComponentSelection.visible = false;
            hoverComponentSelection.visible = false;
            clickComponentSelection.visible = false;

            if (this.targetMorph.master) {
              this.targetMorph.withMetaDo({
                reconcileChanges: true
              }, function () {
                _this2.targetMorph.master = null;
              });

              __varRecorder__$5.signal(this.view, "component changed");
            }
          }
        }, {
          key: "activate",
          value: function ComponentControlModel_activate_() {
            var _this$ui4 = this.ui,
                autoComponentSelection = _this$ui4.autoComponentSelection,
                hoverComponentSelection = _this$ui4.hoverComponentSelection,
                clickComponentSelection = _this$ui4.clickComponentSelection;

            initializeClass._get(Object.getPrototypeOf(__lively_class__.prototype), "activate", this).call(this);

            if (!this.targetMorph.master) {
              this.targetMorph.master = {};

              __varRecorder__$5.signal(this.view, "component changed");
            }

            autoComponentSelection.visible = true;
            hoverComponentSelection.visible = true;
            clickComponentSelection.visible = true;
            this.update();
          }
        }], [{
          key: Symbol["for"]("__LivelyClassName__"),
          get: function get() {
            return "ComponentControlModel";
          }
        }, {
          key: "properties",
          get: function get() {
            return {
              expose: {
                get: function get() {
                  return ["focusOn"];
                }
              }
            };
          }
        }], __lively_classholder__, {
          pathInPackage: function pathInPackage() {
            return "./studio/controls/component.cp.js";
          },
          unsubscribeFromToplevelDefinitionChanges: function unsubscribeFromToplevelDefinitionChanges() {
            return function () {};
          },
          subscribeToToplevelDefinitionChanges: function subscribeToToplevelDefinitionChanges() {
            return function () {};
          },
          "package": function _package() {
            return {
              name: "lively.ide",
              version: "0.1.0"
            };
          }
        }, {
          start: 5966,
          end: 8659
        });
      }(__varRecorder__$5.PropertySectionModel);
      __varRecorder__$5.ComponentControlModel = ComponentControlModel;
      __varRecorder__$5.ComponentControlModel = ComponentControlModel;
      __varRecorder__$5.ComponentControl = __varRecorder__$5.component["for"](function () {
        return __varRecorder__$5.component(__varRecorder__$5.PropertySection, {
          defaultViewModel: __varRecorder__$5.ComponentControlModel,
          name: "component control",
          extent: __varRecorder__$5.pt(223.4, 188),
          layout: new __varRecorder__$5.TilingLayout({
            axis: "column",
            hugContentsVertically: true,
            padding: __varRecorder__$5.rect(0, 10, 0, 0),
            resizePolicies: [["h floater", {
              height: "fixed",
              width: "fill"
            }], ["auto component selection", {
              height: "fixed",
              width: "fill"
            }], ["click component selection", {
              height: "fixed",
              width: "fill"
            }], ["hover component selection", {
              height: "fixed",
              width: "fill"
            }]]
          }),
          submorphs: [{
            name: "h floater",
            submorphs: [{
              name: "section headline",
              textAndAttributes: ["Component", null]
            }]
          }, __varRecorder__$5.add(__varRecorder__$5.part(__varRecorder__$5.ComponentSelection, {
            master: {
              states: {
                disabled: __varRecorder__$5.ComponentSelectionDisabled
              }
            },
            viewModel: {
              stateName: "AUTO"
            },
            name: "auto component selection"
          })), __varRecorder__$5.add(__varRecorder__$5.part(__varRecorder__$5.ComponentSelection, {
            master: {
              states: {
                disabled: __varRecorder__$5.ComponentSelectionDisabled
              }
            },
            viewModel: {
              stateName: "CLICK"
            },
            name: "click component selection"
          })), __varRecorder__$5.add(__varRecorder__$5.part(__varRecorder__$5.ComponentSelection, {
            master: {
              states: {
                disabled: __varRecorder__$5.ComponentSelectionDisabled
              }
            },
            viewModel: {
              stateName: "HOVER"
            },
            name: "hover component selection"
          }))]
        });
      }, {
        module: "lively.ide/studio/controls/component.cp.js",
        "export": "ComponentControl",
        range: {
          start: 8666,
          end: 10059
        }
      }, __varRecorder__$5.ComponentControl);

      (function (superclass) {
        var __lively_classholder__ = lively.FreezerRuntime.recorderFor("lively.ide/studio/controls/component.cp.js");

        var __lively_class__ = __lively_classholder__.hasOwnProperty("ComponentStatesControlModel") && typeof __lively_classholder__.ComponentStatesControlModel === "function" ? __lively_classholder__.ComponentStatesControlModel : __lively_classholder__.ComponentStatesControlModel = function ComponentStatesControlModel(__first_arg__) {
          if (__first_arg__ && __first_arg__[Symbol["for"]("lively-instance-restorer")]) ; else {
            return this[Symbol["for"]("lively-instance-initialize")].apply(this, arguments);
          }
        };

        return initializeClass(__lively_class__, superclass, [{
          key: "bindings",
          get: function get() {
            return [].concat(_toConsumableArray(initializeClass._get(Object.getPrototypeOf(__lively_class__.prototype), "bindings", this)), [{
              target: /component selection/,
              signal: "componentChanged",
              handler: "confirm"
            }]);
          }
        }, {
          key: "confirm",
          value: function ComponentStatesControlModel_confirm_() {
            var _this3 = this;

            var states = {};

            var _iterator = _createForOfIteratorHelper(this.getStatesConfig()),
                _step;

            try {
              for (_iterator.s(); !(_step = _iterator.n()).done;) {
                var _step$value = _step.value,
                    stateName = _step$value.stateName,
                    _component = _step$value.component;
                if (_component) states[stateName] = _component;
              }
            } catch (err) {
              _iterator.e(err);
            } finally {
              _iterator.f();
            }

            var prevMaster = this.targetMorph.master.getConfig();

            if (__varRecorder__$5.obj.isEmpty(states)) {
              delete prevMaster.states;
            } else prevMaster.states = states;

            this.targetMorph.withMetaDo({
              reconcileChanges: true
            }, function () {
              _this3.targetMorph.master = prevMaster;
            });
            this.focusOn(this.targetMorph);
          }
        }, {
          key: "getStatesConfig",
          value: function ComponentStatesControlModel_getStatesConfig_() {
            return this.ui.stateControls.submorphs.map(function (_ref) {
              var stateName = _ref.stateName,
                  component = _ref.component;
              return {
                stateName: stateName,
                component: component
              };
            });
          }
        }, {
          key: "ensureDynamicControls",
          value: function ComponentStatesControlModel_ensureDynamicControls_() {
            this.view.master.setState(null);
            var stateControls = this.ui.stateControls;
            stateControls.visible = true;
            var states = this.targetMorph.master._localComponentStates || [];
            stateControls.submorphs = Object.entries(states).map(function (_ref2) {
              var _ref3 = _slicedToArray(_ref2, 2),
                  stateName = _ref3[0],
                  component = _ref3[1];

              return __varRecorder__$5.part(__varRecorder__$5.CustomStateComponentSelection, {
                name: "component selection",
                viewModel: {
                  stateName: stateName,
                  component: component,
                  editable: true
                },
                submorphs: [{
                  name: "policy type pin",
                  master: {
                    states: {
                      focused: __varRecorder__$5.PolicyPinFocused
                    }
                  }
                }]
              });
            });
            stateControls.submorphs.forEach(function (m) {
              stateControls.layout.setResizePolicyFor(m, {
                width: "fill",
                height: "fixed"
              });
            });
          }
        }, {
          key: "getNewStateName",
          value: function ComponentStatesControlModel_getNewStateName_() {
            var candidate = "State_1";
            var currentStates = this.getStatesConfig().map(function (_ref4) {
              var stateName = _ref4.stateName;
              return stateName;
            });

            while (currentStates.includes(candidate)) {
              candidate = __varRecorder__$5.string.incName(candidate);
            }

            return candidate;
          }
        }, {
          key: "addDynamicState",
          value: function ComponentStatesControlModel_addDynamicState_() {
            var selectionControl = this.ui.stateControls.addMorph(__varRecorder__$5.part(__varRecorder__$5.CustomStateComponentSelection, {
              name: "component selection",
              viewModel: {
                stateName: this.getNewStateName(),
                editable: true
              },
              submorphs: [{
                name: "policy type pin",
                master: {
                  states: {
                    focused: __varRecorder__$5.PolicyPinFocused
                  }
                }
              }]
            }));
            this.ui.stateControls.layout.setResizePolicyFor(selectionControl, {
              width: "fill",
              height: "fixed"
            });
          }
        }, {
          key: "focusOn",
          value: function ComponentStatesControlModel_focusOn_(aMorph) {
            var _aMorph$master;

            this.targetMorph = aMorph;

            if (!((_aMorph$master = aMorph.master) === null || _aMorph$master === void 0 ? void 0 : _aMorph$master._localComponentStates)) {
              this.deactivate();
              return;
            }

            this.ensureDynamicControls();
          }
        }, {
          key: "activate",
          value: function ComponentStatesControlModel_activate_() {
            this.view.master.setState(null);
            this.ui.stateControls.visible = true;
            this.addDynamicState();
          }
        }, {
          key: "deactivate",
          value: function ComponentStatesControlModel_deactivate_() {
            initializeClass._get(Object.getPrototypeOf(__lively_class__.prototype), "deactivate", this).call(this);

            this.ui.stateControls.visible = false;
            this.ui.stateControls.submorphs = [];
          }
        }], [{
          key: Symbol["for"]("__LivelyClassName__"),
          get: function get() {
            return "ComponentStatesControlModel";
          }
        }, {
          key: "properties",
          get: function get() {
            return {
              expose: {
                get: function get() {
                  return ["focusOn"];
                }
              }
            };
          }
        }], __lively_classholder__, {
          pathInPackage: function pathInPackage() {
            return "./studio/controls/component.cp.js";
          },
          unsubscribeFromToplevelDefinitionChanges: function unsubscribeFromToplevelDefinitionChanges() {
            return function () {};
          },
          subscribeToToplevelDefinitionChanges: function subscribeToToplevelDefinitionChanges() {
            return function () {};
          },
          "package": function _package() {
            return {
              name: "lively.ide",
              version: "0.1.0"
            };
          }
        }, {
          start: 10062,
          end: 13204
        });
      })(__varRecorder__$5.PropertySectionModel);

      __varRecorder__$5.ComponentStatesControl = __varRecorder__$5.component["for"](function () {
        return __varRecorder__$5.component(__varRecorder__$5.PropertySection, {
          viewModelClass: __varRecorder__$5.ComponentStatesControlModel,
          layout: new __varRecorder__$5.TilingLayout({
            axis: "column",
            hugContentsVertically: true,
            padding: __varRecorder__$5.rect(0, 10, 0, 0),
            resizePolicies: [["h floater", {
              height: "fixed",
              width: "fill"
            }], ["state controls", {
              height: "fixed",
              width: "fill"
            }]],
            spacing: 10
          }),
          submorphs: [__varRecorder__$5.add({
            name: "state controls",
            layout: new __varRecorder__$5.TilingLayout({
              axis: "column",
              hugContentsVertically: true
            }),
            fill: __varRecorder__$5.Color.rgba(255, 255, 255, 0),
            borderColor: __varRecorder__$5.Color.rgb(23, 160, 251),
            extent: __varRecorder__$5.pt(107.7, 107.1),
            position: __varRecorder__$5.pt(-29.6, 24.5),
            visible: false
          }), {
            name: "h floater",
            submorphs: [{
              name: "section headline",
              textAndAttributes: ["Component States", null]
            }]
          }]
        });
      }, {
        module: "lively.ide/studio/controls/component.cp.js",
        "export": "ComponentStatesControl",
        range: {
          start: 13212,
          end: 14062
        }
      }, __varRecorder__$5.ComponentStatesControl);
      var ComponentControl = __varRecorder__$5.ComponentControl;
      var ComponentStatesControl = __varRecorder__$5.ComponentStatesControl;
      __varRecorder__$5.ComponentControl = ComponentControl;
      __varRecorder__$5.ComponentStatesControl = ComponentStatesControl;

      var __varRecorder__$4 = lively.FreezerRuntime.recorderFor("lively.ide/studio/controls/responsive.cp.js");
      __varRecorder__$4.PropertySection = PropertySection;
      __varRecorder__$4.PropertySectionModel = PropertySectionModel;
      __varRecorder__$4.component = component;
      __varRecorder__$4.ViewModel = ViewModel;
      __varRecorder__$4.TilingLayout = TilingLayout;
      __varRecorder__$4.rect = rect;
      __varRecorder__$4.pt = pt;
      __varRecorder__$4.Color = Color;
      __varRecorder__$4.add = add;
      __varRecorder__$4.part = part;
      __varRecorder__$4.AddButton = AddButton;
      __varRecorder__$4.PropertyLabelActive = PropertyLabelActive;
      __varRecorder__$4.PropertyLabelDisabled = PropertyLabelDisabled;
      __varRecorder__$4.DarkPopupWindow = DarkPopupWindow;
      __varRecorder__$4.Text = Text;
      __varRecorder__$4.ResponsiveLayoutHalo = ResponsiveLayoutHalo;
      __varRecorder__$4.getColorForBreakpoint = getColorForBreakpoint;
      __varRecorder__$4.grid = grid;
      __varRecorder__$4.arr = arr;
      __varRecorder__$4.obj = obj;
      __varRecorder__$4.disconnect = disconnect;
      __varRecorder__$4.connect = connect;
      __varRecorder__$4.signal = signal;
      __varRecorder__$4.epiConnect = epiConnect;
      __varRecorder__$4.ComponentSelection = ComponentSelection;
      __varRecorder__$4.ComponentSelectionDisabled = ComponentSelectionDisabled;
      __varRecorder__$4.PopupModel = PopupModel;
      __varRecorder__$4.ComponentBrowserPopupDark = ComponentBrowserPopupDark;

      (function (superclass) {
        var __lively_classholder__ = lively.FreezerRuntime.recorderFor("lively.ide/studio/controls/responsive.cp.js");

        var __lively_class__ = __lively_classholder__.hasOwnProperty("BreakpointEntryModel") && typeof __lively_classholder__.BreakpointEntryModel === "function" ? __lively_classholder__.BreakpointEntryModel : __lively_classholder__.BreakpointEntryModel = function BreakpointEntryModel(__first_arg__) {
          if (__first_arg__ && __first_arg__[Symbol["for"]("lively-instance-restorer")]) ; else {
            return this[Symbol["for"]("lively-instance-initialize")].apply(this, arguments);
          }
        };

        return initializeClass(__lively_class__, superclass, [{
          key: "getBreakpointSpec",
          value: function BreakpointEntryModel_getBreakpointSpec_() {
            var _this$targetStylePoli;

            var store = (_this$targetStylePoli = this.targetStylePolicy) === null || _this$targetStylePoli === void 0 ? void 0 : _this$targetStylePoli.getBreakpointStore();

            if (!store) {
              return;
            }

            return [__varRecorder__$4.pt(store._horizontalBreakpoints[this.breakpoint.h], store._verticalBreakpoints[this.breakpoint.v]), this.component];
          }
        }, {
          key: "update",
          value: function BreakpointEntryModel_update_(targetMorph) {
            var _this$targetStylePoli2;

            this.targetMorph = targetMorph;
            var store = (_this$targetStylePoli2 = this.targetStylePolicy) === null || _this$targetStylePoli2 === void 0 ? void 0 : _this$targetStylePoli2.getBreakpointStore();
            if (!store) return;
            var _this$ui = this.ui,
                horizontalPin = _this$ui.horizontalPin,
                verticalPin = _this$ui.verticalPin,
                configureComponentButton = _this$ui.configureComponentButton;
            var _verticalBreakpoints = store._verticalBreakpoints,
                _horizontalBreakpoints = store._horizontalBreakpoints,
                _breakpointMasters = store._breakpointMasters;
            var _this$breakpoint = this.breakpoint,
                v = _this$breakpoint.v,
                h = _this$breakpoint.h;
            var vOffset = _verticalBreakpoints[v];
            var hOffset = _horizontalBreakpoints[h];
            this.component = __varRecorder__$4.grid.get(_breakpointMasters, v, h);

            var isSelected = __varRecorder__$4.obj.equals([v, h], store.getMatchingBreakpoint(targetMorph));

            horizontalPin.textString = "w: ".concat(hOffset && hOffset.toFixed() || "*", " px");
            horizontalPin.fill = __varRecorder__$4.getColorForBreakpoint(h, "horizontal");
            horizontalPin.opacity = isSelected ? 1 : 0.5;
            verticalPin.textString = "h: ".concat(vOffset && vOffset.toFixed() || "*", " px");
            verticalPin.fill = __varRecorder__$4.getColorForBreakpoint(v, "vertical");
            verticalPin.opacity = isSelected ? 1 : 0.5;
            if (!this.componentSelectionEnabled) configureComponentButton.master.setState("disabled");else {
              configureComponentButton.master.setState(this._popup ? "active" : null);
            }
          }
        }, {
          key: "chooseComponent",
          value: function () {
            var _BreakpointEntryModel_chooseComponent_ = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee() {
              var _this = this;

              return regeneratorRuntime.wrap(function _callee$(_context) {
                while (1) {
                  switch (_context.prev = _context.next) {
                    case 0:
                      if (this.componentSelectionEnabled) {
                        _context.next = 2;
                        break;
                      }

                      return _context.abrupt("return");

                    case 2:
                      this._popup = __varRecorder__$4.part(__varRecorder__$4.ComponentSelectionPopup, {
                        viewModel: {
                          component: this.component
                        }
                      }).openInWorld();

                      this._popup.alignAtButton(this.ui.configureComponentButton);

                      __varRecorder__$4.connect(this._popup, "component changed", this, "confirm");

                      __varRecorder__$4.connect(this._popup, "remove", function () {
                        _this._popup = null;

                        _this.update(_this.targetMorph);
                      });

                      this.update(this.targetMorph);

                    case 7:
                    case "end":
                      return _context.stop();
                  }
                }
              }, _callee, this);
            }));

            function BreakpointEntryModel_chooseComponent_() {
              return _BreakpointEntryModel_chooseComponent_.apply(this, arguments);
            }

            return BreakpointEntryModel_chooseComponent_;
          }()
        }, {
          key: "confirm",
          value: function BreakpointEntryModel_confirm_(selectedComponent) {
            this.component = selectedComponent;

            __varRecorder__$4.signal(this.view, "component changed", selectedComponent);
          }
        }], [{
          key: Symbol["for"]("__LivelyClassName__"),
          get: function get() {
            return "BreakpointEntryModel";
          }
        }, {
          key: "properties",
          get: function get() {
            return {
              breakpoint: {
                defaultValue: {
                  h: 0,
                  v: 0
                }
              },
              componentSelectionEnabled: {
                defaultValue: true
              },
              component: {},
              targetMorph: {},
              expose: {
                get: function get() {
                  return ["update", "getBreakpointSpec"];
                }
              },
              targetStylePolicy: {
                get: function get() {
                  var stylePolicy = this.targetMorph.master;
                  if (stylePolicy.overriddenMaster) stylePolicy = stylePolicy.overriddenMaster;
                  return stylePolicy;
                }
              },
              bindings: {
                get: function get() {
                  return [{
                    target: "configure component button",
                    signal: "onMouseDown",
                    handler: "chooseComponent"
                  }];
                }
              }
            };
          }
        }], __lively_classholder__, {
          pathInPackage: function pathInPackage() {
            return "./studio/controls/responsive.cp.js";
          },
          unsubscribeFromToplevelDefinitionChanges: function unsubscribeFromToplevelDefinitionChanges() {
            return function () {};
          },
          subscribeToToplevelDefinitionChanges: function subscribeToToplevelDefinitionChanges() {
            return function () {};
          },
          "package": function _package() {
            return {
              name: "lively.ide",
              version: "0.1.0"
            };
          }
        }, {
          start: 943,
          end: 3963
        });
      })(__varRecorder__$4.ViewModel);

      var BreakpointEntry = __varRecorder__$4.component["for"](function () {
        return __varRecorder__$4.component({
          name: "breakpoint entry",
          defaultViewModel: __varRecorder__$4.BreakpointEntryModel,
          layout: new __varRecorder__$4.TilingLayout({
            axisAlign: "center",
            padding: __varRecorder__$4.rect(20, 0, -20, 0),
            resizePolicies: [["padding", {
              height: "fixed",
              width: "fill"
            }]],
            spacing: 5
          }),
          fill: __varRecorder__$4.Color.rgba(255, 255, 255, 0),
          borderColor: __varRecorder__$4.Color.rgb(23, 160, 251),
          extent: __varRecorder__$4.pt(238, 30),
          position: __varRecorder__$4.pt(6.4, 8.9),
          submorphs: [__varRecorder__$4.add({
            type: __varRecorder__$4.Text,
            name: "horizontal pin",
            textAndAttributes: ["w: 10px", null],
            borderRadius: 12,
            dynamicCursorColoring: true,
            extent: __varRecorder__$4.pt(98.7, 22.1),
            fill: __varRecorder__$4.Color.rgb(244, 67, 54),
            fixedHeight: true,
            fixedWidth: false,
            lineWrapping: true,
            padding: __varRecorder__$4.rect(5, 2, 0, -1),
            position: __varRecorder__$4.pt(7.1, 5.2)
          }), {
            type: __varRecorder__$4.Text,
            name: "vertical pin",
            extent: __varRecorder__$4.pt(97, 20.3),
            borderRadius: 12,
            dynamicCursorColoring: true,
            fill: __varRecorder__$4.Color.rgb(76, 175, 80),
            fixedHeight: true,
            fixedWidth: false,
            lineWrapping: true,
            padding: __varRecorder__$4.rect(5, 2, 0, -1),
            position: __varRecorder__$4.pt(-27, 26),
            textAndAttributes: ["h: *", null]
          }, {
            name: "padding",
            fill: __varRecorder__$4.Color.transparent
          }, __varRecorder__$4.add(__varRecorder__$4.part(__varRecorder__$4.AddButton, {
            master: {
              states: {
                active: __varRecorder__$4.PropertyLabelActive,
                disabled: __varRecorder__$4.PropertyLabelDisabled
              }
            },
            name: "configure component button",
            padding: __varRecorder__$4.rect(4, 4, 0, 0),
            textAndAttributes: ["\uEFA5", {
              fontFamily: "Tabler Icons",
              fontSize: 18,
              fontWeight: "900"
            }]
          }))]
        });
      }, {
        module: "lively.ide/studio/controls/responsive.cp.js",
        "export": "BreakpointEntry",
        range: {
          start: 3978,
          end: 5486
        }
      }, __varRecorder__$4.BreakpointEntry);
      __varRecorder__$4.BreakpointEntry = BreakpointEntry;
      __varRecorder__$4.BreakpointEntry = BreakpointEntry;

      (function (superclass) {
        var __lively_classholder__ = lively.FreezerRuntime.recorderFor("lively.ide/studio/controls/responsive.cp.js");

        var __lively_class__ = __lively_classholder__.hasOwnProperty("ComponentSelectionPopupModel") && typeof __lively_classholder__.ComponentSelectionPopupModel === "function" ? __lively_classholder__.ComponentSelectionPopupModel : __lively_classholder__.ComponentSelectionPopupModel = function ComponentSelectionPopupModel(__first_arg__) {
          if (__first_arg__ && __first_arg__[Symbol["for"]("lively-instance-restorer")]) ; else {
            return this[Symbol["for"]("lively-instance-initialize")].apply(this, arguments);
          }
        };

        return initializeClass(__lively_class__, superclass, [{
          key: "bindings",
          get: function get() {
            return [].concat(_toConsumableArray(initializeClass._get(Object.getPrototypeOf(__lively_class__.prototype), "bindings", this)), [{
              target: "component controls",
              signal: "componentChanged",
              handler: "confirm"
            }]);
          }
        }, {
          key: "viewDidLoad",
          value: function ComponentSelectionPopupModel_viewDidLoad_() {
            initializeClass._get(Object.getPrototypeOf(__lively_class__.prototype), "viewDidLoad", this).call(this);

            this.ui.componentControls.component = this.component;
          }
        }, {
          key: "confirm",
          value: function ComponentSelectionPopupModel_confirm_() {
            this.component = this.ui.componentControls.component;

            __varRecorder__$4.signal(this.view, "component changed", this.component);
          }
        }], [{
          key: Symbol["for"]("__LivelyClassName__"),
          get: function get() {
            return "ComponentSelectionPopupModel";
          }
        }, {
          key: "properties",
          get: function get() {
            return {
              isPropertiesPanelPopup: {
                get: function get() {
                  return true;
                }
              },
              isHaloItem: {
                get: function get() {
                  return true;
                }
              },
              expose: {
                get: function get() {
                  return ["close", "isPropertiesPanelPopup", "isHaloItem", "alignAtButton"];
                }
              },
              component: {}
            };
          }
        }], __lively_classholder__, {
          pathInPackage: function pathInPackage() {
            return "./studio/controls/responsive.cp.js";
          },
          unsubscribeFromToplevelDefinitionChanges: function unsubscribeFromToplevelDefinitionChanges() {
            return function () {};
          },
          subscribeToToplevelDefinitionChanges: function subscribeToToplevelDefinitionChanges() {
            return function () {};
          },
          "package": function _package() {
            return {
              name: "lively.ide",
              version: "0.1.0"
            };
          }
        }, {
          start: 5489,
          end: 6329
        });
      })(__varRecorder__$4.PopupModel);

      var ComponentSelectionPopup = __varRecorder__$4.component["for"](function () {
        return __varRecorder__$4.component(__varRecorder__$4.DarkPopupWindow, {
          defaultViewModel: __varRecorder__$4.ComponentSelectionPopupModel,
          layout: new __varRecorder__$4.TilingLayout({
            axis: "column",
            axisAlign: "center",
            hugContentsHorizontally: true,
            hugContentsVertically: true
          }),
          submorphs: [__varRecorder__$4.add(__varRecorder__$4.part(__varRecorder__$4.ComponentSelection, {
            master: {
              states: {
                disabled: __varRecorder__$4.ComponentSelectionDisabled
              }
            },
            name: "component controls",
            layout: new __varRecorder__$4.TilingLayout({
              align: "right",
              padding: __varRecorder__$4.rect(17, 10, -7, 0),
              resizePolicies: [["component name ref", {
                height: "fixed",
                width: "fill"
              }]],
              spacing: 5
            }),
            submorphs: [{
              name: "policy type pin",
              visible: false
            }]
          })), {
            name: "header menu",
            submorphs: [{
              name: "title",
              textAndAttributes: ["Breakpoint Component", null]
            }]
          }]
        });
      }, {
        module: "lively.ide/studio/controls/responsive.cp.js",
        "export": "ComponentSelectionPopup",
        range: {
          start: 6495,
          end: 7354
        }
      }, __varRecorder__$4.ComponentSelectionPopup);
      __varRecorder__$4.ComponentSelectionPopup = ComponentSelectionPopup;
      __varRecorder__$4.ComponentSelectionPopup = ComponentSelectionPopup;
      var ResponsiveControlModel = function (superclass) {
        var __lively_classholder__ = lively.FreezerRuntime.recorderFor("lively.ide/studio/controls/responsive.cp.js");

        var __lively_class__ = __lively_classholder__.hasOwnProperty("ResponsiveControlModel") && typeof __lively_classholder__.ResponsiveControlModel === "function" ? __lively_classholder__.ResponsiveControlModel : __lively_classholder__.ResponsiveControlModel = function ResponsiveControlModel(__first_arg__) {
          if (__first_arg__ && __first_arg__[Symbol["for"]("lively-instance-restorer")]) ; else {
            return this[Symbol["for"]("lively-instance-initialize")].apply(this, arguments);
          }
        };

        return initializeClass(__lively_class__, superclass, [{
          key: "bindings",
          get: function get() {
            return [].concat(_toConsumableArray(initializeClass._get(Object.getPrototypeOf(__lively_class__.prototype), "bindings", this)), [{
              target: /breakpoint control/,
              signal: "component changed",
              handler: "confirm"
            }]);
          }
        }, {
          key: "update",
          value: function ResponsiveControlModel_update_() {
            var _this$targetStylePoli3;

            var bpStore = (_this$targetStylePoli3 = this.targetStylePolicy) === null || _this$targetStylePoli3 === void 0 ? void 0 : _this$targetStylePoli3.getBreakpointStore();

            if (!bpStore) {
              this.ui.controls.submorphs = [];
              return;
            }

            this.ui.controls.submorphs = _toConsumableArray(__varRecorder__$4.grid.map(bpStore._breakpointMasters, function (master, v, h) {
              return __varRecorder__$4.part(__varRecorder__$4.BreakpointEntry, {
                name: "breakpoint control ".concat(v, " ").concat(h),
                viewModel: {
                  componentSelectionEnabled: v !== 0 || h !== 0,
                  breakpoint: {
                    v: v,
                    h: h
                  }
                }
              });
            }).flat());
            this.refreshFromTarget();
          }
        }, {
          key: "toggleResponsiveHalo",
          value: function ResponsiveControlModel_toggleResponsiveHalo_() {
            var h = this.targetMorph._responsiveHalo;

            if (h) {
              h.close();
            } else {
              __varRecorder__$4.part(__varRecorder__$4.ResponsiveLayoutHalo).openInWorld().focusOn(this.targetMorph);
            }

            this.update();
          }
        }, {
          key: "clearHalo",
          value: function ResponsiveControlModel_clearHalo_() {
            var _this$targetMorph, _this$targetMorph$_re;

            (_this$targetMorph = this.targetMorph) === null || _this$targetMorph === void 0 ? void 0 : (_this$targetMorph$_re = _this$targetMorph._responsiveHalo) === null || _this$targetMorph$_re === void 0 ? void 0 : _this$targetMorph$_re.close();
          }
        }, {
          key: "refreshFromTarget",
          value: function ResponsiveControlModel_refreshFromTarget_() {
            var _this2 = this;

            this.ui.controls.submorphs.forEach(function (m) {
              return m.update(_this2.targetMorph);
            });
          }
        }, {
          key: "focusOn",
          value: function ResponsiveControlModel_focusOn_(aMorph) {
            var _this$targetStylePoli4;

            if (this.targetMorph) {
              __varRecorder__$4.disconnect(this.targetMorph, "breakpoint removed", this, "update");

              __varRecorder__$4.disconnect(this.targetMorph, "breakpoint added", this, "update");

              __varRecorder__$4.disconnect(this.targetMorph, "breakpoint changed", this, "refreshFromTarget");

              __varRecorder__$4.disconnect(this.targetMorph, "extent", this, "refreshFromTarget");
            }

            this.targetMorph = aMorph;

            __varRecorder__$4.epiConnect(this.targetMorph, "breakpoint removed", this, "update");

            __varRecorder__$4.epiConnect(this.targetMorph, "breakpoint added", this, "update");

            __varRecorder__$4.epiConnect(this.targetMorph, "breakpoint changed", this, "refreshFromTarget");

            __varRecorder__$4.epiConnect(this.targetMorph, "extent", this, "refreshFromTarget");

            if ((_this$targetStylePoli4 = this.targetStylePolicy) === null || _this$targetStylePoli4 === void 0 ? void 0 : _this$targetStylePoli4._breakpointStore) this.activate();else this.deactivate();
          }
        }, {
          key: "activate",
          value: function () {
            var _ResponsiveControlModel_activate_ = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee2() {
              var policy, proceed, selectedComponent, pos;
              return regeneratorRuntime.wrap(function _callee2$(_context2) {
                while (1) {
                  switch (_context2.prev = _context2.next) {
                    case 0:
                      initializeClass._get(Object.getPrototypeOf(__lively_class__.prototype), "activate", this).call(this);

                      policy = this.targetStylePolicy;

                      if (policy) {
                        _context2.next = 17;
                        break;
                      }

                      _context2.next = 5;
                      return this.world().confirm(["Missing Base Style", {
                        fontWeight: "bold",
                        fontSize: 20
                      }, "\nThe morph you want to configure a responsive design for, is not associated with any master component that defines its \"base\" style. In order to proceed you need to select a master component to serve as the base style.\n", {
                        fontWeight: "normal",
                        fontSize: 18
                      }], {
                        customize: function customize(prompt) {
                          prompt.addStyleClass("Halo");
                          prompt.isHaloItem = true;
                        }
                      });

                    case 5:
                      proceed = _context2.sent;

                      if (proceed) {
                        _context2.next = 8;
                        break;
                      }

                      return _context2.abrupt("return", this.deactivate());

                    case 8:
                      _context2.next = 10;
                      return __varRecorder__$4.part(__varRecorder__$4.ComponentBrowserPopupDark, {
                        hasFixedPosition: true,
                        viewModel: {
                          selectionMode: true
                        }
                      }).activate();

                    case 10:
                      selectedComponent = _context2.sent;

                      if (selectedComponent) {
                        _context2.next = 13;
                        break;
                      }

                      return _context2.abrupt("return", this.deactivate());

                    case 13:
                      pos = this.targetMorph.position;
                      this.targetMorph.master = selectedComponent;
                      policy = this.targetStylePolicy;
                      this.targetMorph.position = pos;

                    case 17:
                      this.ui.controls.visible = true;

                      if (!policy._breakpointStore) {
                        policy.setBreakpoints([[__varRecorder__$4.pt(0, 0), policy.parent]]);
                        this.refreshChangeTrackers();
                        this.world().execCommand("show responsive halo for", {
                          target: this.targetMorph
                        });
                      }

                      this.update();

                    case 20:
                    case "end":
                      return _context2.stop();
                  }
                }
              }, _callee2, this);
            }));

            function ResponsiveControlModel_activate_() {
              return _ResponsiveControlModel_activate_.apply(this, arguments);
            }

            return ResponsiveControlModel_activate_;
          }()
        }, {
          key: "deactivate",
          value: function ResponsiveControlModel_deactivate_() {
            var _this$targetStylePoli5, _this$targetMorph$mas, _this$targetMorph$_re2;

            initializeClass._get(Object.getPrototypeOf(__lively_class__.prototype), "deactivate", this).call(this);

            this.ui.controls.visible = false;
            (_this$targetStylePoli5 = this.targetStylePolicy) === null || _this$targetStylePoli5 === void 0 ? void 0 : _this$targetStylePoli5.clearBreakpoints();
            (_this$targetMorph$mas = this.targetMorph.master) === null || _this$targetMorph$mas === void 0 ? void 0 : _this$targetMorph$mas.applyIfNeeded(true);
            this.refreshChangeTrackers();
            (_this$targetMorph$_re2 = this.targetMorph._responsiveHalo) === null || _this$targetMorph$_re2 === void 0 ? void 0 : _this$targetMorph$_re2.close();
            this.update();
          }
        }, {
          key: "refreshChangeTrackers",
          value: function ResponsiveControlModel_refreshChangeTrackers_() {
            if (!this.targetMorph._changeTracker) return;

            this.targetMorph._changeTracker.processChangeInComponent({
              prop: "master",
              meta: {
                reconcileChanges: true
              },
              target: this.targetMorph,
              value: this.targetStylePolicy
            });
          }
        }, {
          key: "getBreakpointSpec",
          value: function ResponsiveControlModel_getBreakpointSpec_() {
            return __varRecorder__$4.arr.compact(this.ui.controls.submorphs.map(function (bpControl) {
              return bpControl.getBreakpointSpec();
            }));
          }
        }, {
          key: "confirm",
          value: function ResponsiveControlModel_confirm_() {
            this.targetStylePolicy.setBreakpoints(this.getBreakpointSpec());
            this.refreshChangeTrackers();
            this.targetMorph.master.applyIfNeeded(true);
          }
        }], [{
          key: Symbol["for"]("__LivelyClassName__"),
          get: function get() {
            return "ResponsiveControlModel";
          }
        }, {
          key: "properties",
          get: function get() {
            return {
              targetMorph: {},
              targetStylePolicy: {
                get: function get() {
                  var _this$targetMorph2, _stylePolicy;

                  var stylePolicy = (_this$targetMorph2 = this.targetMorph) === null || _this$targetMorph2 === void 0 ? void 0 : _this$targetMorph2.master;
                  if ((_stylePolicy = stylePolicy) === null || _stylePolicy === void 0 ? void 0 : _stylePolicy.overriddenMaster) stylePolicy = stylePolicy.overriddenMaster;
                  return stylePolicy;
                }
              },
              expose: {
                get: function get() {
                  return ["focusOn"];
                }
              },
              responsiveHaloOpen: {
                get: function get() {
                  return this.targetMorph._responsiveHalo;
                }
              }
            };
          }
        }], __lively_classholder__, {
          pathInPackage: function pathInPackage() {
            return "./studio/controls/responsive.cp.js";
          },
          unsubscribeFromToplevelDefinitionChanges: function unsubscribeFromToplevelDefinitionChanges() {
            return function () {};
          },
          subscribeToToplevelDefinitionChanges: function subscribeToToplevelDefinitionChanges() {
            return function () {};
          },
          "package": function _package() {
            return {
              name: "lively.ide",
              version: "0.1.0"
            };
          }
        }, {
          start: 7363,
          end: 12316
        });
      }(__varRecorder__$4.PropertySectionModel);
      __varRecorder__$4.ResponsiveControlModel = ResponsiveControlModel;
      __varRecorder__$4.ResponsiveControlModel = ResponsiveControlModel;
      var ResponsiveControl = __varRecorder__$4.component["for"](function () {
        return __varRecorder__$4.component(__varRecorder__$4.PropertySection, {
          defaultViewModel: __varRecorder__$4.ResponsiveControlModel,
          layout: new __varRecorder__$4.TilingLayout({
            axis: "column",
            hugContentsVertically: true,
            padding: __varRecorder__$4.rect(0, 10, 0, 0),
            resizePolicies: [["h floater", {
              height: "fixed",
              width: "fill"
            }]],
            spacing: 10
          }),
          submorphs: [{
            name: "h floater",
            layout: new __varRecorder__$4.TilingLayout({
              axisAlign: "center",
              justifySubmorphs: "spaced",
              padding: __varRecorder__$4.rect(10, 0, 0, 0),
              spacing: 4
            }),
            submorphs: [{
              name: "section headline",
              textAndAttributes: ["Responsive Design", null]
            }, {
              name: "add button",
              tooltip: "Add Breakpoint Masters"
            }, {
              name: "remove button",
              tooltip: "Disable Breakpoints"
            }]
          }, __varRecorder__$4.add({
            name: "controls",
            layout: new __varRecorder__$4.TilingLayout({
              axis: "column",
              hugContentsVertically: true,
              resizePolicies: [["breakpoint entry", {
                height: "fixed",
                width: "fill"
              }], ["responsive halo toggle", {
                height: "fixed",
                width: "fill"
              }]]
            }),
            fill: __varRecorder__$4.Color.rgba(255, 255, 255, 0),
            borderColor: __varRecorder__$4.Color.rgb(23, 160, 251),
            extent: __varRecorder__$4.pt(194.9, 144.5),
            position: __varRecorder__$4.pt(-64.5, 19.6),
            submorphs: [__varRecorder__$4.part(__varRecorder__$4.BreakpointEntry, {
              name: "breakpoint entry"
            })]
          })]
        });
      }, {
        module: "lively.ide/studio/controls/responsive.cp.js",
        "export": "ResponsiveControl",
        range: {
          start: 12330,
          end: 13646
        }
      }, __varRecorder__$4.ResponsiveControl);
      __varRecorder__$4.ResponsiveControl = ResponsiveControl;
      __varRecorder__$4.ResponsiveControl = ResponsiveControl;

      var __varRecorder__$3 = lively.FreezerRuntime.recorderFor("lively.ide/studio/properties-panel.cp.js");
      __varRecorder__$3.TilingLayout = TilingLayout;
      __varRecorder__$3.easings = easings;
      __varRecorder__$3.touchInputDevice = touchInputDevice;
      __varRecorder__$3.component = component;
      __varRecorder__$3.without = without;
      __varRecorder__$3.add = add;
      __varRecorder__$3.ViewModel = ViewModel;
      __varRecorder__$3.part = part;
      __varRecorder__$3.Color = Color;
      __varRecorder__$3.Rectangle = Rectangle;
      __varRecorder__$3.pt = pt;
      __varRecorder__$3.rect = rect;
      __varRecorder__$3.ColorInput = ColorInput;
      __varRecorder__$3.epiConnect = epiConnect;
      __varRecorder__$3.disconnect = disconnect;
      __varRecorder__$3.RichTextControl = RichTextControl;
      __varRecorder__$3.ShapeControl = ShapeControl;
      __varRecorder__$3.LayoutControl = LayoutControl;
      __varRecorder__$3.BorderControl = BorderControl;
      __varRecorder__$3.FillControl = FillControl;
      __varRecorder__$3.ConstraintsManager = ConstraintsManager;
      __varRecorder__$3.BodyControl = BodyControl;
      __varRecorder__$3.PropertySection = PropertySection;
      __varRecorder__$3.DarkColorPicker = DarkColorPicker;
      __varRecorder__$3.EmbeddingControl = EmbeddingControl;
      __varRecorder__$3.ComponentControl = ComponentControl;
      __varRecorder__$3.ComponentStatesControl = ComponentStatesControl;
      __varRecorder__$3.ResponsiveControl = ResponsiveControl;
      var PropertiesPanelModel = function (superclass) {
        var __lively_classholder__ = lively.FreezerRuntime.recorderFor("lively.ide/studio/properties-panel.cp.js");

        var __lively_class__ = __lively_classholder__.hasOwnProperty("PropertiesPanelModel") && typeof __lively_classholder__.PropertiesPanelModel === "function" ? __lively_classholder__.PropertiesPanelModel : __lively_classholder__.PropertiesPanelModel = function PropertiesPanelModel(__first_arg__) {
          if (__first_arg__ && __first_arg__[Symbol["for"]("lively-instance-restorer")]) ; else {
            return this[Symbol["for"]("lively-instance-initialize")].apply(this, arguments);
          }
        };

        return initializeClass(__lively_class__, superclass, [{
          key: "isPropertiesPanel",
          get: function get() {
            return true;
          }
        }, {
          key: "refreshShapeControl",
          value: function PropertiesPanelModel_refreshShapeControl_() {
            this.ui.shapeControl.refreshFromTarget();
          }
        }, {
          key: "refreshComponentStatesControl",
          value: function PropertiesPanelModel_refreshComponentStatesControl_() {
            this.ui.componentStatesControl.visible = !!this.targetMorph.master;
          }
        }, {
          key: "refreshResponsiveControl",
          value: function PropertiesPanelModel_refreshResponsiveControl_() {
            var _this$targetMorph$mas;

            this.ui.responsiveControl.visible = !!((_this$targetMorph$mas = this.targetMorph.master) === null || _this$targetMorph$mas === void 0 ? void 0 : _this$targetMorph$mas.parent);
          }
        }, {
          key: "updateLayoutControl",
          value: function PropertiesPanelModel_updateLayoutControl_() {
            this.models.layoutControl.update();
          }
        }, {
          key: "onHierarchyChange",
          value: function PropertiesPanelModel_onHierarchyChange_() {}
        }, {
          key: "onTargetMovedInHierarchy",
          value: function PropertiesPanelModel_onTargetMovedInHierarchy_() {
            this.ui.shapeControl.refreshFromTarget();
            this.ui.constraintsControl.focusOn(this.targetMorph);
          }
        }, {
          key: "relayout",
          value: function PropertiesPanelModel_relayout_() {
            this.onWorldResize();
          }
        }, {
          key: "onWorldResize",
          value: function PropertiesPanelModel_onWorldResize_() {
            var align = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : true;
            var view = this.view;
            var bounds = $world.visibleBounds();
            var offsetTop = navigator.standalone && __varRecorder__$3.touchInputDevice ? 25 : 0;
            view.height = bounds.height - offsetTop;
            view.top = offsetTop + bounds.top();
            if (!align) return;

            if (view.owner) {
              view.topRight = bounds.topRight();
            } else view.topLeft = bounds.topRight();
          }
        }, {
          key: "toggle",
          value: function () {
            var _PropertiesPanelModel_toggle_ = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee(active) {
              var view, bounds, zoomIndicator, openedHalos;
              return regeneratorRuntime.wrap(function _callee$(_context) {
                while (1) {
                  switch (_context.prev = _context.next) {
                    case 0:
                      view = this.view;
                      bounds = $world.visibleBounds();
                      zoomIndicator = $world.get("world zoom indicator");
                      this.onWorldResize(false);

                      if (!active) {
                        _context.next = 11;
                        break;
                      }

                      $world.withTopBarDo(function (topBar) {
                        view.opacity = 0;
                        $world.addMorph(view, topBar.view);
                      });
                      view.topLeft = bounds.topRight();
                      view.withAnimationDo(function () {
                        var _$world$get;

                        view.opacity = 1, view.topRight = bounds.topRight();
                        zoomIndicator === null || zoomIndicator === void 0 ? void 0 : zoomIndicator.relayout();
                        (_$world$get = $world.get("world mini map")) === null || _$world$get === void 0 ? void 0 : _$world$get.relayout();
                      }, {
                        easing: __varRecorder__$3.easings.outCirc,
                        duration: 300
                      });
                      this.attachToWorld($world);
                      _context.next = 15;
                      break;

                    case 11:
                      this.detachFromWorld($world);
                      _context.next = 14;
                      return view.withAnimationDo(function () {
                        var _$world$get2;

                        view.opacity = 0, view.topLeft = bounds.topRight();
                        zoomIndicator === null || zoomIndicator === void 0 ? void 0 : zoomIndicator.relayout();
                        (_$world$get2 = $world.get("world mini map")) === null || _$world$get2 === void 0 ? void 0 : _$world$get2.relayout();
                      }, {
                        duration: 300
                      });

                    case 14:
                      view.remove();

                    case 15:
                      openedHalos = $world.halos();
                      if (openedHalos.length > 0 && openedHalos[0].target.isMorph) this.focusOn(openedHalos[0].target);

                    case 17:
                    case "end":
                      return _context.stop();
                  }
                }
              }, _callee, this);
            }));

            function PropertiesPanelModel_toggle_(_x) {
              return _PropertiesPanelModel_toggle_.apply(this, arguments);
            }

            return PropertiesPanelModel_toggle_;
          }()
        }, {
          key: "attachToTarget",
          value: function PropertiesPanelModel_attachToTarget_(aMorph) {
            this.models.backgroundControl.focusOn(aMorph);

            __varRecorder__$3.epiConnect(aMorph, "onHaloOpened", this, "focusOn", {
              garbageCollect: true
            });

            __varRecorder__$3.epiConnect(aMorph, "onHaloRemoved", this, "clearFocus", {
              garbageCollect: true
            });
          }
        }, {
          key: "detachFromTarget",
          value: function PropertiesPanelModel_detachFromTarget_(aMorph) {
            var _this = this;

            this.models.backgroundControl.clearFocus();
            aMorph.attributeConnections.forEach(function (conn) {
              if (conn.targetObj === _this) conn.disconnect();
            });
          }
        }, {
          key: "attachToWorld",
          value: function PropertiesPanelModel_attachToWorld_(aWorld) {
            this.models.backgroundControl.focusOn(aWorld);

            __varRecorder__$3.epiConnect(aWorld, "showHaloFor", this, "focusOn", {
              garbageCollect: true
            });

            __varRecorder__$3.epiConnect(aWorld, "onHaloRemoved", this, "clearFocus", {
              garbageCollect: true
            });
          }
        }, {
          key: "detachFromWorld",
          value: function PropertiesPanelModel_detachFromWorld_(aWorld) {
            var _this2 = this;

            this.models.backgroundControl.clearFocus();
            aWorld.attributeConnections.forEach(function (conn) {
              if (conn.targetObj === _this2) conn.disconnect();
            });
          }
        }, {
          key: "toggleDefaultControls",
          value: function PropertiesPanelModel_toggleDefaultControls_(active) {
            var _this$ui = this.ui,
                shapeControl = _this$ui.shapeControl,
                fillControl = _this$ui.fillControl,
                textControl = _this$ui.textControl,
                layoutControl = _this$ui.layoutControl,
                constraintsControl = _this$ui.constraintsControl,
                borderControl = _this$ui.borderControl,
                effectsControl = _this$ui.effectsControl,
                embeddingControl = _this$ui.embeddingControl,
                componentControl = _this$ui.componentControl,
                responsiveControl = _this$ui.responsiveControl,
                componentStatesControl = _this$ui.componentStatesControl;
            [shapeControl, fillControl, textControl, layoutControl, constraintsControl, borderControl, effectsControl, embeddingControl, componentControl, responsiveControl, componentStatesControl].forEach(function (m) {
              return m.visible = active;
            });
            embeddingControl.visible = false;
          }
        }, {
          key: "clearFocus",
          value: function PropertiesPanelModel_clearFocus_() {
            $world.withAllSubmorphsDo(function (m) {
              return m.isPropertiesPanelPopup && m.close();
            });

            if (this.targetMorph) {
              __varRecorder__$3.disconnect(this.targetMorph, "onOwnerChanged", this, "onTargetMovedInHierarchy");

              this.targetMorph = null;
            }

            this.ui.backgroundControl.visible = true;
            this.models.backgroundControl.onRefresh();
            this.toggleDefaultControls(false);
            this.models.effectsControl.deactivate();
            this.models.fillControl.deactivate();
            this.models.borderControl.targetMorph = null;
            this.models.borderControl.deactivate();
            this.models.textControl.deactivate();
            this.models.responsiveControl.clearHalo();
          }
        }, {
          key: "clearFocusIfRemoved",
          value: function PropertiesPanelModel_clearFocusIfRemoved_() {
            if (this.targetMorph && !this.targetMorph.owner) {
              this.clearFocus();
            }
          }
        }, {
          key: "focusOn",
          value: function PropertiesPanelModel_focusOn_(aMorph) {
            var _aMorph$owner;

            $world.withAllSubmorphsDo(function (m) {
              return m.isPropertiesPanelPopup && m.close();
            });
            if (aMorph.isWorld) return;
            if (Array.isArray(aMorph) && aMorph.length === 1) aMorph = aMorph[0];
            if (!aMorph.isMorph) return;
            var _this$models = this.models,
                shapeControl = _this$models.shapeControl,
                fillControl = _this$models.fillControl,
                textControl = _this$models.textControl,
                layoutControl = _this$models.layoutControl,
                constraintsControl = _this$models.constraintsControl,
                embeddingControl = _this$models.embeddingControl,
                borderControl = _this$models.borderControl,
                effectsControl = _this$models.effectsControl,
                backgroundControl = _this$models.backgroundControl;
                _this$models.alignmentControl;
                var componentControl = _this$models.componentControl,
                responsiveControl = _this$models.responsiveControl,
                componentStatesControl = _this$models.componentStatesControl;

            if (this.targetMorph) {
              __varRecorder__$3.disconnect(this.targetMorph, "onOwnerChanged", this, "onTargetMovedInHierarchy");

              __varRecorder__$3.disconnect(this.targetMorph, "remove", this, "clearFocusIfRemoved");
            }

            this.targetMorph = aMorph;

            __varRecorder__$3.epiConnect(aMorph, "onOwnerChanged", this, "onTargetMovedInHierarchy");

            __varRecorder__$3.epiConnect(aMorph, "remove", this, "clearFocusIfRemoved");

            this.toggleDefaultControls(true);
            this.ui.backgroundControl.visible = false;
            backgroundControl.deactivate();
            shapeControl.focusOn(aMorph);

            if (aMorph.isText || aMorph.isLabel) {
              textControl.view.visible = true;
              textControl.focusOn(aMorph);
              layoutControl.view.visible = false;
            } else {
              textControl.view.visible = false;
            }

            if ((_aMorph$owner = aMorph.owner) === null || _aMorph$owner === void 0 ? void 0 : _aMorph$owner.isText) {
              embeddingControl.view.visible = true;
              embeddingControl.focusOn(aMorph);
            }

            fillControl.focusOn(aMorph);
            layoutControl.focusOn(aMorph);

            if (aMorph.owner && aMorph.owner !== $world) {
              constraintsControl.view.visible = true;
              constraintsControl.focusOn(aMorph);
            } else {
              constraintsControl.view.visible = false;
            }

            this.refreshComponentStatesControl();
            borderControl.focusOn(aMorph);
            effectsControl.focusOn(aMorph);
            componentControl.focusOn(aMorph);
            componentStatesControl.focusOn(aMorph);
            responsiveControl.focusOn(aMorph);
          }
        }], [{
          key: Symbol["for"]("__LivelyClassName__"),
          get: function get() {
            return "PropertiesPanelModel";
          }
        }, {
          key: "properties",
          get: function get() {
            return {
              targetMorph: {},
              isHaloItem: {
                get: function get() {
                  return true;
                }
              },
              bindings: {
                get: function get() {
                  return [{
                    model: "layout control",
                    signal: "layout changed",
                    handler: "refreshShapeControl"
                  }, {
                    target: "component control",
                    signal: "component changed",
                    handler: "refreshResponsiveControl"
                  }, {
                    target: "component control",
                    signal: "component changed",
                    handler: "refreshComponentStatesControl"
                  }, {
                    target: "component control",
                    signal: "deactivate",
                    handler: "refreshResponsiveControl"
                  }];
                }
              },
              expose: {
                get: function get() {
                  return ["focusOn", "relayout", "isHaloItem", "toggle", "onHierarchyChange", "clearFocus", "isPropertiesPanel"];
                }
              }
            };
          }
        }], __lively_classholder__, {
          pathInPackage: function pathInPackage() {
            return "./studio/properties-panel.cp.js";
          },
          unsubscribeFromToplevelDefinitionChanges: function unsubscribeFromToplevelDefinitionChanges() {
            return function () {};
          },
          subscribeToToplevelDefinitionChanges: function subscribeToToplevelDefinitionChanges() {
            return function () {};
          },
          "package": function _package() {
            return {
              name: "lively.ide",
              version: "0.1.0"
            };
          }
        }, {
          start: 1095,
          end: 8928
        });
      }(__varRecorder__$3.ViewModel);
      __varRecorder__$3.PropertiesPanelModel = PropertiesPanelModel;
      __varRecorder__$3.PropertiesPanelModel = PropertiesPanelModel;

      (function (superclass) {
        var __lively_classholder__ = lively.FreezerRuntime.recorderFor("lively.ide/studio/properties-panel.cp.js");

        var __lively_class__ = __lively_classholder__.hasOwnProperty("BackgroundControlModel") && typeof __lively_classholder__.BackgroundControlModel === "function" ? __lively_classholder__.BackgroundControlModel : __lively_classholder__.BackgroundControlModel = function BackgroundControlModel(__first_arg__) {
          if (__first_arg__ && __first_arg__[Symbol["for"]("lively-instance-restorer")]) ; else {
            return this[Symbol["for"]("lively-instance-initialize")].apply(this, arguments);
          }
        };

        return initializeClass(__lively_class__, superclass, [{
          key: "onMouseDown",
          value: function BackgroundControlModel_onMouseDown_() {
            this.deactivate();
          }
        }, {
          key: "focusOn",
          value: function BackgroundControlModel_focusOn_(aMorph) {
            this.targetMorph = aMorph;
            this.models.backgroundFillInput.targetMorph = aMorph;
            this.onRefresh();
          }
        }, {
          key: "clearFocus",
          value: function BackgroundControlModel_clearFocus_() {
            this.targetMorph = null;
          }
        }, {
          key: "onRefresh",
          value: function BackgroundControlModel_onRefresh_() {
            if (this.targetMorph) {
              this.ui.backgroundFillInput.setColor(this.targetMorph.fill);
            }
          }
        }, {
          key: "changeBackgroundColor",
          value: function BackgroundControlModel_changeBackgroundColor_(color) {
            if (this.targetMorph) {
              this.targetMorph.fill = color;
            }
          }
        }, {
          key: "deactivate",
          value: function BackgroundControlModel_deactivate_() {
            this.models.backgroundFillInput.closeColorPicker();
          }
        }], [{
          key: Symbol["for"]("__LivelyClassName__"),
          get: function get() {
            return "BackgroundControlModel";
          }
        }, {
          key: "properties",
          get: function get() {
            return {
              bindings: {
                get: function get() {
                  return [{
                    model: "background fill input",
                    signal: "color",
                    handler: "changeBackgroundColor"
                  }, {
                    signal: "onMouseDown",
                    handler: "onMouseDown"
                  }];
                }
              }
            };
          }
        }], __lively_classholder__, {
          pathInPackage: function pathInPackage() {
            return "./studio/properties-panel.cp.js";
          },
          unsubscribeFromToplevelDefinitionChanges: function unsubscribeFromToplevelDefinitionChanges() {
            return function () {};
          },
          subscribeToToplevelDefinitionChanges: function subscribeToToplevelDefinitionChanges() {
            return function () {};
          },
          "package": function _package() {
            return {
              name: "lively.ide",
              version: "0.1.0"
            };
          }
        }, {
          start: 8930,
          end: 9896
        });
      })(__varRecorder__$3.ViewModel);

      __varRecorder__$3.BackgroundControl = __varRecorder__$3.component["for"](function () {
        return __varRecorder__$3.component(__varRecorder__$3.PropertySection, {
          defaultViewModel: __varRecorder__$3.BackgroundControlModel,
          name: "background control",
          layout: new __varRecorder__$3.TilingLayout({
            axis: "column",
            hugContentsVertically: true,
            orderByIndex: true,
            padding: __varRecorder__$3.rect(0, 10, 0, 10),
            resizePolicies: [["h floater", {
              height: "fixed",
              width: "fill"
            }]],
            spacing: 10
          }),
          extent: __varRecorder__$3.pt(250, 88),
          submorphs: [{
            name: "h floater",
            submorphs: [{
              name: "section headline",
              textAndAttributes: ["Background", null]
            }, __varRecorder__$3.without("add button"), __varRecorder__$3.without("remove button")]
          }, __varRecorder__$3.add(__varRecorder__$3.part(__varRecorder__$3.ColorInput, {
            name: "background fill input",
            viewModel: {
              gradientEnabled: true,
              colorPickerComponent: __varRecorder__$3.DarkColorPicker
            }
          }))]
        });
      }, {
        module: "lively.ide/studio/properties-panel.cp.js",
        "export": "BackgroundControl",
        range: {
          start: 9904,
          end: 10659
        }
      }, __varRecorder__$3.BackgroundControl);
      var defaultPropertiesPanelWidth = 250;
      __varRecorder__$3.defaultPropertiesPanelWidth = defaultPropertiesPanelWidth;
      __varRecorder__$3.defaultPropertiesPanelWidth = defaultPropertiesPanelWidth;
      __varRecorder__$3.PropertiesPanel = __varRecorder__$3.component["for"](function () {
        return __varRecorder__$3.component({
          defaultViewModel: __varRecorder__$3.PropertiesPanelModel,
          name: "properties panel",
          width: __varRecorder__$3.defaultPropertiesPanelWidth,
          height: 1000,
          hideScrollbars: true,
          fill: __varRecorder__$3.Color.rgb(30, 30, 30).withA(0.95),
          clipMode: "auto",
          layout: new __varRecorder__$3.TilingLayout({
            axis: "column",
            padding: __varRecorder__$3.rect(0, 50, 0, -50),
            resizePolicies: [["shape control", {
              height: "fixed",
              width: "fill"
            }], ["text control", {
              height: "fixed",
              width: "fill"
            }], ["component control", {
              height: "fixed",
              width: "fill"
            }], ["component states control", {
              height: "fixed",
              width: "fill"
            }], ["responsive control", {
              height: "fixed",
              width: "fill"
            }], ["layout control", {
              height: "fixed",
              width: "fill"
            }], ["embedding control", {
              height: "fixed",
              width: "fill"
            }], ["constraints control", {
              height: "fixed",
              width: "fill"
            }], ["fill control", {
              height: "fixed",
              width: "fill"
            }], ["border control", {
              height: "fixed",
              width: "fill"
            }], ["effects control", {
              height: "fixed",
              width: "fill"
            }]]
          }),
          submorphs: [__varRecorder__$3.part(__varRecorder__$3.BackgroundControl, {
            name: "background control"
          }), __varRecorder__$3.part(__varRecorder__$3.ShapeControl, {
            name: "shape control",
            visible: false
          }), __varRecorder__$3.part(__varRecorder__$3.RichTextControl, {
            name: "text control",
            visible: false,
            viewModel: {
              globalMode: true
            },
            submorphs: [{
              name: "text controls",
              submorphs: [{
                name: "weight and styles",
                submorphs: [{
                  name: "styling controls",
                  submorphs: [__varRecorder__$3.without("inline link"), __varRecorder__$3.without("quote")]
                }]
              }]
            }]
          }), __varRecorder__$3.part(__varRecorder__$3.LayoutControl, {
            name: "layout control",
            visible: false
          }), __varRecorder__$3.part(__varRecorder__$3.EmbeddingControl, {
            name: "embedding control",
            visible: false
          }), __varRecorder__$3.part(__varRecorder__$3.ConstraintsManager, {
            name: "constraints control",
            visible: false
          }), __varRecorder__$3.part(__varRecorder__$3.FillControl, {
            name: "fill control",
            visible: false
          }), __varRecorder__$3.part(__varRecorder__$3.BorderControl, {
            name: "border control",
            visible: false
          }), __varRecorder__$3.part(__varRecorder__$3.ComponentControl, {
            name: "component control",
            visible: false
          }), __varRecorder__$3.part(__varRecorder__$3.ComponentStatesControl, {
            name: "component states control",
            visible: false
          }), __varRecorder__$3.part(__varRecorder__$3.ResponsiveControl, {
            name: "responsive control",
            visible: false
          }), __varRecorder__$3.part(__varRecorder__$3.BodyControl, {
            name: "effects control",
            visible: false
          })]
        });
      }, {
        module: "lively.ide/studio/properties-panel.cp.js",
        "export": "PropertiesPanel",
        range: {
          start: 10715,
          end: 13124
        }
      }, __varRecorder__$3.PropertiesPanel);
      var PropertiesPanel = __varRecorder__$3.PropertiesPanel;
      var BackgroundControl = __varRecorder__$3.BackgroundControl;
      __varRecorder__$3.PropertiesPanel = PropertiesPanel;
      __varRecorder__$3.BackgroundControl = BackgroundControl;

      var propertiesPanel_cp = /*#__PURE__*/Object.freeze({
        __proto__: null,
        PropertiesPanelModel: PropertiesPanelModel,
        defaultPropertiesPanelWidth: defaultPropertiesPanelWidth,
        PropertiesPanel: PropertiesPanel,
        BackgroundControl: BackgroundControl
      });

      var __varRecorder__$2 = lively.FreezerRuntime.recorderFor("lively.ide/studio/sidebar-flap.js");

      function toggleSidebar(_x) {
        return _toggleSidebar.apply(this, arguments);
      }

      function _toggleSidebar() {
        _toggleSidebar = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee(flapModel) {
          var world, sidebarIsFadingOut, targetSidebar, sideBarWidth, dragAreaWidth, left;
          return regeneratorRuntime.wrap(function _callee$(_context) {
            while (1) {
              switch (_context.prev = _context.next) {
                case 0:
                  world = flapModel.world();
                  sidebarIsFadingOut = world.get(flapModel.target);
                  _context.next = 4;
                  return world.openSideBar(flapModel.target);

                case 4:
                  targetSidebar = _context.sent;

                  if (sidebarIsFadingOut) {
                    flapModel.view.animate({
                      left: flapModel.target === "scene graph" ? 0 : world.visibleBounds().width - flapModel.view.width,
                      duration: 300
                    });

                    if (flapModel.target === "scene graph") {
                      __varRecorder__$2.disconnect(targetSidebar, "extent", flapModel.view, "left");
                    }
                  } else {
                    sideBarWidth = (targetSidebar === null || targetSidebar === void 0 ? void 0 : targetSidebar.width) || __varRecorder__$2.defaultPropertiesPanelWidth;
                    dragAreaWidth = 5;
                    left = flapModel.target === "scene graph" ? sideBarWidth - dragAreaWidth : world.visibleBounds().width - sideBarWidth - flapModel.view.width;

                    if (flapModel.target === "scene graph") {
                      __varRecorder__$2.connect(targetSidebar, "extent", flapModel.view, "left", {
                        updater: function updater($upd, extent) {
                          $upd(extent.x - dragAreaWidth);
                        },
                        varMapping: {
                          dragAreaWidth: dragAreaWidth
                        }
                      });
                    }

                    flapModel.view.animate({
                      left: left,
                      duration: 300,
                      easing: __varRecorder__$2.easings.outCirc
                    });
                  }

                case 6:
                case "end":
                  return _context.stop();
              }
            }
          }, _callee);
        }));
        return _toggleSidebar.apply(this, arguments);
      }

      __varRecorder__$2.toggleSidebar = toggleSidebar;

      function relayoutSidebarFlapInWorld(flapModel) {
        if (flapModel.target === "scene graph") return;
        var propertiesPanelExists = $world.get(flapModel.target);
        if (propertiesPanelExists) flapModel.view.position = flapModel.view.position.withX($world.visibleBounds().width - __varRecorder__$2.defaultPropertiesPanelWidth - flapModel.view.width);else flapModel.view.position = flapModel.view.position.withX($world.visibleBounds().width - flapModel.view.width);
      }

      __varRecorder__$2.relayoutSidebarFlapInWorld = relayoutSidebarFlapInWorld;

      function openSidebarFlapInWorld(_x2) {
        return _openSidebarFlapInWorld.apply(this, arguments);
      }

      function _openSidebarFlapInWorld() {
        _openSidebarFlapInWorld = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee2(flapModel) {
          var world, view;
          return regeneratorRuntime.wrap(function _callee2$(_context2) {
            while (1) {
              switch (_context2.prev = _context2.next) {
                case 0:
                  world = flapModel.world();
                  view = flapModel.view;
                  world.clipMode = "hidden";
                  view.opacity = 0;
                  view.hasFixedPosition = false;
                  view.top = 100;

                  if (!(flapModel.target === "scene graph")) {
                    _context2.next = 13;
                    break;
                  }

                  flapModel.ui.label.textString = "Scene Graph";
                  view.borderRadius = {
                    topLeft: 0,
                    topRight: 5,
                    bottomLeft: 0,
                    bottomRight: 5
                  };
                  view.left = -view.width;
                  _context2.next = 12;
                  return view.withAnimationDo(function () {
                    view.opacity = 1;
                    var scene_graph = world.get(flapModel.target);
                    if (scene_graph) view.left = scene_graph.right;else view.position = __varRecorder__$2.pt(0, view.top);
                  });

                case 12:
                  view.hasFixedPosition = true;

                case 13:
                  if (!(flapModel.target === "properties panel")) {
                    _context2.next = 20;
                    break;
                  }

                  view.left = world.visibleBounds().width;
                  flapModel.ui.label.textString = "Properties Panel";
                  view.borderRadius = {
                    topLeft: 5,
                    topRight: 0,
                    bottomLeft: 5,
                    bottomRight: 0
                  };
                  _context2.next = 19;
                  return view.withAnimationDo(function () {
                    view.opacity = 1;
                    var properties_panel = world.get(flapModel.target);
                    if (properties_panel) view.left = world.visibleBounds().width - __varRecorder__$2.defaultPropertiesPanelWidth - view.width;else view.position = __varRecorder__$2.pt(world.visibleBounds().width - view.width, view.top);
                  });

                case 19:
                  view.hasFixedPosition = true;

                case 20:
                case "end":
                  return _context2.stop();
              }
            }
          }, _callee2);
        }));
        return _openSidebarFlapInWorld.apply(this, arguments);
      }

      __varRecorder__$2.openSidebarFlapInWorld = openSidebarFlapInWorld;
      __varRecorder__$2.disconnect = disconnect;
      __varRecorder__$2.connect = connect;
      __varRecorder__$2.defaultPropertiesPanelWidth = defaultPropertiesPanelWidth;
      __varRecorder__$2.easings = easings;
      __varRecorder__$2.pt = pt;
      __varRecorder__$2.toggleSidebar = toggleSidebar;
      __varRecorder__$2.relayoutSidebarFlapInWorld = relayoutSidebarFlapInWorld;
      __varRecorder__$2.openSidebarFlapInWorld = openSidebarFlapInWorld;

      var __varRecorder__$1 = lively.FreezerRuntime.recorderFor("lively.ide/world.js");
      __varRecorder__$1.resource = resource;
      __varRecorder__$1.Rectangle = Rectangle;
      __varRecorder__$1.Point = Point;
      __varRecorder__$1.Color = Color;
      __varRecorder__$1.pt = pt;
      __varRecorder__$1.arr = arr;
      __varRecorder__$1.string = string;
      __varRecorder__$1.fun = fun;
      __varRecorder__$1.obj = obj;
      __varRecorder__$1.promise = promise;
      __varRecorder__$1.PropertyPath = Path$1;
      __varRecorder__$1.once = once;
      __varRecorder__$1.connect = connect;
      __varRecorder__$1.GridLayout = GridLayout;
      __varRecorder__$1.MorphicDB = MorphicDB;
      __varRecorder__$1.easings = easings;
      __varRecorder__$1.HTMLMorph = HTMLMorph;
      __varRecorder__$1.Text = Text;
      __varRecorder__$1.touchInputDevice = touchInputDevice;
      __varRecorder__$1.Icon = Icon;
      __varRecorder__$1.ConstraintLayout = ConstraintLayout;
      __varRecorder__$1.Image = Image;
      __varRecorder__$1.inspect = inspect;
      __varRecorder__$1.config = config;
      __varRecorder__$1.World = World;
      __varRecorder__$1.loadMorphFromSnapshot = loadMorphFromSnapshot;
      __varRecorder__$1.uploadFile = uploadFile;
      __varRecorder__$1.prompts = prompts;
      __varRecorder__$1.moduleManager = modules;
      __varRecorder__$1.LoadingIndicator = LoadingIndicator;
      __varRecorder__$1.Halo = Halo;
      __varRecorder__$1.MorphHighlighter = MorphHighlighter;
      __varRecorder__$1.ProportionalLayoutHalo = _missingExportShim;
      __varRecorder__$1.GridLayoutHalo = GridLayoutHalo;
      __varRecorder__$1.Window = Window;
      __varRecorder__$1.Menu = Menu;
      __varRecorder__$1.completions = completions;
      __varRecorder__$1.runEval = runEval;
      __varRecorder__$1.getClassName = getClassName;
      __varRecorder__$1.serialize = serialize;
      __varRecorder__$1.StatusMessageDefault = StatusMessageDefault;
      __varRecorder__$1.StatusMessageConfirm = StatusMessageConfirm;
      __varRecorder__$1.StatusMessageError = StatusMessageError;
      __varRecorder__$1.part = part;
      __varRecorder__$1.worldCommands = commands;
      __varRecorder__$1.CommentData = CommentData;
      __varRecorder__$1.TopBar = TopBar;
      __varRecorder__$1.pathForBrowserHistory = pathForBrowserHistory;
      __varRecorder__$1.Project = Project;
      __varRecorder__$1.ObjectPackage = ObjectPackage;
      __varRecorder__$1.toggleSidebar = toggleSidebar;
      __varRecorder__$1.relayoutSidebarFlapInWorld = relayoutSidebarFlapInWorld;
      __varRecorder__$1.openSidebarFlapInWorld = openSidebarFlapInWorld;
      __varRecorder__$1.localInterface = localInterface;
      __varRecorder__$1.ProjectCreationPrompt = ProjectCreationPrompt;
      __varRecorder__$1.currentUsername = currentUsername;
      __varRecorder__$1.isUserLoggedIn = isUserLoggedIn;
      __varRecorder__$1.currentUser = currentUser;
      __varRecorder__$1.subscribe = subscribe;
      var LivelyWorld = exports('L', function (superclass) {
        var __lively_classholder__ = lively.FreezerRuntime.recorderFor("lively.ide/world.js");

        var __lively_class__ = __lively_classholder__.hasOwnProperty("LivelyWorld") && typeof __lively_classholder__.LivelyWorld === "function" ? __lively_classholder__.LivelyWorld : __lively_classholder__.LivelyWorld = function LivelyWorld(__first_arg__) {
          if (__first_arg__ && __first_arg__[Symbol["for"]("lively-instance-restorer")]) ; else {
            return this[Symbol["for"]("lively-instance-initialize")].apply(this, arguments);
          }
        };

        return initializeClass(__lively_class__, superclass, [{
          key: "isIDEWorld",
          get: function get() {
            return true;
          }
        }, {
          key: "topbarMode",
          get: function get() {
            var mode;
            this.withTopBarDo(function (bar) {
              mode = bar.mode;
            });
            return mode;
          }
        }, {
          key: "visibleBoundsExcludingTopBar",
          value: function LivelyWorld_visibleBoundsExcludingTopBar_() {
            var bar = $world.getSubmorphNamed("lively top bar");
            var visibleBounds = this.visibleBounds();

            if (bar) {
              var visibleBoundsExclTopBar = new __varRecorder__$1.Rectangle(visibleBounds.x, visibleBounds.y + bar.height, visibleBounds.width, visibleBounds.height - bar.height);
              return visibleBoundsExclTopBar;
            } else {
              return visibleBounds;
            }
          }
        }, {
          key: "visibleBoundsExcludingStudioInterface",
          value: function LivelyWorld_visibleBoundsExcludingStudioInterface_() {
            var boundsExcludingTopBar = this.visibleBoundsExcludingTopBar();
            var sideBars = this.activeSideBars;
            var bounds = boundsExcludingTopBar;

            if (sideBars.includes("scene graph")) {
              var sceneGraph = this.get("scene graph");
              bounds = __varRecorder__$1.pt(bounds.x + sceneGraph.width, bounds.y).extent(__varRecorder__$1.pt(bounds.width - sceneGraph.width, bounds.height));
            }

            if (sideBars.includes("properties panel")) {
              var propertiesPanel = this.get("properties panel");
              bounds = __varRecorder__$1.pt(bounds.x, bounds.y).extent(__varRecorder__$1.pt(bounds.width - propertiesPanel.width, bounds.height));
            }

            return bounds;
          }
        }, {
          key: "makeDirty",
          value: function LivelyWorld_makeDirty_() {
            if (!this.renderingState.needsRerender && this.get("world mini map")) {
              this.get("world mini map").drawMorphs();
            }

            initializeClass._get(Object.getPrototypeOf(__lively_class__.prototype), "makeDirty", this).call(this);
          }
        }, {
          key: "getListedComponents",
          value: function LivelyWorld_getListedComponents_() {
            var _this = this;

            var componentsInWorld = this.withAllSubmorphsSelect(function (m) {
              return m.isComponent && !_this.hiddenComponents.includes(m.name);
            });
            return __varRecorder__$1.arr.uniq([].concat(_toConsumableArray(componentsInWorld), _toConsumableArray(this.localComponents)));
          }
        }, {
          key: "activeWindow",
          value: function LivelyWorld_activeWindow_() {
            return this.getWindows().reverse().find(function (ea) {
              return ea.isActive();
            });
          }
        }, {
          key: "getWindows",
          value: function LivelyWorld_getWindows_() {
            return this.submorphs.filter(function (ea) {
              return ea.isWindow;
            });
          }
        }, {
          key: "activePrompt",
          value: function LivelyWorld_activePrompt_() {
            return this.getPrompts().reverse().find(function (ea) {
              return ea.isActive();
            });
          }
        }, {
          key: "getPrompts",
          value: function LivelyWorld_getPrompts_() {
            return this.submorphs.filter(function (ea) {
              return ea.isPrompt;
            });
          }
        }, {
          key: "openInWindow",
          value: function LivelyWorld_openInWindow_(morph) {
            var opts = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {
              title: morph.name,
              name: "window for " + morph.name
            };
            var win = new __varRecorder__$1.Window(Object.assign({}, opts, {
              extent: morph.extent.addXY(0, 25),
              targetMorph: morph
            })).openInWorld();
            win.ensureNotOverTheTop();
            win.ensureNotBeyondBottom();
            return win;
          }
        }, {
          key: "withTopBarDo",
          value: function LivelyWorld_withTopBarDo_(cb) {
            var topBar = this.get("lively top bar");
            if (topBar) cb(topBar.viewModel);
          }
        }, {
          key: "onTopBarLoaded",
          value: function LivelyWorld_onTopBarLoaded_() {
            this.withTopBarDo(function (bar) {
              return bar.setEditMode(__varRecorder__$1.config.ide.studio.defaultMode);
            });
          }
        }, {
          key: "onKeyUp",
          value: function LivelyWorld_onKeyUp_(evt) {
            this.withTopBarDo(function (tb) {
              return tb.onKeyUp(evt);
            });
          }
        }, {
          key: "onKeyDown",
          value: function LivelyWorld_onKeyDown_(evt) {
            initializeClass._get(Object.getPrototypeOf(__lively_class__.prototype), "onKeyDown", this).call(this, evt);

            if (evt.targetMorph !== this) return;
            this.withTopBarDo(function (tb) {
              return tb.onKeyDown(evt);
            });
          }
        }, {
          key: "onMouseDown",
          value: function LivelyWorld_onMouseDown_(evt) {
            initializeClass._get(Object.getPrototypeOf(__lively_class__.prototype), "onMouseDown", this).call(this, evt);

            var target = evt.state.clickedOnMorph;
            var activeWindow = this.activeWindow();
            if (activeWindow && target === this) activeWindow.deactivate();
            if (!target.isFlap) this.handleHaloCycle(evt);

            if (evt.state.menu) {
              evt.state.menu.remove();
            }

            this._tooltipViewer.mouseDown(evt);
          }
        }, {
          key: "onMouseUp",
          value: function LivelyWorld_onMouseUp_(evt) {
            if (evt.isCommandKey()) evt.stop();

            if (evt.isAltDown() && __varRecorder__$1.config.altClickDefinesThat) {
              var target = this.morphsContainingPoint(evt.position)[0];
              if (target.owner.isHalo) target = target.owner.target;
              setTimeout(function () {
                return System.global.that = target;
              }, 100);
              target.show();
              evt.stop();
              console.log("Set global \"that\" to ".concat(target));
            }
          }
        }, {
          key: "onDrag",
          value: function LivelyWorld_onDrag_(evt) {}
        }, {
          key: "addMorphAt",
          value: function LivelyWorld_addMorphAt_(submorph, index) {
            var returnValue = initializeClass._get(Object.getPrototypeOf(__lively_class__.prototype), "addMorphAt", this).call(this, submorph, index);

            if (!this.morphsInWorld.includes(submorph)) return returnValue;
            submorph._positionOnCanvas = this.screenToWorld(submorph.position);
            submorph.scale = this.scaleFactor;
            return returnValue;
          }
        }, {
          key: "onSubmorphChange",
          value: function LivelyWorld_onSubmorphChange_(change, submorph) {
            var _change$meta,
                _this2 = this;

            if (!this.morphsInWorld.includes(submorph)) return;

            if (change.selector === "addMorphAt") {
              submorph._positionOnCanvas = this.screenToWorld(submorph.position);
            }

            if (change.prop === "scale" && ((_change$meta = change.meta) === null || _change$meta === void 0 ? void 0 : _change$meta.metaInteraction)) {
              __varRecorder__$1.fun.guardNamed("reset-scale-" + submorph.id, function () {
                submorph.scale = _this2.scaleFactor;
              })();
            }

            if (change.meta && change.meta.metaInteraction) return;
            if (change.type !== "setter" || change.prop !== "position") return;
            submorph._positionOnCanvas = this.screenToWorld(change.value);
          }
        }, {
          key: "worldToScreen",
          value: function LivelyWorld_worldToScreen_(worldPoint) {
            var screenX = Number((worldPoint.x - this.offsetX) * this.scaleFactor);
            var screenY = Number((worldPoint.y - this.offsetY) * this.scaleFactor);
            return new __varRecorder__$1.Point(screenX, screenY);
          }
        }, {
          key: "screenToWorld",
          value: function LivelyWorld_screenToWorld_(screenPoint) {
            var worldX = Number(screenPoint.x / this.scaleFactor + this.offsetX);
            var worldY = Number(screenPoint.y / this.scaleFactor + this.offsetY);
            return new __varRecorder__$1.Point(worldX, worldY);
          }
        }, {
          key: "morphsInWorldWithSubmorphs",
          get: function get() {
            return this.morphsInWorld.map(function (morph) {
              return morph.withAllSubmorphsSelect(function () {
                return true;
              });
            }).flat(1000);
          }
        }, {
          key: "morphsInWorld",
          get: function get() {
            return this.submorphs.filter(function (m) {
              return !m.hasFixedPosition;
            }).filter(function (m) {
              return !m.isWindow;
            }).filter(function (m) {
              return !m.isHand;
            }).filter(function (m) {
              return !m.isHalo;
            }).filter(function (m) {
              return !m.isTopBar;
            }).filter(function (m) {
              return !m.isFlap;
            }).filter(function (m) {
              return !m.isVersionChecker;
            }).filter(function (m) {
              return !m.isSearchWidget;
            }).filter(function (m) {
              return !m.isStatusMessage;
            }).filter(function (m) {
              return !m.isSceneGraphPanel;
            }).filter(function (m) {
              return !m.isLoadingIndicator;
            }).filter(function (m) {
              return !m.isPropertiesPanel;
            }).filter(function (m) {
              return !m.isZoomIndicator;
            }).filter(function (m) {
              return !m.isMiniMap;
            }).filter(function (m) {
              return !m.isMenu;
            }).filter(function (m) {
              return !m.isTooltip;
            }).filter(function (m) {
              return !m.isHaloItem;
            }).filter(function (m) {
              return !m.styleClasses.includes("HaloPreview");
            }).filter(function (m) {
              return !m.isPrompt;
            }).filter(function (m) {
              return !m.isTestRunner;
            });
          }
        }, {
          key: "zoomWorld",
          value: function LivelyWorld_zoomWorld_(delta) {
            var _this3 = this;

            var cursorPositionOnScreen = this.firstHand.position;
            var cursorPositionInSpaceBeforeZoom = this.screenToWorld(cursorPositionOnScreen);
            var scaleDirection = delta < 0 ? 1 : 0;
            var _varRecorder__$confi = __varRecorder__$1.config.ide.studio.zoom,
                step = _varRecorder__$confi.step,
                min = _varRecorder__$confi.min;
            if (scaleDirection) this.scaleFactor *= 1 + step;else this.scaleFactor *= 1 - step;
            if (this.scaleFactor < min) this.scaleFactor = min;
            var cursorPositionInZoomedSpaceAfterZoom = this.screenToWorld(cursorPositionOnScreen);
            this.offsetX += cursorPositionInSpaceBeforeZoom.x - cursorPositionInZoomedSpaceAfterZoom.x;
            this.offsetY += cursorPositionInSpaceBeforeZoom.y - cursorPositionInZoomedSpaceAfterZoom.y;
            this.morphsInWorld.forEach(function (m) {
              return m.scale = _this3.scaleFactor;
            });
            this.morphsInWorld.forEach(function (m) {
              m.withMetaDo({
                metaInteraction: true
              }, function () {
                m.position = _this3.worldToScreen(m.positionOnCanvas);
              });
            });
            var percentage = Number.parseInt(this.scaleFactor * 100);
            $world.get("world zoom indicator").updateZoomLevel(percentage);
          }
        }, {
          key: "scrollWorld",
          value: function LivelyWorld_scrollWorld_(dx, dy) {
            var _this4 = this;

            this.offsetX += dx;
            this.offsetY += dy;
            this.morphsInWorld.forEach(function (m) {
              m.withMetaDo({
                metaInteraction: true
              }, function () {
                m.position = _this4.worldToScreen(m.positionOnCanvas);
              });
            });
            this.halos().forEach(function (h) {
              return h.alignWithTarget();
            });
          }
        }, {
          key: "onMouseWheel",
          value: function LivelyWorld_onMouseWheel_(evt) {
            if (!__varRecorder__$1.config.ide.studio.canvasModeEnabled) return;
            var domEvt = evt.domEvt,
                targetMorphs = evt.targetMorphs;
            var zoomOperation = domEvt.ctrlKey || domEvt.buttons === 4 || evt.isCommandKey();
            if (zoomOperation) domEvt.preventDefault();
            var openedMorphs = this.morphsInWorldWithSubmorphs;

            if (targetMorphs[0] === this) ; else if (!targetMorphs.some(function (t) {
              return openedMorphs.includes(t);
            })) return;else if (targetMorphs.some(function (m) {
              if (m.isWorld) return false;
              return m.horizontalScrollbarVisible || m.verticalScrollbarVisible;
            }) && $world.topbarMode === "Hand" && !zoomOperation) return;

            $world.getSubmorphsByStyleClassName("HaloPreview").forEach(function (m) {
              return m.remove();
            });
            $world.withTopBarDo(function (tb) {
              return tb._previewCache = null;
            });
            var deltaX = domEvt.deltaX,
                deltaY = domEvt.deltaY;

            if (zoomOperation) {
              this.zoomWorld(deltaY);
              return;
            }

            this.scrollWorld(deltaX, deltaY);
          }
        }, {
          key: "onWindowResize",
          value: function LivelyWorld_onWindowResize_() {
            var _this5 = this;

            initializeClass._get(Object.getPrototypeOf(__lively_class__.prototype), "onWindowResize", this).call(this);

            setTimeout(function () {
              var _this5$get, _this5$get2;

              (_this5$get = _this5.get("world mini map")) === null || _this5$get === void 0 ? void 0 : _this5$get.relayout();
              (_this5$get2 = _this5.get("world zoom indicator")) === null || _this5$get2 === void 0 ? void 0 : _this5$get2.relayout();
            });
          }
        }, {
          key: "resetScaleFactor",
          value: function LivelyWorld_resetScaleFactor_() {
            this.scaleFactor = 1;
            this.offsetX = 0;
            this.offsetY = 0;
            this.morphsInWorld.forEach(function (m) {
              return m.scale = 1;
            });
            this.morphsInWorld.forEach(function (m) {
              m.withMetaDo({
                metaInteraction: true
              }, function () {
                m.position = m.positionOnCanvas;
              });
            });
            $world.get("world zoom indicator").updateZoomLevel(100);
          }
        }, {
          key: "whenReady",
          value: function () {
            var _LivelyWorld_whenReady_ = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee() {
              return regeneratorRuntime.wrap(function _callee$(_context) {
                while (1) {
                  switch (_context.prev = _context.next) {
                    case 0:
                      _context.next = 2;
                      return this._styleLoading;

                    case 2:
                      return _context.abrupt("return", true);

                    case 3:
                    case "end":
                      return _context.stop();
                  }
                }
              }, _callee, this);
            }));

            function LivelyWorld_whenReady_() {
              return _LivelyWorld_whenReady_.apply(this, arguments);
            }

            return LivelyWorld_whenReady_;
          }()
        }, {
          key: "onLoad",
          value: function () {
            var _LivelyWorld_onLoad_ = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee3() {
              var _this6 = this;

              return regeneratorRuntime.wrap(function _callee3$(_context3) {
                while (1) {
                  switch (_context3.prev = _context3.next) {
                    case 0:
                      this.opacity = 0;
                      this.onWindowResize();

                      if (__varRecorder__$1.config.ide.studio.canvasModeEnabled) {
                        document.body.style["overscroll-behavior-x"] = "none";
                      }

                      if (lively.modules) lively.modules.removeHook("fetch", window.__logFetch);
                      this.animate({
                        opacity: 1,
                        blur: 3,
                        duration: 1000,
                        easing: __varRecorder__$1.easings.inOutExpo
                      }).then( /*#__PURE__*/_asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee2() {
                        var li, oldWorld;
                        return regeneratorRuntime.wrap(function _callee2$(_context2) {
                          while (1) {
                            switch (_context2.prev = _context2.next) {
                              case 0:
                                if (li = window.worldLoadingIndicator) {
                                  oldWorld = li.world();

                                  if (oldWorld && oldWorld.env !== _this6.env) {
                                    oldWorld.env.renderer.stopRenderWorldLoop();
                                  }
                                }

                                _this6.animate({
                                  blur: 0,
                                  duration: 1000,
                                  easing: __varRecorder__$1.easings.inOutExpo
                                }).then(function () {
                                  document.body.style.background = "black";
                                });

                                _context2.next = 4;
                                return __varRecorder__$1.localInterface.exportsOfModules({
                                  excludedPackages: __varRecorder__$1.config.ide.js.ignoredPackages
                                });

                              case 4:
                                _context2.next = 6;
                                return _this6.initializeStudio();

                              case 6:
                              case "end":
                                return _context2.stop();
                            }
                          }
                        }, _callee2);
                      })));

                    case 5:
                    case "end":
                      return _context3.stop();
                  }
                }
              }, _callee3, this);
            }));

            function LivelyWorld_onLoad_() {
              return _LivelyWorld_onLoad_.apply(this, arguments);
            }

            return LivelyWorld_onLoad_;
          }()
        }, {
          key: "initializeTopBar",
          value: function () {
            var _LivelyWorld_initializeTopBar_ = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee4() {
              var topBar, dropShadow;
              return regeneratorRuntime.wrap(function _callee4$(_context4) {
                while (1) {
                  switch (_context4.prev = _context4.next) {
                    case 0:
                      topBar = __varRecorder__$1.part(__varRecorder__$1.TopBar);
                      topBar.epiMorph = true;
                      topBar.name = "lively top bar";
                      topBar.hasFixedPosition = true;
                      topBar.respondsToVisibleWindow = true;
                      this.addMorph(topBar);
                      topBar.relayout();
                      topBar.top = -topBar.height;
                      dropShadow = topBar.dropShadow;
                      topBar.dropShadow = null;
                      topBar.attachToTarget(this);
                      this.onTopBarLoaded();
                      _context4.next = 14;
                      return topBar.animate({
                        position: __varRecorder__$1.pt(0, 0),
                        dropShadow: dropShadow,
                        duration: 500
                      });

                    case 14:
                      return _context4.abrupt("return", topBar);

                    case 15:
                    case "end":
                      return _context4.stop();
                  }
                }
              }, _callee4, this);
            }));

            function LivelyWorld_initializeTopBar_() {
              return _LivelyWorld_initializeTopBar_.apply(this, arguments);
            }

            return LivelyWorld_initializeTopBar_;
          }()
        }, {
          key: "initializeStudioUI",
          value: function () {
            var _LivelyWorld_initializeStudioUI_ = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee5() {
              var _yield$import, LivelyVersionChecker, versionChecker, _yield$import2, WorldZoomIndicator, zoomIndicator, _yield$import3, Flap;

              return regeneratorRuntime.wrap(function _callee5$(_context5) {
                while (1) {
                  switch (_context5.prev = _context5.next) {
                    case 0:
                      _context5.next = 2;
                      return Promise.resolve().then(function () { return versionChecker_cp; });

                    case 2:
                      _yield$import = _context5.sent;
                      LivelyVersionChecker = _yield$import.LivelyVersionChecker;
                      versionChecker = __varRecorder__$1.part(LivelyVersionChecker);
                      versionChecker.name = "lively version checker";
                      versionChecker.openInWorld();
                      versionChecker.relayout();
                      _context5.next = 10;
                      return versionChecker.checkVersion();

                    case 10:
                      _context5.next = 12;
                      return module.import('./zoom-indicator.cp-90bdb305.js');

                    case 12:
                      _yield$import2 = _context5.sent;
                      WorldZoomIndicator = _yield$import2.WorldZoomIndicator;
                      zoomIndicator = __varRecorder__$1.part(WorldZoomIndicator);
                      zoomIndicator.openInWorld();
                      zoomIndicator.name = "world zoom indicator";
                      zoomIndicator.relayout();
                      _context5.next = 20;
                      return module.import('./flap.cp-c43fc5c1.js');

                    case 20:
                      _yield$import3 = _context5.sent;
                      Flap = _yield$import3.Flap;
                      $world.sceneGraphFlap = __varRecorder__$1.part(Flap, {
                        viewModel: {
                          target: "scene graph",
                          action: __varRecorder__$1.toggleSidebar,
                          openingRoutine: __varRecorder__$1.openSidebarFlapInWorld,
                          relayoutRoutine: __varRecorder__$1.relayoutSidebarFlapInWorld
                        }
                      }).openInWorld();

                      __varRecorder__$1.connect($world.sceneGraphFlap, "position", versionChecker, "relayout");

                      $world.propertiesPanelFlap = __varRecorder__$1.part(Flap, {
                        viewModel: {
                          target: "properties panel",
                          action: __varRecorder__$1.toggleSidebar,
                          openingRoutine: __varRecorder__$1.openSidebarFlapInWorld,
                          relayoutRoutine: __varRecorder__$1.relayoutSidebarFlapInWorld
                        }
                      }).openInWorld();

                      __varRecorder__$1.connect($world.propertiesPanelFlap, "position", zoomIndicator, "relayout");

                      this._uiInitialized = true;

                    case 27:
                    case "end":
                      return _context5.stop();
                  }
                }
              }, _callee5, this);
            }));

            function LivelyWorld_initializeStudioUI_() {
              return _LivelyWorld_initializeStudioUI_.apply(this, arguments);
            }

            return LivelyWorld_initializeStudioUI_;
          }()
        }, {
          key: "initializeStudio",
          value: function () {
            var _LivelyWorld_initializeStudio_ = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee6() {
              var openNewProjectPrompt, openNewWorldPrompt, projectToBeOpened, projectRepoOwner, anonymousMode, _varRecorder__$resou, askForWorldName, worldName, project, pkg;

              return regeneratorRuntime.wrap(function _callee6$(_context6) {
                while (1) {
                  switch (_context6.prev = _context6.next) {
                    case 0:
                      openNewProjectPrompt = this.openNewProjectPrompt, openNewWorldPrompt = this.openNewWorldPrompt, projectToBeOpened = this.projectToBeOpened, projectRepoOwner = this.projectRepoOwner;
                      _varRecorder__$resou = __varRecorder__$1.resource(document.location.href).query(), askForWorldName = _varRecorder__$resou.askForWorldName;
                      if (askForWorldName === undefined) anonymousMode = false;else anonymousMode = !askForWorldName;

                      if (this.metadata) {
                        _context6.next = 35;
                        break;
                      }

                      if (!openNewWorldPrompt) {
                        _context6.next = 14;
                        break;
                      }

                      if (anonymousMode) {
                        _context6.next = 11;
                        break;
                      }

                      _context6.next = 8;
                      return this.askForName();

                    case 8:
                      worldName = _context6.sent;
                      _context6.next = 12;
                      break;

                    case 11:
                      if (anonymousMode) worldName = "aLivelyWorld";

                    case 12:
                      _context6.next = 28;
                      break;

                    case 14:
                      if (!openNewProjectPrompt) {
                        _context6.next = 22;
                        break;
                      }

                      _context6.next = 17;
                      return this.openPrompt(__varRecorder__$1.part(__varRecorder__$1.ProjectCreationPrompt, {
                        hasFixedPosition: true
                      }));

                    case 17:
                      project = _context6.sent;
                      $world.openedProject = project;
                      worldName = project.name;
                      _context6.next = 28;
                      break;

                    case 22:
                      if (!projectToBeOpened) {
                        _context6.next = 28;
                        break;
                      }

                      worldName = projectToBeOpened;
                      _context6.next = 26;
                      return __varRecorder__$1.Project.loadProject(projectToBeOpened, projectRepoOwner);

                    case 26:
                      this.projectToBeOpened = null;
                      this.projectRepoOwner = null;

                    case 28:
                      this.name = worldName;

                      if (!(!anonymousMode && openNewWorldPrompt)) {
                        _context6.next = 34;
                        break;
                      }

                      this.changeMetaData("commit", {
                        name: this.name
                      });
                      pkg = __varRecorder__$1.ObjectPackage.withId(__varRecorder__$1.string.camelCaseString(this.name));
                      _context6.next = 34;
                      return pkg.adoptObject(this);

                    case 34:
                      if (window.history) {
                        if (!projectRepoOwner && $world.openedProject) projectRepoOwner = $world.openedProject.repoOwner;
                        window.history.pushState({}, "lively.next", __varRecorder__$1.pathForBrowserHistory(this.name, null, !!$world.openedProject, $world.openedProject ? projectRepoOwner : null));
                      }

                    case 35:
                      _context6.next = 37;
                      return this.initializeTopBar();

                    case 37:
                      _context6.next = 39;
                      return this.initializeStudioUI();

                    case 39:
                    case "end":
                      return _context6.stop();
                  }
                }
              }, _callee6, this);
            }));

            function LivelyWorld_initializeStudio_() {
              return _LivelyWorld_initializeStudio_.apply(this, arguments);
            }

            return LivelyWorld_initializeStudio_;
          }()
        }, {
          key: "isNotUnique",
          value: function () {
            var _LivelyWorld_isNotUnique_ = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee7(worldName) {
              return regeneratorRuntime.wrap(function _callee7$(_context7) {
                while (1) {
                  switch (_context7.prev = _context7.next) {
                    case 0:
                      _context7.next = 2;
                      return __varRecorder__$1.MorphicDB["default"].exists("world", worldName);

                    case 2:
                      return _context7.abrupt("return", _context7.sent.exists);

                    case 3:
                    case "end":
                      return _context7.stop();
                  }
                }
              }, _callee7);
            }));

            function LivelyWorld_isNotUnique_(_x) {
              return _LivelyWorld_isNotUnique_.apply(this, arguments);
            }

            return LivelyWorld_isNotUnique_;
          }()
        }, {
          key: "openSideBar",
          value: function () {
            var _LivelyWorld_openSideBar_ = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee8(name) {
              var _yield$import4, MorphPanel, _yield$import5, PropertiesPanel, checker, zoomIndicator;

              return regeneratorRuntime.wrap(function _callee8$(_context8) {
                while (1) {
                  switch (_context8.prev = _context8.next) {
                    case 0:
                      if (this.activeSideBars.includes(name)) {
                        __varRecorder__$1.arr.remove(this.activeSideBars, name);
                      } else {
                        this.activeSideBars.push(name);
                      }

                      if (!(name === "scene graph")) {
                        _context8.next = 14;
                        break;
                      }

                      if (this.sceneGraph) {
                        _context8.next = 13;
                        break;
                      }

                      _context8.next = 5;
                      return module.import('./scene-graph.cp-394379ef.js');

                    case 5:
                      _yield$import4 = _context8.sent;
                      MorphPanel = _yield$import4.MorphPanel;
                      this.sceneGraph = __varRecorder__$1.part(MorphPanel);
                      this.sceneGraph.epiMorph = true;
                      this.sceneGraph.hasFixedPosition = true;
                      this.sceneGraph.respondsToVisibleWindow = true;
                      this.sceneGraph.openInWorld();
                      this.sceneGraph.right = 0;

                    case 13:
                      this.sceneGraph.toggle(this.activeSideBars.includes("scene graph"));

                    case 14:
                      if (!(name === "properties panel")) {
                        _context8.next = 25;
                        break;
                      }

                      if (this.propertiesPanel) {
                        _context8.next = 24;
                        break;
                      }

                      _context8.next = 18;
                      return Promise.resolve().then(function () { return propertiesPanel_cp; });

                    case 18:
                      _yield$import5 = _context8.sent;
                      PropertiesPanel = _yield$import5.PropertiesPanel;
                      this.propertiesPanel = __varRecorder__$1.part(PropertiesPanel);
                      this.propertiesPanel.epiMorph = true;
                      this.propertiesPanel.hasFixedPosition = true;
                      this.propertiesPanel.respondsToVisibleWindow = true;

                    case 24:
                      this.propertiesPanel.toggle(this.activeSideBars.includes("properties panel"));

                    case 25:
                      checker = this.get("lively version checker");
                      zoomIndicator = this.get("world zoom indicator");

                      if (checker && checker.owner === $world || zoomIndicator && zoomIndicator.owner === $world) {
                        checker === null || checker === void 0 ? void 0 : checker.relayout();
                        zoomIndicator === null || zoomIndicator === void 0 ? void 0 : zoomIndicator.relayout();
                      }

                      return _context8.abrupt("return", name === "properties panel" ? this.propertiesPanel : this.sceneGraph);

                    case 29:
                    case "end":
                      return _context8.stop();
                  }
                }
              }, _callee8, this);
            }));

            function LivelyWorld_openSideBar_(_x2) {
              return _LivelyWorld_openSideBar_.apply(this, arguments);
            }

            return LivelyWorld_openSideBar_;
          }()
        }, {
          key: "askForName",
          value: function () {
            var _LivelyWorld_askForName_ = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee9() {
              var worldName, override, reallyOverride;
              return regeneratorRuntime.wrap(function _callee9$(_context9) {
                while (1) {
                  switch (_context9.prev = _context9.next) {
                    case 0:
                      _context9.next = 2;
                      return this.whenEnvReady();

                    case 2:
                      if (worldName) {
                        _context9.next = 23;
                        break;
                      }

                      _context9.next = 5;
                      return this.prompt(["New Playground\n", {}, "Enter a name for this Playground:", {
                        fontWeight: "normal"
                      }], {
                        width: 400,
                        hasFixedPosition: true,
                        forceConfirm: true
                      });

                    case 5:
                      worldName = _context9.sent;
                      _context9.next = 8;
                      return this.isNotUnique(String(worldName));

                    case 8:
                      if (!_context9.sent) {
                        _context9.next = 21;
                        break;
                      }

                      _context9.next = 11;
                      return this.confirm("This Playground name is already taken. Do you want to override it?", {
                        hasFixedPosition: true,
                        width: 400
                      });

                    case 11:
                      override = _context9.sent;

                      if (!override) {
                        _context9.next = 20;
                        break;
                      }

                      _context9.next = 15;
                      return this.confirm("The old Playground will be lost! Are you sure you want to override?", {
                        hasFixedPosition: true,
                        width: 400
                      });

                    case 15:
                      reallyOverride = _context9.sent;

                      if (!reallyOverride) {
                        _context9.next = 20;
                        break;
                      }

                      _context9.next = 19;
                      return __varRecorder__$1.MorphicDB["default"]["delete"]("world", worldName);

                    case 19:
                      return _context9.abrupt("return", worldName);

                    case 20:
                      worldName = false;

                    case 21:
                      _context9.next = 2;
                      break;

                    case 23:
                      return _context9.abrupt("return", String(worldName));

                    case 24:
                    case "end":
                      return _context9.stop();
                  }
                }
              }, _callee9, this);
            }));

            function LivelyWorld_askForName_() {
              return _LivelyWorld_askForName_.apply(this, arguments);
            }

            return LivelyWorld_askForName_;
          }()
        }, {
          key: "onNativeDrop",
          value: function () {
            var _LivelyWorld_onNativeDrop_ = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee11(evt) {
              var _this7 = this;

              var domEvt, files, baseURL, uploadPath, proj, really, fd, i, res, answer, ld, headers, onProgress, _files, images, others, _iterator, _step, f, openImages, _iterator2, _step2, file, open, types, html, parsed, imgs, url, img, _i, item, _f, upload, uploadedMorph;

              return regeneratorRuntime.wrap(function _callee11$(_context11) {
                while (1) {
                  switch (_context11.prev = _context11.next) {
                    case 0:
                      if (!(evt.targetMorph !== this)) {
                        _context11.next = 2;
                        break;
                      }

                      return _context11.abrupt("return");

                    case 2:
                      domEvt = evt.domEvt;
                      files = domEvt.dataTransfer.files;
                      baseURL = document.location.origin;

                      if (!files.length) {
                        _context11.next = 73;
                        break;
                      }

                      proj = this.openedProject;

                      if (proj) {
                        uploadPath = "local_projects/".concat(proj.repoOwner, "--").concat(proj.name, "/assets");
                      } else uploadPath = !__varRecorder__$1.isUserLoggedIn() ? "uploads/" : "users/" + __varRecorder__$1.currentUser() + "/uploads";

                      if (!(evt.isAltDown() && !proj)) {
                        _context11.next = 14;
                        break;
                      }

                      _context11.next = 11;
                      return this.prompt("Choose upload location", {
                        history: "lively.morphic-html-drop-file-upload-location",
                        input: uploadPath
                      });

                    case 11:
                      uploadPath = _context11.sent;

                      if (uploadPath) {
                        _context11.next = 14;
                        break;
                      }

                      return _context11.abrupt("return", this.setStatusMessage("Canceled upload"));

                    case 14:
                      _context11.next = 16;
                      return this.confirm("Upload ".concat(files.length, " file").concat(files.length > 1 ? "s" : "", "?"));

                    case 16:
                      really = _context11.sent;

                      if (really) {
                        _context11.next = 19;
                        break;
                      }

                      return _context11.abrupt("return");

                    case 19:
                      fd = new FormData();

                      for (i = 0; i < files.length; i++) {
                        fd.append("file", files[i], files[i].name);
                      }

                      ld = __varRecorder__$1.LoadingIndicator.open("Uploading File");
                      _context11.prev = 22;
                      headers = {};

                      onProgress = function onProgress(evt) {
                        var p = evt.loaded / evt.total;
                        ld.progress = p;
                        ld.status = "Uploaded " + (100 * p).toFixed() + "%";
                      };

                      res = __varRecorder__$1.resource(System.baseURL, {
                        headers: headers,
                        onProgress: onProgress,
                        onLoad: function onLoad(res) {
                          return answer = res;
                        }
                      });
                      res = res.join("/upload?uploadPath=".concat(encodeURIComponent(uploadPath)));
                      _context11.next = 29;
                      return res.write(fd);

                    case 29:
                      _context11.next = 34;
                      break;

                    case 31:
                      _context11.prev = 31;
                      _context11.t0 = _context11["catch"](22);
                      return _context11.abrupt("return", this.showError("Upload failed: ".concat(_context11.t0.message, "\n")));

                    case 34:
                      ld.remove();
                      _context11.prev = 35;
                      this.setStatusMessage("Uploaded ".concat(answer.uploadedFiles.length, " file"));
                      _files = answer.uploadedFiles.map(function (ea) {
                        var res = __varRecorder__$1.resource(baseURL).join(ea.path);

                        return Object.assign({}, ea, {
                          url: res.url,
                          name: res.name()
                        });
                      });
                      images = [];
                      others = [];
                      _iterator = _createForOfIteratorHelper(_files);

                      try {
                        for (_iterator.s(); !(_step = _iterator.n()).done;) {
                          f = _step.value;
                          if (f.type.startsWith("image/")) images.push(f);else others.push(f);
                        }
                      } catch (err) {
                        _iterator.e(err);
                      } finally {
                        _iterator.f();
                      }

                      if (!images.length) {
                        _context11.next = 47;
                        break;
                      }

                      _context11.next = 45;
                      return this.confirm(images.length > 1 ? "There were ".concat(images.length, " images uploaded. Open them?") : "There was 1 image uploaded. Open it?");

                    case 45:
                      openImages = _context11.sent;

                      if (openImages) {
                        images.forEach(function (ea) {
                          var img = new __varRecorder__$1.Image({
                            imageUrl: ea.url,
                            name: ea.name
                          });
                          img.whenLoaded().then( /*#__PURE__*/_asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee10() {
                            return regeneratorRuntime.wrap(function _callee10$(_context10) {
                              while (1) {
                                switch (_context10.prev = _context10.next) {
                                  case 0:
                                    img.extent = img.naturalExtent.scaleBy(0.8 * _this7.visibleBounds().height / img.height);
                                    img.openInWorld();
                                    img.center = _this7.visibleBounds().center();

                                  case 3:
                                  case "end":
                                    return _context10.stop();
                                }
                              }
                            }, _callee10);
                          })));
                        });
                      }

                    case 47:
                      if (!others.length) {
                        _context11.next = 67;
                        break;
                      }

                      _iterator2 = _createForOfIteratorHelper(others);
                      _context11.prev = 49;

                      _iterator2.s();

                    case 51:
                      if ((_step2 = _iterator2.n()).done) {
                        _context11.next = 59;
                        break;
                      }

                      file = _step2.value;
                      _context11.next = 55;
                      return this.confirm("open file ".concat(file.name, " (").concat(file.type, ")?"));

                    case 55:
                      open = _context11.sent;
                      if (open) this.execCommand("open file", {
                        url: file.url
                      });

                    case 57:
                      _context11.next = 51;
                      break;

                    case 59:
                      _context11.next = 64;
                      break;

                    case 61:
                      _context11.prev = 61;
                      _context11.t1 = _context11["catch"](49);

                      _iterator2.e(_context11.t1);

                    case 64:
                      _context11.prev = 64;

                      _iterator2.f();

                      return _context11.finish(64);

                    case 67:
                      _context11.next = 72;
                      break;

                    case 69:
                      _context11.prev = 69;
                      _context11.t2 = _context11["catch"](35);
                      this.showError(_context11.t2);

                    case 72:
                      return _context11.abrupt("return");

                    case 73:
                      types = domEvt.dataTransfer.types;

                      if (!types.includes("text/html")) {
                        _context11.next = 80;
                        break;
                      }

                      html = domEvt.dataTransfer.getData("text/html");
                      parsed = new DOMParser().parseFromString(html, "text/html");
                      imgs = parsed.querySelectorAll("img");

                      if (imgs.length === 1 && imgs[0].src && types.includes("text/uri-list")) {
                        url = imgs[0].src;
                        img = new __varRecorder__$1.Image({
                          imageUrl: url,
                          name: __varRecorder__$1.arr.last(url.split("/"))
                        });
                        img.whenLoaded().then(function () {
                          return img.openInWorld();
                        });
                      } else {
                        new __varRecorder__$1.HTMLMorph({
                          html: html
                        }).openInWorld();
                      }

                      return _context11.abrupt("return");

                    case 80:
                      _i = 0;

                    case 81:
                      if (!(_i < domEvt.dataTransfer.items.length)) {
                        _context11.next = 100;
                        break;
                      }

                      item = domEvt.dataTransfer.items[_i];

                      if (!(item.kind === "file")) {
                        _context11.next = 96;
                        break;
                      }

                      _f = item.getAsFile();
                      _context11.next = 87;
                      return this.confirm("Upload ".concat(_f.name, "?"));

                    case 87:
                      upload = _context11.sent;

                      if (!upload) {
                        _context11.next = 94;
                        break;
                      }

                      _context11.next = 91;
                      return __varRecorder__$1.uploadFile(_f, _f.type);

                    case 91:
                      uploadedMorph = _context11.sent;
                      uploadedMorph && uploadedMorph.openInWorld();
                      uploadedMorph.center = this.visibleBounds().center();

                    case 94:
                      _context11.next = 97;
                      break;

                    case 96:
                      if (item.kind === "string") {
                        item.getAsString(function (s) {
                          return __varRecorder__$1.inspect(s);
                        });
                      }

                    case 97:
                      _i++;
                      _context11.next = 81;
                      break;

                    case 100:
                    case "end":
                      return _context11.stop();
                  }
                }
              }, _callee11, this, [[22, 31], [35, 69], [49, 61, 64, 67]]);
            }));

            function LivelyWorld_onNativeDrop_(_x3) {
              return _LivelyWorld_onNativeDrop_.apply(this, arguments);
            }

            return LivelyWorld_onNativeDrop_;
          }()
        }, {
          key: "menuItems",
          value: function LivelyWorld_menuItems_() {
            return [{
              title: "World menu"
            }, {
              command: "undo",
              target: this
            }, {
              command: "redo",
              target: this
            }, {
              isDivider: true
            }, ["Debugging", [{
              command: "delete change history",
              target: this
            }, {
              command: "fix font metric",
              target: this
            }, {
              command: "inspect server",
              target: this
            }]], ["Tools", [{
              command: "open javascript workspace",
              target: this
            }, {
              command: "open browser",
              target: this
            }, {
              command: "choose and browse module",
              target: this
            }, {
              command: "open code search",
              target: this
            }, {
              command: "open file browser",
              target: this
            }, {
              command: "open shell workspace",
              target: this,
              tooltip: "Opens a workspace like interface\nthat allows you to trigger shell comands\nvia select + eval by pressing either ".concat(new __varRecorder__$1.Text().keysForCommand("doit"), " or ").concat(new __varRecorder__$1.Text().keysForCommand("printit"))
            }, {
              command: "open shell terminal",
              target: this,
              tooltip: "Opens a classic remote shell interface,\nthat allows you to send commands to a\nbash session running on the server.\nAlso comes with advanced git support."
            }, {
              command: "open workspace",
              args: {
                askForMode: true
              },
              target: this
            }]], {
              isDivider: true
            }, {
              command: "run command",
              target: this
            }, {
              command: "select morph",
              target: this
            }, {
              command: "window switcher",
              target: this
            }, ["Troubleshooting", [{
              command: "report a bug",
              target: this
            }, {
              command: "clear storage and reload",
              target: this
            }]], {
              isDivider: true
            }, ["Windows", [{
              command: "toggle minimize all windows",
              target: this
            }, {
              command: "close all windows",
              target: this
            }]], {
              isDivider: true
            }, {
              command: "save world or project",
              target: this
            }, {
              command: "load world",
              target: this
            }];
          }
        }, {
          key: "openWorldMenu",
          value: function LivelyWorld_openWorldMenu_(evt, items) {
            var eventState = this.env.eventDispatcher.eventState;
            if (eventState.menu) eventState.menu.remove();
            return eventState.menu = items && items.length ? __varRecorder__$1.Menu.openAtHand(items, {
              hand: evt && evt.hand || this.firstHand
            }) : null;
          }
        }, {
          key: "onPaste",
          value: function () {
            var _LivelyWorld_onPaste_ = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee12(evt) {
              var li, data, snapshots, morphs, _iterator3, _step3, s, morph, _s$copyMeta$offset, x, y;

              return regeneratorRuntime.wrap(function _callee12$(_context12) {
                while (1) {
                  switch (_context12.prev = _context12.next) {
                    case 0:
                      _context12.prev = 0;
                      data = evt.domEvt.clipboardData;

                      if (!data.types.includes("application/morphic")) {
                        _context12.next = 31;
                        break;
                      }

                      evt.stop();
                      snapshots = JSON.parse(data.getData("application/morphic"));
                      morphs = [];
                      if (!Array.isArray(snapshots)) snapshots = [snapshots];
                      li = __varRecorder__$1.LoadingIndicator.open("pasting morphs...");
                      _iterator3 = _createForOfIteratorHelper(snapshots);
                      _context12.prev = 9;

                      _iterator3.s();

                    case 11:
                      if ((_step3 = _iterator3.n()).done) {
                        _context12.next = 21;
                        break;
                      }

                      s = _step3.value;
                      _context12.next = 15;
                      return __varRecorder__$1.loadMorphFromSnapshot(s, {
                        moduleManager: __varRecorder__$1.moduleManager
                      });

                    case 15:
                      morph = _context12.sent;
                      morph.openInWorld(evt.hand.position);

                      if (s.copyMeta && s.copyMeta.offset) {
                        _s$copyMeta$offset = s.copyMeta.offset, x = _s$copyMeta$offset.x, y = _s$copyMeta$offset.y;
                        morph.moveBy(__varRecorder__$1.pt(x, y));
                      }

                      morphs.push(morph);

                    case 19:
                      _context12.next = 11;
                      break;

                    case 21:
                      _context12.next = 26;
                      break;

                    case 23:
                      _context12.prev = 23;
                      _context12.t0 = _context12["catch"](9);

                      _iterator3.e(_context12.t0);

                    case 26:
                      _context12.prev = 26;

                      _iterator3.f();

                      return _context12.finish(26);

                    case 29:
                      this.halos().forEach(function (h) {
                        return h.remove();
                      });
                      this.showHaloFor(morphs);

                    case 31:
                      _context12.next = 36;
                      break;

                    case 33:
                      _context12.prev = 33;
                      _context12.t1 = _context12["catch"](0);
                      this.showError(_context12.t1);

                    case 36:
                      _context12.prev = 36;
                      if (li) li.remove();
                      return _context12.finish(36);

                    case 39:
                    case "end":
                      return _context12.stop();
                  }
                }
              }, _callee12, this, [[0, 33, 36, 39], [9, 23, 26, 29]]);
            }));

            function LivelyWorld_onPaste_(_x4) {
              return _LivelyWorld_onPaste_.apply(this, arguments);
            }

            return LivelyWorld_onPaste_;
          }()
        }, {
          key: "addCommentFor",
          value: function LivelyWorld_addCommentFor_(morph, commentText) {
            var relativePosition = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : __varRecorder__$1.pt(0, 0);
            var comment = new __varRecorder__$1.CommentData(commentText, relativePosition);
            if (this.morphCommentMap.has(morph)) this.morphCommentMap.set(morph, this.morphCommentMap.get(morph).concat([comment]));else this.morphCommentMap.set(morph, [comment]);
            var commentBrowser = $world.getSubmorphNamed("Comment Browser");
            if (commentBrowser) commentBrowser.viewModel.addCommentForMorph(comment, morph);
            return comment;
          }
        }, {
          key: "removeCommentFor",
          value: function LivelyWorld_removeCommentFor_(morph, commentToRemove) {
            var commentBrowser = $world.getSubmorphNamed("Comment Browser");
            if (commentBrowser) commentBrowser.viewModel.removeCommentForMorph(commentToRemove, morph);
            this.morphCommentMap.set(morph, __varRecorder__$1.arr.without(this.morphCommentMap.get(morph), commentToRemove));
          }
        }, {
          key: "emptyCommentsFor",
          value: function LivelyWorld_emptyCommentsFor_(morph) {
            var commentBrowser = $world.getSubmorphNamed("Comment Browser");

            if (this.morphCommentMap.has(morph)) {
              if (commentBrowser) this.morphCommentMap.get(morph).forEach(function (comment) {
                return commentBrowser.viewModel.removeCommentForMorph(comment, morph);
              });
              this.morphCommentMap.set(morph, []);
            }
          }
        }, {
          key: "commands",
          get: function get() {
            return __varRecorder__$1.worldCommands.concat(initializeClass._get(Object.getPrototypeOf(__lively_class__.prototype), "commands", this));
          }
        }, {
          key: "keybindings",
          get: function get() {
            return initializeClass._get(Object.getPrototypeOf(__lively_class__.prototype), "keybindings", this).concat(__varRecorder__$1.config.globalKeyBindings);
          }
        }, {
          key: "keybindings",
          set: function set(x) {
            initializeClass._set(Object.getPrototypeOf(__lively_class__.prototype), "keybindings", x, this);
          }
        }, {
          key: "halos",
          value: function LivelyWorld_halos_() {
            return this.submorphs.filter(function (m) {
              return m.isHalo;
            });
          }
        }, {
          key: "haloForPointerId",
          value: function LivelyWorld_haloForPointerId_(pointerId) {
            return this.submorphs.find(function (m) {
              return m.isHalo && m.state && m.state.pointerId === pointerId;
            });
          }
        }, {
          key: "showHaloFor",
          value: function LivelyWorld_showHaloFor_(target) {
            var pointerId = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : this.firstHand && this.firstHand.pointerId;
            var focus = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : true;
            var halo;
            if (target._responsiveHalo) target._responsiveHalo.remove();
            if (!__varRecorder__$1.Halo) return;
            if (!__varRecorder__$1.obj.isArray(target) && !target.halosEnabled) return;
            if (this.halos().filter(function (halo) {
              return halo.target === target;
            }).length > 0) return;

            if (typeof target.createHalo === "function") {
              halo = target.createHalo(__varRecorder__$1.Halo, pointerId);
            } else {
              halo = new __varRecorder__$1.Halo({
                pointerId: pointerId,
                target: target
              });
            }

            this.addMorph(halo);
            if (focus) halo.focus();
            halo.alignWithTarget();
            return halo;
          }
        }, {
          key: "showHaloForSelection",
          value: function LivelyWorld_showHaloForSelection_(selection, pointerId) {
            return selection.length > 0 && this.showHaloFor(selection, pointerId);
          }
        }, {
          key: "layoutHaloForPointerId",
          value: function LivelyWorld_layoutHaloForPointerId_() {
            var pointerId = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : this.firstHand && this.firstHand.pointerId;
            return this.submorphs.find(function (m) {
              return m.isLayoutHalo && m.state && m.state.pointerId === pointerId;
            });
          }
        }, {
          key: "showLayoutHaloFor",
          value: function LivelyWorld_showLayoutHaloFor_(morph) {
            var pointerId = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : this.firstHand && this.firstHand.pointerId;
            var world = this;
            var ownerInWorld = morph === world ? null : morph.owner === world ? morph : morph.ownerChain().slice(-2)[0];
            var insertionIndex = ownerInWorld ? world.submorphs.indexOf(ownerInWorld) + 1 : world.submorphs.length;
            var overlay;

            switch (morph.layout.constructor) {
              case __varRecorder__$1.ConstraintLayout:
                overlay = new __varRecorder__$1.ProportionalLayoutHalo({
                  container: morph,
                  pointerId: pointerId
                });
                break;

              case __varRecorder__$1.GridLayout:
                overlay = new __varRecorder__$1.GridLayoutHalo({
                  container: this.container,
                  pointerId: pointerId
                });
                break;
            }

            return overlay && this.addMorphAt(overlay, insertionIndex);
          }
        }, {
          key: "handleHaloCycle",
          value: function LivelyWorld_handleHaloCycle_(evt) {
            var target = evt.state.clickedOnMorph;
            var isCommandKey = evt.isCommandKey();
            var isShiftKey = evt.isShiftDown();
            var haloTarget;

            if (isCommandKey && !target.isHalo) {
              var morphsBelow = evt.world.morphsContainingPoint(evt.position);
              var morphsBelowTarget = morphsBelow;
              morphsBelow = morphsBelow.filter(function (ea) {
                return ea.halosEnabled;
              });
              morphsBelowTarget = morphsBelowTarget.filter(function (ea) {
                return ea.halosEnabled;
              });
              haloTarget = morphsBelowTarget[0] || morphsBelow[0];
            }

            if (isShiftKey && !target.isHaloItem && haloTarget && evt.halo && evt.halo.borderBox !== haloTarget) {
              evt.halo.addMorphToSelection(haloTarget);
              return;
            }

            var removeHalo = evt.halo && !evt.targetMorphs.find(function (morph) {
              return morph.isHaloItem || morph.keepHalo && morph.keepHalo(evt);
            });
            var removeLayoutHalo = evt.layoutHalo && !evt.targetMorphs.find(function (morph) {
              return morph.isHaloItem;
            });
            var addHalo = (!evt.halo || removeHalo) && haloTarget;
            if (removeLayoutHalo) evt.layoutHalo.remove();

            if (removeHalo) {
              evt.halo.remove();
              this.withTopBarDo(function (tb) {
                if (tb.stylingPalette) {
                  tb.stylingPalette.clearFocus();
                }

                if (tb.sideBar) {
                  tb.sideBar.clearFocus();
                }
              });
            }

            if (addHalo) {
              haloTarget.cancelTemporaryEdit && haloTarget.cancelTemporaryEdit(null, false);
              evt.stop();
              this.showHaloFor(haloTarget, evt.domEvt.pointerId);
            }
          }
        }, {
          key: "highlightMorph",
          value: function LivelyWorld_highlightMorph_(highlightOwner, morph) {
            var showLayout = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : false;
            var highlightedSides = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : [];
            return __varRecorder__$1.MorphHighlighter["for"](highlightOwner, morph, showLayout, highlightedSides);
          }
        }, {
          key: "removeHighlighters",
          value: function LivelyWorld_removeHighlighters_() {
            var highlightOwner = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : this;
            return __varRecorder__$1.MorphHighlighter.removeHighlighters(highlightOwner);
          }
        }, {
          key: "visibleStatusMessages",
          value: function LivelyWorld_visibleStatusMessages_() {
            return this.submorphs.filter(function (ea) {
              return ea.isStatusMessage;
            });
          }
        }, {
          key: "visibleStatusMessagesFor",
          value: function LivelyWorld_visibleStatusMessagesFor_(morph) {
            return this.submorphs.filter(function (ea) {
              return ea.isStatusMessage && ea.targetMorph === morph;
            });
          }
        }, {
          key: "logErrorPreperation",
          value: function LivelyWorld_logErrorPreperation_(err) {
            var stringified = String(err);
            var stack = err.stack || "";

            if (stack && err.message !== err.stack) {
              stack = String(stack);
              var errInStackIdx = stack.indexOf(stringified);

              if (errInStackIdx === 0) {
                stack = stack.slice(stringified.length);
              }

              stringified += "\n" + stack;
            }

            return stringified;
          }
        }, {
          key: "logError",
          value: function LivelyWorld_logError_(err) {
            this.setStatusMessage(this.logErrorPreperation(err), __varRecorder__$1.StatusMessageError);
          }
        }, {
          key: "showError",
          value: function LivelyWorld_showError_(err) {
            return this.logError(err);
          }
        }, {
          key: "showErrorFor",
          value: function LivelyWorld_showErrorFor_(morph, err) {
            return this.setStatusMessageFor(morph, this.logErrorPreperation(err), __varRecorder__$1.StatusMessageError);
          }
        }, {
          key: "setStatusMessageFor",
          value: function LivelyWorld_setStatusMessageFor_(morph, message, StatusMessageComponent) {
            var delay = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : 5000;
            var props = arguments.length > 4 ? arguments[4] : undefined;
            if (!StatusMessageComponent) StatusMessageComponent = __varRecorder__$1.StatusMessageDefault;
            this.visibleStatusMessagesFor(morph).forEach(function (ea) {
              return ea.remove();
            });

            var msgMorph = __varRecorder__$1.part(StatusMessageComponent, {
              epiMorph: true,
              viewModel: Object.assign({
                slidable: false,
                message: message
              }, props)
            });

            this.openStatusMessage(msgMorph, delay);
            msgMorph.alignAtBottomOf(morph);
            msgMorph.targetMorph = morph;
            msgMorph.fadeIn(300);

            if (msgMorph.removeOnTargetMorphChange && morph.isText) {
              __varRecorder__$1.once(morph, "selectionChange", msgMorph, "fadeOut", {
                converter: function converter() {
                  return 200;
                },
                garbageCollect: true
              });
            }

            return msgMorph;
          }
        }, {
          key: "setStatusMessage",
          value: function LivelyWorld_setStatusMessage_(message, StatusMessageComponent) {
            var delay = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : 5000;
            var optStyle = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : {};
            if (!StatusMessageComponent) StatusMessageComponent = __varRecorder__$1.StatusMessageDefault;
            console[StatusMessageComponent === __varRecorder__$1.StatusMessageError ? "error" : "log"](message);
            return __varRecorder__$1.config.verboseLogging ? this.openStatusMessage(__varRecorder__$1.part(StatusMessageComponent, Object.assign({
              epiMorph: true,
              viewModel: {
                message: message
              },
              hasFixedPosition: true,
              width: 300
            }, optStyle)), delay) : null;
          }
        }, {
          key: "openStatusMessage",
          value: function LivelyWorld_openStatusMessage_(statusMessage, delay) {
            this.addMorph(statusMessage);

            if (statusMessage.slidable) {
              var messages = this.visibleStatusMessages();

              var _iterator4 = _createForOfIteratorHelper(messages),
                  _step4;

              try {
                for (_iterator4.s(); !(_step4 = _iterator4.n()).done;) {
                  var m = _step4.value;
                  if (messages.length <= (__varRecorder__$1.config.maxStatusMessages || 0)) break;
                  if (m.stayOpen || !m.slidable) continue;
                  m.remove();

                  __varRecorder__$1.arr.remove(messages, m);
                }
              } catch (err) {
                _iterator4.e(err);
              } finally {
                _iterator4.f();
              }

              __varRecorder__$1.arr.without(messages, statusMessage).forEach( /*#__PURE__*/function () {
                var _ref3 = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee13(msg) {
                  return regeneratorRuntime.wrap(function _callee13$(_context13) {
                    while (1) {
                      switch (_context13.prev = _context13.next) {
                        case 0:
                          if (!msg.isMaximized && msg.slidable) {
                            msg.slideTo(msg.position.subPt(__varRecorder__$1.pt(0, statusMessage.height + 10)));
                          }

                        case 1:
                        case "end":
                          return _context13.stop();
                      }
                    }
                  }, _callee13);
                }));

                return function (_x5) {
                  return _ref3.apply(this, arguments);
                };
              }());

              var msgPos = this.visibleBounds().bottomRight().addXY(-20, -20);
              statusMessage.align(statusMessage.bounds().bottomRight(), msgPos);
              statusMessage.topRight = msgPos.addPt(__varRecorder__$1.pt(0, 40));
              statusMessage.animate({
                bottomRight: msgPos,
                duration: 500
              });
            }

            if (typeof delay === "number") {
              setTimeout(function () {
                return statusMessage.stayOpen || statusMessage.fadeOut();
              }, delay);
            }

            return statusMessage;
          }
        }, {
          key: "openPrompt",
          value: function () {
            var _LivelyWorld_openPrompt_ = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee15(promptMorph) {
              var _this8 = this;

              var opts,
                  focused,
                  visBounds,
                  _args16 = arguments;
              return regeneratorRuntime.wrap(function _callee15$(_context15) {
                while (1) {
                  switch (_context15.prev = _context15.next) {
                    case 0:
                      opts = _args16.length > 1 && _args16[1] !== undefined ? _args16[1] : {
                        requester: null,
                        animated: false
                      };
                      focused = this.focusedMorph;
                      visBounds = this.visibleBounds();
                      if (opts.name) promptMorph.name = opts.name;
                      return _context15.abrupt("return", this.withRequesterDo(opts.requester, /*#__PURE__*/function () {
                        var _ref4 = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee14(pos) {
                          var translatedPromptBounds;
                          return regeneratorRuntime.wrap(function _callee14$(_context14) {
                            while (1) {
                              switch (_context14.prev = _context14.next) {
                                case 0:
                                  promptMorph.openInWorld();
                                  promptMorph.center = pos;

                                  if (promptMorph.height > visBounds.height) {
                                    promptMorph.height = visBounds.height - 5;
                                  }

                                  translatedPromptBounds = $world.visibleBoundsExcludingTopBar().translateForInclusion(promptMorph.bounds());
                                  promptMorph.setBounds(translatedPromptBounds);

                                  if (typeof opts.customize === "function") {
                                    opts.customize(promptMorph);
                                  }

                                  if (opts.animated) {
                                    if (_this8.previousPrompt && _this8.previousPrompt.world() && _this8.previousPrompt.transitionTo) {
                                      _this8.previousPrompt.transitionTo(promptMorph);
                                    }
                                  }

                                  _this8.previousPrompt = promptMorph;
                                  return _context14.abrupt("return", __varRecorder__$1.promise["finally"](promptMorph.activate(opts), function () {
                                    return focused && focused.focus();
                                  }));

                                case 9:
                                case "end":
                                  return _context14.stop();
                              }
                            }
                          }, _callee14);
                        }));

                        return function (_x7) {
                          return _ref4.apply(this, arguments);
                        };
                      }()));

                    case 5:
                    case "end":
                      return _context15.stop();
                  }
                }
              }, _callee15, this);
            }));

            function LivelyWorld_openPrompt_(_x6) {
              return _LivelyWorld_openPrompt_.apply(this, arguments);
            }

            return LivelyWorld_openPrompt_;
          }()
        }, {
          key: "withRequesterDo",
          value: function () {
            var _LivelyWorld_withRequesterDo_ = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee16(requester, doFn) {
              var win, pos, res;
              return regeneratorRuntime.wrap(function _callee16$(_context16) {
                while (1) {
                  switch (_context16.prev = _context16.next) {
                    case 0:
                      pos = this.visibleBounds().center();

                      if (requester) {
                        pos = requester.globalBounds().center();
                        if (requester.isWorld) pos = requester.visibleBounds().center();

                        if (win = requester.getWindow()) {
                          __varRecorder__$1.fun.guardNamed("toggleFader-" + win.id, function () {
                            return win.toggleFader(true);
                          })();

                          pos = win.globalBounds().center();
                        }
                      }

                      _context16.next = 4;
                      return doFn(pos);

                    case 4:
                      res = _context16.sent;

                      if (win) {
                        setTimeout(function () {
                          __varRecorder__$1.fun.guardNamed("toggleFader-" + win.id, function () {
                            return win.toggleFader(false);
                          })();
                        }, 300);
                      }

                      return _context16.abrupt("return", res);

                    case 7:
                    case "end":
                      return _context16.stop();
                  }
                }
              }, _callee16, this);
            }));

            function LivelyWorld_withRequesterDo_(_x8, _x9) {
              return _LivelyWorld_withRequesterDo_.apply(this, arguments);
            }

            return LivelyWorld_withRequesterDo_;
          }()
        }, {
          key: "inform",
          value: function LivelyWorld_inform_() {
            var label = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : "no message";
            var opts = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {
              fontSize: 16,
              requester: null,
              animated: true
            };
            return this.openPrompt(__varRecorder__$1.part(__varRecorder__$1.prompts.InformPrompt, {
              viewModel: Object.assign({
                label: label
              }, opts)
            }), opts);
          }
        }, {
          key: "prompt",
          value: function LivelyWorld_prompt_(label) {
            var opts = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {
              requester: null,
              input: "",
              historyId: null,
              useLastInput: false,
              selectInput: false
            };
            return this.openPrompt(__varRecorder__$1.part(__varRecorder__$1.prompts.TextPrompt, {
              viewModel: Object.assign({
                label: label
              }, opts)
            }), opts);
          }
        }, {
          key: "editPrompt",
          value: function LivelyWorld_editPrompt_(label) {
            var opts = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {
              requester: null,
              input: "",
              historyId: null,
              useLastInput: false,
              textStyle: null,
              mode: null,
              evalEnvironment: null
            };
            return this.openPrompt(__varRecorder__$1.part(__varRecorder__$1.prompts.EditPrompt, {
              viewModel: Object.assign({
                label: label
              }, opts)
            }), opts);
          }
        }, {
          key: "passwordPrompt",
          value: function LivelyWorld_passwordPrompt_(label) {
            var opts = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {
              requester: null,
              input: ""
            };
            return this.openPrompt(__varRecorder__$1.part(__varRecorder__$1.prompts.PasswordPrompt, {
              viewModel: Object.assign({
                label: label
              }, opts)
            }), opts);
          }
        }, {
          key: "confirm",
          value: function LivelyWorld_confirm_(label) {
            var opts = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {
              requester: null,
              animated: true
            };
            return this.openPrompt(__varRecorder__$1.part(__varRecorder__$1.prompts.ConfirmPrompt, {
              viewModel: Object.assign({
                label: label
              }, opts)
            }), opts);
          }
        }, {
          key: "multipleChoicePrompt",
          value: function LivelyWorld_multipleChoicePrompt_(label) {
            var opts = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {
              requester: null,
              animated: true,
              choices: []
            };
            return this.openPrompt(__varRecorder__$1.part(__varRecorder__$1.prompts.MultipleChoicePrompt, {
              viewModel: Object.assign({
                label: label
              }, opts)
            }), opts);
          }
        }, {
          key: "listPrompt",
          value: function LivelyWorld_listPrompt_() {
            var label = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : "";
            var items = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : [];
            var opts = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {
              requester: null,
              onSelection: null,
              preselect: 0
            };
            return this.openPrompt(__varRecorder__$1.part(__varRecorder__$1.prompts.ListPrompt, {
              viewModel: Object.assign({
                filterable: false,
                padding: __varRecorder__$1.Rectangle.inset(3),
                label: label,
                items: items
              }, opts)
            }), opts);
          }
        }, {
          key: "filterableListPrompt",
          value: function LivelyWorld_filterableListPrompt_() {
            var label = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : "";
            var items = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : [];
            var opts = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {
              requester: null,
              onSelection: null,
              preselect: 0,
              multiSelect: false,
              historyId: null,
              fuzzy: false,
              actions: ["default"],
              selectedAction: "default",
              theme: "dark"
            };
            var list;

            if (opts.prompt) {
              opts.prompt.items = items;
              opts.prompt.ui.list.selectedIndex = opts.preselect || 0;
              return this.openPrompt(opts.prompt.view, opts);
            }

            list = __varRecorder__$1.part(__varRecorder__$1.prompts.ListPrompt, {
              viewModel: Object.assign({
                filterable: true,
                padding: __varRecorder__$1.Rectangle.inset(3),
                label: label,
                items: items
              }, opts)
            });
            return this.openPrompt(list, opts);
          }
        }, {
          key: "editListPrompt",
          value: function LivelyWorld_editListPrompt_() {
            var label = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : "";
            var items = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : [];
            var opts = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {
              requester: null,
              multiSelect: true,
              historyId: null
            };
            return this.openPrompt(__varRecorder__$1.part(__varRecorder__$1.prompts.EditListPrompt, {
              viewModel: Object.assign({
                label: label,
                multiSelect: true,
                items: items,
                padding: __varRecorder__$1.Rectangle.inset(3)
              }, opts)
            }), opts);
          }
        }, {
          key: "showLoadingIndicatorFor",
          value: function LivelyWorld_showLoadingIndicatorFor_(requester, label) {
            var li = __varRecorder__$1.LoadingIndicator.open(label, {
              target: requester
            });

            if (requester === null || requester === void 0 ? void 0 : requester.hasFixedPosition) li.hasFixedPosition = true;
            return li;
          }
        }, {
          key: "withLoadingIndicatorDo",
          value: function () {
            var _LivelyWorld_withLoadingIndicatorDo_ = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee17(doFn, requester, label) {
              var pBar;
              return regeneratorRuntime.wrap(function _callee17$(_context17) {
                while (1) {
                  switch (_context17.prev = _context17.next) {
                    case 0:
                      _context17.next = 2;
                      return this.showLoadingIndicatorFor(requester, label);

                    case 2:
                      pBar = _context17.sent;
                      _context17.prev = 3;
                      _context17.next = 6;
                      return doFn(pBar);

                    case 6:
                      return _context17.abrupt("return", _context17.sent);

                    case 7:
                      _context17.prev = 7;
                      pBar.remove();
                      return _context17.finish(7);

                    case 10:
                    case "end":
                      return _context17.stop();
                  }
                }
              }, _callee17, this, [[3,, 7, 10]]);
            }));

            function LivelyWorld_withLoadingIndicatorDo_(_x10, _x11, _x12) {
              return _LivelyWorld_withLoadingIndicatorDo_.apply(this, arguments);
            }

            return LivelyWorld_withLoadingIndicatorDo_;
          }()
        }, {
          key: "defaultMenuItems",
          value: function LivelyWorld_defaultMenuItems_(morph, evt) {
            var _this9 = this;

            var world = this;
            var items = [];
            var self = morph;

            if (this.reset && typeof this.reset === "function") {
              items.push(["Reset", function () {
                _this9.reset();
              }]);
            }

            items.push(["Open in...", [["Window", function () {
              self.openInWindow();
            }]]]);

            function menuItemsForMorphsBeneathMe(itemCallback) {
              var _this10 = this;

              var morphs = world.morphsContainingPoint(self.worldPoint(__varRecorder__$1.pt(0, 0)));
              morphs.pop();
              var selfInList = morphs.indexOf(self);
              morphs = morphs.slice(selfInList + 1);
              return morphs.map(function (ea) {
                return [String(ea), itemCallback.bind(_this10, ea)];
              });
            }

            items.push(["Add morph to...", {
              getItems: menuItemsForMorphsBeneathMe.bind(self, function (morph) {
                return morph.addMorph(self);
              })
            }]);
            items.push(["Get halo on...", {
              getItems: menuItemsForMorphsBeneathMe.bind(self, function (morph) {
                return morph.world().showHaloFor(morph);
              })
            }]);

            if (self.owner && self.owner.submorphs.length > 1) {
              items.push(["Arrange morph", [["Bring to front", function () {
                return self.owner.addMorph(self);
              }], ["Send to back", function () {
                return self.owner.addMorphBack(self);
              }], ["Fit to submorphs", /*#__PURE__*/_asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee18() {
                var padding, _yield$__varRecorder_, value;

                return regeneratorRuntime.wrap(function _callee18$(_context18) {
                  while (1) {
                    switch (_context18.prev = _context18.next) {
                      case 0:
                        _context18.next = 2;
                        return self.world().prompt("Padding around submorphs:", {
                          input: "Rectangle.inset(5)",
                          historyId: "lively.morphic-fit-to-submorphs-padding-hist",
                          requester: self
                        });

                      case 2:
                        padding = _context18.sent;

                        if (!(typeof padding !== "string")) {
                          _context18.next = 5;
                          break;
                        }

                        return _context18.abrupt("return");

                      case 5:
                        _context18.next = 7;
                        return __varRecorder__$1.runEval(padding, {
                          topLevelVarRecorder: {
                            Rectangle: __varRecorder__$1.Rectangle
                          }
                        });

                      case 7:
                        _yield$__varRecorder_ = _context18.sent;
                        value = _yield$__varRecorder_.value;
                        padding = value && value.isRectangle ? value : __varRecorder__$1.Rectangle.inset(0);
                        self.undoStart("fitToSubmorphs");
                        self.fitToSubmorphs(padding);
                        self.undoStop("fitToSubmorphs");

                      case 13:
                      case "end":
                        return _context18.stop();
                    }
                  }
                }, _callee18);
              }))]].concat(_toConsumableArray(__varRecorder__$1.PropertyPath("master.auto").get(self) ? [["Adjust to Master Component Submorph Hierarchy", function () {
                return self.master.reconcileSubmorphs();
              }]] : []))]);
            }

            if (this.submorphs.length) {
              items.push(["Select all submorphs", function () {
                return self.world().showHaloFor(self.submorphs.slice());
              }]);
            }

            var steppingItems = [];

            if (self.startSteppingScripts) {
              steppingItems.push(["Start stepping", function () {
                self.startSteppingScripts();
              }]);
            } else {
              steppingItems.push(["Start stepping", /*#__PURE__*/_asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee19() {
                var items, _iterator5, _step5, methodsPerProto, _methodsPerProto, protoName, methods, _iterator6, _step6, method, _ref7, _ref8, selector, _args20, _yield$$world$filtera, _yield$$world$filtera2, choice, time, args, evalEnvironment, _args, _yield$__varRecorder_2, _argsEvaled, isError;

                return regeneratorRuntime.wrap(function _callee19$(_context19) {
                  while (1) {
                    switch (_context19.prev = _context19.next) {
                      case 0:
                        items = [];
                        _context19.t0 = _createForOfIteratorHelper;
                        _context19.next = 4;
                        return __varRecorder__$1.completions.getCompletions(function () {
                          return self;
                        }, "");

                      case 4:
                        _context19.t1 = _context19.sent.completions;
                        _iterator5 = (0, _context19.t0)(_context19.t1);
                        _context19.prev = 6;

                        _iterator5.s();

                      case 8:
                        if ((_step5 = _iterator5.n()).done) {
                          _context19.next = 34;
                          break;
                        }

                        methodsPerProto = _step5.value;
                        _methodsPerProto = _slicedToArray(methodsPerProto, 2), protoName = _methodsPerProto[0], methods = _methodsPerProto[1];
                        _iterator6 = _createForOfIteratorHelper(methods);
                        _context19.prev = 12;

                        _iterator6.s();

                      case 14:
                        if ((_step6 = _iterator6.n()).done) {
                          _context19.next = 24;
                          break;
                        }

                        method = _step6.value;

                        if (!(method.startsWith("_") || method.startsWith("$"))) {
                          _context19.next = 18;
                          break;
                        }

                        return _context19.abrupt("continue", 22);

                      case 18:
                        _ref7 = method.match(/^([^\(]+)\(?([^\)]+)?\)?$/) || [], _ref8 = _slicedToArray(_ref7, 3), selector = _ref8[1], _args20 = _ref8[2];

                        if (!(!selector || typeof self[selector] !== "function")) {
                          _context19.next = 21;
                          break;
                        }

                        return _context19.abrupt("continue", 22);

                      case 21:
                        items.push({
                          isListItem: true,
                          string: "".concat(protoName, " ").concat(method),
                          value: {
                            selector: selector,
                            args: _args20
                          }
                        });

                      case 22:
                        _context19.next = 14;
                        break;

                      case 24:
                        _context19.next = 29;
                        break;

                      case 26:
                        _context19.prev = 26;
                        _context19.t2 = _context19["catch"](12);

                        _iterator6.e(_context19.t2);

                      case 29:
                        _context19.prev = 29;

                        _iterator6.f();

                        return _context19.finish(29);

                      case 32:
                        _context19.next = 8;
                        break;

                      case 34:
                        _context19.next = 39;
                        break;

                      case 36:
                        _context19.prev = 36;
                        _context19.t3 = _context19["catch"](6);

                        _iterator5.e(_context19.t3);

                      case 39:
                        _context19.prev = 39;

                        _iterator5.f();

                        return _context19.finish(39);

                      case 42:
                        _context19.next = 44;
                        return $world.filterableListPrompt("Select method to start", items, {
                          requester: self,
                          historyId: "lively.morphic-start-stepping-chooser"
                        });

                      case 44:
                        _yield$$world$filtera = _context19.sent;
                        _yield$$world$filtera2 = _slicedToArray(_yield$$world$filtera.selected, 1);
                        choice = _yield$$world$filtera2[0];

                        if (choice) {
                          _context19.next = 49;
                          break;
                        }

                        return _context19.abrupt("return");

                      case 49:
                        _context19.next = 51;
                        return $world.prompt("Steptime in ms (how of the method will be called)?", {
                          input: 100
                        });

                      case 51:
                        time = _context19.sent;
                        time = Number(time);

                        if (!isNaN(time)) {
                          _context19.next = 55;
                          break;
                        }

                        return _context19.abrupt("return");

                      case 55:
                        args = [time, choice.selector];

                        if (!choice.args) {
                          _context19.next = 70;
                          break;
                        }

                        evalEnvironment = {
                          targetModule: "lively://lively.morphic-stepping-args/eval.js"
                        };
                        _context19.next = 60;
                        return $world.editPrompt("Arguments to pass", {
                          input: "[".concat(choice.args, "]"),
                          mode: "js",
                          evalEnvironment: evalEnvironment
                        });

                      case 60:
                        _args = _context19.sent;
                        _context19.next = 63;
                        return __varRecorder__$1.runEval(_args, evalEnvironment);

                      case 63:
                        _yield$__varRecorder_2 = _context19.sent;
                        _argsEvaled = _yield$__varRecorder_2.value;
                        isError = _yield$__varRecorder_2.isError;

                        if (!isError) {
                          _context19.next = 69;
                          break;
                        }

                        $world.inform("Error evaluating the arguments: ".concat(_argsEvaled));
                        return _context19.abrupt("return");

                      case 69:
                        if (Array.isArray(_argsEvaled)) {
                          args.push.apply(args, _toConsumableArray(_argsEvaled));
                        }

                      case 70:
                        self.startStepping.apply(self, args);

                      case 71:
                      case "end":
                        return _context19.stop();
                    }
                  }
                }, _callee19, null, [[6, 36, 39, 42], [12, 26, 29, 32]]);
              }))]);
            }

            if (self.tickingScripts.length !== 0) {
              steppingItems.push(["Stop stepping", function () {
                return self.stopStepping();
              }]);
            }

            if (steppingItems.length !== 0) {
              items.push(["Stepping", steppingItems]);
            }

            items.push(["Change Tooltip", /*#__PURE__*/_asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee20() {
              var tooltip;
              return regeneratorRuntime.wrap(function _callee20$(_context20) {
                while (1) {
                  switch (_context20.prev = _context20.next) {
                    case 0:
                      _context20.next = 2;
                      return self.world().prompt("Enter Tooltip", {
                        placeholder: "Description",
                        input: self.tooltip || ""
                      });

                    case 2:
                      tooltip = _context20.sent;
                      self.withMetaDo({
                        reconcileChanges: true
                      }, function () {
                        self.tooltip = tooltip;
                      });

                    case 4:
                    case "end":
                      return _context20.stop();
                  }
                }
              }, _callee20);
            }))]);
            var morphicMenuItems = ["Morphic properties", []];
            items.push(morphicMenuItems);
            items.push(["display serialization info", /*#__PURE__*/_asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee21() {
              var _yield$import6, SnapshotInspector, snapshot;

              return regeneratorRuntime.wrap(function _callee21$(_context21) {
                while (1) {
                  switch (_context21.prev = _context21.next) {
                    case 0:
                      _context21.next = 2;
                      return module.import('./debugging-91eb99b4.js');

                    case 2:
                      _yield$import6 = _context21.sent;
                      SnapshotInspector = _yield$import6.SnapshotInspector;
                      snapshot = __varRecorder__$1.serialize(self);
                      SnapshotInspector.forSnapshot(snapshot).openSummary();

                    case 6:
                    case "end":
                      return _context21.stop();
                  }
                }
              }, _callee21);
            }))]);
            items.push(["display object report", /*#__PURE__*/_asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee22() {
              var _yield$import7, SnapshotInspector, snapshot;

              return regeneratorRuntime.wrap(function _callee22$(_context22) {
                while (1) {
                  switch (_context22.prev = _context22.next) {
                    case 0:
                      _context22.next = 2;
                      return module.import('./debugging-91eb99b4.js');

                    case 2:
                      _yield$import7 = _context22.sent;
                      SnapshotInspector = _yield$import7.SnapshotInspector;
                      snapshot = __varRecorder__$1.serialize(self);
                      SnapshotInspector.forSnapshot(snapshot).openObjectReport();

                    case 6:
                    case "end":
                      return _context22.stop();
                  }
                }
              }, _callee22);
            }))]);

            var checked = __varRecorder__$1.Icon.textAttribute("check-square");

            var unchecked = __varRecorder__$1.Icon.textAttribute("square");

            Object.assign(checked[1], {
              "float": "none",
              display: "inline"
            });
            ["grabbable", "draggable", "acceptsDrops", "halosEnabled"].forEach(function (propName) {
              return morphicMenuItems[1].push([[].concat(_toConsumableArray(morph[propName] ? checked : unchecked), [" " + propName, {
                "float": "none"
              }]), function () {
                return morph[propName] = !morph[propName];
              }]);
            });
            items.push(["export to HTML", /*#__PURE__*/_asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee23() {
              var _yield$import8, generateHTML;

              return regeneratorRuntime.wrap(function _callee23$(_context23) {
                while (1) {
                  switch (_context23.prev = _context23.next) {
                    case 0:
                      _context23.next = 2;
                      return module.import('./html-generator-d5ca1544.js');

                    case 2:
                      _yield$import8 = _context23.sent;
                      generateHTML = _yield$import8.generateHTML;
                      _context23.t0 = __varRecorder__$1.HTMLMorph;
                      _context23.t1 = "exported-" + morph.name;
                      _context23.next = 8;
                      return generateHTML(morph, null, {
                        isFragment: true,
                        addStyles: false
                      });

                    case 8:
                      _context23.t2 = _context23.sent;
                      _context23.t3 = {
                        name: _context23.t1,
                        html: _context23.t2
                      };
                      new _context23.t0(_context23.t3).openInWorld();

                    case 11:
                    case "end":
                      return _context23.stop();
                  }
                }
              }, _callee23);
            }))]);
            items.push(["Remove Morph", function () {
              return self.abandon(true);
            }]);
            items.push(["Rename Morph", /*#__PURE__*/_asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee24() {
              var newName;
              return regeneratorRuntime.wrap(function _callee24$(_context24) {
                while (1) {
                  switch (_context24.prev = _context24.next) {
                    case 0:
                      _context24.next = 2;
                      return $world.prompt("Enter new Name for Morph", {
                        input: self.name
                      });

                    case 2:
                      newName = _context24.sent;

                      if (newName) {
                        _context24.next = 5;
                        break;
                      }

                      return _context24.abrupt("return");

                    case 5:
                      self.name = newName;

                    case 6:
                    case "end":
                      return _context24.stop();
                  }
                }
              }, _callee24);
            }))]);
            items.push(["Open Inspector", function () {
              return self.inspect();
            }]);
            items.push({
              isDivider: true
            });
            items.push(["Add comment", /*#__PURE__*/_asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee25() {
              var commentText, relativePosition, xRelative, yRelative;
              return regeneratorRuntime.wrap(function _callee25$(_context25) {
                while (1) {
                  switch (_context25.prev = _context25.next) {
                    case 0:
                      _context25.next = 2;
                      return $world.prompt("Enter comment");

                    case 2:
                      commentText = _context25.sent;

                      if (commentText) {
                        relativePosition = __varRecorder__$1.pt(0, 0);

                        if (evt && !evt.halo) {
                          xRelative = self.localize(evt.position).x / self.width;
                          yRelative = self.localize(evt.position).y / self.height;
                          relativePosition = __varRecorder__$1.pt(xRelative, yRelative);
                        }

                        $world.addCommentFor(self, commentText, relativePosition);
                        $world.setStatusMessage("Comment saved", __varRecorder__$1.StatusMessageConfirm);
                      } else {
                        $world.setStatusMessage("Comment not saved", __varRecorder__$1.StatusMessageError);
                      }

                    case 4:
                    case "end":
                      return _context25.stop();
                  }
                }
              }, _callee25);
            }))]);
            return items;
          }
        }, {
          key: "defaultConnectionMenuItems",
          value: function LivelyWorld_defaultConnectionMenuItems_(morph) {
            var self = morph;
            if (!self.attributeConnections || !self.attributeConnections.length) return null;
            return self.attributeConnections.map(function (c) {
              return [String(c), [["show", /*#__PURE__*/_asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee26() {
                var _yield$import9, interactivelyShowConnection;

                return regeneratorRuntime.wrap(function _callee26$(_context26) {
                  while (1) {
                    switch (_context26.prev = _context26.next) {
                      case 0:
                        _context26.next = 2;
                        return module.import('./fabrik-de151c15.js');

                      case 2:
                        _yield$import9 = _context26.sent;
                        interactivelyShowConnection = _yield$import9.interactivelyShowConnection;
                        interactivelyShowConnection(c);

                      case 5:
                      case "end":
                        return _context26.stop();
                    }
                  }
                }, _callee26);
              }))], ["edit", /*#__PURE__*/_asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee27() {
                var _yield$import10, interactivelyReEvaluateConnection;

                return regeneratorRuntime.wrap(function _callee27$(_context27) {
                  while (1) {
                    switch (_context27.prev = _context27.next) {
                      case 0:
                        _context27.next = 2;
                        return module.import('./fabrik-de151c15.js');

                      case 2:
                        _yield$import10 = _context27.sent;
                        interactivelyReEvaluateConnection = _yield$import10.interactivelyReEvaluateConnection;
                        interactivelyReEvaluateConnection(c);

                      case 5:
                      case "end":
                        return _context27.stop();
                    }
                  }
                }, _callee27);
              }))], ["disconnect", function () {
                c.disconnect();
                $world.setStatusMessage("disconnected " + c);
              }]]];
            });
          }
        }, {
          key: "defaultSourceDataBindings",
          value: function LivelyWorld_defaultSourceDataBindings_(morph) {
            var self = morph;
            var allProps = self.propertiesAndPropertySettings().properties;

            var groupedProps = __varRecorder__$1.arr.groupByKey(Object.keys(allProps).map(function (name) {
              var props = Object.assign({
                name: name
              }, allProps[name]);
              if (props.group && props.group.startsWith("_")) return null;
              return props;
            }).filter(Boolean), "group");

            var customOrder = ["core", "geometry", "interaction", "styling", "layouting"];
            var sortedGroupedProps = [];
            customOrder.forEach(function (ea) {
              return sortedGroupedProps.push(groupedProps[ea]);
            });

            __varRecorder__$1.arr.withoutAll(groupedProps.keys(), customOrder).forEach(function (ea) {
              return sortedGroupedProps.push(groupedProps[ea]);
            });

            return sortedGroupedProps;
          }
        }, {
          key: "targetDataBindings",
          value: function LivelyWorld_targetDataBindings_(morph) {
            var self = morph;
            var methodsByProto = [];

            for (var proto = self; proto !== Object.prototype;) {
              var protoName = proto === self ? String(this) : __varRecorder__$1.getClassName(proto);
              var group = null;

              var descrs = __varRecorder__$1.obj.getOwnPropertyDescriptors(proto);

              var nextProto = Object.getPrototypeOf(proto);

              for (var prop in descrs) {
                var val = descrs[prop].value;
                if (typeof val !== "function" || val === proto.constructor) continue;
                if (prop.startsWith("$") || prop.startsWith("_")) continue;
                if (!group) group = [];

                var args = __varRecorder__$1.fun.argumentNames(val);

                group.push({
                  group: protoName + " methods",
                  signature: "".concat(prop, "(").concat(args.join(", "), ")"),
                  name: prop
                });
              }

              if (group) methodsByProto.push(group);
              proto = nextProto;
            }

            return this.defaultSourceDataBindings(self).concat(methodsByProto);
          }
        }, {
          key: "defaultConnectMenuItems",
          value: function LivelyWorld_defaultConnectMenuItems_(actionFn, morph) {
            var _this11 = this;

            var self = morph;
            var bindings = this.defaultSourceDataBindings(morph);
            var w = self.world();
            var items = bindings.map(function (group) {
              return [group[0].group || "uncategorized", group.map(function (ea) {
                return [ea.name, actionFn ? function () {
                  return actionFn(ea.name, self, ea);
                } : /*#__PURE__*/_asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee28() {
                  var _yield$import11, interactiveConnectGivenSource;

                  return regeneratorRuntime.wrap(function _callee28$(_context28) {
                    while (1) {
                      switch (_context28.prev = _context28.next) {
                        case 0:
                          _context28.next = 2;
                          return module.import('./fabrik-de151c15.js');

                        case 2:
                          _yield$import11 = _context28.sent;
                          interactiveConnectGivenSource = _yield$import11.interactiveConnectGivenSource;
                          interactiveConnectGivenSource(self, ea.name);

                        case 5:
                        case "end":
                          return _context28.stop();
                      }
                    }
                  }, _callee28);
                }))];
              })];
            });
            w && items.push(["custom...", actionFn ? function () {
              return actionFn("custom...", self, null);
            } : /*#__PURE__*/_asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee29() {
              var _yield$import12, interactiveConnectGivenSource, attr;

              return regeneratorRuntime.wrap(function _callee29$(_context29) {
                while (1) {
                  switch (_context29.prev = _context29.next) {
                    case 0:
                      _context29.next = 2;
                      return module.import('./fabrik-de151c15.js');

                    case 2:
                      _yield$import12 = _context29.sent;
                      interactiveConnectGivenSource = _yield$import12.interactiveConnectGivenSource;
                      _context29.next = 6;
                      return w.prompt("Enter custom connection point", {
                        requester: self,
                        historyId: "lively.morphic-custom-connection-points",
                        useLastInput: true
                      });

                    case 6:
                      attr = _context29.sent;
                      if (attr) interactiveConnectGivenSource(_this11, attr);

                    case 8:
                    case "end":
                      return _context29.stop();
                  }
                }
              }, _callee29);
            }))]);
            return items;
          }
        }, {
          key: "updateVisibleWindowMorphs",
          value: function LivelyWorld_updateVisibleWindowMorphs_() {
            var _this12 = this;

            initializeClass._get(Object.getPrototypeOf(__lively_class__.prototype), "updateVisibleWindowMorphs", this).call(this);

            this.halos().forEach(function (halo) {
              halo.maskBounds = _this12.visibleBounds();
            });
          }
        }], [{
          key: Symbol["for"]("__LivelyClassName__"),
          get: function get() {
            return "LivelyWorld";
          }
        }, {
          key: "properties",
          get: function get() {
            return {
              openNewProjectPrompt: {},
              openNewWorldPrompt: {},
              projectToBeOpened: {},
              projectRepoOwner: {},
              playgroundsMode: {
                get: function get() {
                  return !(this.openNewProjectPrompt || this.projectToBeOpened || this.openedProject);
                }
              },
              fileWatcher: {
                initialize: function initialize() {
                  this.fileWatcher = new __varRecorder__$1.FileWatcher();
                }
              },
              clipMode: {
                defaultValue: "hidden",
                readOnly: true,
                set: function set() {}
              },
              hideScrollbars: {
                defaultValue: true
              },
              name: {
                set: function set(name) {
                  this.setProperty("name", name);
                  document.title = "lively.next - ".concat(name);
                }
              },
              activeSideBars: {
                serialize: false,
                initialize: function initialize() {
                  this.activeSideBars = [];
                }
              },
              hiddenComponents: {
                initialize: function initialize() {
                  this.hiddenComponents = [];
                }
              },
              fill: {
                defaultValue: __varRecorder__$1.Color.rgb(81, 90, 90)
              },
              draggable: {
                readOnly: true,
                get: function get() {
                  return !__varRecorder__$1.touchInputDevice;
                }
              },
              morphCommentMap: {
                initialize: function initialize() {
                  this.morphCommentMap = new Map();
                },
                doc: "Stores a mapping from Morphs to an Array with their comments (if they have any)."
              },
              scaleFactor: {
                defaultValue: 1
              },
              offsetX: {
                defaultValue: 0
              },
              offsetY: {
                defaultValue: 0
              }
            };
          }
        }], __lively_classholder__, {
          pathInPackage: function pathInPackage() {
            return "./world.js";
          },
          unsubscribeFromToplevelDefinitionChanges: function unsubscribeFromToplevelDefinitionChanges() {
            return function () {};
          },
          subscribeToToplevelDefinitionChanges: function subscribeToToplevelDefinitionChanges() {
            return function () {};
          },
          "package": function _package() {
            return {
              name: "lively.ide",
              version: "0.1.0"
            };
          }
        }, {
          start: 1890,
          end: 58279
        });
      }(__varRecorder__$1.World));
      __varRecorder__$1.LivelyWorld = LivelyWorld;
      __varRecorder__$1.LivelyWorld = LivelyWorld;

      (function (superclass) {
        var __lively_classholder__ = lively.FreezerRuntime.recorderFor("lively.ide/world.js");

        var __lively_class__ = __lively_classholder__.hasOwnProperty("FileWatcher") && typeof __lively_classholder__.FileWatcher === "function" ? __lively_classholder__.FileWatcher : __lively_classholder__.FileWatcher = function FileWatcher(__first_arg__) {
          if (__first_arg__ && __first_arg__[Symbol["for"]("lively-instance-restorer")]) ; else {
            return this[Symbol["for"]("lively-instance-initialize")].apply(this, arguments);
          }
        };

        return initializeClass(__lively_class__, superclass, [{
          key: Symbol["for"]("lively-instance-initialize"),
          value: function FileWatcher_initialize_() {
            this.fileActions = {};
            this.onFileSave.bind(this);

            __varRecorder__$1.subscribe("file/save", this.onFileSave.bind(this));
          }
        }, {
          key: "clear",
          value: function FileWatcher_clear_() {
            this.fileActions = {};
          }
        }, {
          key: "registerFileAction",
          value: function FileWatcher_registerFileAction_(file, cB) {
            if (this.fileActions[file]) {
              if (Array.isArray(this.fileActions[file])) this.fileActions[file].push(cB);else this.fileActions[file] = [this.fileActions[file], cB];
            } else {
              this.fileActions[file] = cB;
            }
          }
        }, {
          key: "unregisterFileActions",
          value: function FileWatcher_unregisterFileActions_(file) {
            this.fileActions[file] = null;
          }
        }, {
          key: "onFileSave",
          value: function () {
            var _FileWatcher_onFileSave_ = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee30(savedFileData) {
              var actions, _iterator7, _step7, action;

              return regeneratorRuntime.wrap(function _callee30$(_context30) {
                while (1) {
                  switch (_context30.prev = _context30.next) {
                    case 0:
                      if (this.fileActions[savedFileData.resource]) {
                        _context30.next = 2;
                        break;
                      }

                      return _context30.abrupt("return");

                    case 2:
                      actions = this.fileActions[savedFileData.resource];

                      if (!Array.isArray(actions)) {
                        _context30.next = 23;
                        break;
                      }

                      _iterator7 = _createForOfIteratorHelper(actions);
                      _context30.prev = 5;

                      _iterator7.s();

                    case 7:
                      if ((_step7 = _iterator7.n()).done) {
                        _context30.next = 13;
                        break;
                      }

                      action = _step7.value;
                      _context30.next = 11;
                      return action();

                    case 11:
                      _context30.next = 7;
                      break;

                    case 13:
                      _context30.next = 18;
                      break;

                    case 15:
                      _context30.prev = 15;
                      _context30.t0 = _context30["catch"](5);

                      _iterator7.e(_context30.t0);

                    case 18:
                      _context30.prev = 18;

                      _iterator7.f();

                      return _context30.finish(18);

                    case 21:
                      _context30.next = 25;
                      break;

                    case 23:
                      _context30.next = 25;
                      return actions();

                    case 25:
                    case "end":
                      return _context30.stop();
                  }
                }
              }, _callee30, this, [[5, 15, 18, 21]]);
            }));

            function FileWatcher_onFileSave_(_x13) {
              return _FileWatcher_onFileSave_.apply(this, arguments);
            }

            return FileWatcher_onFileSave_;
          }()
        }], [{
          key: Symbol["for"]("__LivelyClassName__"),
          get: function get() {
            return "FileWatcher";
          }
        }], __lively_classholder__, {
          pathInPackage: function pathInPackage() {
            return "./world.js";
          },
          unsubscribeFromToplevelDefinitionChanges: function unsubscribeFromToplevelDefinitionChanges() {
            return function () {};
          },
          subscribeToToplevelDefinitionChanges: function subscribeToToplevelDefinitionChanges() {
            return function () {};
          },
          "package": function _package() {
            return {
              name: "lively.ide",
              version: "0.1.0"
            };
          }
        }, {
          start: 58281,
          end: 59116
        });
      })(undefined);

      var world = /*#__PURE__*/Object.freeze({
        __proto__: null,
        LivelyWorld: LivelyWorld
      });
      exports('w', world);

      var __varRecorder__ = lively.FreezerRuntime.recorderFor("engageLively--galyleo-dashboard/publication/index.js");

      function main() {
        return _main.apply(this, arguments);
      }

      function _main() {
        _main = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee() {
          var _yield$import, GalyleoDashboardPublication, dashboard;

          return regeneratorRuntime.wrap(function _callee$(_context) {
            while (1) {
              switch (_context.prev = _context.next) {
                case 0:
                  __varRecorder__.config.ide.studio.canvasModeEnabled = false;
                  _context.next = 3;
                  return module.import('./index-3bdd1c4b.js');

                case 3:
                  _yield$import = _context.sent;
                  GalyleoDashboardPublication = _yield$import.GalyleoDashboardPublication;
                  dashboard = __varRecorder__.part(GalyleoDashboardPublication);
                  dashboard.respondsToVisibleWindow = true;
                  $world.addMorph(dashboard);
                  dashboard.relayout();

                case 9:
                case "end":
                  return _context.stop();
              }
            }
          }, _callee);
        }));
        return _main.apply(this, arguments);
      }

      __varRecorder__.main = main;
      __varRecorder__.part = part;
      __varRecorder__.config = config;
      __varRecorder__.LivelyWorld = LivelyWorld;
      __varRecorder__.main = main;
      var TITLE = "Galyleo Dashboard";
      __varRecorder__.TITLE = TITLE;
      __varRecorder__.TITLE = TITLE;
      var WORLD_CLASS = __varRecorder__.LivelyWorld;
      __varRecorder__.WORLD_CLASS = WORLD_CLASS;
      __varRecorder__.WORLD_CLASS = WORLD_CLASS;
      var EXCLUDED_MODULES = ["pouchdb", "pouchdb-adapter-mem", "rollup", "lively.freezer", "lively.modules", "lively.storage", "lively.user"];
      __varRecorder__.EXCLUDED_MODULES = EXCLUDED_MODULES;
      __varRecorder__.EXCLUDED_MODULES = EXCLUDED_MODULES;

      var index = /*#__PURE__*/Object.freeze({
        __proto__: null,
        main: main,
        TITLE: TITLE,
        WORLD_CLASS: WORLD_CLASS,
        EXCLUDED_MODULES: EXCLUDED_MODULES
      });
      exports('i', index);

    })
  };
}));
